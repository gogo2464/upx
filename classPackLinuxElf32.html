<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: PackLinuxElf32 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classPackLinuxElf32.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="classPackLinuxElf32-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PackLinuxElf32 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PackLinuxElf32:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32__inherit__graph.png" border="0" usemap="#aPackLinuxElf32_inherit__map" alt="Inheritance graph"/></div>
<map name="aPackLinuxElf32_inherit__map" id="aPackLinuxElf32_inherit__map">
<area shape="rect" title=" " alt="" coords="544,153,664,179"/>
<area shape="rect" href="classPackLinuxElf32Be.html" title=" " alt="" coords="712,80,849,105"/>
<area shape="rect" href="classPackLinuxElf32Le.html" title=" " alt="" coords="713,177,848,203"/>
<area shape="rect" href="classPackLinuxElf.html" title=" " alt="" coords="392,153,496,179"/>
<area shape="rect" href="classPackUnix.html" title="Abstract class for all Unix&#45;type packers." alt="" coords="261,153,344,179"/>
<area shape="rect" href="classPacker.html" title="Packer: default implementation base class for all current packers." alt="" coords="149,153,213,179"/>
<area shape="rect" href="classPackerBase.html" title="PackerBase: abstract minimal base class for all packers." alt="" coords="5,153,101,179"/>
<area shape="rect" href="classPackLinuxElf32armBe.html" title=" " alt="" coords="900,5,1063,31"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html" title=" " alt="" coords="897,55,1065,80"/>
<area shape="rect" href="classPackLinuxElf32ppc.html" title="linux/elf32ppc" alt="" coords="910,104,1053,129"/>
<area shape="rect" href="classPackLinuxElf32armLe.html" title="linux/elfarm" alt="" coords="901,153,1062,179"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html" title=" " alt="" coords="899,203,1063,228"/>
<area shape="rect" href="classPackLinuxElf32x86.html" title="linux/elf386" alt="" coords="909,252,1053,277"/>
<area shape="rect" href="classPackBSDElf32x86.html" title=" " alt="" coords="1137,203,1273,228"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html" title="linux/interp386" alt="" coords="1113,252,1296,277"/>
<area shape="rect" href="classPackNetBSDElf32x86.html" title=" " alt="" coords="1125,301,1284,327"/>
<area shape="rect" href="classPackFreeBSDElf32x86.html" title=" " alt="" coords="1347,179,1511,204"/>
<area shape="rect" href="classPackOpenBSDElf32x86.html" title=" " alt="" coords="1344,228,1515,253"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for PackLinuxElf32:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32__coll__graph.png" border="0" usemap="#aPackLinuxElf32_coll__map" alt="Collaboration graph"/></div>
<map name="aPackLinuxElf32_coll__map" id="aPackLinuxElf32_coll__map">
<area shape="rect" title=" " alt="" coords="1636,346,1756,371"/>
<area shape="rect" href="classPackLinuxElf.html" title=" " alt="" coords="1447,321,1551,346"/>
<area shape="rect" href="classPackUnix.html" title="Abstract class for all Unix&#45;type packers." alt="" coords="1315,201,1397,226"/>
<area shape="rect" href="classPacker.html" title="Packer: default implementation base class for all current packers." alt="" coords="1103,159,1167,185"/>
<area shape="rect" href="classPackerBase.html" title="PackerBase: abstract minimal base class for all packers." alt="" coords="923,133,1019,158"/>
<area shape="rect" href="classInputFile.html" title=" " alt="" coords="705,95,784,121"/>
<area shape="rect" href="classFileBase.html" title=" " alt="" coords="367,95,445,121"/>
<area shape="rect" href="structPackHeader.html" title="PackHeader also see stub/src/include/header.S." alt="" coords="695,145,794,170"/>
<area shape="rect" href="structupx__compress__result__t.html" title=" " alt="" coords="320,145,492,170"/>
<area shape="rect" href="structupx__compress__result__t_1_1Debug.html" title=" " alt="" coords="17,5,177,45"/>
<area shape="rect" href="structbzip2__compress__result__t.html" title="compression &#45; result_t" alt="" coords="5,70,188,95"/>
<area shape="rect" href="structlzma__compress__result__t.html" title=" " alt="" coords="7,119,187,145"/>
<area shape="rect" href="structucl__compress__result__t.html" title=" " alt="" coords="13,169,180,194"/>
<area shape="rect" href="structzlib__compress__result__t.html" title=" " alt="" coords="11,218,182,243"/>
<area shape="rect" href="structzstd__compress__result__t.html" title=" " alt="" coords="9,267,184,293"/>
<area shape="rect" href="classMemBuffer.html" title="MemBuffer." alt="" coords="923,226,1018,251"/>
<area shape="rect" href="classMemBufferBase.html" title=" " alt="" coords="652,215,837,241"/>
<area shape="rect" href="structMemBuffer_1_1Stats.html" title=" " alt="" coords="677,265,812,290"/>
<area shape="rect" href="structl__info.html" title=" " alt="" coords="1105,110,1164,135"/>
<area shape="rect" href="structElf32__Phdr.html" title=" " alt="" coords="1453,370,1544,395"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPackLinuxElf32_1_1Elf32__Nhdr.html">Elf32_Nhdr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad4a70681445083e44ae8ac59d81077ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ad4a70681445083e44ae8ac59d81077ae">PackLinuxElf32</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:ad4a70681445083e44ae8ac59d81077ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b4d5dd33ffefd2879addc0dce06d14"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a50b4d5dd33ffefd2879addc0dce06d14">~PackLinuxElf32</a> ()</td></tr>
<tr class="separator:a50b4d5dd33ffefd2879addc0dce06d14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:ac95c781c95ed54d3f82d6957d13563ef inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac95c781c95ed54d3f82d6957d13563ef">PackLinuxElf</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:ac95c781c95ed54d3f82d6957d13563ef inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbfa44abec2d5cbfb7fad953ebd852a inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5cbfa44abec2d5cbfb7fad953ebd852a">~PackLinuxElf</a> ()</td></tr>
<tr class="separator:a5cbfa44abec2d5cbfb7fad953ebd852a inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7b16256150aeee5316b817b469b93f inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a2b7b16256150aeee5316b817b469b93f">getVersion</a> () const override</td></tr>
<tr class="separator:a2b7b16256150aeee5316b817b469b93f inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3924832e55889e051ae9ad0ab43c5c9 inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac3924832e55889e051ae9ad0ab43c5c9">canUnpackVersion</a> (int version) const override</td></tr>
<tr class="separator:ac3924832e55889e051ae9ad0ab43c5c9 inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">canUnpack</a> () override</td></tr>
<tr class="memdesc:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a2918e27dbfa2989e2bebbc9d55278502 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2918e27dbfa2989e2bebbc9d55278502">~PackUnix</a> ()</td></tr>
<tr class="separator:a2918e27dbfa2989e2bebbc9d55278502 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a4ffa6385cc3e65f0e0edf03f1a689 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a56a4ffa6385cc3e65f0e0edf03f1a689">getVersion</a> () const override</td></tr>
<tr class="separator:a56a4ffa6385cc3e65f0e0edf03f1a689 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bbbfbba5b4b2b33de9d7801bd58b2cb inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">getFilters</a> () const override</td></tr>
<tr class="separator:a6bbbfbba5b4b2b33de9d7801bd58b2cb inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362bc5d4016b05a3e36f20f364950602 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602">getStrategy</a> (<a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a362bc5d4016b05a3e36f20f364950602 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421acb038daef916fef027bd5e2a7427 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a421acb038daef916fef027bd5e2a7427">pack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="separator:a421acb038daef916fef027bd5e2a7427 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a62fec1407c3b1d45bd049df4b9f5e6f7">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#a62fec1407c3b1d45bd049df4b9f5e6f7" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935b7961d8278ae7b19c53d6ef3fe3cf inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">canPack</a> () override</td></tr>
<tr class="separator:a935b7961d8278ae7b19c53d6ef3fe3cf inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120">canUnpack</a> () override</td></tr>
<tr class="memdesc:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1d471152b26686e619f2e8b6744366 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4f1d471152b26686e619f2e8b6744366">find_overlay_offset</a> (<a class="el" href="classMemBuffer.html">MemBuffer</a> const &amp;<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>)</td></tr>
<tr class="separator:a4f1d471152b26686e619f2e8b6744366 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a53a278648f1e7dd8409c81134ca110bc inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a53a278648f1e7dd8409c81134ca110bc">~Packer</a> () noexcept</td></tr>
<tr class="separator:a53a278648f1e7dd8409c81134ca110bc inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e855c1df3707b0e054eac328a520c5 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a65e855c1df3707b0e054eac328a520c5">assertPacker</a> () const override</td></tr>
<tr class="separator:a65e855c1df3707b0e054eac328a520c5 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a06289b68601b59ba96d2d0bacec15aa6">initPackHeader</a> () final override</td></tr>
<tr class="memdesc:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">packheader util  <br /></td></tr>
<tr class="separator:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb7d756fd4914ecba61720460873904 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afcb7d756fd4914ecba61720460873904">updatePackHeader</a> () final override</td></tr>
<tr class="separator:afcb7d756fd4914ecba61720460873904 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0f04afb915721f1dc846115241895eb6">doPack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) final override</td></tr>
<tr class="memdesc:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">public entries called from class <a class="el" href="classPackMaster.html" title="dispatch to a concrete subclass of class PackerBase; see work.cpp">PackMaster</a>  <br /></td></tr>
<tr class="separator:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bfdeba49a1c92bcc0d7a5bb3e10345 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad4bfdeba49a1c92bcc0d7a5bb3e10345">doUnpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) final override</td></tr>
<tr class="separator:ad4bfdeba49a1c92bcc0d7a5bb3e10345 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cfe7201a1e90ac2df2e21778b09bf9c inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4cfe7201a1e90ac2df2e21778b09bf9c">doTest</a> () final override</td></tr>
<tr class="separator:a4cfe7201a1e90ac2df2e21778b09bf9c inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303bc70d7e7247ee535e9750a26c714a inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a303bc70d7e7247ee535e9750a26c714a">doList</a> () final override</td></tr>
<tr class="separator:a303bc70d7e7247ee535e9750a26c714a inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ac0c24f13d1ba6fa3e450539ea2933 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a01ac0c24f13d1ba6fa3e450539ea2933">doFileInfo</a> () final override</td></tr>
<tr class="separator:a01ac0c24f13d1ba6fa3e450539ea2933 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d96e4d4cbfe8e5f01711f47098ccc9 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a73d96e4d4cbfe8e5f01711f47098ccc9">canUnpackVersion</a> (int version) const</td></tr>
<tr class="separator:a73d96e4d4cbfe8e5f01711f47098ccc9 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c73202b82e8ce8970cca8881d9a82e inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a31c73202b82e8ce8970cca8881d9a82e">canUnpackFormat</a> (int format) const</td></tr>
<tr class="separator:a31c73202b82e8ce8970cca8881d9a82e inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:aad37a4b709f2215c2dd790268e3e596f inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aad37a4b709f2215c2dd790268e3e596f">~PackerBase</a> () noexcept</td></tr>
<tr class="separator:aad37a4b709f2215c2dd790268e3e596f inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9d6b0ba4f236e640f8610b6688a6db inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#abe9d6b0ba4f236e640f8610b6688a6db">getVersion</a> () const =0</td></tr>
<tr class="separator:abe9d6b0ba4f236e640f8610b6688a6db inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6132cc9ef747b35947837d463aeac60 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60">getFormat</a> () const =0</td></tr>
<tr class="separator:aa6132cc9ef747b35947837d463aeac60 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf646b36342d8706c83e7c26fe47108e inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#adf646b36342d8706c83e7c26fe47108e">getName</a> () const =0</td></tr>
<tr class="separator:adf646b36342d8706c83e7c26fe47108e inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3699d96b9dc2a2531fa15d2cd348c110 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a3699d96b9dc2a2531fa15d2cd348c110">getFullName</a> (const <a class="el" href="structOptions.html">Options</a> *) const =0</td></tr>
<tr class="separator:a3699d96b9dc2a2531fa15d2cd348c110 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237baf1e217ee3aae78235baba4ad05c inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a237baf1e217ee3aae78235baba4ad05c">getCompressionMethods</a> (int method, int level) const =0</td></tr>
<tr class="separator:a237baf1e217ee3aae78235baba4ad05c inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0204dbe7106f6ac24aa712ad1ab3a5b8 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0204dbe7106f6ac24aa712ad1ab3a5b8">getFilters</a> () const =0</td></tr>
<tr class="separator:a0204dbe7106f6ac24aa712ad1ab3a5b8 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fc9b13105ad33ec6cca04b4abb507b inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a53fc9b13105ad33ec6cca04b4abb507b">canPack</a> ()=0</td></tr>
<tr class="separator:a53fc9b13105ad33ec6cca04b4abb507b inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa758490b3cc414478d262f753257d634 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa758490b3cc414478d262f753257d634">canUnpack</a> ()=0</td></tr>
<tr class="separator:aa758490b3cc414478d262f753257d634 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a83499a5451f8ab84d24fcc77f9b19 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa0a83499a5451f8ab84d24fcc77f9b19">assertPacker</a> () const =0</td></tr>
<tr class="separator:aa0a83499a5451f8ab84d24fcc77f9b19 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b4191ca6e4ca14fd425215afe129c1 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a41b4191ca6e4ca14fd425215afe129c1">initPackHeader</a> ()=0</td></tr>
<tr class="separator:a41b4191ca6e4ca14fd425215afe129c1 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1168410761f4965c7069d69628ebf203 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a1168410761f4965c7069d69628ebf203">updatePackHeader</a> ()=0</td></tr>
<tr class="separator:a1168410761f4965c7069d69628ebf203 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade8c0ee5d2501df14980c744b2fa47f4 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#ade8c0ee5d2501df14980c744b2fa47f4">doPack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:ade8c0ee5d2501df14980c744b2fa47f4 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c4c814d3afebb81309699ea0d8d8c6 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a28c4c814d3afebb81309699ea0d8d8c6">doUnpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:a28c4c814d3afebb81309699ea0d8d8c6 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e5d42ed9b00879eb0811d9492cb6a9 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a90e5d42ed9b00879eb0811d9492cb6a9">doTest</a> ()=0</td></tr>
<tr class="separator:a90e5d42ed9b00879eb0811d9492cb6a9 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb2533c208ee20b3951b1c4a8641084 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a4bb2533c208ee20b3951b1c4a8641084">doList</a> ()=0</td></tr>
<tr class="separator:a4bb2533c208ee20b3951b1c4a8641084 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d9d32792e01d4ecb6d1068939be150 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a30d9d32792e01d4ecb6d1068939be150">doFileInfo</a> ()=0</td></tr>
<tr class="separator:a30d9d32792e01d4ecb6d1068939be150 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa2acf155f6a76482cd3cbd17cef800e6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:aa2acf155f6a76482cd3cbd17cef800e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c404e04836d12a4840ccfc0f1c98ae7"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7">checkEhdr</a> (<a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> const *ehdr) const</td></tr>
<tr class="separator:a3c404e04836d12a4840ccfc0f1c98ae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362f74f1bc69654c06e59aa1805f009a"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">canPackOSABI</a> (<a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> const *)</td></tr>
<tr class="separator:a362f74f1bc69654c06e59aa1805f009a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f9df5fb4c6ace9d197f29e1594a552"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack</a> () override</td></tr>
<tr class="separator:ac4f9df5fb4c6ace9d197f29e1594a552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89a8cceb7f8ef9df9542156c01118aa4"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">canUnpack</a> () override</td></tr>
<tr class="memdesc:a89a8cceb7f8ef9df9542156c01118aa4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:a89a8cceb7f8ef9df9542156c01118aa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a247c49c374e4a7c27cafadafb01f5642"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a247c49c374e4a7c27cafadafb01f5642">ARM_defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *ft)</td></tr>
<tr class="separator:a247c49c374e4a7c27cafadafb01f5642"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa515825407739bf3ca522be194de8b27"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa515825407739bf3ca522be194de8b27">ARM_updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *)</td></tr>
<tr class="separator:aa515825407739bf3ca522be194de8b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a379f1a6161600dea7e368dabb0819f71"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">ARM_is_QNX</a> (void)</td></tr>
<tr class="separator:a379f1a6161600dea7e368dabb0819f71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bafd32333cb29e162b3a21d3cd4c625"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:a5bafd32333cb29e162b3a21d3cd4c625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12904e259a31849e8633faf26b5e07fe"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, unsigned pre_xct_top)</td></tr>
<tr class="separator:a12904e259a31849e8633faf26b5e07fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a001986a5884a191f0426037687d2f475"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a001986a5884a191f0426037687d2f475">asl_slide_Shdrs</a> ()</td></tr>
<tr class="separator:a001986a5884a191f0426037687d2f475"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a475c24cd3f9652ad82ea69cdf377aca5"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:a475c24cd3f9652ad82ea69cdf377aca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaea43508f7513692cf3da5e91677c52c"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:aaea43508f7513692cf3da5e91677c52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad190f7b83d9aaccf78119ebb0f00eb41"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:ad190f7b83d9aaccf78119ebb0f00eb41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9fc35299e310d90855abb422cd660a"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">forward_Shdrs</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, <a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *ehdro)</td></tr>
<tr class="separator:a4b9fc35299e310d90855abb422cd660a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09edcb8bd331405f99b25b09d37f5040"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a09edcb8bd331405f99b25b09d37f5040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a09edcb8bd331405f99b25b09d37f5040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cec931e83f51aaba944196c3476154c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym</a> (unsigned orig_file_size, <a class="el" href="classOutputFile.html">OutputFile</a> *)</td></tr>
<tr class="separator:a9cec931e83f51aaba944196c3476154c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a054376b40ab2dc536ce43302d2c989"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *const fo, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;o_elfhdrs, unsigned &amp;c_adler, unsigned &amp;u_adler, unsigned const orig_file_size)</td></tr>
<tr class="separator:a6a054376b40ab2dc536ce43302d2c989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52055eaaf3a28d1986937825c9382ae7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT</a> (unsigned old_dtinit, <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *phdro, <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *dynhdr, <a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:a52055eaaf3a28d1986937825c9382ae7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9885ff5b4641396d7e4604d44e4cbe97"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97">unRel32</a> (unsigned dt_rel, <a class="el" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *rel0, unsigned relsz, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;membuf, unsigned const load_off, <a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:a9885ff5b4641396d7e4604d44e4cbe97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a1446667e5e41721ae1ed8d40e3a82"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, void const *proto, unsigned const brka) override</td></tr>
<tr class="separator:aa3a1446667e5e41721ae1ed8d40e3a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b1cda087bb627b537152b283c9419b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b">defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *) override</td></tr>
<tr class="separator:a42b1cda087bb627b537152b283c9419b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2de3b0ba7a17f5de7f5a62f5df6a0bb3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a2de3b0ba7a17f5de7f5a62f5df6a0bb3">buildLinuxLoader</a> (<a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const proto, unsigned const szproto, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const fold, unsigned const szfold, <a class="el" href="classFilter.html">Filter</a> const *ft)</td></tr>
<tr class="separator:a2de3b0ba7a17f5de7f5a62f5df6a0bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69001fad2a5e68585846d1fb1abd2afb"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb">getbrk</a> (const <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr, int <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) const</td></tr>
<tr class="separator:a69001fad2a5e68585846d1fb1abd2afb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae71afa0e6f24dc33a224f2225b7c4bbe"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ae71afa0e6f24dc33a224f2225b7c4bbe">patchLoader</a> () override</td></tr>
<tr class="separator:ae71afa0e6f24dc33a224f2225b7c4bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654efeae935871a2aa2032b61610ce33"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a654efeae935871a2aa2032b61610ce33">updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="separator:a654efeae935871a2aa2032b61610ce33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ea5f1df204c3f64aa7d4bea4da1dd2"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap</a> (<a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *const <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, unsigned const k, unsigned const <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>)</td></tr>
<tr class="separator:a26ea5f1df204c3f64aa7d4bea4da1dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccea780c95ceb2ad3e29a234d3f2863"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a5ccea780c95ceb2ad3e29a234d3f2863">getbase</a> (const <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr, int <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) const</td></tr>
<tr class="separator:a5ccea780c95ceb2ad3e29a234d3f2863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57c8f63c6f5b8671a39cd8acf2b48bc6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">calls_crt1</a> (<a class="el" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> const *rel, int sz)</td></tr>
<tr class="separator:a57c8f63c6f5b8671a39cd8acf2b48bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1d8db1d83d751bf6acfdde1045403ad"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup</a> (char const *) const</td></tr>
<tr class="separator:aa1d8db1d83d751bf6acfdde1045403ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed8111e8e63b6f87ff03edd42538ecaf"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a> (unsigned) const</td></tr>
<tr class="separator:aed8111e8e63b6f87ff03edd42538ecaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0fe8832b28a69327c9c65628f13dc53"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53">elf_get_offset_from_Phdrs</a> (unsigned, <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *phdr0) const</td></tr>
<tr class="separator:aa0fe8832b28a69327c9c65628f13dc53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dbc6cc573876410e6b5fe1ed235a6e0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va</a> (unsigned addr, <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *phdr, unsigned phnum)</td></tr>
<tr class="separator:a7dbc6cc573876410e6b5fe1ed235a6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f2fa5dca83b3dc674c10277cd57c909"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a0f2fa5dca83b3dc674c10277cd57c909">elf_find_ptype</a> (unsigned type, <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *phdr0, unsigned phnum)</td></tr>
<tr class="separator:a0f2fa5dca83b3dc674c10277cd57c909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313f7710d0510a233bbda02e91d359a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a313f7710d0510a233bbda02e91d359a5">elf_find_section_name</a> (char const *) const</td></tr>
<tr class="separator:a313f7710d0510a233bbda02e91d359a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86f5c0bb23dea2f02777b2bd551f3756"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type</a> (unsigned) const</td></tr>
<tr class="separator:a86f5c0bb23dea2f02777b2bd551f3756"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab12506f897a258211fa947e556cb2615"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr</a> (unsigned) const</td></tr>
<tr class="separator:ab12506f897a258211fa947e556cb2615"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f2721b58e10a1d02b398f398fb7812"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size</a> (unsigned dt_type, unsigned sh_type)</td></tr>
<tr class="separator:aa3f2721b58e10a1d02b398f398fb7812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34521f96ea9eb8d358528d794fa9345b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">sort_DT32_offsets</a> (<a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> const *const dynp0)</td></tr>
<tr class="separator:a34521f96ea9eb8d358528d794fa9345b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9929af0daa1854fea2672c0c50bddb84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a> (<a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *phdr) const</td></tr>
<tr class="separator:a9929af0daa1854fea2672c0c50bddb84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a117c75deef89749d3998463ab14ad780"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">check_pt_load</a> (<a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *)</td></tr>
<tr class="separator:a117c75deef89749d3998463ab14ad780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba7026f4211ff852ffc5fc17ba0ec2b9"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic</a> (<a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *)</td></tr>
<tr class="separator:aba7026f4211ff852ffc5fc17ba0ec2b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b74d82d2a2993873377ac87e6393d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic</a> (<a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> const *, unsigned dt_filesz)</td></tr>
<tr class="separator:a18b74d82d2a2993873377ac87e6393d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0582ead69b6b3552ad4f751c2fa3f882"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a> (unsigned) const</td></tr>
<tr class="separator:a0582ead69b6b3552ad4f751c2fa3f882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2f68dcc6a3caecbcb5cf7ad6e7866a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a7c2f68dcc6a3caecbcb5cf7ad6e7866a">elf_has_dynamic</a> (unsigned) const</td></tr>
<tr class="separator:a7c2f68dcc6a3caecbcb5cf7ad6e7866a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc398e82caa74060ec330d678f7e142"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a> (unsigned) const override</td></tr>
<tr class="separator:a3cc398e82caa74060ec330d678f7e142"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae126d225cb28e675a4261204a3872e2c"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c">find_dt_ndx</a> (unsigned rva)</td></tr>
<tr class="separator:ae126d225cb28e675a4261204a3872e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71dfe9e1479de8e093db3320b9b4588f"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">adjABS</a> (<a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *sym, unsigned delta)</td></tr>
<tr class="separator:a71dfe9e1479de8e093db3320b9b4588f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26bcf782bacd0c3b94c981ad6272c0b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx</a> (<a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *)</td></tr>
<tr class="separator:a26bcf782bacd0c3b94c981ad6272c0b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaad617181a6e644a245633fc306f6fca"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name</a> (unsigned st_name, unsigned symnum) const</td></tr>
<tr class="separator:aaad617181a6e644a245633fc306f6fca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84aeb851cffb6a47f23a5f2ae01c1cd"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name</a> (unsigned symnum, unsigned relnum) const</td></tr>
<tr class="separator:ae84aeb851cffb6a47f23a5f2ae01c1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad4336fa530cb9da3d195d9e300317c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#adad4336fa530cb9da3d195d9e300317c">packed_struct</a> (cprElfHdr1)</td></tr>
<tr class="separator:adad4336fa530cb9da3d195d9e300317c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b210d9e6476af2004d00b23c4a00c95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a1b210d9e6476af2004d00b23c4a00c95">packed_struct</a> (cprElfHdr2)</td></tr>
<tr class="separator:a1b210d9e6476af2004d00b23c4a00c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab163d7a5984874e85649cc44c8b73793"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ab163d7a5984874e85649cc44c8b73793">packed_struct</a> (cprElfHdr3)</td></tr>
<tr class="separator:ab163d7a5984874e85649cc44c8b73793"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abddcb05bd923d39c073a529a0cc36f78"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#abddcb05bd923d39c073a529a0cc36f78">packed_struct</a> (cprElfHdr4)</td></tr>
<tr class="separator:abddcb05bd923d39c073a529a0cc36f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51dbad0e6cf4a9326f7ec267e2f9b3cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a51dbad0e6cf4a9326f7ec267e2f9b3cf">packed_struct</a> (cprElfHdrNetBSD)</td></tr>
<tr class="separator:a51dbad0e6cf4a9326f7ec267e2f9b3cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fbaa32428822f238a62aac48e9cb56"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a53fbaa32428822f238a62aac48e9cb56">packed_struct</a> (cprElfShdr3)</td></tr>
<tr class="separator:a53fbaa32428822f238a62aac48e9cb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a622b799334a48cb6634e790f2566248a inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">getCompressionMethods</a> (int method, int level) const override</td></tr>
<tr class="separator:a622b799334a48cb6634e790f2566248a inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01b0f8403997790f28a72329e7b28f6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af01b0f8403997790f28a72329e7b28f6">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:af01b0f8403997790f28a72329e7b28f6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619d0ed2f97d37150ed5b1437c67b6f1 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a619d0ed2f97d37150ed5b1437c67b6f1">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:a619d0ed2f97d37150ed5b1437c67b6f1 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3409fd940ae9b30dc51e68f69e0160f6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:a3409fd940ae9b30dc51e68f69e0160f6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378dd6608963beeae5bb6393ef4b23d5 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a378dd6608963beeae5bb6393ef4b23d5">generateElfHdr</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, void const *proto, unsigned const brka)=0</td></tr>
<tr class="separator:a378dd6608963beeae5bb6393ef4b23d5 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addaacfe47a36eb9d70929a58ba311e29 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *)</td></tr>
<tr class="separator:addaacfe47a36eb9d70929a58ba311e29 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0c06e7772712b8f5cb8a7101a2e052 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">addStubEntrySections</a> (<a class="el" href="classFilter.html">Filter</a> const *, unsigned m_decompr)</td></tr>
<tr class="separator:afe0c06e7772712b8f5cb8a7101a2e052 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7cb95fd27c29245be62f4e388fc3f09 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac7cb95fd27c29245be62f4e388fc3f09">elf_unsigned_dynamic</a> (unsigned) const =0</td></tr>
<tr class="separator:ac7cb95fd27c29245be62f4e388fc3f09 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a326420727ef64feb46ddcd2f12b96a96 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a326420727ef64feb46ddcd2f12b96a96">PackUnix</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a326420727ef64feb46ddcd2f12b96a96 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67466cfa57e26dc50991e0bf9a610a05 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a67466cfa57e26dc50991e0bf9a610a05">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a67466cfa57e26dc50991e0bf9a610a05 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a90e16aac8e8c0e11180da8082bfd0f inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2a90e16aac8e8c0e11180da8082bfd0f">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a2a90e16aac8e8c0e11180da8082bfd0f inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573f3c8c4c540f51c2a7b168535d4741 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a573f3c8c4c540f51c2a7b168535d4741">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a573f3c8c4c540f51c2a7b168535d4741 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d92de9aedc1747be87ef5968952838c inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">pack4</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a7d92de9aedc1747be87ef5968952838c inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b328c80b7172751702a447aed1afb2 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ac4b328c80b7172751702a447aed1afb2">patchLoader</a> ()=0</td></tr>
<tr class="separator:ac4b328c80b7172751702a447aed1afb2 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20942814df6e718e04462ac03aebe08 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#af20942814df6e718e04462ac03aebe08">patchLoaderChecksum</a> ()</td></tr>
<tr class="separator:af20942814df6e718e04462ac03aebe08 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cee24303a1b5e7676c8d98acada2be0 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2cee24303a1b5e7676c8d98acada2be0">updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *)=0</td></tr>
<tr class="separator:a2cee24303a1b5e7676c8d98acada2be0 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced1a9bb3fee3c231bfc90051224a6dd inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aced1a9bb3fee3c231bfc90051224a6dd">writePackHeader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:aced1a9bb3fee3c231bfc90051224a6dd inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aeddca239c9109efe577257d5ac798ba7">checkCompressionRatio</a> (unsigned, unsigned) const override</td></tr>
<tr class="memdesc:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#a421acb038daef916fef027bd5e2a7427">pack()</a>.  <br /></td></tr>
<tr class="separator:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f398fa4a3b34fd79f441e3069f78b1 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a> (const <a class="el" href="structPackUnix_1_1Extent.html">Extent</a> &amp;x, <a class="el" href="classFilter.html">Filter</a> *, <a class="el" href="classOutputFile.html">OutputFile</a> *, unsigned hdr_len=0, unsigned b_extra=0, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:ad3f398fa4a3b34fd79f441e3069f78b1 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16d64e1b95f1dcf5f128665b83660f6 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a> (unsigned wanted, <a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned &amp;c_adler, unsigned &amp;u_adler, bool first_PF_X, int is_rewrite=false)</td></tr>
<tr class="separator:ab16d64e1b95f1dcf5f128665b83660f6 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd8340ae0c422e428d1a0874791c47b inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4bd8340ae0c422e428d1a0874791c47b">packed_struct</a> (<a class="el" href="structb__info.html">b_info</a>)</td></tr>
<tr class="separator:a4bd8340ae0c422e428d1a0874791c47b inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40aab492369d544f29a717b571d7f004 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a40aab492369d544f29a717b571d7f004">packed_struct</a> (<a class="el" href="structl__info.html">l_info</a>)</td></tr>
<tr class="separator:a40aab492369d544f29a717b571d7f004 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22613c8b5d9a79ac5cdeae1d6664537d inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a22613c8b5d9a79ac5cdeae1d6664537d">packed_struct</a> (<a class="el" href="structp__info.html">p_info</a>)</td></tr>
<tr class="separator:a22613c8b5d9a79ac5cdeae1d6664537d inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a133376f040e1a9677374b6b799a0b630 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a133376f040e1a9677374b6b799a0b630">Packer</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a133376f040e1a9677374b6b799a0b630 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd46726f44d4d6ecbb38ca0b682abff inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0dd46726f44d4d6ecbb38ca0b682abff">testUnpackVersion</a> (int version) const <a class="el" href="conf_8h.html#aac314c25ecc359ec37c364e623d312c1">may_throw</a></td></tr>
<tr class="separator:a0dd46726f44d4d6ecbb38ca0b682abff inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb5aa92c52d38f3c7f4cc75d111debd inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abcb5aa92c52d38f3c7f4cc75d111debd">testUnpackFormat</a> (int format) const <a class="el" href="conf_8h.html#aac314c25ecc359ec37c364e623d312c1">may_throw</a></td></tr>
<tr class="separator:abcb5aa92c52d38f3c7f4cc75d111debd inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4856b75dcd93c17a197b3cc0f6f631b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa4856b75dcd93c17a197b3cc0f6f631b">pack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:aa4856b75dcd93c17a197b3cc0f6f631b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29c743954e67295ef1793155a96c7d3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa29c743954e67295ef1793155a96c7d3">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:aa29c743954e67295ef1793155a96c7d3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4224ba769e4e9f5839f4e8a320a60e09">test</a> ()</td></tr>
<tr class="memdesc:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">default actions  <br /></td></tr>
<tr class="separator:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2a1baf71486055fcf2010eff9ddad3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aec2a1baf71486055fcf2010eff9ddad3">list</a> ()</td></tr>
<tr class="separator:aec2a1baf71486055fcf2010eff9ddad3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758c9c8f833608e7744538587c72653d inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a758c9c8f833608e7744538587c72653d">fileInfo</a> ()</td></tr>
<tr class="separator:a758c9c8f833608e7744538587c72653d inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e">compress</a> (<a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) i_ptr, unsigned i_len, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) o_ptr, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf=nullptr)</td></tr>
<tr class="memdesc:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">compress - wrap call to low-level <a class="el" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress()</a>  <br /></td></tr>
<tr class="separator:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">decompress</a> (<a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) in, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) out, bool verify_checksum=true, <a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="memdesc:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">decompress  <br /></td></tr>
<tr class="separator:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9864c9f06e96c60330ae5df35f285d9 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab9864c9f06e96c60330ae5df35f285d9">checkDefaultCompressionRatio</a> (unsigned u_len, unsigned c_len) const</td></tr>
<tr class="separator:ab9864c9f06e96c60330ae5df35f285d9 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2456e468bbb9b026d301c3e668f28d05 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a2456e468bbb9b026d301c3e668f28d05">checkCompressionRatio</a> (unsigned u_len, unsigned c_len) const</td></tr>
<tr class="separator:a2456e468bbb9b026d301c3e668f28d05 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1b90e1cf536d0dd0bcd90799d6195f inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#acc1b90e1cf536d0dd0bcd90799d6195f">checkFinalCompressionRatio</a> (const <a class="el" href="classOutputFile.html">OutputFile</a> *fo) const</td></tr>
<tr class="separator:acc1b90e1cf536d0dd0bcd90799d6195f inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ae5b698e68d64585e5be87a256f675 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a> (<a class="el" href="classFilter.html">Filter</a> *ft, const unsigned overlap_range, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf, int filter_strategy=0, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:ad0ae5b698e68d64585e5be87a256f675 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeabf0f70b5c414b04a5d7a895c50351b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aeabf0f70b5c414b04a5d7a895c50351b">compressWithFilters</a> (<a class="el" href="classFilter.html">Filter</a> *ft, const unsigned overlap_range, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf, int filter_strategy, unsigned filter_buf_off, unsigned compress_ibuf_off, unsigned compress_obuf_off, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *const hdr_ptr, unsigned hdr_len, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:aeabf0f70b5c414b04a5d7a895c50351b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c29dbab3c13461ccccdf08ba3b6cde2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a6c29dbab3c13461ccccdf08ba3b6cde2">compressWithFilters</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *i_ptr, unsigned i_len, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *o_ptr, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *f_ptr, unsigned f_len, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *const hdr_ptr, unsigned hdr_len, <a class="el" href="classFilter.html">Filter</a> *parm_ft, unsigned overlap_range, <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> const *cconf, int filter_strategy, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:a6c29dbab3c13461ccccdf08ba3b6cde2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78">testOverlappingDecompression</a> (const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *tbuf, unsigned overlap_overhead) const</td></tr>
<tr class="memdesc:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">overlapping decompression  <br /></td></tr>
<tr class="separator:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af11da16aeb96ac7ccd05f31472793ca7">findOverlapOverhead</a> (const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *tbuf, unsigned range=0, unsigned upper_limit=~0u) const</td></tr>
<tr class="memdesc:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find overhead for in-place decompression in a heuristic way (using a binary search).  <br /></td></tr>
<tr class="separator:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98836d189865b8496d759334c6257608 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a98836d189865b8496d759334c6257608">verifyOverlappingDecompression</a> (<a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="separator:a98836d189865b8496d759334c6257608 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b1f4ce72c7ddc53b424653ffde5ff8 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a34b1f4ce72c7ddc53b424653ffde5ff8">verifyOverlappingDecompression</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *o_ptr, unsigned o_size, <a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="separator:a34b1f4ce72c7ddc53b424653ffde5ff8 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f9499f529513c9d26fc647968dfe7e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad1f9499f529513c9d26fc647968dfe7e">patchPackHeader</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen) final</td></tr>
<tr class="separator:ad1f9499f529513c9d26fc647968dfe7e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeee17a50e4f350eebc14b1704ec9a39 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afeee17a50e4f350eebc14b1704ec9a39">getPackHeader</a> (const void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, bool allow_incompressible=false) final</td></tr>
<tr class="separator:afeee17a50e4f350eebc14b1704ec9a39 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42fa62442193d76789d049cbc3635bd2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a42fa62442193d76789d049cbc3635bd2">readPackHeader</a> (int len, bool allow_incompressible=false) final</td></tr>
<tr class="separator:a42fa62442193d76789d049cbc3635bd2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b9cb85a2382ebc043228597992283b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a14b9cb85a2382ebc043228597992283b">checkAlreadyPacked</a> (const void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen) final</td></tr>
<tr class="separator:a14b9cb85a2382ebc043228597992283b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0b2c2bbf482db53bf6a40811348d45 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a1e0b2c2bbf482db53bf6a40811348d45">buildLoader</a> (const <a class="el" href="classFilter.html">Filter</a> *ft)=0</td></tr>
<tr class="separator:a1e0b2c2bbf482db53bf6a40811348d45 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fe94299cf76c70de7ed953aa774330 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a86b1e444574bf0cf210927b9494cdc95">Linker</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa7fe94299cf76c70de7ed953aa774330">newLinker</a> () const =0</td></tr>
<tr class="separator:aa7fe94299cf76c70de7ed953aa774330 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9f88864fd7faa59c8130bd59a811a3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a> ()</td></tr>
<tr class="separator:a2c9f88864fd7faa59c8130bd59a811a3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e094d3b47373817a66457952f26dc70 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">getLoader</a> () const</td></tr>
<tr class="separator:a6e094d3b47373817a66457952f26dc70 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade07bbe55dcfe9cc68a6c785e9b0c33c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ade07bbe55dcfe9cc68a6c785e9b0c33c">getLoaderSize</a> () const</td></tr>
<tr class="separator:ade07bbe55dcfe9cc68a6c785e9b0c33c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af6a45574697d68421e70baef1c8d8c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a> (const void *pdata, int plen, int small=-1, int pextra=0)</td></tr>
<tr class="separator:a4af6a45574697d68421e70baef1c8d8c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a516182985490860d361a8266fa418235 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a516182985490860d361a8266fa418235 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37fb57f49864a5d22b43a13f4fc52923 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a37fb57f49864a5d22b43a13f4fc52923">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a37fb57f49864a5d22b43a13f4fc52923 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762161bd9480b458295cb0393633e224 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a762161bd9480b458295cb0393633e224">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a762161bd9480b458295cb0393633e224 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc42fc3224a7d9c6f4c9bc304392bab2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abc42fc3224a7d9c6f4c9bc304392bab2">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:abc42fc3224a7d9c6f4c9bc304392bab2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d8132ddf586284fc04b4798aac0597 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a69d8132ddf586284fc04b4798aac0597">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a69d8132ddf586284fc04b4798aac0597 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9320791ae051214ea71d7dade2c7c8e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab9320791ae051214ea71d7dade2c7c8e">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:ab9320791ae051214ea71d7dade2c7c8e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcf659cf5575651c05425f9943f3cf7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#adfcf659cf5575651c05425f9943f3cf7">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:adfcf659cf5575651c05425f9943f3cf7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20bd3abaf7f257ad69660ce6624585c6 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a20bd3abaf7f257ad69660ce6624585c6">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a20bd3abaf7f257ad69660ce6624585c6 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a813dc5ab0d1fb4bebb24261a297e5a87 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a813dc5ab0d1fb4bebb24261a297e5a87">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a813dc5ab0d1fb4bebb24261a297e5a87 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2163953fd8aa0c3af6085c03425931c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa2163953fd8aa0c3af6085c03425931c">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:aa2163953fd8aa0c3af6085c03425931c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf81a88111b09b6bd3353864484510b7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aaf81a88111b09b6bd3353864484510b7">addLoaderVA</a> (const char *s,...)</td></tr>
<tr class="separator:aaf81a88111b09b6bd3353864484510b7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c72885ba3799acf227862f721ddd5ab inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">hasLoaderSection</a> (const char *name) const</td></tr>
<tr class="separator:a0c72885ba3799acf227862f721ddd5ab inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebb62f4bf76fae3dcf2c64aac6bbf5ce inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aebb62f4bf76fae3dcf2c64aac6bbf5ce">getLoaderSection</a> (const char *name, int *slen=nullptr) const</td></tr>
<tr class="separator:aebb62f4bf76fae3dcf2c64aac6bbf5ce inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5239dbc85d3edd59b558deb94ed8e40d inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a5239dbc85d3edd59b558deb94ed8e40d">getLoaderSectionStart</a> (const char *name, int *slen=nullptr) const</td></tr>
<tr class="separator:a5239dbc85d3edd59b558deb94ed8e40d inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968ed89b0a113c54e982a497fdb8a97b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a968ed89b0a113c54e982a497fdb8a97b">getDefaultCompressionMethods_8</a> (int method, int level, int small=-1) const</td></tr>
<tr class="separator:a968ed89b0a113c54e982a497fdb8a97b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91d266e1612ca6108035e22fe8b1203 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac91d266e1612ca6108035e22fe8b1203">getDefaultCompressionMethods_le32</a> (int method, int level, int small=-1) const</td></tr>
<tr class="separator:ac91d266e1612ca6108035e22fe8b1203 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">prepareMethods</a> (int *methods, int ph_method, const int *all_methods) const</td></tr>
<tr class="memdesc:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">void <a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters()</a>: Try compression with several methods and filters, choose the best / or first working one.  <br /></td></tr>
<tr class="separator:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173933a7adb7d38dcc12ee8043457aa4 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a173933a7adb7d38dcc12ee8043457aa4">getDecompressorSections</a> () const</td></tr>
<tr class="separator:a173933a7adb7d38dcc12ee8043457aa4 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28302b0171618cd0b4949ab6c026dc31 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a28302b0171618cd0b4949ab6c026dc31">getDecompressorWrkmemSize</a> () const</td></tr>
<tr class="separator:a28302b0171618cd0b4949ab6c026dc31 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2cf462e56fc1876b93f047d8b222ce3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac2cf462e56fc1876b93f047d8b222ce3">defineDecompressorSymbols</a> ()</td></tr>
<tr class="separator:ac2cf462e56fc1876b93f047d8b222ce3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a02f8ef879cf94330288554bc525e8fd3">isValidFilter</a> (int filter_id) const</td></tr>
<tr class="memdesc:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">filter util; see class <a class="el" href="classFilterImpl.html" title="We don&#39;t want a full OO interface here because of certain implementation speed reasons.">FilterImpl</a>  <br /></td></tr>
<tr class="separator:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0525cfe60bfaae0ef0cf3efde338cd57 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0525cfe60bfaae0ef0cf3efde338cd57">optimizeFilter</a> (<a class="el" href="classFilter.html">Filter</a> *, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *, unsigned) const</td></tr>
<tr class="separator:a0525cfe60bfaae0ef0cf3efde338cd57 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a451951590472595cfd04a238624d1 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a07a451951590472595cfd04a238624d1">addFilter32</a> (int filter_id)</td></tr>
<tr class="separator:a07a451951590472595cfd04a238624d1 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec73793b1e58249dff949fad71520901 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aec73793b1e58249dff949fad71520901">defineFilterSymbols</a> (const <a class="el" href="classFilter.html">Filter</a> *ft)</td></tr>
<tr class="separator:aec73793b1e58249dff949fad71520901 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b47a6575142d8a8fafd88256c8a26e8 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0b47a6575142d8a8fafd88256c8a26e8">checkOverlay</a> (unsigned overlay)</td></tr>
<tr class="separator:a0b47a6575142d8a8fafd88256c8a26e8 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781dc4327dd4bcab50a94bfc85f52802 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a781dc4327dd4bcab50a94bfc85f52802">copyOverlay</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned overlay, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, bool do_seek=true)</td></tr>
<tr class="separator:a781dc4327dd4bcab50a94bfc85f52802 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3c0c359a5fa3597aeef5dcb6783b53 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a1e3c0c359a5fa3597aeef5dcb6783b53">getRandomId</a> () const</td></tr>
<tr class="separator:a1e3c0c359a5fa3597aeef5dcb6783b53 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90882bb1ff87aee14e72be4d953064d9 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a90882bb1ff87aee14e72be4d953064d9">patch_be16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:a90882bb1ff87aee14e72be4d953064d9 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d3293543c5f6b6ab634203eb6f7e6d7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a8d3293543c5f6b6ab634203eb6f7e6d7">patch_be16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a8d3293543c5f6b6ab634203eb6f7e6d7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba76e5b8b8d7504893344a9a166c7364 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aba76e5b8b8d7504893344a9a166c7364">patch_be32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:aba76e5b8b8d7504893344a9a166c7364 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4245c8c4fc839068b12989ee67b5f351 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4245c8c4fc839068b12989ee67b5f351">patch_be32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a4245c8c4fc839068b12989ee67b5f351 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcb9d7db4f85cd7a88ba890da7965c6 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#affcb9d7db4f85cd7a88ba890da7965c6">patch_le16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:affcb9d7db4f85cd7a88ba890da7965c6 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9336ee74f309cd9a47b91c426dc260a inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac9336ee74f309cd9a47b91c426dc260a">patch_le16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:ac9336ee74f309cd9a47b91c426dc260a inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f9280a6a5ddf2cbb669bd9a4aabf92 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac8f9280a6a5ddf2cbb669bd9a4aabf92">patch_le32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:ac8f9280a6a5ddf2cbb669bd9a4aabf92 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721bade28a259d93e7a7e0f93509f6e5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a721bade28a259d93e7a7e0f93509f6e5">patch_le32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a721bade28a259d93e7a7e0f93509f6e5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af51db683baf7d75a65f48429b77db475">checkPatch</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, int boff, int <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>)</td></tr>
<tr class="memdesc:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">patch util for loader  <br /></td></tr>
<tr class="separator:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01e10cd32d88f80d316455b55bcb1a5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a> (const void *p) const noexcept</td></tr>
<tr class="separator:ad01e10cd32d88f80d316455b55bcb1a5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a54fc63360923941cec0aa6060ae01 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a> (const void *p) const noexcept</td></tr>
<tr class="separator:a47a54fc63360923941cec0aa6060ae01 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae85a3d8295d26480a18f0abea6912451 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a> (const void *p) const noexcept</td></tr>
<tr class="separator:ae85a3d8295d26480a18f0abea6912451 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860499fa0849a7c7a7c4d43ee084f76e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a> (void *p, unsigned v) noexcept</td></tr>
<tr class="separator:a860499fa0849a7c7a7c4d43ee084f76e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cad2c8624ee68213d01eb606be0382 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a> (void *p, unsigned v) noexcept</td></tr>
<tr class="separator:af9cad2c8624ee68213d01eb606be0382 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ee35ba69e590153658a06d471c4184 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a> (void *p, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> v) noexcept</td></tr>
<tr class="separator:a36ee35ba69e590153658a06d471c4184 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe77995491ee79eda48b8ca480687bb5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abe77995491ee79eda48b8ca480687bb5">OwningPointer</a> (<a class="el" href="classUiPacker.html">UiPacker</a>) uip</td></tr>
<tr class="separator:abe77995491ee79eda48b8ca480687bb5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82badd32867f847f506da476cce326f3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a82badd32867f847f506da476cce326f3">OwningPointer</a> (<a class="el" href="conf_8h.html#a86b1e444574bf0cf210927b9494cdc95">Linker</a>) linker</td></tr>
<tr class="separator:a82badd32867f847f506da476cce326f3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:af7608c13cbf253eea98ad6eb7cee8b61 inherit pro_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#af7608c13cbf253eea98ad6eb7cee8b61">PackerBase</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:af7608c13cbf253eea98ad6eb7cee8b61 inherit pro_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a6714d3d54a016578688207074404d0dc"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a6714d3d54a016578688207074404d0dc">compileTimeAssertions</a> ()</td></tr>
<tr class="separator:a6714d3d54a016578688207074404d0dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a9cdb0429d3e2faba00ef2d67b2c628c0 inherit pro_static_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">elf_hash</a> (char const *)</td></tr>
<tr class="separator:a9cdb0429d3e2faba00ef2d67b2c628c0 inherit pro_static_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a504fe912dd96ebfcd443b89dd425317f inherit pro_static_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">gnu_hash</a> (char const *)</td></tr>
<tr class="separator:a504fe912dd96ebfcd443b89dd425317f inherit pro_static_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af727b6b460db28607ea976e650dbb16f">handleStub</a> (<a class="el" href="classInputFile.html">InputFile</a> *<a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>, <a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>)</td></tr>
<tr class="memdesc:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">file i/o utils  <br /></td></tr>
<tr class="separator:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a55f33ae9a3b893a0811404d4aa85592e">optimizeReloc</a> (unsigned relocnum, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) relocs, <a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) out, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) image, unsigned image_size, int bits, bool bswap, int *big)</td></tr>
<tr class="memdesc:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">sort and delta-compress relocations with optional bswap within image returns number of <b>bytes</b> written to 'out'  <br /></td></tr>
<tr class="separator:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad50f653ca4844165671764219a33eb74">unoptimizeReloc</a> (<a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) &amp;in, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;out, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) image, unsigned image_size, int bits, bool bswap)</td></tr>
<tr class="memdesc:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">delta-decompress relocations advances 'in' allocates 'out' and returns number of <b>relocs</b> written to 'out'  <br /></td></tr>
<tr class="separator:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a10cfe7410f5f1cdd4b1d4d8aa32c177e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a></td></tr>
<tr class="separator:a10cfe7410f5f1cdd4b1d4d8aa32c177e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f49d5da05459eab08054620b8afa81"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a></td></tr>
<tr class="separator:a16f49d5da05459eab08054620b8afa81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37a0e7b21ef6ab9036a71fe7101eb9fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a></td></tr>
<tr class="separator:a37a0e7b21ef6ab9036a71fe7101eb9fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf5438532351b0b6482b174e87ec9fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a></td></tr>
<tr class="separator:a4cf5438532351b0b6482b174e87ec9fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6320858ad11e1f2a16f29d6554fbbca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#af6320858ad11e1f2a16f29d6554fbbca">phdrx</a> [<a class="el" href="classPackLinuxElf32.html#a652cb27d6ab7bd6d04199fe7da4886cd">END_PHDRX</a>]</td></tr>
<tr class="separator:af6320858ad11e1f2a16f29d6554fbbca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21816e305175e291da2cbe8f85e5b6c0"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a></td></tr>
<tr class="separator:a21816e305175e291da2cbe8f85e5b6c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a188a0aa12a6b1d42437cd1bb391424c1"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a></td></tr>
<tr class="separator:a188a0aa12a6b1d42437cd1bb391424c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d8e571980c32f2e706cc6f60f38e736"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a></td></tr>
<tr class="separator:a2d8e571980c32f2e706cc6f60f38e736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46cb564e37f90259226b0fa81fe8b496"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a></td></tr>
<tr class="separator:a46cb564e37f90259226b0fa81fe8b496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1b4b28858fe215fd7bcd305f3a58c1b"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#af1b4b28858fe215fd7bcd305f3a58c1b">sz_dynseg</a></td></tr>
<tr class="separator:af1b4b28858fe215fd7bcd305f3a58c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a877d014b8498a8bfe5d40ebdebd5dfa0"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a></td></tr>
<tr class="separator:a877d014b8498a8bfe5d40ebdebd5dfa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8080878f78d400b2c84e1d4efdf4af04"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a8080878f78d400b2c84e1d4efdf4af04">plt_off</a></td></tr>
<tr class="separator:a8080878f78d400b2c84e1d4efdf4af04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1048a909a2fce5d2c861b88974f81d6"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a></td></tr>
<tr class="separator:ae1048a909a2fce5d2c861b88974f81d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4994d4daac1ceef79bff5afb8c9dcf5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a></td></tr>
<tr class="separator:aa4994d4daac1ceef79bff5afb8c9dcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa5a2328d0273f004e496796df5d0ae8"><td class="memItemLeft" align="right" valign="top">unsigned int const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a></td></tr>
<tr class="separator:aaa5a2328d0273f004e496796df5d0ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac22a29dfaad87f15dc1d1a09aed4fa7e"><td class="memItemLeft" align="right" valign="top">unsigned int const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ac22a29dfaad87f15dc1d1a09aed4fa7e">hashend</a></td></tr>
<tr class="separator:ac22a29dfaad87f15dc1d1a09aed4fa7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df504485b4e0c1cce47eca10de37b94"><td class="memItemLeft" align="right" valign="top">unsigned int const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a></td></tr>
<tr class="separator:a6df504485b4e0c1cce47eca10de37b94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81eaf2981770e46ea4d5895612a3bab7"><td class="memItemLeft" align="right" valign="top">unsigned int const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a81eaf2981770e46ea4d5895612a3bab7">gashend</a></td></tr>
<tr class="separator:a81eaf2981770e46ea4d5895612a3bab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25b2132cbfb2fb5a02219fbae96ad5e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a></td></tr>
<tr class="separator:aa25b2132cbfb2fb5a02219fbae96ad5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a034060e8e938b65cdd961851dea44420"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a></td></tr>
<tr class="separator:a034060e8e938b65cdd961851dea44420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a014f24da8144d063099bf9c9fc45f442"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a></td></tr>
<tr class="separator:a014f24da8144d063099bf9c9fc45f442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac06c59607bfc28297c4739e3df424ca7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a></td></tr>
<tr class="separator:ac06c59607bfc28297c4739e3df424ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8006727271622c8955b9d2cd87282a28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">sec_dynstr</a></td></tr>
<tr class="separator:a8006727271622c8955b9d2cd87282a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a46ce4ee2f2878d9122e12b8106e0ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a></td></tr>
<tr class="separator:a6a46ce4ee2f2878d9122e12b8106e0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a5249ca04607b3dcf5a09ca156da8f"><td class="memItemLeft" align="right" valign="top">cprElfHdrNetBSD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a></td></tr>
<tr class="separator:ac8a5249ca04607b3dcf5a09ca156da8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c03f5577e3a79a7900f4159318998b8"><td class="memItemLeft" align="right" valign="top">cprElfShdr3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a></td></tr>
<tr class="separator:a8c03f5577e3a79a7900f4159318998b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:ae803acdbc60d287ce17afb401b844f43 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ae803acdbc60d287ce17afb401b844f43">old_data_off</a></td></tr>
<tr class="separator:ae803acdbc60d287ce17afb401b844f43 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362fdf6e7ad11e117be7166b119d80fa inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a362fdf6e7ad11e117be7166b119d80fa">old_data_len</a></td></tr>
<tr class="separator:a362fdf6e7ad11e117be7166b119d80fa inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf175264167b93a8ce865a34937584e6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a></td></tr>
<tr class="separator:aaf175264167b93a8ce865a34937584e6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0f5122457c7d42172531d3cb116f00 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a></td></tr>
<tr class="separator:a3b0f5122457c7d42172531d3cb116f00 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca43f8d44f554de5f8129732f291f2d inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a></td></tr>
<tr class="separator:aaca43f8d44f554de5f8129732f291f2d inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc48dc344bb8340e9691a43d45f8458 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></td></tr>
<tr class="separator:afcc48dc344bb8340e9691a43d45f8458 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e3d4f8dd219c66f8a2d78e20ca5df4 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a></td></tr>
<tr class="separator:ad4e3d4f8dd219c66f8a2d78e20ca5df4 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e8bd1f64f0d8583676289f7329eb31 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a></td></tr>
<tr class="separator:a29e8bd1f64f0d8583676289f7329eb31 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55541b4f9e0f8f1fe16cb785b093ab1c inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a></td></tr>
<tr class="separator:a55541b4f9e0f8f1fe16cb785b093ab1c inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834063e926d1118a24f23a8106edcd4e inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a></td></tr>
<tr class="separator:a834063e926d1118a24f23a8106edcd4e inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe0a4831f0aafe74de573ca657ea430 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a></td></tr>
<tr class="separator:acbe0a4831f0aafe74de573ca657ea430 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc33d310cb391da2166a1dd3857ee4d inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a></td></tr>
<tr class="separator:a4cc33d310cb391da2166a1dd3857ee4d inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c581148f2345d127c21f0ba5a33a656 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a></td></tr>
<tr class="separator:a4c581148f2345d127c21f0ba5a33a656 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ec71c63b3b76a8847d2a5989c2f3fbb inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a></td></tr>
<tr class="separator:a6ec71c63b3b76a8847d2a5989c2f3fbb inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ca408b94c072437e9e96a3b4e3ab1f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a></td></tr>
<tr class="separator:ab3ca408b94c072437e9e96a3b4e3ab1f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac334df9f0f0666906d1b49d1d45be792 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a></td></tr>
<tr class="separator:ac334df9f0f0666906d1b49d1d45be792 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ee39bcba2a438ad1728c8332356ce2 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a></td></tr>
<tr class="separator:a99ee39bcba2a438ad1728c8332356ce2 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae86e3eeb56091063ef73bbcab2c1262a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">sz_pack2a</a></td></tr>
<tr class="separator:ae86e3eeb56091063ef73bbcab2c1262a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd64335916d77771c6dd2f5b71e9a77 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a></td></tr>
<tr class="separator:a8cd64335916d77771c6dd2f5b71e9a77 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80989e5fdaa51b0650d6f5d66eaf3766 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a></td></tr>
<tr class="separator:a80989e5fdaa51b0650d6f5d66eaf3766 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6c41a7dc3caa60ac369d2776ee5a12 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">is_pie</a></td></tr>
<tr class="separator:a9f6c41a7dc3caa60ac369d2776ee5a12 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b16212a7cce313d106777dc6c198af inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a></td></tr>
<tr class="separator:af8b16212a7cce313d106777dc6c198af inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8dc91b5f08ffdd31586e4d0c8ef2cb inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></td></tr>
<tr class="separator:a3a8dc91b5f08ffdd31586e4d0c8ef2cb inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac769941a308e20fdce0e86d1ec3b2f3 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a></td></tr>
<tr class="separator:aac769941a308e20fdce0e86d1ec3b2f3 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371519bdb05124340b9d78e067bee1e0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a></td></tr>
<tr class="separator:a371519bdb05124340b9d78e067bee1e0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be817665d0219026ebd50acdd3700af inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a></td></tr>
<tr class="separator:a8be817665d0219026ebd50acdd3700af inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa692858672c20488c367295681b28422 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a></td></tr>
<tr class="separator:aa692858672c20488c367295681b28422 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa8506d335cb1116f720aff4611a337 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a></td></tr>
<tr class="separator:a3fa8506d335cb1116f720aff4611a337 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539c946c8c36fa509670ec9948ccb1fc inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a></td></tr>
<tr class="separator:a539c946c8c36fa509670ec9948ccb1fc inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb9134e6f6d635119bbce8ee9fc2cc0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a></td></tr>
<tr class="separator:a3bb9134e6f6d635119bbce8ee9fc2cc0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8e26f797ec69a6c183c8b15fcd4f53 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a></td></tr>
<tr class="separator:a8c8e26f797ec69a6c183c8b15fcd4f53 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f1dfda6aea57348d0720fa78b782d0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a></td></tr>
<tr class="separator:aa2f1dfda6aea57348d0720fa78b782d0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0ac0fb5a7d76ec145e96317d6501d7 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aae0ac0fb5a7d76ec145e96317d6501d7">plt_off</a></td></tr>
<tr class="separator:aae0ac0fb5a7d76ec145e96317d6501d7 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a59994ceb7e3d20444f07a08cd1cfe inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a></td></tr>
<tr class="separator:a59a59994ceb7e3d20444f07a08cd1cfe inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888f94bd6a90f535ea5567e3f8b39ccc inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a></td></tr>
<tr class="separator:a888f94bd6a90f535ea5567e3f8b39ccc inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4920cc3ff82dcbc60f2a87fdd276d025 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a></td></tr>
<tr class="separator:a4920cc3ff82dcbc60f2a87fdd276d025 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc257b84970a37def2e57221bf91c48 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a01856cf6f1215fb3b66cb3547550f99a">upx_uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></td></tr>
<tr class="separator:accc257b84970a37def2e57221bf91c48 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c2c447099336ae2bc5cc1539c36610 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">ei_class</a></td></tr>
<tr class="separator:af6c2c447099336ae2bc5cc1539c36610 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dabe40d6f7f71e6b9bce64b9cc3290f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">ei_data</a></td></tr>
<tr class="separator:a5dabe40d6f7f71e6b9bce64b9cc3290f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad930777406ea601d200de0ab59de88d6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a></td></tr>
<tr class="separator:ad930777406ea601d200de0ab59de88d6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691359a24fbf2963d4ac5f625dd0299c inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a></td></tr>
<tr class="separator:a691359a24fbf2963d4ac5f625dd0299c inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946ebc79f94eff58bd559c7b5bb60057 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">osabi_note</a></td></tr>
<tr class="separator:a946ebc79f94eff58bd559c7b5bb60057 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5789e03712ad5c821ed718be76cb006a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></td></tr>
<tr class="separator:a5789e03712ad5c821ed718be76cb006a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93d9de72bcb60bbea6757e0d44e5e296 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a> [<a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>]</td></tr>
<tr class="separator:a93d9de72bcb60bbea6757e0d44e5e296 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c2a145b6739ad4cd1035af406a821a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a></td></tr>
<tr class="separator:a76c2a145b6739ad4cd1035af406a821a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193d50a7694d9bbdd607514c4fe691ab inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a></td></tr>
<tr class="separator:a193d50a7694d9bbdd607514c4fe691ab inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0f4c33a259ca5c14cdc2384285e274f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a></td></tr>
<tr class="separator:ab0f4c33a259ca5c14cdc2384285e274f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4036b37656b78e0053108ad8f9a17ef8 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a></td></tr>
<tr class="separator:a4036b37656b78e0053108ad8f9a17ef8 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2664a0d3b21d1e9fc0871a9acefff6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3e2664a0d3b21d1e9fc0871a9acefff6">note_body</a></td></tr>
<tr class="separator:a3e2664a0d3b21d1e9fc0871a9acefff6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d39fd80fb77e53dd4d79b5042a2941 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a63d39fd80fb77e53dd4d79b5042a2941">note_size</a></td></tr>
<tr class="separator:a63d39fd80fb77e53dd4d79b5042a2941 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a02a5314fbdff34469cfa4b59ddde10 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a></td></tr>
<tr class="separator:a1a02a5314fbdff34469cfa4b59ddde10 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a614b94da58152b4585040e30a72a0de3 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a></td></tr>
<tr class="separator:a614b94da58152b4585040e30a72a0de3 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3e459ee90ee28853a76401b8145123 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a></td></tr>
<tr class="separator:aeb3e459ee90ee28853a76401b8145123 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449871a4fd2081e1399999ef05741f92 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a></td></tr>
<tr class="separator:a449871a4fd2081e1399999ef05741f92 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3408c180ca78a03f0c06da6c8c25dc34 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a></td></tr>
<tr class="separator:a3408c180ca78a03f0c06da6c8c25dc34 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6db1e979cfd371114262e2887980ee inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">progid</a></td></tr>
<tr class="separator:a4e6db1e979cfd371114262e2887980ee inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e227135d766557eb3e012e610d72a0 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a></td></tr>
<tr class="separator:aa3e227135d766557eb3e012e610d72a0 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce6e18bbda8d182b25bc7188740b55b inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a0ce6e18bbda8d182b25bc7188740b55b">loader</a></td></tr>
<tr class="separator:a0ce6e18bbda8d182b25bc7188740b55b inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914345298d86f797a6c960ca80afdeb7 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a></td></tr>
<tr class="separator:a914345298d86f797a6c960ca80afdeb7 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a7532bf1dac1d3df6a453729750505 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ac7a7532bf1dac1d3df6a453729750505">pt_dynamic</a></td></tr>
<tr class="separator:ac7a7532bf1dac1d3df6a453729750505 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe548f0eb818215a9924b273022ad71f inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#afe548f0eb818215a9924b273022ad71f">sz_dynamic</a></td></tr>
<tr class="separator:afe548f0eb818215a9924b273022ad71f inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055b87f94fa37391fb1c356b215ec027 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a055b87f94fa37391fb1c356b215ec027">b_len</a></td></tr>
<tr class="separator:a055b87f94fa37391fb1c356b215ec027 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33d54bc7392e242453b126d23c3ecbd inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a></td></tr>
<tr class="separator:aa33d54bc7392e242453b126d23c3ecbd inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a8d9222b7627fa48786c128340b0c0 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a></td></tr>
<tr class="separator:a05a8d9222b7627fa48786c128340b0c0 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab714a14f4ff2f120107dfc08b2a3a5 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a></td></tr>
<tr class="separator:a8ab714a14f4ff2f120107dfc08b2a3a5 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a994baf32174356ff73af67ad5d15ba inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structl__info.html">l_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a></td></tr>
<tr class="separator:a8a994baf32174356ff73af67ad5d15ba inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPacker')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a18d294254872108f1373a26ccabbd821 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">const N_BELE_RTP::AbstractPolicy *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a> = nullptr</td></tr>
<tr class="separator:a18d294254872108f1373a26ccabbd821 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d498ce73ff0a988560ff88f603e50ae inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a7d498ce73ff0a988560ff88f603e50ae">ph_format</a> = -1</td></tr>
<tr class="separator:a7d498ce73ff0a988560ff88f603e50ae inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096e8f1e0d39dd91a106bfb89451a25e inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a096e8f1e0d39dd91a106bfb89451a25e">ph_version</a> = -1</td></tr>
<tr class="separator:a096e8f1e0d39dd91a106bfb89451a25e inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d40264330fe966e66718440b450ec8 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a></td></tr>
<tr class="separator:a95d40264330fe966e66718440b450ec8 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f51aecfca1c5d86cc11a7d2ab574d5e inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a8f51aecfca1c5d86cc11a7d2ab574d5e">obuf</a></td></tr>
<tr class="separator:a8f51aecfca1c5d86cc11a7d2ab574d5e inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afda0c36e70bfaeeecc0494abfb924ae7 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afda0c36e70bfaeeecc0494abfb924ae7">ibufgood</a> = 0</td></tr>
<tr class="separator:afda0c36e70bfaeeecc0494abfb924ae7 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:a0306ca7a6b44bd2b88bda7eefa46d49b inherit pro_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classInputFile.html">InputFile</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a></td></tr>
<tr class="separator:a0306ca7a6b44bd2b88bda7eefa46d49b inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memItemLeft" >union {</td></tr>
<tr class="memitem:ae9574c21b6d500a7a2d0e20bcbc6f512 inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a58b8dd6274f8ad1eca2637b12665167f">upx_int64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a></td></tr>
<tr class="separator:ae9574c21b6d500a7a2d0e20bcbc6f512 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa805ae048630f146d2abf38797fea52d inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a></td></tr>
<tr class="separator:aa805ae048630f146d2abf38797fea52d inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a3f0252ee140d3a44d4a1d47ea1a9da inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a58b8dd6274f8ad1eca2637b12665167f">upx_int64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a76d1e66f0b3c637fdb874858bcda14e8">file_size_i64</a></td></tr>
<tr class="separator:a9a3f0252ee140d3a44d4a1d47ea1a9da inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae30790328b3b3bb901099d1dd6aaab inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a0fcea265b45d10fd12879bc2031bf7ab">file_size_u64</a></td></tr>
<tr class="separator:a1ae30790328b3b3bb901099d1dd6aaab inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memItemLeft" >union {</td></tr>
<tr class="memitem:ad2f05b968c3b089b974b6ee0d58f5f3d inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#ab4a628cc601ebd17416219a120bedc22">upx_int32_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a5149b8b54da86de4aece59e39d73e676">file_size_i32</a></td></tr>
<tr class="separator:ad2f05b968c3b089b974b6ee0d58f5f3d inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9da74dad6d9e37f7a927a94587ae04f inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a></td></tr>
<tr class="separator:ac9da74dad6d9e37f7a927a94587ae04f inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f3c918e5ce5b4de630d11c703cec05 inherit pro_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPackHeader.html">PackHeader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a></td></tr>
<tr class="separator:a01f3c918e5ce5b4de630d11c703cec05 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a652cb27d6ab7bd6d04199fe7da4886cd"><td class="memItemLeft" align="right" valign="top">static unsigned const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a652cb27d6ab7bd6d04199fe7da4886cd">END_PHDRX</a> = 5</td></tr>
<tr class="separator:a652cb27d6ab7bd6d04199fe7da4886cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_attribs_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_static_attribs_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Static Protected Attributes inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a14a0202c4a2a508fef4009ae120b44b8 inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned int const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> = (1u&lt;&lt;12)</td></tr>
<tr class="separator:a14a0202c4a2a508fef4009ae120b44b8 inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7515af27403f7b035c02bc0f92dee48c inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a> = 34</td></tr>
<tr class="separator:a7515af27403f7b035c02bc0f92dee48c inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793632661a0af5efd197304078be1ed0 inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static const unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">o_shstrtab</a> []</td></tr>
<tr class="separator:a793632661a0af5efd197304078be1ed0 inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-types" name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a77a68f3e542e71b7fa6b1e805f9637a9"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf32.html#a77a68f3e542e71b7fa6b1e805f9637a9">super</a></td></tr>
<tr class="separator:a77a68f3e542e71b7fa6b1e805f9637a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a5d4431054206626f898a559c0bb183c4 inherit pub_types_classPackUnix"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classPacker.html">Packer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a5d4431054206626f898a559c0bb183c4">super</a></td></tr>
<tr class="separator:a5d4431054206626f898a559c0bb183c4 inherit pub_types_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4a969f788c3bad61abe0eec73fca0f0c">isValidCompressionMethod</a> (int method)</td></tr>
<tr class="memdesc:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">compression method util  <br /></td></tr>
<tr class="separator:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:a0c49d00b430fd8a28f49499748875943 inherit pub_static_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top">static constexpr unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0c49d00b430fd8a28f49499748875943">MAX_METHODS</a> = 8</td></tr>
<tr class="separator:a0c49d00b430fd8a28f49499748875943 inherit pub_static_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8691a09f947ec86dd6437b357c277851 inherit pub_static_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top">static constexpr unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a8691a09f947ec86dd6437b357c277851">MAX_FILTERS</a> = 16</td></tr>
<tr class="separator:a8691a09f947ec86dd6437b357c277851 inherit pub_static_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_types_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a1f6547d32f13116f4f888f8f359cdbef inherit pro_types_classPackUnix"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a> = 2048
 }</td></tr>
<tr class="separator:a1f6547d32f13116f4f888f8f359cdbef inherit pro_types_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00133">133</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a77a68f3e542e71b7fa6b1e805f9637a9" name="a77a68f3e542e71b7fa6b1e805f9637a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77a68f3e542e71b7fa6b1e805f9637a9">&#9670;&#160;</a></span>super</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a> <a class="el" href="classPackLinuxElf32.html#a77a68f3e542e71b7fa6b1e805f9637a9">PackLinuxElf32::super</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00135">135</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad4a70681445083e44ae8ac59d81077ae" name="ad4a70681445083e44ae8ac59d81077ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4a70681445083e44ae8ac59d81077ae">&#9670;&#160;</a></span>PackLinuxElf32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::PackLinuxElf32 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInputFile.html">InputFile</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00961">961</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  962</span>    : <a class="code hl_typedef" href="classPackLinuxElf32.html#a77a68f3e542e71b7fa6b1e805f9637a9">super</a>(f), <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  963</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>(0), <a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>(0),</div>
<div class="line"><span class="lineno">  964</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a>(~0u&lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>),</div>
<div class="line"><span class="lineno">  965</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#ac22a29dfaad87f15dc1d1a09aed4fa7e">hashend</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  966</span>                     <a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#a81eaf2981770e46ea4d5895612a3bab7">gashend</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  967</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  968</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">sec_dynstr</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  969</span>    , <a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  970</span>{</div>
<div class="line"><span class="lineno">  971</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>));</div>
<div class="line"><span class="lineno">  972</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a> = 0;</div>
<div class="line"><span class="lineno">  973</span>    <span class="keywordflow">if</span> (f) {</div>
<div class="line"><span class="lineno">  974</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  975</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>));</div>
<div class="line"><span class="lineno">  976</span>    }</div>
<div class="line"><span class="lineno">  977</span>}</div>
<div class="ttc" id="absd_8h_html_a0d112bae8fd35be772185b6ec6bcbe64"><div class="ttname"><a href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a></div><div class="ttdeci">#define SEEK_SET</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00101">bsd.h:101</a></div></div>
<div class="ttc" id="aclassInputFile_html_a6fad8c9902f939edfcb0e48ee8379232"><div class="ttname"><a href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx</a></div><div class="ttdeci">int readx(SPAN_P(void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00201">file.cpp:201</a></div></div>
<div class="ttc" id="aclassInputFile_html_aa76b4db751f0d4ad6c47e93fa676d4a9"><div class="ttname"><a href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek</a></div><div class="ttdeci">virtual upx_off_t seek(upx_off_t off, int whence) override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00208">file.cpp:208</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a014f24da8144d063099bf9c9fc45f442"><div class="ttname"><a href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">PackLinuxElf32::sec_strndx</a></div><div class="ttdeci">Elf32_Shdr * sec_strndx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00244">p_lx_elf.h:244</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a034060e8e938b65cdd961851dea44420"><div class="ttname"><a href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">PackLinuxElf32::jni_onload_sym</a></div><div class="ttdeci">Elf32_Sym const  * jni_onload_sym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00242">p_lx_elf.h:242</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a10cfe7410f5f1cdd4b1d4d8aa32c177e"><div class="ttname"><a href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">PackLinuxElf32::ehdri</a></div><div class="ttdeci">Elf32_Ehdr ehdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00223">p_lx_elf.h:223</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a16f49d5da05459eab08054620b8afa81"><div class="ttname"><a href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">PackLinuxElf32::phdri</a></div><div class="ttdeci">Elf32_Phdr * phdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00224">p_lx_elf.h:224</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a188a0aa12a6b1d42437cd1bb391424c1"><div class="ttname"><a href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">PackLinuxElf32::sz_phdrx</a></div><div class="ttdeci">unsigned sz_phdrx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00230">p_lx_elf.h:230</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a21816e305175e291da2cbe8f85e5b6c0"><div class="ttname"><a href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">PackLinuxElf32::n_phdrx</a></div><div class="ttdeci">unsigned n_phdrx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00229">p_lx_elf.h:229</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a37a0e7b21ef6ab9036a71fe7101eb9fc"><div class="ttname"><a href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">PackLinuxElf32::shdri</a></div><div class="ttdeci">Elf32_Shdr * shdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00225">p_lx_elf.h:225</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a6a46ce4ee2f2878d9122e12b8106e0ae"><div class="ttname"><a href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">PackLinuxElf32::sec_arm_attr</a></div><div class="ttdeci">Elf32_Shdr * sec_arm_attr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00247">p_lx_elf.h:247</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a6df504485b4e0c1cce47eca10de37b94"><div class="ttname"><a href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">PackLinuxElf32::gashtab</a></div><div class="ttdeci">unsigned int const  * gashtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00240">p_lx_elf.h:240</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a77a68f3e542e71b7fa6b1e805f9637a9"><div class="ttname"><a href="classPackLinuxElf32.html#a77a68f3e542e71b7fa6b1e805f9637a9">PackLinuxElf32::super</a></div><div class="ttdeci">PackLinuxElf super</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00135">p_lx_elf.h:135</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a8006727271622c8955b9d2cd87282a28"><div class="ttname"><a href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">PackLinuxElf32::sec_dynstr</a></div><div class="ttdeci">Elf32_Shdr const  * sec_dynstr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00246">p_lx_elf.h:246</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a81eaf2981770e46ea4d5895612a3bab7"><div class="ttname"><a href="classPackLinuxElf32.html#a81eaf2981770e46ea4d5895612a3bab7">PackLinuxElf32::gashend</a></div><div class="ttdeci">unsigned int const * gashend</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00240">p_lx_elf.h:240</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a877d014b8498a8bfe5d40ebdebd5dfa0"><div class="ttname"><a href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">PackLinuxElf32::n_jmp_slot</a></div><div class="ttdeci">unsigned n_jmp_slot</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00234">p_lx_elf.h:234</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_aa25b2132cbfb2fb5a02219fbae96ad5e"><div class="ttname"><a href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">PackLinuxElf32::dynsym</a></div><div class="ttdeci">Elf32_Sym * dynsym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00241">p_lx_elf.h:241</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_aa4994d4daac1ceef79bff5afb8c9dcf5"><div class="ttname"><a href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">PackLinuxElf32::dynseg</a></div><div class="ttdeci">Elf32_Dyn * dynseg</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00238">p_lx_elf.h:238</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_aaa5a2328d0273f004e496796df5d0ae8"><div class="ttname"><a href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">PackLinuxElf32::hashtab</a></div><div class="ttdeci">unsigned int const  * hashtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00239">p_lx_elf.h:239</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_ac06c59607bfc28297c4739e3df424ca7"><div class="ttname"><a href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">PackLinuxElf32::sec_dynsym</a></div><div class="ttdeci">Elf32_Shdr const  * sec_dynsym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00245">p_lx_elf.h:245</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_ac22a29dfaad87f15dc1d1a09aed4fa7e"><div class="ttname"><a href="classPackLinuxElf32.html#ac22a29dfaad87f15dc1d1a09aed4fa7e">PackLinuxElf32::hashend</a></div><div class="ttdeci">unsigned int const * hashend</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00239">p_lx_elf.h:239</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_ae1048a909a2fce5d2c861b88974f81d6"><div class="ttname"><a href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">PackLinuxElf32::page_mask</a></div><div class="ttdeci">unsigned page_mask</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00236">p_lx_elf.h:236</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8cd64335916d77771c6dd2f5b71e9a77"><div class="ttname"><a href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">PackLinuxElf::lg2_page</a></div><div class="ttdeci">unsigned lg2_page</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00095">p_lx_elf.h:95</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a4ffffab0dc6ead4a09af1dba0b85f71c"><div class="ttname"><a href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a></div><div class="ttdeci">void * memset(const C&lt; T &gt; &amp;a, int v, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00139">xspan_fwd.h:139</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, and <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ad4a70681445083e44ae8ac59d81077ae_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_ad4a70681445083e44ae8ac59d81077ae_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ad4a70681445083e44ae8ac59d81077ae_cgraph" id="aclassPackLinuxElf32_ad4a70681445083e44ae8ac59d81077ae_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,199,162"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="270,80,346,105"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="247,129,369,155"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="249,180,367,205"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="435,80,549,105"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="417,129,567,155"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="619,131,750,156"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="837,87,927,112"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="640,29,729,55"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="616,180,753,205"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1009,59,1128,84"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="803,22,961,62"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="434,231,550,256"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="656,279,713,304"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="617,229,753,255"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="615,328,755,353"/>
</map>
</div>

</div>
</div>
<a id="a50b4d5dd33ffefd2879addc0dce06d14" name="a50b4d5dd33ffefd2879addc0dce06d14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50b4d5dd33ffefd2879addc0dce06d14">&#9670;&#160;</a></span>~PackLinuxElf32()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::~PackLinuxElf32 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00979">979</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  980</span>{</div>
<div class="line"><span class="lineno">  981</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a26bcf782bacd0c3b94c981ad6272c0b8" name="a26bcf782bacd0c3b94c981ad6272c0b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26bcf782bacd0c3b94c981ad6272c0b8">&#9670;&#160;</a></span>add_phdrx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::add_phdrx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00983">983</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  984</span>{</div>
<div class="line"><span class="lineno">  985</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a652cb27d6ab7bd6d04199fe7da4886cd">END_PHDRX</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>) {</div>
<div class="line"><span class="lineno">  986</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many Phdr %u&quot;</span>, (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>));</div>
<div class="line"><span class="lineno">  987</span>    }</div>
<div class="line"><span class="lineno">  988</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#af6320858ad11e1f2a16f29d6554fbbca">phdrx</a>[<a class="code hl_variable" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>++] = phdr;</div>
<div class="line"><span class="lineno">  989</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a652cb27d6ab7bd6d04199fe7da4886cd"><div class="ttname"><a href="classPackLinuxElf32.html#a652cb27d6ab7bd6d04199fe7da4886cd">PackLinuxElf32::END_PHDRX</a></div><div class="ttdeci">static unsigned const END_PHDRX</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00227">p_lx_elf.h:227</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_af6320858ad11e1f2a16f29d6554fbbca"><div class="ttname"><a href="classPackLinuxElf32.html#af6320858ad11e1f2a16f29d6554fbbca">PackLinuxElf32::phdrx</a></div><div class="ttdeci">Elf32_Phdr const  * phdrx[END_PHDRX]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00228">p_lx_elf.h:228</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a388ab1f73d9ba5222a35cbdd67b396ff"><div class="ttname"><a href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a></div><div class="ttdeci">void throwCantPack(const char *msg)</div><div class="ttdoc">compression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00075">except.cpp:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a652cb27d6ab7bd6d04199fe7da4886cd">END_PHDRX</a>, <a class="el" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classPackLinuxElf32.html#af6320858ad11e1f2a16f29d6554fbbca">phdrx</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">canPackOSABI()</a>, and <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_cgraph" id="aclassPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="205,13,324,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_icgraph" id="aclassPackLinuxElf32_a26bcf782bacd0c3b94c981ad6272c0b8_icgraph">
<area shape="rect" title=" " alt="" coords="736,31,888,71"/>
<area shape="rect" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a" title=" " alt="" coords="465,13,688,38"/>
<area shape="rect" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625" title=" " alt="" coords="493,62,660,87"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="a71dfe9e1479de8e093db3320b9b4588f" name="a71dfe9e1479de8e093db3320b9b4588f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71dfe9e1479de8e093db3320b9b4588f">&#9670;&#160;</a></span>adjABS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf32::adjABS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03865">3865</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3866</span>{</div>
<div class="line"><span class="lineno"> 3867</span>    <span class="keywordtype">unsigned</span> st_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sym-&gt;st_name);</div>
<div class="line"><span class="lineno"> 3868</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; <a class="code hl_variable" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>[j][0]; ++j) {</div>
<div class="line"><span class="lineno"> 3869</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>[j], <a class="code hl_function" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name</a>(st_name, (<span class="keywordtype">unsigned</span>)-1))) {</div>
<div class="line"><span class="lineno"> 3870</span>            sym-&gt;st_value += delta;</div>
<div class="line"><span class="lineno"> 3871</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 3872</span>        }</div>
<div class="line"><span class="lineno"> 3873</span>    }</div>
<div class="line"><span class="lineno"> 3874</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3875</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_aaad617181a6e644a245633fc306f6fca"><div class="ttname"><a href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">PackLinuxElf32::get_str_name</a></div><div class="ttdeci">char const * get_str_name(unsigned st_name, unsigned symnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02417">p_lx_elf.cpp:2417</a></div></div>
<div class="ttc" id="aclassPacker_html_a47a54fc63360923941cec0aa6060ae01"><div class="ttname"><a href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32</a></div><div class="ttdeci">unsigned get_te32(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00262">packer.h:262</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aa76502ba73704544aa4c5bf2afca9195"><div class="ttname"><a href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a></div><div class="ttdeci">static char const abs_symbol_names[][14]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03853">p_lx_elf.cpp:3853</a></div></div>
<div class="ttc" id="asnprintf_8h_html_a674a04e474d5db68cb6272b9d46940cf"><div class="ttname"><a href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a></div><div class="ttdeci">forceinline int strcmp(const uchar *s1, const char *s2) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00077">snprintf.h:77</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>, <a class="el" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, and <a class="el" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_cgraph" id="aclassPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_cgraph">
<area shape="rect" title=" " alt="" coords="5,70,180,95"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="228,5,377,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="238,70,367,95"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="269,143,336,169"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="425,13,544,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_icgraph" id="aclassPackLinuxElf32_a71dfe9e1479de8e093db3320b9b4588f_icgraph">
<area shape="rect" title=" " alt="" coords="637,45,812,70"/>
<area shape="rect" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe" title=" " alt="" coords="443,5,589,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="444,69,588,109"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="228,13,395,38"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="239,69,383,109"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,77,180,102"/>
</map>
</div>

</div>
</div>
<a id="a247c49c374e4a7c27cafadafb01f5642" name="a247c49c374e4a7c27cafadafb01f5642"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a247c49c374e4a7c27cafadafb01f5642">&#9670;&#160;</a></span>ARM_defineSymbols()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::ARM_defineSymbols </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05532">5532</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5533</span>{</div>
<div class="line"><span class="lineno"> 5534</span>    <a class="code hl_function" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b">PackLinuxElf32::defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno"> 5535</span> </div>
<div class="line"><span class="lineno"> 5536</span><span class="preprocessor">#define MAP_PRIVATE      2     </span><span class="comment">/* UNIX standard */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 5537</span><span class="preprocessor">#define MAP_FIXED     0x10     </span><span class="comment">/* UNIX standard */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 5538</span><span class="preprocessor">#define MAP_ANONYMOUS 0x20     </span><span class="comment">/* UNIX standard */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 5539</span><span class="preprocessor">#define MAP_PRIVANON     3     </span><span class="comment">/* QNX anonymous private memory */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno"> 5540</span>    <span class="keywordtype">unsigned</span> mflg = <a class="code hl_define" href="p__lx__elf_8cpp.html#a398ef47a991a44389aa9818c98a28d24">MAP_PRIVATE</a> | <a class="code hl_define" href="p__lx__elf_8cpp.html#ae4f86bff73414c5fc08c058f957212f0">MAP_ANONYMOUS</a>;</div>
<div class="line"><span class="lineno"> 5541</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">ARM_is_QNX</a>())</div>
<div class="line"><span class="lineno"> 5542</span>        mflg = <a class="code hl_define" href="p__lx__elf_8cpp.html#aa0c9edefc31c23161a1c8499042f61af">MAP_PRIVANON</a>;</div>
<div class="line"><span class="lineno"> 5543</span>    linker-&gt;defineSymbol(<span class="stringliteral">&quot;MFLG&quot;</span>, mflg);</div>
<div class="line"><span class="lineno"> 5544</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a379f1a6161600dea7e368dabb0819f71"><div class="ttname"><a href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">PackLinuxElf32::ARM_is_QNX</a></div><div class="ttdeci">virtual int ARM_is_QNX(void)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05505">p_lx_elf.cpp:5505</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a42b1cda087bb627b537152b283c9419b"><div class="ttname"><a href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b">PackLinuxElf32::defineSymbols</a></div><div class="ttdeci">virtual void defineSymbols(Filter const *) override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00951">p_lx_elf.cpp:951</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a398ef47a991a44389aa9818c98a28d24"><div class="ttname"><a href="p__lx__elf_8cpp.html#a398ef47a991a44389aa9818c98a28d24">MAP_PRIVATE</a></div><div class="ttdeci">#define MAP_PRIVATE</div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aa0c9edefc31c23161a1c8499042f61af"><div class="ttname"><a href="p__lx__elf_8cpp.html#aa0c9edefc31c23161a1c8499042f61af">MAP_PRIVANON</a></div><div class="ttdeci">#define MAP_PRIVANON</div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae4f86bff73414c5fc08c058f957212f0"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae4f86bff73414c5fc08c058f957212f0">MAP_ANONYMOUS</a></div><div class="ttdeci">#define MAP_ANONYMOUS</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">ARM_is_QNX()</a>, <a class="el" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b">defineSymbols()</a>, <a class="el" href="p__lx__elf_8cpp.html#ae4f86bff73414c5fc08c058f957212f0">MAP_ANONYMOUS</a>, <a class="el" href="p__lx__elf_8cpp.html#aa0c9edefc31c23161a1c8499042f61af">MAP_PRIVANON</a>, and <a class="el" href="p__lx__elf_8cpp.html#a398ef47a991a44389aa9818c98a28d24">MAP_PRIVATE</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32armLe.html#a9e09fa4d0193751ca6866465ccdb97b3">PackLinuxElf32armLe::defineSymbols()</a>, and <a class="el" href="classPackLinuxElf32armBe.html#a3c3ef6474fdf3b84b9d613c89f7cc4cf">PackLinuxElf32armBe::defineSymbols()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_cgraph" id="aclassPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_cgraph">
<area shape="rect" title=" " alt="" coords="5,247,164,287"/>
<area shape="rect" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71" title=" " alt="" coords="245,198,403,238"/>
<area shape="rect" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b" title=" " alt="" coords="212,283,436,308"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="523,229,652,255"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="523,279,652,304"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="545,81,629,107"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="526,131,649,156"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="529,180,646,205"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="756,129,871,155"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="739,80,888,105"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="941,131,1071,156"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1159,87,1248,112"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="961,29,1051,55"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="937,180,1075,205"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1331,59,1449,84"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1124,22,1283,62"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="755,231,871,256"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="977,328,1035,353"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="938,229,1074,255"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="936,279,1076,304"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="484,328,691,353"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_icgraph" id="aclassPackLinuxElf32_a247c49c374e4a7c27cafadafb01f5642_icgraph">
<area shape="rect" title=" " alt="" coords="216,37,375,77"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#a9e09fa4d0193751ca6866465ccdb97b3" title=" " alt="" coords="6,5,167,45"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a3c3ef6474fdf3b84b9d613c89f7cc4cf" title=" " alt="" coords="5,69,168,109"/>
</map>
</div>

</div>
</div>
<a id="a379f1a6161600dea7e368dabb0819f71" name="a379f1a6161600dea7e368dabb0819f71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a379f1a6161600dea7e368dabb0819f71">&#9670;&#160;</a></span>ARM_is_QNX()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf32::ARM_is_QNX </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05505">5505</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5506</span>{</div>
<div class="line"><span class="lineno"> 5507</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>)</div>
<div class="line"><span class="lineno"> 5508</span>    &amp;&amp;  Elf32_Ehdr::ELFDATA2MSB== <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>[Elf32_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno"> 5509</span>    &amp;&amp;  Elf32_Ehdr::ELFOSABI_ARM==<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>[Elf32_Ehdr::EI_OSABI]</div>
<div class="line"><span class="lineno"> 5510</span>    &amp;&amp;  0x100000==(<a class="code hl_variable" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a> &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[0].p_vaddr))) {</div>
<div class="line"><span class="lineno"> 5511</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 5512</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>); --j&gt;=0; ++phdr) {</div>
<div class="line"><span class="lineno"> 5513</span>            <span class="keywordflow">if</span> (Elf32_Phdr::PT_INTERP==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 5514</span>                <span class="keywordtype">char</span> interp[64];</div>
<div class="line"><span class="lineno"> 5515</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_interp = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 5516</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> pos_interp = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 5517</span>                <span class="keywordflow">if</span> (sz_interp &lt;= <span class="keyword">sizeof</span>(interp)</div>
<div class="line"><span class="lineno"> 5518</span>                &amp;&amp;  (sz_interp + pos_interp) &lt;= (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>) {</div>
<div class="line"><span class="lineno"> 5519</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos_interp, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5520</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(interp, sz_interp);</div>
<div class="line"><span class="lineno"> 5521</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sz_interp - 5; k&gt;=0; --k) {</div>
<div class="line"><span class="lineno"> 5522</span>                        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<span class="stringliteral">&quot;ldqnx&quot;</span>, &amp;interp[k], 5))</div>
<div class="line"><span class="lineno"> 5523</span>                            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 5524</span>                    }</div>
<div class="line"><span class="lineno"> 5525</span>                }</div>
<div class="line"><span class="lineno"> 5526</span>            }</div>
<div class="line"><span class="lineno"> 5527</span>        }</div>
<div class="line"><span class="lineno"> 5528</span>    }</div>
<div class="line"><span class="lineno"> 5529</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 5530</span>}</div>
<div class="ttc" id="aclassPackerBase_html_a0306ca7a6b44bd2b88bda7eefa46d49b"><div class="ttname"><a href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a></div><div class="ttdeci">InputFile *const fi</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00084">packer.h:84</a></div></div>
<div class="ttc" id="aclassPackerBase_html_ace3319e7b055b7328edc18f48dba58db"><div class="ttname"><a href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a></div><div class="ttdeci">const upx_int64_t file_size</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00087">packer.h:87</a></div></div>
<div class="ttc" id="aclassPacker_html_ad01e10cd32d88f80d316455b55bcb1a5"><div class="ttname"><a href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16</a></div><div class="ttdeci">unsigned get_te16(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00261">packer.h:261</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a19bca7faba9e5573814643efc3574c7b"><div class="ttname"><a href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a></div><div class="ttdeci">Elf32_Half e_machine</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00191">bsd.h:191</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a360898812db1655f8cb8258780d9df5b"><div class="ttname"><a href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a></div><div class="ttdeci">Elf32_Half e_phnum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00199">bsd.h:199</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_aebd5576e5ae99cb99c2eb76d94c7f9f7"><div class="ttname"><a href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a></div><div class="ttdeci">unsigned char e_ident[EI_NIDENT]</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00189">bsd.h:189</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html"><div class="ttname"><a href="structElf32__Phdr.html">Elf32_Phdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00223">bsd.h:224</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html_a8b1d2942ddb9abcb85db1429b5116923"><div class="ttname"><a href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a></div><div class="ttdeci">Elf32_Word p_type</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00225">bsd.h:225</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html_ac590d4c4b26104216e53058b5b03eef0"><div class="ttname"><a href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a></div><div class="ttdeci">Elf32_Off p_offset</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00226">bsd.h:226</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html_ac9151f2e11001284bf1c7d2d2659555c"><div class="ttname"><a href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a></div><div class="ttdeci">Elf32_Word p_filesz</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00229">bsd.h:229</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a1a9f236758b0df388ddf70ed0e05e350"><div class="ttname"><a href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a></div><div class="ttdeci">int memcmp(const C&lt; T &gt; &amp;a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00073">xspan_fwd.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a>, <a class="el" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a>, <a class="el" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, and <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a247c49c374e4a7c27cafadafb01f5642">ARM_defineSymbols()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_cgraph" id="aclassPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_cgraph">
<area shape="rect" title=" " alt="" coords="5,121,164,161"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="212,5,341,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="212,55,341,80"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="235,128,319,153"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="215,177,338,203"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="218,228,335,253"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="407,128,521,153"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="389,177,539,203"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="591,179,722,204"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="809,135,899,160"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="612,77,701,103"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="588,228,725,253"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="981,107,1100,132"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="775,70,933,110"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="406,279,522,304"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="628,327,685,352"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="589,277,725,303"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="587,376,727,401"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_icgraph" id="aclassPackLinuxElf32_a379f1a6161600dea7e368dabb0819f71_icgraph">
<area shape="rect" title=" " alt="" coords="423,37,581,77"/>
<area shape="rect" href="classPackLinuxElf32.html#a247c49c374e4a7c27cafadafb01f5642" title=" " alt="" coords="216,37,375,77"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#a9e09fa4d0193751ca6866465ccdb97b3" title=" " alt="" coords="6,5,167,45"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a3c3ef6474fdf3b84b9d613c89f7cc4cf" title=" " alt="" coords="5,69,168,109"/>
</map>
</div>

</div>
</div>
<a id="aa515825407739bf3ca522be194de8b27" name="aa515825407739bf3ca522be194de8b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa515825407739bf3ca522be194de8b27">&#9670;&#160;</a></span>ARM_updateLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::ARM_updateLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01204">1204</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1205</span>{</div>
<div class="line"><span class="lineno"> 1206</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.ehdr.e_entry, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> +</div>
<div class="line"><span class="lineno"> 1207</span>        linker-&gt;getSymbolOffset(<span class="stringliteral">&quot;_start&quot;</span>) +</div>
<div class="line"><span class="lineno"> 1208</span>        <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr));</div>
<div class="line"><span class="lineno"> 1209</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_ac8a5249ca04607b3dcf5a09ca156da8f"><div class="ttname"><a href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">PackLinuxElf32::elfout</a></div><div class="ttdeci">cprElfHdrNetBSD elfout</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00279">p_lx_elf.h:279</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a99ee39bcba2a438ad1728c8332356ce2"><div class="ttname"><a href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a></div><div class="ttdeci">unsigned sz_pack2</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00093">p_lx_elf.h:93</a></div></div>
<div class="ttc" id="aclassPacker_html_af9cad2c8624ee68213d01eb606be0382"><div class="ttname"><a href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32</a></div><div class="ttdeci">void set_te32(void *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00265">packer.h:265</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5"><div class="ttname"><a href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a></div><div class="ttdeci">@ C_TEXT</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00510">p_lx_elf.cpp:509</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, and <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32armLe.html#acd542d296a8ba1501712e7c11c4ff910">PackLinuxElf32armLe::updateLoader()</a>, <a class="el" href="classPackLinuxElf32armBe.html#af5054235efb5ecacb2d9fd9022ca3987">PackLinuxElf32armBe::updateLoader()</a>, <a class="el" href="classPackLinuxElf32mipseb.html#aba36624955a246a45e01becd0b4700bb">PackLinuxElf32mipseb::updateLoader()</a>, and <a class="el" href="classPackLinuxElf32mipsel.html#ac57c5824382ab097c99de4809c14f300">PackLinuxElf32mipsel::updateLoader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa515825407739bf3ca522be194de8b27_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa515825407739bf3ca522be194de8b27_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa515825407739bf3ca522be194de8b27_cgraph" id="aclassPackLinuxElf32_aa515825407739bf3ca522be194de8b27_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,164,63"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="212,5,341,31"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="213,55,341,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa515825407739bf3ca522be194de8b27_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa515825407739bf3ca522be194de8b27_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa515825407739bf3ca522be194de8b27_icgraph" id="aclassPackLinuxElf32_aa515825407739bf3ca522be194de8b27_icgraph">
<area shape="rect" title=" " alt="" coords="221,101,380,141"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#acd542d296a8ba1501712e7c11c4ff910" title=" " alt="" coords="9,5,170,45"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#af5054235efb5ecacb2d9fd9022ca3987" title=" " alt="" coords="8,69,171,109"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#aba36624955a246a45e01becd0b4700bb" title=" " alt="" coords="5,133,173,173"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#ac57c5824382ab097c99de4809c14f300" title=" " alt="" coords="7,197,171,237"/>
</map>
</div>

</div>
</div>
<a id="a12904e259a31849e8633faf26b5e07fe" name="a12904e259a31849e8633faf26b5e07fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12904e259a31849e8633faf26b5e07fe">&#9670;&#160;</a></span>asl_pack2_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::asl_pack2_Shdrs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>pre_xct_top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04405">4405</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4406</span>{</div>
<div class="line"><span class="lineno"> 4407</span>    <span class="keywordflow">if</span> (!fo) {</div>
<div class="line"><span class="lineno"> 4408</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 4409</span>    }</div>
<div class="line"><span class="lineno"> 4410</span>    <span class="comment">// In order to pacify the runtime linker on Android &quot;O&quot; (&quot;Oreo&quot;),</span></div>
<div class="line"><span class="lineno"> 4411</span>    <span class="comment">// we will splice-in a 4KiB page that contains an &quot;extra&quot; copy</span></div>
<div class="line"><span class="lineno"> 4412</span>    <span class="comment">// of the Shdr, any PT_NOTE above xct_off, and shstrtab.</span></div>
<div class="line"><span class="lineno"> 4413</span>    <span class="comment">// File order: Ehdr, Phdr[], section contents below xct_off,</span></div>
<div class="line"><span class="lineno"> 4414</span>    <span class="comment">//    Shdr_copy[], PT_NOTEs.hi, shstrtab.</span></div>
<div class="line"><span class="lineno"> 4415</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>  += <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 4416</span>    <span class="comment">//xct_off += asl_delta;  // not until ::pack3()</span></div>
<div class="line"><span class="lineno"> 4417</span> </div>
<div class="line"><span class="lineno"> 4418</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = pre_xct_top;</div>
<div class="line"><span class="lineno"> 4419</span> </div>
<div class="line"><span class="lineno"> 4420</span>    <span class="comment">// Relocate PT_DYNAMIC (in PT_LOAD with PF_W)</span></div>
<div class="line"><span class="lineno"> 4421</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *dyn = <span class="keyword">const_cast&lt;</span><a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>);</div>
<div class="line"><span class="lineno"> 4422</span>    <span class="keywordflow">for</span> (; dyn-&gt;d_tag; ++dyn) {</div>
<div class="line"><span class="lineno"> 4423</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d_tag = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dyn-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 4424</span>        <span class="keywordflow">if</span> (Elf32_Dyn::DT_FINI       == d_tag</div>
<div class="line"><span class="lineno"> 4425</span>        ||  Elf32_Dyn::DT_FINI_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4426</span>        ||  Elf32_Dyn::DT_INIT_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4427</span>        ||  Elf32_Dyn::DT_PREINIT_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4428</span>        ||  Elf32_Dyn::DT_PLTGOT      == d_tag) {</div>
<div class="line"><span class="lineno"> 4429</span>            <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d_val = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dyn-&gt;d_val);</div>
<div class="line"><span class="lineno"> 4430</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;dyn-&gt;d_val, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + d_val);</div>
<div class="line"><span class="lineno"> 4431</span>        }</div>
<div class="line"><span class="lineno"> 4432</span>    }</div>
<div class="line"><span class="lineno"> 4433</span>    <span class="comment">// Updated dynseg (.dynamic, in PT_DYNAMIC (PT_LOAD{PF_W})) has not been written.</span></div>
<div class="line"><span class="lineno"> 4434</span>    <span class="comment">// dynseg is in file_image[] but not in low_mem[].</span></div>
<div class="line"><span class="lineno"> 4435</span> </div>
<div class="line"><span class="lineno"> 4436</span>    <span class="comment">// Relocate dynsym (DT_SYMTAB) which is below xct_va</span></div>
<div class="line"><span class="lineno"> 4437</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> off_dynsym = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4438</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> sz_dynsym  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4439</span>    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sz_dynsym</div>
<div class="line"><span class="lineno"> 4440</span>    ||  (<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; off_dynsym</div>
<div class="line"><span class="lineno"> 4441</span>    || ((<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - off_dynsym) &lt; sz_dynsym) {</div>
<div class="line"><span class="lineno"> 4442</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_SYMTAB&quot;</span>);</div>
<div class="line"><span class="lineno"> 4443</span>    }</div>
<div class="line"><span class="lineno"> 4444</span>    <a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *dyntym = (<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4445</span>        <span class="stringliteral">&quot;bad dynsym&quot;</span>, off_dynsym, sz_dynsym);</div>
<div class="line"><span class="lineno"> 4446</span>    <a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *sym = dyntym;</div>
<div class="line"><span class="lineno"> 4447</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = sz_dynsym / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a>); --j&gt;=0; ++sym) {</div>
<div class="line"><span class="lineno"> 4448</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> symval = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sym-&gt;st_value);</div>
<div class="line"><span class="lineno"> 4449</span>        <span class="keywordtype">unsigned</span> symsec = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;sym-&gt;st_shndx);</div>
<div class="line"><span class="lineno"> 4450</span>        <span class="keywordflow">if</span> (Elf32_Sym::SHN_UNDEF != symsec</div>
<div class="line"><span class="lineno"> 4451</span>        &amp;&amp;  Elf32_Sym::SHN_ABS   != symsec</div>
<div class="line"><span class="lineno"> 4452</span>        &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 4453</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sym-&gt;st_value, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + symval);</div>
<div class="line"><span class="lineno"> 4454</span>        }</div>
<div class="line"><span class="lineno"> 4455</span>        <span class="keywordflow">if</span> (Elf32_Sym::SHN_ABS == symsec &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 4456</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">adjABS</a>(sym, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 4457</span>        }</div>
<div class="line"><span class="lineno"> 4458</span>    }</div>
<div class="line"><span class="lineno"> 4459</span> </div>
<div class="line"><span class="lineno"> 4460</span>    <span class="comment">// Relocate Phdr virtual addresses, but not physical offsets and sizes</span></div>
<div class="line"><span class="lineno"> 4461</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf_notes[512]; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(buf_notes, 0, <span class="keyword">sizeof</span>(buf_notes));</div>
<div class="line"><span class="lineno"> 4462</span>    <span class="keywordtype">unsigned</span> len_notes = 0;</div>
<div class="line"><span class="lineno"> 4463</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4464</span>        <span class="stringliteral">&quot;bad e_phoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));</div>
<div class="line"><span class="lineno"> 4465</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 4466</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4467</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= offset) { <span class="comment">// above the extra page</span></div>
<div class="line"><span class="lineno"> 4468</span>            {</div>
<div class="line"><span class="lineno"> 4469</span>                <span class="comment">//set_te32(&amp;phdr-&gt;p_offset, asl_delta + offset);  // physical</span></div>
<div class="line"><span class="lineno"> 4470</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> v_addr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 4471</span>                                      <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + v_addr);</div>
<div class="line"><span class="lineno"> 4472</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> p_addr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">p_paddr</a>);</div>
<div class="line"><span class="lineno"> 4473</span>                                      <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">p_paddr</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + p_addr);</div>
<div class="line"><span class="lineno"> 4474</span>            }</div>
<div class="line"><span class="lineno"> 4475</span>        }</div>
<div class="line"><span class="lineno"> 4476</span>        <span class="comment">// .p_filesz,.p_memsz are updated in ::pack3</span></div>
<div class="line"><span class="lineno"> 4477</span>    }</div>
<div class="line"><span class="lineno"> 4478</span> </div>
<div class="line"><span class="lineno"> 4479</span>    <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *<span class="keyword">const</span> ehdr = (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0];</div>
<div class="line"><span class="lineno"> 4480</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> e_entry = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">e_entry</a>);</div>
<div class="line"><span class="lineno"> 4481</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= e_entry) { <span class="comment">// FIXME: --android-shlib is different</span></div>
<div class="line"><span class="lineno"> 4482</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">e_entry</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + e_entry);</div>
<div class="line"><span class="lineno"> 4483</span>    }</div>
<div class="line"><span class="lineno"> 4484</span>    <span class="comment">// Relocate Shdr; and Rela, Rel (below xct_off)</span></div>
<div class="line"><span class="lineno"> 4485</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> pal_xct_top = <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(pre_xct_top);</div>
<div class="line"><span class="lineno"> 4486</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">e_shoff</a>, pal_xct_top);  <span class="comment">// Shdr alignment</span></div>
<div class="line"><span class="lineno"> 4487</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[pal_xct_top], <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4488</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a> = (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[pal_xct_top];</div>
<div class="line"><span class="lineno"> 4489</span>    <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>;</div>
<div class="line"><span class="lineno"> 4490</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> sz_shstrtab  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4491</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++j, ++shdr) {</div>
<div class="line"><span class="lineno"> 4492</span>        <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 4493</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> sh_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4494</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4495</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> sh_entsize = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_entsize);</div>
<div class="line"><span class="lineno"> 4496</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_size</div>
<div class="line"><span class="lineno"> 4497</span>        ||  (<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_offset</div>
<div class="line"><span class="lineno"> 4498</span>        || (Elf32_Shdr::SHT_NOBITS != sh_type</div>
<div class="line"><span class="lineno"> 4499</span>           &amp;&amp; ((<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - sh_offset) &lt; sh_size) ) {</div>
<div class="line"><span class="lineno"> 4500</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad SHT_STRNDX&quot;</span>);</div>
<div class="line"><span class="lineno"> 4501</span>        }</div>
<div class="line"><span class="lineno"> 4502</span> </div>
<div class="line"><span class="lineno"> 4503</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= sh_offset &amp;&amp; Elf32_Shdr::SHF_ALLOC &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_flags)) {</div>
<div class="line"><span class="lineno"> 4504</span>            <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> addr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 4505</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr-&gt;sh_addr, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4506</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 4507</span>        }</div>
<div class="line"><span class="lineno"> 4508</span>        <span class="keywordflow">switch</span> (sh_type) {</div>
<div class="line"><span class="lineno"> 4509</span>        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4510</span>        <span class="keywordflow">case</span> Elf32_Shdr::SHT_RELA: { <span class="comment">// 32-bit Elf_Rela is unused (by convention)</span></div>
<div class="line"><span class="lineno"> 4511</span>            <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a308335509ec9fb2e442fa92cd6cb7afd">Elf32_Rela</a>) != sh_entsize) {</div>
<div class="line"><span class="lineno"> 4512</span>                <span class="keywordtype">char</span> msg[50];</div>
<div class="line"><span class="lineno"> 4513</span>                <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad Rela.sh_entsize %lu&quot;</span>, (<span class="keywordtype">long</span>)sh_entsize);</div>
<div class="line"><span class="lineno"> 4514</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4515</span>            }</div>
<div class="line"><span class="lineno"> 4516</span>            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = ~0ull;</div>
<div class="line"><span class="lineno"> 4517</span>            <a class="code hl_typedef" href="p__elf_8h.html#a308335509ec9fb2e442fa92cd6cb7afd">Elf32_Rela</a> *<span class="keyword">const</span> relb = (<a class="code hl_typedef" href="p__elf_8h.html#a308335509ec9fb2e442fa92cd6cb7afd">Elf32_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4518</span>                 <span class="stringliteral">&quot;bad Rela offset&quot;</span>, sh_offset, sh_size);</div>
<div class="line"><span class="lineno"> 4519</span>            <a class="code hl_typedef" href="p__elf_8h.html#a308335509ec9fb2e442fa92cd6cb7afd">Elf32_Rela</a> *rela = relb;</div>
<div class="line"><span class="lineno"> 4520</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sh_size / sh_entsize; --k &gt;= 0; ++rela) {</div>
<div class="line"><span class="lineno"> 4521</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> r_addend = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rela-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 4522</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> r_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rela-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 4523</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> r_info   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rela-&gt;r_info);</div>
<div class="line"><span class="lineno"> 4524</span>                <span class="keywordtype">unsigned</span> r_type = ELF32_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 4525</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 4526</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rela-&gt;r_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4527</span>                }</div>
<div class="line"><span class="lineno"> 4528</span>                <span class="keywordflow">if</span> (Elf32_Ehdr::EM_386 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) <span class="keywordflow">switch</span> (r_type) {</div>
<div class="line"><span class="lineno"> 4529</span>                    <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 4530</span>                        <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4531</span>                            <span class="stringliteral">&quot;unexpected relocation %#x [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 4532</span>                            r_type, -1 + (<span class="keywordtype">unsigned</span>)(sh_size / sh_entsize) - k);</div>
<div class="line"><span class="lineno"> 4533</span>                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4534</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4535</span>                    <span class="keywordflow">case</span> R_386_32: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4536</span>                    <span class="keywordflow">case</span> R_386_GLOB_DAT: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4537</span>                    <span class="keywordflow">case</span> R_386_RELATIVE: {</div>
<div class="line"><span class="lineno"> 4538</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_addend) {</div>
<div class="line"><span class="lineno"> 4539</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rela-&gt;r_addend, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_addend);</div>
<div class="line"><span class="lineno"> 4540</span>                        }</div>
<div class="line"><span class="lineno"> 4541</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4542</span>                    <span class="keywordflow">case</span> R_386_JMP_SLOT: {</div>
<div class="line"><span class="lineno"> 4543</span>                        <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 4544</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; r_offset) {</div>
<div class="line"><span class="lineno"> 4545</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = r_offset;</div>
<div class="line"><span class="lineno"> 4546</span>                        }</div>
<div class="line"><span class="lineno"> 4547</span>                        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(r_offset);</div>
<div class="line"><span class="lineno"> 4548</span>                        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4549</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4550</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4551</span>                        }</div>
<div class="line"><span class="lineno"> 4552</span>                        ++<a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 4553</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4554</span>                } <span class="comment">// end EM_386 r_type</span></div>
<div class="line"><span class="lineno"> 4555</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) <span class="keywordflow">switch</span> (r_type) {</div>
<div class="line"><span class="lineno"> 4556</span>                    <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 4557</span>                        <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4558</span>                            <span class="stringliteral">&quot;unexpected relocation %#x [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 4559</span>                            r_type, -1 + (<span class="keywordtype">unsigned</span>)(sh_size / sh_entsize) - k);</div>
<div class="line"><span class="lineno"> 4560</span>                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4561</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4562</span>                    <span class="keywordflow">case</span> R_ARM_ABS32: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4563</span>                    <span class="keywordflow">case</span> R_ARM_GLOB_DAT: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4564</span>                    <span class="keywordflow">case</span> R_ARM_RELATIVE: {</div>
<div class="line"><span class="lineno"> 4565</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_addend) {</div>
<div class="line"><span class="lineno"> 4566</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rela-&gt;r_addend, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_addend);</div>
<div class="line"><span class="lineno"> 4567</span>                        }</div>
<div class="line"><span class="lineno"> 4568</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4569</span>                    <span class="keywordflow">case</span> R_ARM_JUMP_SLOT: {</div>
<div class="line"><span class="lineno"> 4570</span>                        <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 4571</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; r_offset) {</div>
<div class="line"><span class="lineno"> 4572</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = r_offset;</div>
<div class="line"><span class="lineno"> 4573</span>                        }</div>
<div class="line"><span class="lineno"> 4574</span>                        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(r_offset);</div>
<div class="line"><span class="lineno"> 4575</span>                        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4576</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4577</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4578</span>                        }</div>
<div class="line"><span class="lineno"> 4579</span>                        ++<a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 4580</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4581</span>                }  <span class="comment">// end EM_ARM r_type</span></div>
<div class="line"><span class="lineno"> 4582</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4583</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4584</span>                        <span class="stringliteral">&quot;Unknown architecture %d&quot;</span>, this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);</div>
<div class="line"><span class="lineno"> 4585</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4586</span>                }  <span class="comment">// end e_machine</span></div>
<div class="line"><span class="lineno"> 4587</span>            }</div>
<div class="line"><span class="lineno"> 4588</span>        }; <span class="keywordflow">break</span>;  <span class="comment">// end Elf32_Shdr::SHT_RELA</span></div>
<div class="line"><span class="lineno"> 4589</span>        <span class="keywordflow">case</span> Elf32_Shdr::SHT_REL: {</div>
<div class="line"><span class="lineno"> 4590</span>            <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>) != sh_entsize) {</div>
<div class="line"><span class="lineno"> 4591</span>                <span class="keywordtype">char</span> msg[50];</div>
<div class="line"><span class="lineno"> 4592</span>                <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad Rel.sh_entsize %lu&quot;</span>, (<span class="keywordtype">long</span>)sh_entsize);</div>
<div class="line"><span class="lineno"> 4593</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4594</span>            }</div>
<div class="line"><span class="lineno"> 4595</span>            <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *rel = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4596</span>                    <span class="stringliteral">&quot;bad Rel sh_offset&quot;</span>, sh_offset, sh_size);</div>
<div class="line"><span class="lineno"> 4597</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sh_size / sh_entsize; --k &gt;= 0; ++rel) {</div>
<div class="line"><span class="lineno"> 4598</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> r_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rel-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 4599</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 4600</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rel-&gt;r_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4601</span>                }</div>
<div class="line"><span class="lineno"> 4602</span>                <span class="comment">// r_offset must be in 2nd PT_LOAD; .p_vaddr was already relocated</span></div>
<div class="line"><span class="lineno"> 4603</span>                <span class="keywordflow">if</span> (0x9055c == r_offset || 0x9155c==r_offset) {</div>
<div class="line"><span class="lineno"> 4604</span>                    <span class="comment">//printf(&quot;Here!\n&quot;);</span></div>
<div class="line"><span class="lineno"> 4605</span>                }</div>
<div class="line"><span class="lineno"> 4606</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(r_offset);</div>
<div class="line"><span class="lineno"> 4607</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4608</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> r_info = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rel-&gt;r_info);</div>
<div class="line"><span class="lineno"> 4609</span>                <span class="keywordtype">unsigned</span> r_type = ELF32_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 4610</span>                <span class="comment">//printf(&quot;d=%#x  w=%#x  r_info=%#x\n&quot;, d, w, r_info);</span></div>
<div class="line"><span class="lineno"> 4611</span>                <span class="keywordflow">if</span> (Elf32_Ehdr::EM_386 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) <span class="keywordflow">switch</span> (r_type) {</div>
<div class="line"><span class="lineno"> 4612</span>                    <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 4613</span>                        <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4614</span>                            <span class="stringliteral">&quot;unexpected relocation %#x [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 4615</span>                            r_type, -1 + (<span class="keywordtype">unsigned</span>)(sh_size / sh_entsize) - k);</div>
<div class="line"><span class="lineno"> 4616</span>                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4617</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4618</span>                    <span class="keywordflow">case</span> R_386_32: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4619</span>                    <span class="keywordflow">case</span> R_386_GLOB_DAT: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4620</span>                    <span class="keywordflow">case</span> R_386_RELATIVE: {</div>
<div class="line"><span class="lineno"> 4621</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4622</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4623</span>                        }</div>
<div class="line"><span class="lineno"> 4624</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4625</span>                    <span class="keywordflow">case</span> R_386_JMP_SLOT: {</div>
<div class="line"><span class="lineno"> 4626</span>                        <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 4627</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; r_offset) {</div>
<div class="line"><span class="lineno"> 4628</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = r_offset;</div>
<div class="line"><span class="lineno"> 4629</span>                        }</div>
<div class="line"><span class="lineno"> 4630</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4631</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4632</span>                        }</div>
<div class="line"><span class="lineno"> 4633</span>                        ++<a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 4634</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4635</span>                } <span class="comment">// end EM_386 r_type</span></div>
<div class="line"><span class="lineno"> 4636</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) <span class="keywordflow">switch</span> (r_type) {</div>
<div class="line"><span class="lineno"> 4637</span>                    <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 4638</span>                        <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4639</span>                            <span class="stringliteral">&quot;unexpected relocation %#x [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 4640</span>                            r_type, -1 + (<span class="keywordtype">unsigned</span>)(sh_size / sh_entsize) - k);</div>
<div class="line"><span class="lineno"> 4641</span>                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4642</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4643</span>                    <span class="keywordflow">case</span> R_ARM_ABS32: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4644</span>                    <span class="keywordflow">case</span> R_ARM_GLOB_DAT: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4645</span>                    <span class="keywordflow">case</span> R_ARM_RELATIVE: {</div>
<div class="line"><span class="lineno"> 4646</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4647</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4648</span>                        }</div>
<div class="line"><span class="lineno"> 4649</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4650</span>                    <span class="keywordflow">case</span> R_ARM_JUMP_SLOT: {</div>
<div class="line"><span class="lineno"> 4651</span>                        <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 4652</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; r_offset) {</div>
<div class="line"><span class="lineno"> 4653</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = r_offset;</div>
<div class="line"><span class="lineno"> 4654</span>                        }</div>
<div class="line"><span class="lineno"> 4655</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4656</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4657</span>                        }</div>
<div class="line"><span class="lineno"> 4658</span>                        ++<a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 4659</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4660</span>                }  <span class="comment">// end EM_ARM r_type</span></div>
<div class="line"><span class="lineno"> 4661</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4662</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4663</span>                        <span class="stringliteral">&quot;Unknown architecture %d&quot;</span>, this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);</div>
<div class="line"><span class="lineno"> 4664</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4665</span>                }  <span class="comment">// end e_machine</span></div>
<div class="line"><span class="lineno"> 4666</span>            }  <span class="comment">// end rel</span></div>
<div class="line"><span class="lineno"> 4667</span>        }; <span class="keywordflow">break</span>;  <span class="comment">// end Elf32_Shdr::SHT_REL</span></div>
<div class="line"><span class="lineno"> 4668</span>        <span class="keywordflow">case</span> Elf32_Shdr::SHT_NOTE: {</div>
<div class="line"><span class="lineno"> 4669</span>            <span class="keywordflow">if</span> (!(Elf32_Shdr::SHF_ALLOC &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_flags))) {</div>
<div class="line"><span class="lineno"> 4670</span>                <span class="comment">// example: version number of &#39;gold&#39; linker (static binder)</span></div>
<div class="line"><span class="lineno"> 4671</span>                <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(buf_notes) &lt; (sh_size + len_notes)) {</div>
<div class="line"><span class="lineno"> 4672</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;SHT_NOTEs too big&quot;</span>);</div>
<div class="line"><span class="lineno"> 4673</span>                }</div>
<div class="line"><span class="lineno"> 4674</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>[j].sh_offset,</div>
<div class="line"><span class="lineno"> 4675</span>                    len_notes + (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>)) + <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 4676</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;buf_notes[len_notes], &amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[sh_offset], sh_size);</div>
<div class="line"><span class="lineno"> 4677</span>                len_notes += sh_size;</div>
<div class="line"><span class="lineno"> 4678</span>            }</div>
<div class="line"><span class="lineno"> 4679</span>            <span class="keywordflow">else</span> { <span class="comment">// SHF_ALLOC: in PT_LOAD; but move sh_addr and sh_offset</span></div>
<div class="line"><span class="lineno"> 4680</span>                <span class="comment">// Not sure why we need this conditional.</span></div>
<div class="line"><span class="lineno"> 4681</span>                <span class="comment">// Anyway, some Android have multiple SHT_NOTE sections.</span></div>
<div class="line"><span class="lineno"> 4682</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 4683</span>                    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> pos = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>);</div>
<div class="line"><span class="lineno"> 4684</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr-&gt;sh_addr,   pos);</div>
<div class="line"><span class="lineno"> 4685</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr-&gt;sh_offset, pos);</div>
<div class="line"><span class="lineno"> 4686</span>                }</div>
<div class="line"><span class="lineno"> 4687</span>            }</div>
<div class="line"><span class="lineno"> 4688</span>        }; <span class="keywordflow">break</span>;  <span class="comment">// end Elf32_Shdr::SHT_NOTE</span></div>
<div class="line"><span class="lineno"> 4689</span>        <span class="keywordflow">case</span> Elf32_Shdr::SHT_ARM_ATTRIBUTES: {</div>
<div class="line"><span class="lineno"> 4690</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a> = shdr;</div>
<div class="line"><span class="lineno"> 4691</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4692</span>        } <span class="comment">// end switch (sh_type)</span></div>
<div class="line"><span class="lineno"> 4693</span>    }</div>
<div class="line"><span class="lineno"> 4694</span>    <span class="comment">// shstrndx will move</span></div>
<div class="line"><span class="lineno"> 4695</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>[<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">e_shstrndx</a>)].sh_offset,</div>
<div class="line"><span class="lineno"> 4696</span>        len_notes + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) + <a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(pal_xct_top));</div>
<div class="line"><span class="lineno"> 4697</span> </div>
<div class="line"><span class="lineno"> 4698</span>    <span class="comment">// Write all changes below pal_xct_top</span></div>
<div class="line"><span class="lineno"> 4699</span>    <span class="comment">// FIXME: why is this any more than Ehdr + Phdrs?</span></div>
<div class="line"><span class="lineno"> 4700</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 4701</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4702</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, pal_xct_top);</div>
<div class="line"><span class="lineno"> 4703</span>    }</div>
<div class="line"><span class="lineno"> 4704</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = pal_xct_top;</div>
<div class="line"><span class="lineno"> 4705</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  = pal_xct_top;</div>
<div class="line"><span class="lineno"> 4706</span> </div>
<div class="line"><span class="lineno"> 4707</span>    <span class="comment">// New copy of Shdr</span></div>
<div class="line"><span class="lineno"> 4708</span>    <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> blank; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;blank, 0, <span class="keyword">sizeof</span>(blank));</div>
<div class="line"><span class="lineno"> 4709</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;blank.sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// hint for &quot;upx -d&quot;</span></div>
<div class="line"><span class="lineno"> 4710</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// hint for &quot;upx -d&quot;</span></div>
<div class="line"><span class="lineno"> 4711</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);  <span class="comment">// Shdr alignment</span></div>
<div class="line"><span class="lineno"> 4712</span>    <span class="keywordtype">unsigned</span> arm_attr_off = 0;</div>
<div class="line"><span class="lineno"> 4713</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>) {</div>
<div class="line"><span class="lineno"> 4714</span>        arm_attr_off = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4715</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>-&gt;sh_offset,</div>
<div class="line"><span class="lineno"> 4716</span>            <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>)</div>
<div class="line"><span class="lineno"> 4717</span>            + len_notes + sz_shstrtab);</div>
<div class="line"><span class="lineno"> 4718</span>    }</div>
<div class="line"><span class="lineno"> 4719</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 4720</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;blank, <span class="keyword">sizeof</span>(blank));</div>
<div class="line"><span class="lineno"> 4721</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>[1], (-1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4722</span>        <span class="keywordflow">if</span> (len_notes) {</div>
<div class="line"><span class="lineno"> 4723</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(buf_notes, len_notes);</div>
<div class="line"><span class="lineno"> 4724</span>        }</div>
<div class="line"><span class="lineno"> 4725</span>        <span class="comment">// New copy of Shdr[.e_shstrndx].[ sh_offset, +.sh_size )</span></div>
<div class="line"><span class="lineno"> 4726</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>,  sz_shstrtab);</div>
<div class="line"><span class="lineno"> 4727</span> </div>
<div class="line"><span class="lineno"> 4728</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>) {</div>
<div class="line"><span class="lineno"> 4729</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[arm_attr_off],</div>
<div class="line"><span class="lineno"> 4730</span>                <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>-&gt;sh_size));</div>
<div class="line"><span class="lineno"> 4731</span>        }</div>
<div class="line"><span class="lineno"> 4732</span>    }</div>
<div class="line"><span class="lineno"> 4733</span> </div>
<div class="line"><span class="lineno"> 4734</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 4735</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 4736</span>    <span class="comment">//xct_off += asl_delta;  // wait until ::pack3</span></div>
<div class="line"><span class="lineno"> 4737</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a>(fo, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> - (<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> - pal_xct_top));</div>
<div class="line"><span class="lineno"> 4738</span>}</div>
<div class="ttc" id="aclassMemBuffer_html_a4909e2f9df016dda4d2a9e4d1991e7be"><div class="ttname"><a href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref</a></div><div class="ttdeci">forceinline pointer subref(const char *errfmt, size_t skip, size_t take) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00219">membuffer.h:219</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a8b1b934391e5d959387552e48a5fb4b4"><div class="ttname"><a href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek</a></div><div class="ttdeci">virtual upx_off_t seek(upx_off_t off, int whence) override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00320">file.cpp:320</a></div></div>
<div class="ttc" id="aclassOutputFile_html_aa8beb793956b90404c940c5821936718"><div class="ttname"><a href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write</a></div><div class="ttdeci">void write(SPAN_0(const void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00274">file.cpp:274</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a2d8e571980c32f2e706cc6f60f38e736"><div class="ttname"><a href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">PackLinuxElf32::e_phoff</a></div><div class="ttdeci">unsigned e_phoff</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00231">p_lx_elf.h:231</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a4cf5438532351b0b6482b174e87ec9fb"><div class="ttname"><a href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">PackLinuxElf32::shdro</a></div><div class="ttdeci">Elf32_Shdr * shdro</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00226">p_lx_elf.h:226</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a71dfe9e1479de8e093db3320b9b4588f"><div class="ttname"><a href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">PackLinuxElf32::adjABS</a></div><div class="ttdeci">virtual int adjABS(Elf32_Sym *sym, unsigned delta)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03865">p_lx_elf.cpp:3865</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_aed8111e8e63b6f87ff03edd42538ecaf"><div class="ttname"><a href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">PackLinuxElf32::elf_get_offset_from_address</a></div><div class="ttdeci">virtual unsigned elf_get_offset_from_address(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07625">p_lx_elf.cpp:7625</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a14a0202c4a2a508fef4009ae120b44b8"><div class="ttname"><a href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a></div><div class="ttdeci">static unsigned int const asl_delta</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00077">p_lx_elf.h:77</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a193d50a7694d9bbdd607514c4fe691ab"><div class="ttname"><a href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a></div><div class="ttdeci">char const  * shstrtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00124">p_lx_elf.h:124</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a29e8bd1f64f0d8583676289f7329eb31"><div class="ttname"><a href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a></div><div class="ttdeci">MemBuffer lowmem</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00083">p_lx_elf.h:83</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3a8dc91b5f08ffdd31586e4d0c8ef2cb"><div class="ttname"><a href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a></div><div class="ttdeci">unsigned xct_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00099">p_lx_elf.h:99</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3b0f5122457c7d42172531d3cb116f00"><div class="ttname"><a href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a></div><div class="ttdeci">unsigned e_phnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00079">p_lx_elf.h:79</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3fa8506d335cb1116f720aff4611a337"><div class="ttname"><a href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a></div><div class="ttdeci">upx_uint64_t xct_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00104">p_lx_elf.h:104</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aa2f1dfda6aea57348d0720fa78b782d0"><div class="ttname"><a href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a></div><div class="ttdeci">upx_uint64_t plt_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00108">p_lx_elf.h:108</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aaca43f8d44f554de5f8129732f291f2d"><div class="ttname"><a href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a></div><div class="ttdeci">unsigned e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00080">p_lx_elf.h:80</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ac334df9f0f0666906d1b49d1d45be792"><div class="ttname"><a href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a></div><div class="ttdeci">unsigned sz_elf_hdrs</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00092">p_lx_elf.h:92</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_accc257b84970a37def2e57221bf91c48"><div class="ttname"><a href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a></div><div class="ttdeci">upx_uint16_t e_machine</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00113">p_lx_elf.h:113</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ad4e3d4f8dd219c66f8a2d78e20ca5df4"><div class="ttname"><a href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a></div><div class="ttdeci">MemBuffer file_image</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00082">p_lx_elf.h:82</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a614b94da58152b4585040e30a72a0de3"><div class="ttname"><a href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a></div><div class="ttdeci">unsigned total_in</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00091">p_unix.h:91</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aeb3e459ee90ee28853a76401b8145123"><div class="ttname"><a href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a></div><div class="ttdeci">unsigned total_out</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00091">p_unix.h:91</a></div></div>
<div class="ttc" id="aconf_8h_html_a8e3030ad36a1cb27a77eb87e12a648bc"><div class="ttname"><a href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a></div><div class="ttdeci">acc_uint32_t upx_uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00165">conf.h:165</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a113e9bb6ba2f2774bff6f3aadd35a6ba"><div class="ttname"><a href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a></div><div class="ttdeci">ElfClass_Host32::Sym Elf32_Sym</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00371">p_elf.h:371</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a2670bbbc279f3f9d9ac6e3b009cbbb26"><div class="ttname"><a href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a></div><div class="ttdeci">ElfClass_Host32::Dyn Elf32_Dyn</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00368">p_elf.h:368</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a308335509ec9fb2e442fa92cd6cb7afd"><div class="ttname"><a href="p__elf_8h.html#a308335509ec9fb2e442fa92cd6cb7afd">Elf32_Rela</a></div><div class="ttdeci">ElfClass_Host32::Rela Elf32_Rela</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00370">p_elf.h:370</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a5a26c3fc1d8625558cdce93d5a53c6de"><div class="ttname"><a href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a></div><div class="ttdeci">ElfClass_Host32::Rel Elf32_Rel</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00369">p_elf.h:369</a></div></div>
<div class="ttc" id="ap__elf_8h_html_ae858cb90aa9483b3ccee39f61446f130"><div class="ttname"><a href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a></div><div class="ttdeci">ElfClass_Host32::Shdr Elf32_Shdr</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00367">p_elf.h:367</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a13631338bc966bdceaf740dfd8082dd5"><div class="ttname"><a href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a></div><div class="ttdeci">static off_t fpadN(OutputFile *fo, unsigned len)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00089">p_lx_elf.cpp:89</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a5487e5169059653e4841e5aa6fe72859"><div class="ttname"><a href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a></div><div class="ttdeci">static unsigned up8(unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00083">p_lx_elf.cpp:83</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a7236f968e16474ded809aa6b9f98452a"><div class="ttname"><a href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a></div><div class="ttdeci">static unsigned up4(unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00077">p_lx_elf.cpp:77</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae67031a5cdb8843f862b05500cb6984f"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a></div><div class="ttdeci">static off_t fpad8(OutputFile *fo, unsigned pos)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00115">p_lx_elf.cpp:115</a></div></div>
<div class="ttc" id="asnprintf_8h_html_aa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00061">snprintf.h:61</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html"><div class="ttname"><a href="structElf32__Ehdr.html">Elf32_Ehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00187">bsd.h:188</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a00601af5187a1b3f8babfe9cddd95c15"><div class="ttname"><a href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a></div><div class="ttdeci">Elf32_Off e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00195">bsd.h:195</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a3b3070ccd7d971e8cb6ea58d4c6fab09"><div class="ttname"><a href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a></div><div class="ttdeci">Elf32_Half e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00202">bsd.h:202</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_ab8a982696048d807017919b7d0145482"><div class="ttname"><a href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">Elf32_Ehdr::e_entry</a></div><div class="ttdeci">Elf32_Addr e_entry</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00193">bsd.h:193</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html_a01a298ebc899bcf9c23211a7bf1155a6"><div class="ttname"><a href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a></div><div class="ttdeci">Elf32_Addr p_vaddr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00227">bsd.h:227</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html_af18f0a179a5fca09e3c04bcdce3fac2f"><div class="ttname"><a href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">Elf32_Phdr::p_paddr</a></div><div class="ttdeci">Elf32_Addr p_paddr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00228">bsd.h:228</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a9cf3296ee41855b4ced7b3bdfcaf8e5d"><div class="ttname"><a href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a></div><div class="ttdeci">void * memcpy(C&lt; T &gt; a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00095">xspan_fwd.h:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">adjABS()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, <a class="el" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">Elf32_Ehdr::e_entry</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8()</a>, <a class="el" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">Elf32_Phdr::p_paddr</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>, <a class="el" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>, <a class="el" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, <a class="el" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8()</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_cgraph" id="aclassPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_cgraph">
<area shape="rect" title=" " alt="" coords="5,736,152,776"/>
<area shape="rect" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f" title=" " alt="" coords="665,42,840,68"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1333,684,1452,709"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="911,148,1040,173"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="200,314,391,354"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="266,592,325,617"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="463,617,593,642"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5" title=" " alt="" coords="265,693,326,718"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="937,893,1013,918"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="231,794,360,820"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="256,868,335,893"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="464,942,592,968"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="231,969,359,994"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="224,1018,367,1044"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="272,1068,319,1093"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="272,1117,319,1142"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="1115,511,1265,551"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="942,42,1009,68"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="441,226,615,266"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="683,143,822,183"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="457,568,599,593"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1541,461,1678,486"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="685,517,820,542"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1751,792,1881,817"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="931,617,1020,642"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1145,842,1235,868"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="708,566,797,592"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1329,410,1456,436"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="911,517,1040,542"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1516,412,1703,437"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1788,412,1844,437"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1127,461,1253,486"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1319,512,1466,537"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1582,512,1637,537"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1539,1044,1679,1069"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1111,676,1269,716"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="461,732,595,757"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="693,769,812,794"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="888,820,1063,845"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1149,993,1231,1018"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1113,892,1267,917"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1317,979,1468,1019"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="907,942,1043,968"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="695,1018,811,1044"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="947,1044,1004,1069"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="439,1094,617,1120"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="683,1196,822,1221"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="902,1246,1049,1272"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1166,1246,1214,1272"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1347,1246,1438,1272"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_icgraph" id="aclassPackLinuxElf32_a12904e259a31849e8633faf26b5e07fe_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,367,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a001986a5884a191f0426037687d2f475" name="a001986a5884a191f0426037687d2f475"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a001986a5884a191f0426037687d2f475">&#9670;&#160;</a></span>asl_slide_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::asl_slide_Shdrs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00484">484</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  485</span>{</div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>;</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++shdr, ++j) {</div>
<div class="line"><span class="lineno">  488</span>        <span class="keywordtype">unsigned</span> sh_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_offset) {</div>
<div class="line"><span class="lineno">  490</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno">  491</span>        }</div>
<div class="line"><span class="lineno">  492</span>    }</div>
<div class="line"><span class="lineno">  493</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a8be817665d0219026ebd50acdd3700af"><div class="ttname"><a href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a></div><div class="ttdeci">upx_off_t so_slide</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00102">p_lx_elf.h:102</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a4cf5438532351b0b6482b174e87ec9fb">shdro</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a001986a5884a191f0426037687d2f475_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a001986a5884a191f0426037687d2f475_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a001986a5884a191f0426037687d2f475_cgraph" id="aclassPackLinuxElf32_a001986a5884a191f0426037687d2f475_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,152,63"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="200,5,329,31"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="201,55,329,80"/>
</map>
</div>

</div>
</div>
<a id="a2de3b0ba7a17f5de7f5a62f5df6a0bb3" name="a2de3b0ba7a17f5de7f5a62f5df6a0bb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2de3b0ba7a17f5de7f5a62f5df6a0bb3">&#9670;&#160;</a></span>buildLinuxLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::buildLinuxLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>szproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const&#160;</td>
          <td class="paramname"><em>fold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>szfold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01441">1441</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1448</span>{</div>
<div class="line"><span class="lineno"> 1449</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_cprLoader;</div>
<div class="line"><span class="lineno"> 1450</span>    <span class="keywordtype">unsigned</span> sz_cpr = 0;</div>
<div class="line"><span class="lineno"> 1451</span>    <span class="keywordtype">unsigned</span> sz_unc = 0;</div>
<div class="line"><span class="lineno"> 1452</span>    <span class="keywordtype">unsigned</span> method = 0;</div>
<div class="line"><span class="lineno"> 1453</span>    <a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> <span class="keyword">const</span> *uncLoader = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>  <span class="keywordflow">if</span> (0 &lt; szfold) {</div>
<div class="line"><span class="lineno"> 1456</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 1457</span>      &amp;&amp; (  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_ARM</div>
<div class="line"><span class="lineno"> 1458</span>         || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_386)</div>
<div class="line"><span class="lineno"> 1459</span>    ) {</div>
<div class="line"><span class="lineno"> 1460</span>        <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(fold, szfold);</div>
<div class="line"><span class="lineno"> 1461</span><span class="comment">// Typical layout of &#39;sections&#39; in compressed stub code for shared library:</span></div>
<div class="line"><span class="lineno"> 1462</span><span class="comment">//   SO_HEAD</span></div>
<div class="line"><span class="lineno"> 1463</span><span class="comment">//   ptr_NEXT</span></div>
<div class="line"><span class="lineno"> 1464</span><span class="comment">//   EXP_HEAD  NRV getbit(), copy</span></div>
<div class="line"><span class="lineno"> 1465</span><span class="comment">//   NRV2B etc: daisy chain of de-compressor for each method used</span></div>
<div class="line"><span class="lineno"> 1466</span><span class="comment">//   EXP_TAIL  FIXME: unfilter</span></div>
<div class="line"><span class="lineno"> 1467</span><span class="comment">//   SO_TAIL</span></div>
<div class="line"><span class="lineno"> 1468</span><span class="comment">//   SO_MAIN  C-language supervision based on PT_LOADs</span></div>
<div class="line"><span class="lineno"> 1469</span>        <span class="keywordtype">char</span> sec[120];</div>
<div class="line"><span class="lineno"> 1470</span>        <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><span class="lineno"> 1471</span>        <span class="keywordtype">unsigned</span> m_decompr = (<a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> ? <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> : (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>)));</div>
<div class="line"><span class="lineno"> 1472</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(sec, <span class="keyword">sizeof</span>(sec), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;SO_HEAD,ptr_NEXT,EXP_HEAD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1473</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1474</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2B&quot;</span>);</div>
<div class="line"><span class="lineno"> 1475</span>        }</div>
<div class="line"><span class="lineno"> 1476</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1477</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2D&quot;</span>);</div>
<div class="line"><span class="lineno"> 1478</span>        }</div>
<div class="line"><span class="lineno"> 1479</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1480</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2E&quot;</span>);</div>
<div class="line"><span class="lineno"> 1481</span>        }</div>
<div class="line"><span class="lineno"> 1482</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1483</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;LZMA_ELF00,LZMA_DEC20,LZMA_DEC30&quot;</span>);</div>
<div class="line"><span class="lineno"> 1484</span>        }</div>
<div class="line"><span class="lineno"> 1485</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;EXP_TAIL,SO_TAIL,SO_MAIN&quot;</span>);</div>
<div class="line"><span class="lineno"> 1486</span>        (void)len;  <span class="comment">// Pacify the anal-retentive static analyzer which hates a good idiom.</span></div>
<div class="line"><span class="lineno"> 1487</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(sec, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1488</span>        <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1489</span>        {</div>
<div class="line"><span class="lineno"> 1490</span>            <span class="keywordtype">int</span> sz_unc_int;</div>
<div class="line"><span class="lineno"> 1491</span>            uncLoader = linker-&gt;getLoader(&amp;sz_unc_int);</div>
<div class="line"><span class="lineno"> 1492</span>            sz_unc = sz_unc_int;</div>
<div class="line"><span class="lineno"> 1493</span>        }</div>
<div class="line"><span class="lineno"> 1494</span>        method = <a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>;  <span class="comment">// requires unaligned fetch</span></div>
<div class="line"><span class="lineno"> 1495</span>        <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_ARM)</div>
<div class="line"><span class="lineno"> 1496</span>            method = <a class="code hl_define" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>;  <span class="comment">//only ARM v6 and above has unaligned fetch</span></div>
<div class="line"><span class="lineno"> 1497</span>    }</div>
<div class="line"><span class="lineno"> 1498</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1499</span>        cprElfHdr1 <span class="keyword">const</span> *<span class="keyword">const</span> hf = (cprElfHdr1 <span class="keyword">const</span> *)fold;</div>
<div class="line"><span class="lineno"> 1500</span>        <span class="keywordtype">unsigned</span> fold_hdrlen = <a class="code hl_function" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7">upx::umax</a>(0x80u, <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(hf-&gt;ehdr) +</div>
<div class="line"><span class="lineno"> 1501</span>            <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_phentsize) * <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_phnum) +</div>
<div class="line"><span class="lineno"> 1502</span>                <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(<a class="code hl_struct" href="structl__info.html">l_info</a>) );</div>
<div class="line"><span class="lineno"> 1503</span>        uncLoader = fold_hdrlen + fold;</div>
<div class="line"><span class="lineno"> 1504</span>        sz_unc = ((szfold &lt; fold_hdrlen) ? 0 : (szfold - fold_hdrlen));</div>
<div class="line"><span class="lineno"> 1505</span>        method = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>;</div>
<div class="line"><span class="lineno"> 1506</span>    }</div>
<div class="line"><span class="lineno"> 1507</span> </div>
<div class="line"><span class="lineno"> 1508</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structb__info.html">b_info</a> h; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h, 0, <span class="keyword">sizeof</span>(h));</div>
<div class="line"><span class="lineno"> 1509</span>    h.b_method = method;</div>
<div class="line"><span class="lineno"> 1510</span>    <span class="comment">// _Ehdr and _Phdr are NOT filtered, so Leave h.b_ftid and h.b_cto8 as zero.</span></div>
<div class="line"><span class="lineno"> 1511</span> </div>
<div class="line"><span class="lineno"> 1512</span>    mb_cprLoader.<a class="code hl_function" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">allocForCompression</a>(<span class="keyword">sizeof</span>(h) + sz_unc);</div>
<div class="line"><span class="lineno"> 1513</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> cprLoader = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)mb_cprLoader;  <span class="comment">// less typing</span></div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>    h.sz_unc = sz_unc;</div>
<div class="line"><span class="lineno"> 1516</span>    h.sz_cpr = mb_cprLoader.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>();  <span class="comment">// max that upx_compress may use</span></div>
<div class="line"><span class="lineno"> 1517</span>    {</div>
<div class="line"><span class="lineno"> 1518</span>        <span class="keywordtype">int</span> r = <a class="code hl_function" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress</a>(uncLoader, sz_unc, <span class="keyword">sizeof</span>(h) + cprLoader, &amp;sz_cpr,</div>
<div class="line"><span class="lineno"> 1519</span>            <span class="keyword">nullptr</span>, <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(method), 10, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span> );</div>
<div class="line"><span class="lineno"> 1520</span>        h.sz_cpr = sz_cpr;  <span class="comment">// actual length used</span></div>
<div class="line"><span class="lineno"> 1521</span>        <span class="keywordflow">if</span> (r != <a class="code hl_define" href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a> || h.sz_cpr &gt;= h.sz_unc)</div>
<div class="line"><span class="lineno"> 1522</span>            <a class="code hl_function" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a>(<span class="stringliteral">&quot;loader compression failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1523</span>    }</div>
<div class="line"><span class="lineno"> 1524</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h.sz_cpr, h.sz_cpr);</div>
<div class="line"><span class="lineno"> 1525</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h.sz_unc, h.sz_unc);</div>
<div class="line"><span class="lineno"> 1526</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(cprLoader, &amp;h, <span class="keyword">sizeof</span>(h)); <span class="comment">// cprLoader will become FOLDEXEC</span></div>
<div class="line"><span class="lineno"> 1527</span>  }</div>
<div class="line"><span class="lineno"> 1528</span> </div>
<div class="line"><span class="lineno"> 1529</span>    <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(proto, szproto, -1, sz_cpr);</div>
<div class="line"><span class="lineno"> 1530</span>    <a class="code hl_function" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a>(<span class="stringliteral">&quot;FOLDEXEC unc=%#x  cpr=%#x\n&quot;</span>, sz_unc, sz_cpr);</div>
<div class="line"><span class="lineno"> 1531</span>    linker-&gt;addSection(<span class="stringliteral">&quot;FOLDEXEC&quot;</span>, mb_cprLoader, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structb__info.html">b_info</a>) + sz_cpr, 0);</div>
<div class="line"><span class="lineno"> 1532</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 1533</span>       &amp;&amp; (  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_ARM</div>
<div class="line"><span class="lineno"> 1534</span>          || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_386)</div>
<div class="line"><span class="lineno"> 1535</span>    ) {</div>
<div class="line"><span class="lineno"> 1536</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(<span class="stringliteral">&quot;ELFMAINX,ELFMAINZ,FOLDEXEC,IDENTSTR&quot;</span>);</div>
<div class="line"><span class="lineno"> 1537</span>    }</div>
<div class="line"><span class="lineno"> 1538</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1539</span>        <a class="code hl_function" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">addStubEntrySections</a>(ft, (<a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> ? <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a></div>
<div class="line"><span class="lineno"> 1540</span>                            : (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>))) );</div>
<div class="line"><span class="lineno"> 1541</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 1542</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b">defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno"> 1543</span>        }</div>
<div class="line"><span class="lineno"> 1544</span>    }</div>
<div class="line"><span class="lineno"> 1545</span>    <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1546</span>}</div>
<div class="ttc" id="aclassMemBuffer_html"><div class="ttname"><a href="classMemBuffer.html">MemBuffer</a></div><div class="ttdoc">MemBuffer.</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00187">membuffer.h:187</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a15705698799e612d2ed4b439837c649a"><div class="ttname"><a href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize</a></div><div class="ttdeci">unsigned getSize() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00208">membuffer.h:208</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_aa7fca1d24644887e92e728c1d3f3785f"><div class="ttname"><a href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression</a></div><div class="ttdeci">void allocForCompression(unsigned uncompressed_size, unsigned extra=0) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8cpp_source.html#l00125">membuffer.cpp:125</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_afe0c06e7772712b8f5cb8a7101a2e052"><div class="ttname"><a href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">PackLinuxElf::addStubEntrySections</a></div><div class="ttdeci">virtual void addStubEntrySections(Filter const *, unsigned m_decompr)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00905">p_lx_elf.cpp:905</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aa33d54bc7392e242453b126d23c3ecbd"><div class="ttname"><a href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">PackUnix::methods_used</a></div><div class="ttdeci">unsigned methods_used</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00104">p_unix.h:104</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a01f3c918e5ce5b4de630d11c703cec05"><div class="ttname"><a href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a></div><div class="ttdeci">PackHeader ph</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00096">packer.h:96</a></div></div>
<div class="ttc" id="aclassPacker_html_a2c9f88864fd7faa59c8130bd59a811a3"><div class="ttname"><a href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">Packer::relocateLoader</a></div><div class="ttdeci">virtual void relocateLoader()</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00841">packer.cpp:841</a></div></div>
<div class="ttc" id="aclassPacker_html_a4af6a45574697d68421e70baef1c8d8c"><div class="ttname"><a href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">Packer::initLoader</a></div><div class="ttdeci">virtual void initLoader(const void *pdata, int plen, int small=-1, int pextra=0)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00760">packer.cpp:760</a></div></div>
<div class="ttc" id="aclassPacker_html_a516182985490860d361a8266fa418235"><div class="ttname"><a href="classPacker.html#a516182985490860d361a8266fa418235">Packer::addLoader</a></div><div class="ttdeci">void addLoader(C)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00773">packer.cpp:773</a></div></div>
<div class="ttc" id="acompress_8cpp_html_a503ce434d639fefff3eee167b8bc5b64"><div class="ttname"><a href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress</a></div><div class="ttdeci">int upx_compress(const upx_bytep src, unsigned src_len, upx_bytep dst, unsigned *dst_len, upx_callback_t *cb, int method, int level, const upx_compress_config_t *cconf, upx_compress_result_t *cresult)</div><div class="ttdef"><b>Definition:</b> <a href="compress_8cpp_source.html#l00064">compress.cpp:64</a></div></div>
<div class="ttc" id="aconf_8h_html_a019151729ec9d9cd6f87106a18fdfb50"><div class="ttname"><a href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a></div><div class="ttdeci">#define M_LZMA</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00599">conf.h:599</a></div></div>
<div class="ttc" id="aconf_8h_html_a1bbfdab7b8396bae1dcb8f14f235d862"><div class="ttname"><a href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a></div><div class="ttdeci">#define M_NRV2E_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00594">conf.h:594</a></div></div>
<div class="ttc" id="aconf_8h_html_a28d10b43a6177d2d5f9b2e76d728d241"><div class="ttname"><a href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a></div><div class="ttdeci">#define upx_byte</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00185">conf.h:185</a></div></div>
<div class="ttc" id="aconf_8h_html_a3143e9be3cc076994dd57e0c1a2ed4d8"><div class="ttname"><a href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a></div><div class="ttdeci">#define M_NRV2E_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00595">conf.h:595</a></div></div>
<div class="ttc" id="aconf_8h_html_a514895bc5cc851af35523494bbdedc36"><div class="ttname"><a href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a></div><div class="ttdeci">#define M_NRV2B_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00588">conf.h:588</a></div></div>
<div class="ttc" id="aconf_8h_html_a5d201f974fac93da9a7fe4821477ca70"><div class="ttname"><a href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a></div><div class="ttdeci">#define M_NRV2B_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00587">conf.h:587</a></div></div>
<div class="ttc" id="aconf_8h_html_a5fc25c01aa02e925d76494b476074a7d"><div class="ttname"><a href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a></div><div class="ttdeci">#define usizeof(expr)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00484">conf.h:484</a></div></div>
<div class="ttc" id="aconf_8h_html_a6633961dc2e4df53ee07eacffeb154d3"><div class="ttname"><a href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a></div><div class="ttdeci">#define UPX_E_OK</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00513">conf.h:513</a></div></div>
<div class="ttc" id="aconf_8h_html_a71fca72da6661281c6b285f5507da415"><div class="ttname"><a href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a></div><div class="ttdeci">#define M_NRV2D_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00590">conf.h:590</a></div></div>
<div class="ttc" id="aconf_8h_html_a7b1664a2d7051a8e85beaa77e98aa157"><div class="ttname"><a href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a></div><div class="ttdeci">#define M_NRV2B_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00589">conf.h:589</a></div></div>
<div class="ttc" id="aconf_8h_html_a8cfb2c5a5eeaaad5aead9d35339242c8"><div class="ttname"><a href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a></div><div class="ttdeci">#define M_NRV2E_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00593">conf.h:593</a></div></div>
<div class="ttc" id="aconf_8h_html_a9c028313c33deb35227a3e5af1b1513d"><div class="ttname"><a href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a></div><div class="ttdeci">#define M_NRV2D_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00592">conf.h:592</a></div></div>
<div class="ttc" id="aconf_8h_html_aa54a53fd4499f1e86cac93fb7f7b802a"><div class="ttname"><a href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a></div><div class="ttdeci">#define M_NRV2D_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00591">conf.h:591</a></div></div>
<div class="ttc" id="aconf_8h_html_af79eab1f480f5a57b6bfbff38256b0d2"><div class="ttname"><a href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a></div><div class="ttdeci">void NO_printf(const char *,...) noexcept attribute_format(1</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00375">conf.h:375</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a57b532c382fd20e682bf0393b6d63050"><div class="ttname"><a href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a></div><div class="ttdeci">void throwInternalError(const char *msg)</div><div class="ttdoc">other</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00128">except.cpp:128</a></div></div>
<div class="ttc" id="anamespaceupx_html_a45583c0cc56452ba56d9a16895c7f0d7"><div class="ttname"><a href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7">upx::umax</a></div><div class="ttdeci">forceinline constexpr T umax(const T &amp;a, const T &amp;b) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cxxlib_8h_source.html#l00254">cxxlib.h:254</a></div></div>
<div class="ttc" id="apackhead_8cpp_html_a772d316c45ac4858f5cffa5f842fff49"><div class="ttname"><a href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a></div><div class="ttdeci">int ph_forced_method(int method) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00300">packhead.cpp:300</a></div></div>
<div class="ttc" id="astructPackHeader_html_af1d11217d186dee6524ad3ab35768b0a"><div class="ttname"><a href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a></div><div class="ttdeci">int method</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00052">packhead.h:52</a></div></div>
<div class="ttc" id="astructb__info_html"><div class="ttname"><a href="structb__info.html">b_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00322">bsd.h:322</a></div></div>
<div class="ttc" id="astructl__info_html"><div class="ttname"><a href="structl__info.html">l_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00331">bsd.h:332</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a516182985490860d361a8266fa418235">Packer::addLoader()</a>, <a class="el" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">PackLinuxElf::addStubEntrySections()</a>, <a class="el" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression()</a>, <a class="el" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a>, <a class="el" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b">defineSymbols()</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">Packer::initLoader()</a>, <a class="el" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>, <a class="el" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>, <a class="el" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>, <a class="el" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>, <a class="el" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>, <a class="el" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>, <a class="el" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>, <a class="el" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>, <a class="el" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>, <a class="el" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a>, <a class="el" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">PackUnix::methods_used</a>, <a class="el" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method()</a>, <a class="el" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">Packer::relocateLoader()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a>, <a class="el" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError()</a>, <a class="el" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7">upx::umax()</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, <a class="el" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress()</a>, <a class="el" href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a>, <a class="el" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32ppc.html#a837a4d1bf96e44b0ecd11e7150c5565b">PackLinuxElf32ppc::buildLoader()</a>, <a class="el" href="classPackLinuxElf32x86.html#a69d1831a5732ba82bc6a21e187003b81">PackLinuxElf32x86::buildLoader()</a>, <a class="el" href="classPackBSDElf32x86.html#a28fe533055d17e4e4570bc890dd802b4">PackBSDElf32x86::buildLoader()</a>, <a class="el" href="classPackLinuxElf32armLe.html#abf40ab0b8e777d22c12eebf77a8dde2a">PackLinuxElf32armLe::buildLoader()</a>, <a class="el" href="classPackLinuxElf32armBe.html#a4eaf1a02af96f64941c82e06aff51237">PackLinuxElf32armBe::buildLoader()</a>, <a class="el" href="classPackLinuxElf32mipseb.html#af1b1d619d6cf7810897aa82c57a7638d">PackLinuxElf32mipseb::buildLoader()</a>, <a class="el" href="classPackLinuxElf32mipsel.html#abb9c15cc5a974ec3554d78bfc7999b09">PackLinuxElf32mipsel::buildLoader()</a>, <a class="el" href="classPackNetBSDElf32x86.html#a52476626884e67e577a2e37a8a934634">PackNetBSDElf32x86::buildLoader()</a>, and <a class="el" href="classPackOpenBSDElf32x86.html#a814d4f91e539a066454d1d2f360d5b79">PackOpenBSDElf32x86::buildLoader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_cgraph" id="aclassPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_cgraph">
<area shape="rect" title=" " alt="" coords="5,406,200,446"/>
<area shape="rect" href="classPacker.html#a516182985490860d361a8266fa418235" title=" " alt="" coords="569,24,709,49"/>
<area shape="rect" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052" title=" " alt="" coords="261,70,459,110"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="568,130,711,156"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="520,286,759,312"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1179,186,1255,212"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1175,237,1259,262"/>
<area shape="rect" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7" title=" " alt="" coords="1171,461,1262,486"/>
<area shape="rect" href="classPackLinuxElf32.html#a42b1cda087bb627b537152b283c9419b" title=" " alt="" coords="248,388,472,413"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="295,437,425,462"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="285,486,435,512"/>
<area shape="rect" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c" title=" " alt="" coords="291,536,429,561"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="1177,650,1256,676"/>
<area shape="rect" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3" title=" " alt="" coords="275,977,445,1002"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1147,902,1287,928"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="296,853,424,878"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="581,593,697,618"/>
<area shape="rect" href="classPacker.html#aaf81a88111b09b6bd3353864484510b7" title=" " alt="" coords="855,24,1013,49"/>
<area shape="rect" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab" title=" " alt="" coords="546,77,733,102"/>
<area shape="rect" href="packhead_8cpp.html#a99fd3f5cbc734f9863205a1e892ea48c" title="ph method util" alt="" coords="853,130,1015,156"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="867,286,1001,312"/>
<area shape="rect" href="classMemBuffer.html#a3dcd6ad1b690292fd215302825ceaf5b" title=" " alt="" coords="807,486,1061,512"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1172,412,1261,437"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1176,853,1257,878"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1109,336,1324,361"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1139,286,1294,312"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1372,512,1491,537"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="536,388,743,413"/>
<area shape="rect" href="packer_8cpp.html#afa767aba089a4d3b97fe3a1f391004d0" title="loader util (interface to linker)" alt="" coords="593,445,686,470"/>
<area shape="rect" href="classPacker.html#aa7fe94299cf76c70de7ed953aa774330" title=" " alt="" coords="570,494,709,520"/>
<area shape="rect" href="namespaceupx.html#a0c83095d93809bd5537d12d7217b1b64" title=" " alt="" coords="568,544,711,569"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="910,853,958,878"/>
<area shape="rect" href="util_8cpp.html#a9d6effb3a2dacaed842c2e588220b3d5" title=" " alt="" coords="879,536,989,561"/>
<area shape="rect" href="conf_8h.html#a24c77e0d6845ec1a80a990def321c620" title=" " alt="" coords="863,388,1005,413"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1171,804,1262,829"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="1177,1253,1256,1278"/>
<area shape="rect" href="classPacker.html#a6e094d3b47373817a66457952f26dc70" title=" " alt="" coords="571,934,708,960"/>
<area shape="rect" href="classPacker.html#a5239dbc85d3edd59b558deb94ed8e40d" title=" " alt="" coords="547,870,732,910"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="818,1152,1050,1177"/>
<area shape="rect" href="structPackHeader.html#a3c61166ce01a954f2c2ec5c9a563f478" title="see stub/src/include/header.S" alt="" coords="537,1028,742,1053"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1390,1253,1473,1278"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="870,902,998,928"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1147,1052,1286,1077"/>
<area shape="rect" href="packhead_8cpp.html#a316db91362bd31b5ff8c167f8456ead5" title="extremely simple checksum for the header itself (since version 10)" alt="" coords="835,1253,1033,1278"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="889,1102,979,1128"/>
<area shape="rect" href="bele_8h.html#abc3e7ac42e0d364d55e526be7243cc7f" title=" " alt="" coords="893,952,975,977"/>
<area shape="rect" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1" title=" " alt="" coords="895,1053,973,1078"/>
<area shape="rect" href="structupx__compress__result__t.html#a92ddd8771e00cf86eedb13cda3e3c52c" title=" " alt="" coords="854,586,1014,626"/>
<area shape="rect" href="compress__lzma_8cpp.html#a16968f66ecd1f6e7a199462fc20b5b9c" title=" " alt="" coords="857,437,1011,462"/>
<area shape="rect" href="compress__ucl_8cpp.html#aee4e34700d3f36ec3ae2aee005649204" title=" " alt="" coords="863,650,1005,676"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_icgraph" id="aclassPackLinuxElf32_a2de3b0ba7a17f5de7f5a62f5df6a0bb3_icgraph">
<area shape="rect" title=" " alt="" coords="273,248,468,288"/>
<area shape="rect" href="classPackLinuxElf32ppc.html#a837a4d1bf96e44b0ecd11e7150c5565b" title=" " alt="" coords="40,5,191,45"/>
<area shape="rect" href="classPackLinuxElf32x86.html#a69d1831a5732ba82bc6a21e187003b81" title=" " alt="" coords="39,69,191,109"/>
<area shape="rect" href="classPackBSDElf32x86.html#a28fe533055d17e4e4570bc890dd802b4" title=" " alt="" coords="5,134,225,159"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#abf40ab0b8e777d22c12eebf77a8dde2a" title=" " alt="" coords="35,184,196,224"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a4eaf1a02af96f64941c82e06aff51237" title=" " alt="" coords="34,248,197,288"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#af1b1d619d6cf7810897aa82c57a7638d" title=" " alt="" coords="31,312,199,352"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#abb9c15cc5a974ec3554d78bfc7999b09" title=" " alt="" coords="33,376,197,416"/>
<area shape="rect" href="classPackNetBSDElf32x86.html#a52476626884e67e577a2e37a8a934634" title=" " alt="" coords="36,440,195,480"/>
<area shape="rect" href="classPackOpenBSDElf32x86.html#a814d4f91e539a066454d1d2f360d5b79" title=" " alt="" coords="30,504,201,544"/>
</map>
</div>

</div>
</div>
<a id="a57c8f63c6f5b8671a39cd8acf2b48bc6" name="a57c8f63c6f5b8671a39cd8acf2b48bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57c8f63c6f5b8671a39cd8acf2b48bc6">&#9670;&#160;</a></span>calls_crt1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PackLinuxElf32::calls_crt1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> const *&#160;</td>
          <td class="paramname"><em>rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02436">2436</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2437</span>{</div>
<div class="line"><span class="lineno"> 2438</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a> || !<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> || !rel) {</div>
<div class="line"><span class="lineno"> 2439</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2440</span>    }</div>
<div class="line"><span class="lineno"> 2441</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> relnum= 0; 0 &lt; sz; (sz -= <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>)), ++rel, ++relnum) {</div>
<div class="line"><span class="lineno"> 2442</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symnum = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rel-&gt;r_info) &gt;&gt; 8;</div>
<div class="line"><span class="lineno"> 2443</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> symnam = <a class="code hl_function" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name</a>(symnum, relnum);</div>
<div class="line"><span class="lineno"> 2444</span>        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__libc_start_main&quot;</span>)  <span class="comment">// glibc</span></div>
<div class="line"><span class="lineno"> 2445</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__libc_init&quot;</span>)  <span class="comment">// Android</span></div>
<div class="line"><span class="lineno"> 2446</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__uClibc_main&quot;</span>)</div>
<div class="line"><span class="lineno"> 2447</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__uClibc_start_main&quot;</span>))</div>
<div class="line"><span class="lineno"> 2448</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2449</span>    }</div>
<div class="line"><span class="lineno"> 2450</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2451</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_ae84aeb851cffb6a47f23a5f2ae01c1cd"><div class="ttname"><a href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">PackLinuxElf32::get_dynsym_name</a></div><div class="ttdeci">char const * get_dynsym_name(unsigned symnum, unsigned relnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02427">p_lx_elf.cpp:2427</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a6ec71c63b3b76a8847d2a5989c2f3fbb"><div class="ttname"><a href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a></div><div class="ttdeci">char const  * dynstr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00089">p_lx_elf.h:89</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>, <a class="el" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_cgraph" id="aclassPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_cgraph">
<area shape="rect" title=" " alt="" coords="5,70,196,95"/>
<area shape="rect" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd" title=" " alt="" coords="244,5,393,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="451,70,581,95"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="285,145,352,170"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="441,5,591,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="639,13,757,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_icgraph" id="aclassPackLinuxElf32_a57c8f63c6f5b8671a39cd8acf2b48bc6_icgraph">
<area shape="rect" title=" " alt="" coords="465,13,656,38"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="ac4f9df5fb4c6ace9d197f29e1594a552" name="ac4f9df5fb4c6ace9d197f29e1594a552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4f9df5fb4c6ace9d197f29e1594a552">&#9670;&#160;</a></span>canPack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tribool PackLinuxElf32::canPack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5">PackLinuxElf32x86interp</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02555">2555</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2556</span>{</div>
<div class="line"><span class="lineno"> 2557</span>    <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 2558</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[<a class="code hl_variable" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a>];</div>
<div class="line"><span class="lineno"> 2559</span>        <span class="comment">//struct { Elf32_Ehdr ehdr; Elf32_Phdr phdr; } e;</span></div>
<div class="line"><span class="lineno"> 2560</span>    } u;</div>
<div class="line"><span class="lineno"> 2561</span>    <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(u.buf) &lt;= (2*512))</div>
<div class="line"><span class="lineno"> 2562</span> </div>
<div class="line"><span class="lineno"> 2563</span><span class="comment">// My earlier design with &quot;extra&quot; Shdrs in output at xct_off</span></div>
<div class="line"><span class="lineno"> 2564</span><span class="comment">// DOES NOT WORK because code for EM_ARM has embedded relocations</span></div>
<div class="line"><span class="lineno"> 2565</span><span class="comment">// that are not made visible, such as:</span></div>
<div class="line"><span class="lineno"> 2566</span><span class="comment">//    ----- glibc-2.31/sysdeps/arm/crti.S</span></div>
<div class="line"><span class="lineno"> 2567</span><span class="comment">//            .type call_weak_fn, %function</span></div>
<div class="line"><span class="lineno"> 2568</span><span class="comment">//    call_weak_fn:</span></div>
<div class="line"><span class="lineno"> 2569</span><span class="comment">//            ldr r3, .LGOT</span></div>
<div class="line"><span class="lineno"> 2570</span><span class="comment">//            ldr r2, .LGOT+4</span></div>
<div class="line"><span class="lineno"> 2571</span><span class="comment">//    .LPIC:</span></div>
<div class="line"><span class="lineno"> 2572</span><span class="comment">//            add r3, pc, r3</span></div>
<div class="line"><span class="lineno"> 2573</span><span class="comment">//            ldr r2, [r3, r2]</span></div>
<div class="line"><span class="lineno"> 2574</span><span class="comment">//            cmp r2, #0</span></div>
<div class="line"><span class="lineno"> 2575</span><span class="comment">//            bxeq lr</span></div>
<div class="line"><span class="lineno"> 2576</span><span class="comment">//            b PREINIT_FUNCTION</span></div>
<div class="line"><span class="lineno"> 2577</span><span class="comment">//            .p2align 2</span></div>
<div class="line"><span class="lineno"> 2578</span><span class="comment">//    .LGOT:</span></div>
<div class="line"><span class="lineno"> 2579</span><span class="comment">//            .word _GLOBAL_OFFSET_TABLE_-(.LPIC+8)  // unseen reloc!</span></div>
<div class="line"><span class="lineno"> 2580</span><span class="comment">//            .word PREINIT_FUNCTION(GOT)</span></div>
<div class="line"><span class="lineno"> 2581</span><span class="comment">//    -----</span></div>
<div class="line"><span class="lineno"> 2582</span><span class="comment">// So, PackUnix::PackUnix() disables (but silently accepts) --android-shlib,</span></div>
<div class="line"><span class="lineno"> 2583</span><span class="comment">// and see if appending ARM_ATTRIBUTES Shdr is good enough.</span></div>
<div class="line"><span class="lineno"> 2584</span> </div>
<div class="line"><span class="lineno"> 2585</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;seek(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 2586</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;readx(u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, sizeof(u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>));</div>
<div class="line"><span class="lineno"> 2587</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;seek(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 2588</span>    <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> const *const ehdr = (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *) u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>;</div>
<div class="line"><span class="lineno"> 2589</span> </div>
<div class="line"><span class="lineno"> 2590</span>    <span class="comment">// now check the ELF header</span></div>
<div class="line"><span class="lineno"> 2591</span>    if (<a class="code hl_function" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7">checkEhdr</a>(ehdr) != 0)</div>
<div class="line"><span class="lineno"> 2592</span>        return false;</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>    <span class="comment">// additional requirements for linux/elf386</span></div>
<div class="line"><span class="lineno"> 2595</span>    if (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_ehsize) != sizeof(*ehdr)) {</div>
<div class="line"><span class="lineno"> 2596</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;invalid Ehdr e_ehsize; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2597</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2598</span>    }</div>
<div class="line"><span class="lineno"> 2599</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> != <span class="keyword">sizeof</span>(*ehdr)) {<span class="comment">// Phdrs not contiguous with Ehdr</span></div>
<div class="line"><span class="lineno"> 2600</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;non-contiguous Ehdr/Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2601</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2602</span>    }</div>
<div class="line"><span class="lineno"> 2603</span> </div>
<div class="line"><span class="lineno"> 2604</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">canPackOSABI</a>((<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)u.buf)) {</div>
<div class="line"><span class="lineno"> 2605</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2606</span>    }</div>
<div class="line"><span class="lineno"> 2607</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> max_LOADsz = 0, max_offset = 0;</div>
<div class="line"><span class="lineno"> 2608</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 2610</span>        <span class="keywordflow">if</span> (j &gt; ((<a class="code hl_variable" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>)) / <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>))) {</div>
<div class="line"><span class="lineno"> 2611</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many ElfXX_Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2612</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2613</span>        }</div>
<div class="line"><span class="lineno"> 2614</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>);</div>
<div class="line"><span class="lineno"> 2615</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == p_type) {</div>
<div class="line"><span class="lineno"> 2616</span>            <span class="comment">// The first PT_LOAD32 must cover the beginning of the file (0==p_offset).</span></div>
<div class="line"><span class="lineno"> 2617</span>            <span class="keywordflow">if</span> (1!= <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a>) {</div>
<div class="line"><span class="lineno"> 2618</span>                <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 1;</div>
<div class="line"><span class="lineno"> 2619</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);  <span class="comment">// class data member</span></div>
<div class="line"><span class="lineno"> 2620</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 2621</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> off = ~page_mask &amp; (<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>)<a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>;</div>
<div class="line"><span class="lineno"> 2622</span>                <span class="keywordflow">if</span> (off &amp;&amp; off == p_offset) { <span class="comment">// specific hint</span></div>
<div class="line"><span class="lineno"> 2623</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;Go-language PT_LOAD: try hemfix.c, or try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2624</span>                    <span class="comment">// Fixing it inside upx fails because packExtent() reads original file.</span></div>
<div class="line"><span class="lineno"> 2625</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2626</span>                }</div>
<div class="line"><span class="lineno"> 2627</span>                <span class="keywordflow">if</span> (0 != p_offset) { <span class="comment">// 1st PT_LOAD must cover Ehdr and Phdr</span></div>
<div class="line"><span class="lineno"> 2628</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;first PT_LOAD.p_offset != 0; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2629</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2630</span>                }</div>
<div class="line"><span class="lineno"> 2631</span>                <span class="comment">// FIXME: bad for shlib!</span></div>
<div class="line"><span class="lineno"> 2632</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a> = ~3ul &amp; (3+ <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">p_memsz</a>));</div>
<div class="line"><span class="lineno"> 2633</span>            }</div>
<div class="line"><span class="lineno"> 2634</span>            max_LOADsz = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>));</div>
<div class="line"><span class="lineno"> 2635</span>            max_offset = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_offset, <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>) + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>));</div>
<div class="line"><span class="lineno"> 2636</span>        }</div>
<div class="line"><span class="lineno"> 2637</span>    }</div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">canUnpack</a>()) {</div>
<div class="line"><span class="lineno"> 2639</span>        <a class="code hl_function" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a>();</div>
<div class="line"><span class="lineno"> 2640</span>    }</div>
<div class="line"><span class="lineno"> 2641</span>    <span class="comment">// Heuristic for lopped trailing PackHeader (packed and &quot;hacked&quot;!)</span></div>
<div class="line"><span class="lineno"> 2642</span>    <span class="keywordflow">if</span> (3 == <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>  <span class="comment">// not shlib: PT_LOAD.C_BASE, PT_LOAD.C_TEXT, PT_GNU_STACK</span></div>
<div class="line"><span class="lineno"> 2643</span>    &amp;&amp; <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> == <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;((<a class="code hl_struct" href="structl__info.html">l_info</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>])-&gt;l_magic)) {</div>
<div class="line"><span class="lineno"> 2644</span>        <a class="code hl_function" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a>();</div>
<div class="line"><span class="lineno"> 2645</span>    }</div>
<div class="line"><span class="lineno"> 2646</span>    <span class="comment">// We want to compress position-independent executable (gcc -pie)</span></div>
<div class="line"><span class="lineno"> 2647</span>    <span class="comment">// main programs, but compressing a shared library must be avoided</span></div>
<div class="line"><span class="lineno"> 2648</span>    <span class="comment">// because the result is no longer usable.  In theory, there is no way</span></div>
<div class="line"><span class="lineno"> 2649</span>    <span class="comment">// to tell them apart: both are just ET_DYN.  Also in theory,</span></div>
<div class="line"><span class="lineno"> 2650</span>    <span class="comment">// neither the presence nor the absence of any particular symbol name</span></div>
<div class="line"><span class="lineno"> 2651</span>    <span class="comment">// can be used to tell them apart; there are counterexamples.</span></div>
<div class="line"><span class="lineno"> 2652</span>    <span class="comment">// However, we will use the following heuristic suggested by</span></div>
<div class="line"><span class="lineno"> 2653</span>    <span class="comment">// Peter S. Mazinger &lt;ps.m@gmx.net&gt; September 2005:</span></div>
<div class="line"><span class="lineno"> 2654</span>    <span class="comment">// If a ET_DYN has __libc_start_main as a global undefined symbol,</span></div>
<div class="line"><span class="lineno"> 2655</span>    <span class="comment">// then the file is a position-independent executable main program</span></div>
<div class="line"><span class="lineno"> 2656</span>    <span class="comment">// (that depends on libc.so.6) and is eligible to be compressed.</span></div>
<div class="line"><span class="lineno"> 2657</span>    <span class="comment">// Otherwise (no __libc_start_main as global undefined): skip it.</span></div>
<div class="line"><span class="lineno"> 2658</span>    <span class="comment">// Also allow  __uClibc_main  and  __uClibc_start_main .</span></div>
<div class="line"><span class="lineno"> 2659</span> </div>
<div class="line"><span class="lineno"> 2660</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::ET_DYN==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_type)) {</div>
<div class="line"><span class="lineno"> 2661</span>        <span class="comment">// The DT_SYMTAB has no designated length.  Read the whole file.</span></div>
<div class="line"><span class="lineno"> 2662</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 2663</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 2664</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 2665</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, ehdr, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 2666</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>= (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)((<span class="keywordtype">size_t</span>)<a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 2667</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>= (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)((<span class="keywordtype">size_t</span>)<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 2668</span> </div>
<div class="line"><span class="lineno"> 2669</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2670</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2671</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno"> 2672</span>            <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_shstrndx);</div>
<div class="line"><span class="lineno"> 2673</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) {</div>
<div class="line"><span class="lineno"> 2674</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) {</div>
<div class="line"><span class="lineno"> 2675</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2676</span>                        <span class="stringliteral">&quot;bad e_shstrndx %#x &gt;= e_shnum %d&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 2677</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2678</span>                }</div>
<div class="line"><span class="lineno"> 2679</span>                <a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>];</div>
<div class="line"><span class="lineno"> 2680</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 2681</span>                <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 2682</span>                    <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2683</span>                        <span class="stringliteral">&quot;bad .e_shstrndx-&gt;sh_offset %#x&quot;</span>, sh_offset);</div>
<div class="line"><span class="lineno"> 2684</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2685</span>                }</div>
<div class="line"><span class="lineno"> 2686</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(sh_offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 2687</span>            }</div>
<div class="line"><span class="lineno"> 2688</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type</a>(Elf32_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 2689</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 2690</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_link = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>-&gt;sh_link);</div>
<div class="line"><span class="lineno"> 2691</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= sh_link) {</div>
<div class="line"><span class="lineno"> 2692</span>                    <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2693</span>                        <span class="stringliteral">&quot;bad SHT_DYNSYM.sh_link %#x&quot;</span>, sh_link);</div>
<div class="line"><span class="lineno"> 2694</span>                }</div>
<div class="line"><span class="lineno"> 2695</span>                <a class="code hl_variable" href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">sec_dynstr</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>[sh_link];</div>
<div class="line"><span class="lineno"> 2696</span>            }</div>
<div class="line"><span class="lineno"> 2697</span> </div>
<div class="line"><span class="lineno"> 2698</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>) {</div>
<div class="line"><span class="lineno"> 2699</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>-&gt;sh_name);</div>
<div class="line"><span class="lineno"> 2700</span>                <span class="keywordflow">if</span> (Elf32_Shdr::SHT_STRTAB != <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>-&gt;sh_type)</div>
<div class="line"><span class="lineno"> 2701</span>                || (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= (<span class="keyword">sizeof</span>(<span class="stringliteral">&quot;.shstrtab&quot;</span>)</div>
<div class="line"><span class="lineno"> 2702</span>                    + sh_name + (<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> - (<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0]))</div>
<div class="line"><span class="lineno"> 2703</span>                || (sh_name</div>
<div class="line"><span class="lineno"> 2704</span>                  &amp;&amp; 0!=<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>((<span class="keywordtype">char</span> <span class="keyword">const</span> *)<span class="stringliteral">&quot;.shstrtab&quot;</span>, &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[sh_name]))</div>
<div class="line"><span class="lineno"> 2705</span>                ) {</div>
<div class="line"><span class="lineno"> 2706</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad e_shstrtab&quot;</span>);</div>
<div class="line"><span class="lineno"> 2707</span>                }</div>
<div class="line"><span class="lineno"> 2708</span>            }</div>
<div class="line"><span class="lineno"> 2709</span>        }</div>
<div class="line"><span class="lineno"> 2710</span> </div>
<div class="line"><span class="lineno"> 2711</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *pload_x0(<span class="keyword">nullptr</span>);  <span class="comment">// first eXecutable PT_LOAD</span></div>
<div class="line"><span class="lineno"> 2712</span>        phdr= <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 2713</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ++phdr)</div>
<div class="line"><span class="lineno"> 2714</span>        <span class="keywordflow">if</span> (Elf32_Phdr::PT_DYNAMIC==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 2715</span>            <span class="keywordtype">unsigned</span> offset = <a class="code hl_function" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic</a>(phdr);</div>
<div class="line"><span class="lineno"> 2716</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)(offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 2717</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>,</div>
<div class="line"><span class="lineno"> 2718</span>                <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>), (<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> - offset)));</div>
<div class="line"><span class="lineno"> 2719</span>        }</div>
<div class="line"><span class="lineno"> 2720</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 2721</span>            <span class="keywordflow">if</span> (!pload_x0</div>
<div class="line"><span class="lineno"> 2722</span>            &amp;&amp;  Elf32_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>)</div>
<div class="line"><span class="lineno"> 2723</span>            ) {</div>
<div class="line"><span class="lineno"> 2724</span>                pload_x0 = phdr;</div>
<div class="line"><span class="lineno"> 2725</span>            }</div>
<div class="line"><span class="lineno"> 2726</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">check_pt_load</a>(phdr);</div>
<div class="line"><span class="lineno"> 2727</span>        }</div>
<div class="line"><span class="lineno"> 2728</span>        <span class="keywordflow">if</span> (!pload_x0) {</div>
<div class="line"><span class="lineno"> 2729</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;No PT_LOAD has (p_flags &amp; PF_X)&quot;</span>);</div>
<div class="line"><span class="lineno"> 2730</span>        }</div>
<div class="line"><span class="lineno"> 2731</span>        <span class="comment">// elf_find_dynamic() returns 0 if 0==dynseg.</span></div>
<div class="line"><span class="lineno"> 2732</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>=          (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 2733</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> <span class="comment">/*const*/</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_SYMTAB);</div>
<div class="line"><span class="lineno"> 2734</span> </div>
<div class="line"><span class="lineno"> 2735</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.force_pie</div>
<div class="line"><span class="lineno"> 2736</span>        ||      Elf32_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_FLAGS_1)</div>
<div class="line"><span class="lineno"> 2737</span>        ||  <a class="code hl_function" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">calls_crt1</a>((<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_REL),</div>
<div class="line"><span class="lineno"> 2738</span>                                 (<span class="keywordtype">int</span>)<a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_RELSZ))</div>
<div class="line"><span class="lineno"> 2739</span>        ||  <a class="code hl_function" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">calls_crt1</a>((<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_JMPREL),</div>
<div class="line"><span class="lineno"> 2740</span>                                 (<span class="keywordtype">int</span>)<a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_PLTRELSZ))) {</div>
<div class="line"><span class="lineno"> 2741</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">is_pie</a> = <span class="keyword">true</span>;  <span class="comment">// UNUSED except to ignore is_shlib and xct_off</span></div>
<div class="line"><span class="lineno"> 2742</span>            <span class="keywordflow">goto</span> proceed;  <span class="comment">// calls C library init for main program</span></div>
<div class="line"><span class="lineno"> 2743</span>        }</div>
<div class="line"><span class="lineno"> 2744</span> </div>
<div class="line"><span class="lineno"> 2745</span>        <span class="comment">// Heuristic HACK for shared libraries (compare Darwin (MacOS) Dylib.)</span></div>
<div class="line"><span class="lineno"> 2746</span>        <span class="comment">// If there is an existing DT_INIT, and if everything that the dynamic</span></div>
<div class="line"><span class="lineno"> 2747</span>        <span class="comment">// linker ld-linux needs to perform relocations before calling DT_INIT</span></div>
<div class="line"><span class="lineno"> 2748</span>        <span class="comment">// resides below the first SHT_EXECINSTR Section in one PT_LOAD, then</span></div>
<div class="line"><span class="lineno"> 2749</span>        <span class="comment">// compress from the first executable Section to the end of that PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 2750</span>        <span class="comment">// We must not alter anything that ld-linux might touch before it calls</span></div>
<div class="line"><span class="lineno"> 2751</span>        <span class="comment">// the DT_INIT function.</span></div>
<div class="line"><span class="lineno"> 2752</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 2753</span>        <span class="comment">// Obviously this hack requires that the linker script put pieces</span></div>
<div class="line"><span class="lineno"> 2754</span>        <span class="comment">// into good positions when building the original shared library,</span></div>
<div class="line"><span class="lineno"> 2755</span>        <span class="comment">// and also requires ld-linux to behave.</span></div>
<div class="line"><span class="lineno"> 2756</span> </div>
<div class="line"><span class="lineno"> 2757</span>        <span class="comment">// Apparently glibc-2.13.90 insists on 0==e_ident[EI_PAD..15],</span></div>
<div class="line"><span class="lineno"> 2758</span>        <span class="comment">// so compressing shared libraries may be doomed anyway.</span></div>
<div class="line"><span class="lineno"> 2759</span>        <span class="comment">// 2011-06-01: stub.shlib-init.S works around by installing hatch</span></div>
<div class="line"><span class="lineno"> 2760</span>        <span class="comment">// at end of .text.</span></div>
<div class="line"><span class="lineno"> 2761</span> </div>
<div class="line"><span class="lineno"> 2762</span>        <span class="keywordflow">if</span> (<span class="comment">/*jni_onload_sym ||*/</span> <a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>)) {</div>
<div class="line"><span class="lineno"> 2763</span>            <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>!=Elf32_Ehdr::EM_386</div>
<div class="line"><span class="lineno"> 2764</span>            &amp;&amp;  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>!=Elf32_Ehdr::EM_MIPS</div>
<div class="line"><span class="lineno"> 2765</span>            &amp;&amp;  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>!=Elf32_Ehdr::EM_ARM)</div>
<div class="line"><span class="lineno"> 2766</span>                <span class="keywordflow">goto</span> abandon;  <span class="comment">// need stub: EM_PPC</span></div>
<div class="line"><span class="lineno"> 2767</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a7c2f68dcc6a3caecbcb5cf7ad6e7866a">elf_has_dynamic</a>(Elf32_Dyn::DT_TEXTREL)) {</div>
<div class="line"><span class="lineno"> 2768</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;DT_TEXTREL found; re-compile with -fPIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 2769</span>                <span class="keywordflow">goto</span> abandon;</div>
<div class="line"><span class="lineno"> 2770</span>            }</div>
<div class="line"><span class="lineno"> 2771</span>            <span class="keywordflow">if</span> (!(Elf32_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_FLAGS_1))) {</div>
<div class="line"><span class="lineno"> 2772</span>                <span class="comment">// not explicitly PIE main program</span></div>
<div class="line"><span class="lineno"> 2773</span>                <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>  <span class="comment">// Android is common</span></div>
<div class="line"><span class="lineno"> 2774</span>                &amp;&amp;  !<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib  <span class="comment">// but not explicit</span></div>
<div class="line"><span class="lineno"> 2775</span>                &amp;&amp;  !<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a></div>
<div class="line"><span class="lineno"> 2776</span>                ) {</div>
<div class="line"><span class="lineno"> 2777</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode++;</div>
<div class="line"><span class="lineno"> 2778</span>                    <a class="code hl_function" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a>(<span class="stringliteral">&quot;note: use --android-shlib if appropriate&quot;</span>);</div>
<div class="line"><span class="lineno"> 2779</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode--;</div>
<div class="line"><span class="lineno"> 2780</span>                }</div>
<div class="line"><span class="lineno"> 2781</span>            }</div>
<div class="line"><span class="lineno"> 2782</span>            <span class="keywordflow">if</span> (Elf32_Ehdr::EM_MIPS == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine)</div>
<div class="line"><span class="lineno"> 2783</span>            ||  Elf32_Ehdr::EM_PPC  == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine)) {</div>
<div class="line"><span class="lineno"> 2784</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;This test UPX cannot pack .so for MIPS or PowerPC; coming soon.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2785</span>            }</div>
<div class="line"><span class="lineno"> 2786</span>            <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> <span class="keyword">const</span> *shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>;</div>
<div class="line"><span class="lineno"> 2787</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = ~0u;</div>
<div class="line"><span class="lineno"> 2788</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno"> 2789</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; --j&gt;=0; ++shdr) {</div>
<div class="line"><span class="lineno"> 2790</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 2791</span>                    <span class="keywordflow">if</span> (Elf32_Shdr::SHF_EXECINSTR &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_flags)) {</div>
<div class="line"><span class="lineno"> 2792</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>((<span class="keywordtype">unsigned</span>) <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>, <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_addr));</div>
<div class="line"><span class="lineno"> 2793</span>                    }</div>
<div class="line"><span class="lineno"> 2794</span>                    <span class="comment">// Hook the first slot of DT_PREINIT_ARRAY or DT_INIT_ARRAY.</span></div>
<div class="line"><span class="lineno"> 2795</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> &amp;&amp; (</div>
<div class="line"><span class="lineno"> 2796</span>                        (     Elf32_Dyn::DT_PREINIT_ARRAY==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></div>
<div class="line"><span class="lineno"> 2797</span>                        &amp;&amp;  Elf32_Shdr::SHT_PREINIT_ARRAY==sh_type)</div>
<div class="line"><span class="lineno"> 2798</span>                    ||  (     Elf32_Dyn::DT_INIT_ARRAY   ==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></div>
<div class="line"><span class="lineno"> 2799</span>                        &amp;&amp;  Elf32_Shdr::SHT_INIT_ARRAY   ==sh_type) )) {</div>
<div class="line"><span class="lineno"> 2800</span>                        <span class="keywordtype">unsigned</span> user_init_ava = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 2801</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 2802</span>                        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>) {</div>
<div class="line"><span class="lineno"> 2803</span>                            <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2804</span>                                <span class="stringliteral">&quot;bad Elf32_Shdr[%d].sh_offset %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2805</span>                                -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> - j, <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>);</div>
<div class="line"><span class="lineno"> 2806</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2807</span>                        }</div>
<div class="line"><span class="lineno"> 2808</span>                        <span class="comment">// Check that &amp;file_image[user_init_off] has</span></div>
<div class="line"><span class="lineno"> 2809</span>                        <span class="comment">// *_RELATIVE or *_ABS* relocation, and fetch user_init_va.</span></div>
<div class="line"><span class="lineno"> 2810</span>                        <span class="comment">// If Elf32_Rela then the actual value is in Rela.r_addend.</span></div>
<div class="line"><span class="lineno"> 2811</span>                        <span class="keywordtype">int</span> z_rel = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_REL];</div>
<div class="line"><span class="lineno"> 2812</span>                        <span class="keywordtype">int</span> z_rsz = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_RELSZ];</div>
<div class="line"><span class="lineno"> 2813</span>                        <span class="keywordflow">if</span> (z_rel &amp;&amp; z_rsz) {</div>
<div class="line"><span class="lineno"> 2814</span>                            <span class="keywordtype">unsigned</span> rel_off = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>[-1+ z_rel].d_val);</div>
<div class="line"><span class="lineno"> 2815</span>                            <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= rel_off) {</div>
<div class="line"><span class="lineno"> 2816</span>                                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2817</span>                                     <span class="stringliteral">&quot;bad Elf32_Dynamic[DT_REL] %#x\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2818</span>                                     rel_off);</div>
<div class="line"><span class="lineno"> 2819</span>                                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2820</span>                            }</div>
<div class="line"><span class="lineno"> 2821</span>                            <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *rp = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[rel_off];</div>
<div class="line"><span class="lineno"> 2822</span>                            <span class="keywordtype">unsigned</span> relsz   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>[-1+ z_rsz].d_val);</div>
<div class="line"><span class="lineno"> 2823</span>                            <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= relsz) {</div>
<div class="line"><span class="lineno"> 2824</span>                                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2825</span>                                     <span class="stringliteral">&quot;bad Elf32_Dynamic[DT_RELSZ] %#x\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2826</span>                                     relsz);</div>
<div class="line"><span class="lineno"> 2827</span>                                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2828</span>                            }</div>
<div class="line"><span class="lineno"> 2829</span>                            <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *last = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)(relsz + (<span class="keywordtype">char</span> *)rp);</div>
<div class="line"><span class="lineno"> 2830</span>                            <span class="keywordflow">for</span> (; rp &lt; last; ++rp) {</div>
<div class="line"><span class="lineno"> 2831</span>                                <span class="keywordtype">unsigned</span> r_va = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rp-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 2832</span>                                <span class="keywordflow">if</span> (r_va == user_init_ava) { <span class="comment">// found the Elf32_Rel</span></div>
<div class="line"><span class="lineno"> 2833</span>                                    <a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> = rp;</div>
<div class="line"><span class="lineno"> 2834</span>                                    <span class="keywordtype">unsigned</span> r_info = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rp-&gt;r_info);</div>
<div class="line"><span class="lineno"> 2835</span>                                    <span class="keywordtype">unsigned</span> r_type = ELF32_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 2836</span>                                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[0].st_name, r_va);  <span class="comment">// for decompressor</span></div>
<div class="line"><span class="lineno"> 2837</span>                                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[0].st_value, r_info);</div>
<div class="line"><span class="lineno"> 2838</span>                                    <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 2839</span>                                        <span class="keywordflow">if</span> (R_ARM_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 2840</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>]);</div>
<div class="line"><span class="lineno"> 2841</span>                                        }</div>
<div class="line"><span class="lineno"> 2842</span>                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_ARM_ABS32 == r_type) {</div>
<div class="line"><span class="lineno"> 2843</span>                                            <span class="keywordtype">unsigned</span> symj = ELF32_R_SYM(r_info);</div>
<div class="line"><span class="lineno"> 2844</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[symj].st_value);</div>
<div class="line"><span class="lineno"> 2845</span>                                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rp-&gt;r_info, ELF32_R_INFO(0, R_ARM_RELATIVE));</div>
<div class="line"><span class="lineno"> 2846</span>                                            <span class="comment">// pack3() will set &amp;file_image[user_init_off]</span></div>
<div class="line"><span class="lineno"> 2847</span>                                        }</div>
<div class="line"><span class="lineno"> 2848</span>                                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2849</span>                                            <span class="keywordflow">goto</span> bad;</div>
<div class="line"><span class="lineno"> 2850</span>                                        }</div>
<div class="line"><span class="lineno"> 2851</span>                                    }</div>
<div class="line"><span class="lineno"> 2852</span>                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Ehdr::EM_386 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 2853</span>                                        <span class="keywordflow">if</span> (R_386_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 2854</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>]);</div>
<div class="line"><span class="lineno"> 2855</span>                                        }</div>
<div class="line"><span class="lineno"> 2856</span>                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_386_32 == r_type) {</div>
<div class="line"><span class="lineno"> 2857</span>                                            <span class="keywordtype">unsigned</span> symj = ELF32_R_SYM(r_info);</div>
<div class="line"><span class="lineno"> 2858</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[symj].st_value);</div>
<div class="line"><span class="lineno"> 2859</span>                                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rp-&gt;r_info, ELF32_R_INFO(0, R_386_RELATIVE));</div>
<div class="line"><span class="lineno"> 2860</span>                                            <span class="comment">// pack3() will set &amp;file_image[user_init_off]</span></div>
<div class="line"><span class="lineno"> 2861</span>                                        }</div>
<div class="line"><span class="lineno"> 2862</span>                                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2863</span>                                            <span class="keywordflow">goto</span> bad;</div>
<div class="line"><span class="lineno"> 2864</span>                                        }</div>
<div class="line"><span class="lineno"> 2865</span>                                    }</div>
<div class="line"><span class="lineno"> 2866</span>                                    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2867</span>bad:</div>
<div class="line"><span class="lineno"> 2868</span>                                        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2869</span>                                            <span class="stringliteral">&quot;bad relocation %#x DT_INIT_ARRAY[0]&quot;</span>,</div>
<div class="line"><span class="lineno"> 2870</span>                                            r_info);</div>
<div class="line"><span class="lineno"> 2871</span>                                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2872</span>                                    }</div>
<div class="line"><span class="lineno"> 2873</span>                                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2874</span>                                }</div>
<div class="line"><span class="lineno"> 2875</span>                            }</div>
<div class="line"><span class="lineno"> 2876</span>                        }</div>
<div class="line"><span class="lineno"> 2877</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;pload_x0-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 2878</span>                        <span class="keywordflow">if</span> (!((<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> - <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>) &lt; p_filesz)) {</div>
<div class="line"><span class="lineno"> 2879</span>                            <span class="comment">// Not in executable portion of first executable PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 2880</span>                            <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> &amp;&amp; <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib) {</div>
<div class="line"><span class="lineno"> 2881</span>                                <span class="comment">// Android allows (0 ==&gt; skip) ?</span></div>
<div class="line"><span class="lineno"> 2882</span>                                <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = 0;  <span class="comment">// force steal of &#39;extra&#39; DT_NULL</span></div>
<div class="line"><span class="lineno"> 2883</span>                                <span class="comment">// XXX: FIXME: depends on SHT_DYNAMIC coming later</span></div>
<div class="line"><span class="lineno"> 2884</span>                            }</div>
<div class="line"><span class="lineno"> 2885</span>                            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2886</span>                                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2887</span>                                    <span class="stringliteral">&quot;bad init address %#x in Elf32_Shdr[%d].%#x\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2888</span>                                    (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a>, -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> - j, <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>);</div>
<div class="line"><span class="lineno"> 2889</span>                                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2890</span>                            }</div>
<div class="line"><span class="lineno"> 2891</span>                        }</div>
<div class="line"><span class="lineno"> 2892</span>                    }</div>
<div class="line"><span class="lineno"> 2893</span>                    <span class="comment">// By default /usr/bin/ld leaves 4 extra DT_NULL to support pre-linking.</span></div>
<div class="line"><span class="lineno"> 2894</span>                    <span class="comment">// Take one as a last resort.</span></div>
<div class="line"><span class="lineno"> 2895</span>                    <span class="keywordflow">if</span> ((Elf32_Dyn::DT_INIT==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> || !<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>)</div>
<div class="line"><span class="lineno"> 2896</span>                    &amp;&amp;  Elf32_Shdr::SHT_DYNAMIC == sh_type) {</div>
<div class="line"><span class="lineno"> 2897</span>                        <span class="keywordtype">unsigned</span> sh_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 2898</span>                        <span class="keywordtype">unsigned</span> sh_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 2899</span>                        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_size</div>
<div class="line"><span class="lineno"> 2900</span>                        ||  (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_offset</div>
<div class="line"><span class="lineno"> 2901</span>                        || ((<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - sh_offset) &lt; sh_size) {</div>
<div class="line"><span class="lineno"> 2902</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad SHT_DYNAMIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 2903</span>                        }</div>
<div class="line"><span class="lineno"> 2904</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> <a class="code hl_variable" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_size) / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a>);</div>
<div class="line"><span class="lineno"> 2905</span>                        <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *dynp = (<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset)];</div>
<div class="line"><span class="lineno"> 2906</span>                        <span class="keywordflow">for</span> (; Elf32_Dyn::DT_NULL != dynp-&gt;d_tag; ++dynp) {</div>
<div class="line"><span class="lineno"> 2907</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_tag)) {</div>
<div class="line"><span class="lineno"> 2908</span>                                <span class="keywordflow">break</span>;  <span class="comment">// re-found DT_INIT</span></div>
<div class="line"><span class="lineno"> 2909</span>                            }</div>
<div class="line"><span class="lineno"> 2910</span>                        }</div>
<div class="line"><span class="lineno"> 2911</span>                        <span class="keywordflow">if</span> ((1+ dynp) &lt; (<a class="code hl_variable" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a>+ <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>)) { <span class="comment">// not the terminator, so take it</span></div>
<div class="line"><span class="lineno"> 2912</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_val);  <span class="comment">// 0 if (0==upx_dt_init)</span></div>
<div class="line"><span class="lineno"> 2913</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;dynp-&gt;d_tag, <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf32_Dyn::DT_INIT);</div>
<div class="line"><span class="lineno"> 2914</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;dynp-&gt;d_val - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0];</div>
<div class="line"><span class="lineno"> 2915</span>                        }</div>
<div class="line"><span class="lineno"> 2916</span>                    }</div>
<div class="line"><span class="lineno"> 2917</span>                }</div>
<div class="line"><span class="lineno"> 2918</span>            }</div>
<div class="line"><span class="lineno"> 2919</span>            <span class="keywordflow">else</span> { <span class="comment">// no Sections; use heuristics</span></div>
<div class="line"><span class="lineno"> 2920</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> strsz  = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_STRSZ);</div>
<div class="line"><span class="lineno"> 2921</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> strtab = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 2922</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> relsz  = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_RELSZ);</div>
<div class="line"><span class="lineno"> 2923</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> rel    = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_REL);</div>
<div class="line"><span class="lineno"> 2924</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> init   = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>);</div>
<div class="line"><span class="lineno"> 2925</span>                <span class="keywordflow">if</span> ((init == (relsz + rel   ) &amp;&amp; rel    == (strsz + strtab))</div>
<div class="line"><span class="lineno"> 2926</span>                ||  (init == (strsz + strtab) &amp;&amp; strtab == (relsz + rel   ))</div>
<div class="line"><span class="lineno"> 2927</span>                ) {</div>
<div class="line"><span class="lineno"> 2928</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = init;</div>
<div class="line"><span class="lineno"> 2929</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = init;</div>
<div class="line"><span class="lineno"> 2930</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(init);</div>
<div class="line"><span class="lineno"> 2931</span>                }</div>
<div class="line"><span class="lineno"> 2932</span>            }</div>
<div class="line"><span class="lineno"> 2933</span>            <span class="comment">// Rely on 0==elf_unsigned_dynamic(tag) if no such tag.</span></div>
<div class="line"><span class="lineno"> 2934</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> va_gash = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 2935</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> va_hash = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 2936</span>            <span class="keywordtype">unsigned</span> y = 0;</div>
<div class="line"><span class="lineno"> 2937</span>            <span class="keywordflow">if</span> ((y=1, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; va_gash)  ||  (y=2, (0==va_gash &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; va_hash))</div>
<div class="line"><span class="lineno"> 2938</span>            ||  (y=3, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_STRTAB))</div>
<div class="line"><span class="lineno"> 2939</span>            ||  (y=4, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_SYMTAB))</div>
<div class="line"><span class="lineno"> 2940</span>            ||  (y=5, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_REL))</div>
<div class="line"><span class="lineno"> 2941</span>            ||  (y=6, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_RELA))</div>
<div class="line"><span class="lineno"> 2942</span>            ||  (y=7, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_JMPREL))</div>
<div class="line"><span class="lineno"> 2943</span>            ||  (y=8, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_VERDEF))</div>
<div class="line"><span class="lineno"> 2944</span>            ||  (y=9, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_VERSYM))</div>
<div class="line"><span class="lineno"> 2945</span>            ||  (y=10, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_VERNEED)) ) {</div>
<div class="line"><span class="lineno"> 2946</span>                <span class="keyword">static</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *which[] = {</div>
<div class="line"><span class="lineno"> 2947</span>                    <span class="stringliteral">&quot;unknown&quot;</span>,</div>
<div class="line"><span class="lineno"> 2948</span>                    <span class="stringliteral">&quot;DT_GNU_HASH&quot;</span>,</div>
<div class="line"><span class="lineno"> 2949</span>                    <span class="stringliteral">&quot;DT_HASH&quot;</span>,</div>
<div class="line"><span class="lineno"> 2950</span>                    <span class="stringliteral">&quot;DT_STRTAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 2951</span>                    <span class="stringliteral">&quot;DT_SYMTAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 2952</span>                    <span class="stringliteral">&quot;DT_REL&quot;</span>,</div>
<div class="line"><span class="lineno"> 2953</span>                    <span class="stringliteral">&quot;DT_RELA&quot;</span>,</div>
<div class="line"><span class="lineno"> 2954</span>                    <span class="stringliteral">&quot;DT_JMPREL&quot;</span>,</div>
<div class="line"><span class="lineno"> 2955</span>                    <span class="stringliteral">&quot;DT_VERDEF&quot;</span>,</div>
<div class="line"><span class="lineno"> 2956</span>                    <span class="stringliteral">&quot;DT_VERSYM&quot;</span>,</div>
<div class="line"><span class="lineno"> 2957</span>                    <span class="stringliteral">&quot;DT_VERNEED&quot;</span>,</div>
<div class="line"><span class="lineno"> 2958</span>                };</div>
<div class="line"><span class="lineno"> 2959</span>                <span class="keywordtype">char</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[30]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>), <span class="stringliteral">&quot;%s above stub&quot;</span>, which[y]);</div>
<div class="line"><span class="lineno"> 2960</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>);</div>
<div class="line"><span class="lineno"> 2961</span>                <span class="keywordflow">goto</span> abandon;</div>
<div class="line"><span class="lineno"> 2962</span>            }</div>
<div class="line"><span class="lineno"> 2963</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>);</div>
<div class="line"><span class="lineno"> 2964</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;debug.debug_level) {</div>
<div class="line"><span class="lineno"> 2965</span>                fprintf(stderr, <span class="stringliteral">&quot;shlib canPack: xct_va=%#lx  xct_off=%#lx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2966</span>                    (<span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>, (<span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 2967</span>            }</div>
<div class="line"><span class="lineno"> 2968</span>            <span class="keywordflow">goto</span> proceed;  <span class="comment">// But proper packing depends on checking xct_va.</span></div>
<div class="line"><span class="lineno"> 2969</span>        }</div>
<div class="line"><span class="lineno"> 2970</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2971</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;need DT_INIT; try \&quot;void _init(void){}\&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2972</span>        }</div>
<div class="line"><span class="lineno"> 2973</span>abandon:</div>
<div class="line"><span class="lineno"> 2974</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2975</span>proceed: ;</div>
<div class="line"><span class="lineno"> 2976</span>    }</div>
<div class="line"><span class="lineno"> 2977</span>    <span class="comment">// XXX Theoretically the following test should be first,</span></div>
<div class="line"><span class="lineno"> 2978</span>    <span class="comment">// but PackUnix::canPack() wants 0!=exetype ?</span></div>
<div class="line"><span class="lineno"> 2979</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">super::canPack</a>())</div>
<div class="line"><span class="lineno"> 2980</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2981</span>    assert(<a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> == 1);</div>
<div class="line"><span class="lineno"> 2982</span>    <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 0;</div>
<div class="line"><span class="lineno"> 2983</span> </div>
<div class="line"><span class="lineno"> 2984</span>    <span class="comment">// set options</span></div>
<div class="line"><span class="lineno"> 2985</span>    <span class="comment">// this-&gt;blocksize: avoid over-allocating.</span></div>
<div class="line"><span class="lineno"> 2986</span>    <span class="comment">// (file_size - max_offset): debug info, non-globl symbols, etc.</span></div>
<div class="line"><span class="lineno"> 2987</span>    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.blocksize = <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, (<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - max_offset));</div>
<div class="line"><span class="lineno"> 2988</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2989</span>}</div>
<div class="ttc" id="abele_8h_html_a975f8af4219a9c95cf3395cbd46fc472"><div class="ttname"><a href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_le32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00327">bele.h:327</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a0582ead69b6b3552ad4f751c2fa3f882"><div class="ttname"><a href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">PackLinuxElf32::elf_find_dynamic</a></div><div class="ttdeci">void * elf_find_dynamic(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07742">p_lx_elf.cpp:7742</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a117c75deef89749d3998463ab14ad780"><div class="ttname"><a href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">PackLinuxElf32::check_pt_load</a></div><div class="ttdeci">unsigned check_pt_load(Elf32_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07652">p_lx_elf.cpp:7652</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a18b74d82d2a2993873377ac87e6393d4"><div class="ttname"><a href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">PackLinuxElf32::invert_pt_dynamic</a></div><div class="ttdeci">void invert_pt_dynamic(Elf32_Dyn const *, unsigned dt_filesz)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02089">p_lx_elf.cpp:2089</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a362f74f1bc69654c06e59aa1805f009a"><div class="ttname"><a href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">PackLinuxElf32::canPackOSABI</a></div><div class="ttdeci">virtual bool canPackOSABI(Elf32_Ehdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02471">p_lx_elf.cpp:2471</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a3c404e04836d12a4840ccfc0f1c98ae7"><div class="ttname"><a href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7">PackLinuxElf32::checkEhdr</a></div><div class="ttdeci">virtual int checkEhdr(Elf32_Ehdr const *ehdr) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00150">p_lx_elf.cpp:150</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a3cc398e82caa74060ec330d678f7e142"><div class="ttname"><a href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">PackLinuxElf32::elf_unsigned_dynamic</a></div><div class="ttdeci">virtual upx_uint64_t elf_unsigned_dynamic(unsigned) const override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07778">p_lx_elf.cpp:7778</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a46cb564e37f90259226b0fa81fe8b496"><div class="ttname"><a href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">PackLinuxElf32::e_shoff</a></div><div class="ttdeci">unsigned e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00232">p_lx_elf.h:232</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a57c8f63c6f5b8671a39cd8acf2b48bc6"><div class="ttname"><a href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">PackLinuxElf32::calls_crt1</a></div><div class="ttdeci">bool calls_crt1(Elf32_Rel const *rel, int sz)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02436">p_lx_elf.cpp:2436</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a7c2f68dcc6a3caecbcb5cf7ad6e7866a"><div class="ttname"><a href="classPackLinuxElf32.html#a7c2f68dcc6a3caecbcb5cf7ad6e7866a">PackLinuxElf32::elf_has_dynamic</a></div><div class="ttdeci">Elf32_Dyn const * elf_has_dynamic(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07672">p_lx_elf.cpp:7672</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a86f5c0bb23dea2f02777b2bd551f3756"><div class="ttname"><a href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">PackLinuxElf32::elf_find_section_type</a></div><div class="ttdeci">Elf32_Shdr * elf_find_section_type(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02347">p_lx_elf.cpp:2347</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a89a8cceb7f8ef9df9542156c01118aa4"><div class="ttname"><a href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">PackLinuxElf32::canUnpack</a></div><div class="ttdeci">virtual tribool canUnpack() override</div><div class="ttdoc">Generic Unix canUnpack().</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02453">p_lx_elf.cpp:2453</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a9929af0daa1854fea2672c0c50bddb84"><div class="ttname"><a href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">PackLinuxElf32::is_LOAD32</a></div><div class="ttdeci">int is_LOAD32(Elf32_Phdr const *phdr) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00265">p_lx_elf.cpp:265</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_aba7026f4211ff852ffc5fc17ba0ec2b9"><div class="ttname"><a href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">PackLinuxElf32::check_pt_dynamic</a></div><div class="ttdeci">unsigned check_pt_dynamic(Elf32_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07683">p_lx_elf.cpp:7683</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3bb9134e6f6d635119bbce8ee9fc2cc0"><div class="ttname"><a href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a></div><div class="ttdeci">upx_uint64_t user_init_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00106">p_lx_elf.h:106</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a5789e03712ad5c821ed718be76cb006a"><div class="ttname"><a href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a></div><div class="ttdeci">unsigned upx_dt_init</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00119">p_lx_elf.h:119</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a59a59994ceb7e3d20444f07a08cd1cfe"><div class="ttname"><a href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a></div><div class="ttdeci">unsigned user_init_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00109">p_lx_elf.h:109</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8c8e26f797ec69a6c183c8b15fcd4f53"><div class="ttname"><a href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a></div><div class="ttdeci">void * user_init_rp</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00107">p_lx_elf.h:107</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a93d9de72bcb60bbea6757e0d44e5e296"><div class="ttname"><a href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a></div><div class="ttdeci">unsigned dt_table[DT_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00121">p_lx_elf.h:121</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a9f6c41a7dc3caa60ac369d2776ee5a12"><div class="ttname"><a href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">PackLinuxElf::is_pie</a></div><div class="ttdeci">bool is_pie</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00097">p_lx_elf.h:97</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aa692858672c20488c367295681b28422"><div class="ttname"><a href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a></div><div class="ttdeci">upx_uint64_t load_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00103">p_lx_elf.h:103</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aac769941a308e20fdce0e86d1ec3b2f3"><div class="ttname"><a href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a></div><div class="ttdeci">unsigned hatch_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00100">p_lx_elf.h:100</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_afcc48dc344bb8340e9691a43d45f8458"><div class="ttname"><a href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a></div><div class="ttdeci">unsigned e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00081">p_lx_elf.h:81</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a3408c180ca78a03f0c06da6c8c25dc34"><div class="ttname"><a href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a></div><div class="ttdeci">unsigned blocksize</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00094">p_unix.h:94</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a449871a4fd2081e1399999ef05741f92"><div class="ttname"><a href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a></div><div class="ttdeci">int exetype</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00093">p_unix.h:93</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a8ab714a14f4ff2f120107dfc08b2a3a5"><div class="ttname"><a href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a></div><div class="ttdeci">unsigned saved_opt_android_shlib</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00106">p_unix.h:106</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a935b7961d8278ae7b19c53d6ef3fe3cf"><div class="ttname"><a href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix::canPack</a></div><div class="ttdeci">virtual tribool canPack() override</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00070">p_unix.cpp:70</a></div></div>
<div class="ttc" id="aclassPackerBase_html_ac91973d9b4ba31e291970a8a058f6b07"><div class="ttname"><a href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a></div><div class="ttdeci">const upx_uint64_t file_size_u</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00088">packer.h:88</a></div></div>
<div class="ttc" id="aconf_8h_html_a2ce9aaa3ef74889b5352e4a6025db5bc"><div class="ttname"><a href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a></div><div class="ttdeci">#define UPX_MAGIC_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00509">conf.h:509</a></div></div>
<div class="ttc" id="aconf_8h_html_a92f0ba69c0f889de4efac3dea2b0cc8a"><div class="ttname"><a href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT(e)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00237">conf.h:237</a></div></div>
<div class="ttc" id="aconf_8h_html_aafadbc56bd61f1a892099d70ff71b6e4"><div class="ttname"><a href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a></div><div class="ttdeci">#define UPX_MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00488">conf.h:488</a></div></div>
<div class="ttc" id="aconf_8h_html_af1fdeecf9ad80f9618354edc154be54a"><div class="ttname"><a href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a></div><div class="ttdeci">void void void void void info(const char *format,...) attribute_format(1</div></div>
<div class="ttc" id="aexcept_8cpp_html_a263a7fe48ef7383a4fd0b9daf6c317fa"><div class="ttname"><a href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a></div><div class="ttdeci">void throwAlreadyPacked(const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00097">except.cpp:97</a></div></div>
<div class="ttc" id="anamespaceupx_html_a79bf3f180bc97aea86be54634b455c77"><div class="ttname"><a href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">upx::umin</a></div><div class="ttdeci">forceinline constexpr T umin(const T &amp;a, const T &amp;b) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cxxlib_8h_source.html#l00250">cxxlib.h:250</a></div></div>
<div class="ttc" id="aoptions_8cpp_html_a887b9edd7a68b4cde1de1f0d7ac1d6eb"><div class="ttname"><a href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a></div><div class="ttdeci">#define opt</div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a204ef936a203e18150dc61b25af76bb8"><div class="ttname"><a href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a></div><div class="ttdeci">#define PT_LOAD32</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00053">p_lx_elf.cpp:53</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a34f9d3637288371175e78109dfbabef4"><div class="ttname"><a href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a></div><div class="ttdeci">static void alloc_file_image(MemBuffer &amp;mb, off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00139">p_lx_elf.cpp:139</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a977c134df2e7ed6eb5533874edb9d791"><div class="ttname"><a href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a></div><div class="ttdeci">static constexpr unsigned MAX_ELF_HDR_32</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00063">p_lx_elf.cpp:63</a></div></div>
<div class="ttc" id="ap__lx__elf_8h_html_a68e5abb5d6e413b99c6e37512b057090"><div class="ttname"><a href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a></div><div class="ttdeci">upx_uint32_t u32_t</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00037">p_lx_elf.h:37</a></div></div>
<div class="ttc" id="ap__unix_8cpp_html_aa29b866765bdc5bdf87b7eb666d66093"><div class="ttname"><a href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a></div><div class="ttdeci">#define buf</div></div>
<div class="ttc" id="astructElf32__Phdr_html_a35c457e6828894b7b275730593802050"><div class="ttname"><a href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a></div><div class="ttdeci">Elf32_Word p_flags</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00231">bsd.h:231</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html_ada1cdd3d6ccb79a17bed0e3c21379c84"><div class="ttname"><a href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">Elf32_Phdr::p_memsz</a></div><div class="ttdeci">Elf32_Word p_memsz</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00230">bsd.h:230</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_af532e634462c5e42c213735f6869b383"><div class="ttname"><a href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a></div><div class="ttdeci">const C&lt; U &gt; size_t n</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00080">xspan_fwd.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image()</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <a class="el" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">calls_crt1()</a>, <a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix::canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">canPackOSABI()</a>, <a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">canUnpack()</a>, <a class="el" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">check_pt_load()</a>, <a class="el" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7">checkEhdr()</a>, <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>, <a class="el" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">Elf32_Ehdr::e_ehsize</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf32.html#a7c2f68dcc6a3caecbcb5cf7ad6e7866a">elf_has_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a>, <a class="el" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info()</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">PackLinuxElf::is_pie</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a>, <a class="el" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">Elf32_Phdr::p_memsz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">sec_dynstr</a>, <a class="el" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>, <a class="el" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked()</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a>, <a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a>, <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5">PackLinuxElf32x86interp::canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_cgraph" id="aclassPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_cgraph">
<area shape="rect" title=" " alt="" coords="5,1435,187,1461"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="792,879,920,905"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1702,1157,1821,1182"/>
<area shape="rect" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6" title=" " alt="" coords="499,121,689,146"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1884,1661,2013,1686"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="823,246,889,271"/>
<area shape="rect" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf" title=" " alt="" coords="523,499,665,525"/>
<area shape="rect" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa" title=" " alt="" coords="1015,247,1169,273"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="795,550,917,575"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="797,449,915,474"/>
<area shape="rect" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a" title=" " alt="" coords="483,601,705,626"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="235,1230,435,1255"/>
<area shape="rect" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7" title=" " alt="" coords="497,1005,691,1030"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="1027,1461,1157,1486"/>
<area shape="rect" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9" title=" " alt="" coords="1468,1431,1635,1471"/>
<area shape="rect" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780" title=" " alt="" coords="1468,1557,1635,1597"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="1019,2095,1165,2135"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="1225,2092,1416,2132"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="1692,2209,1831,2249"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="1248,1764,1393,1804"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="773,1828,939,1868"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="1245,1883,1396,1923"/>
<area shape="rect" href="classPackLinuxElf32.html#a7c2f68dcc6a3caecbcb5cf7ad6e7866a" title=" " alt="" coords="1689,5,1834,45"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="295,2362,374,2387"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="311,2411,358,2437"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="295,2485,374,2510"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="271,2534,399,2559"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="1254,955,1387,981"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="1017,1055,1167,1081"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="1236,1562,1405,1587"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="1007,905,1177,930"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1068,954,1116,979"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1507,882,1596,907"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1513,955,1589,981"/>
<area shape="rect" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd" title=" " alt="" coords="1687,120,1836,160"/>
<area shape="rect" href="classPacker.html#a14b9cb85a2382ebc043228597992283b" title=" " alt="" coords="753,347,959,373"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="1035,550,1149,575"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="1017,501,1167,526"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1252,385,1389,410"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="1034,349,1150,374"/>
<area shape="rect" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8" title=" " alt="" coords="1245,587,1397,627"/>
<area shape="rect" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack()." alt="" coords="503,1201,685,1226"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="497,1251,691,1291"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="787,1106,925,1131"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="814,1005,898,1030"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="1479,1929,1624,1969"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="1464,2092,1639,2132"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="1019,1879,1165,1919"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="1015,1663,1169,1703"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="553,2362,635,2387"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_icgraph" id="aclassPackLinuxElf32_ac4f9df5fb4c6ace9d197f29e1594a552_icgraph">
<area shape="rect" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="a362f74f1bc69654c06e59aa1805f009a" name="a362f74f1bc69654c06e59aa1805f009a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a362f74f1bc69654c06e59aa1805f009a">&#9670;&#160;</a></span>canPackOSABI()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PackLinuxElf32::canPackOSABI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> const *&#160;</td>
          <td class="paramname"><em>ehdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02471">2471</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2472</span>{</div>
<div class="line"><span class="lineno"> 2473</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> osabi0 = ehdr-&gt;e_ident[Elf32_Ehdr::EI_OSABI];</div>
<div class="line"><span class="lineno"> 2474</span>    <span class="comment">// The first PT_LOAD32 must cover the beginning of the file (0==p_offset).</span></div>
<div class="line"><span class="lineno"> 2475</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 2476</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a63d39fd80fb77e53dd4d79b5042a2941">note_size</a> = 0;</div>
<div class="line"><span class="lineno"> 2477</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 2478</span>        <span class="keywordflow">if</span> (j &gt; ((<a class="code hl_variable" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>)) / <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>))) {</div>
<div class="line"><span class="lineno"> 2479</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many ElfXX_Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2480</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2481</span>        }</div>
<div class="line"><span class="lineno"> 2482</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>);</div>
<div class="line"><span class="lineno"> 2483</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 2484</span>        <span class="keywordflow">if</span> (1!=<a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> &amp;&amp; <a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == p_type) { <span class="comment">// 1st PT_LOAD</span></div>
<div class="line"><span class="lineno"> 2485</span>            <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 1;</div>
<div class="line"><span class="lineno"> 2486</span>            <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);  <span class="comment">// class data member</span></div>
<div class="line"><span class="lineno"> 2487</span> </div>
<div class="line"><span class="lineno"> 2488</span>            <span class="comment">// Cast on next line is to avoid a compiler bug (incorrect complaint) in</span></div>
<div class="line"><span class="lineno"> 2489</span>            <span class="comment">// Microsoft (R) C/C++ Optimizing Compiler Version 19.00.24215.1 for x64</span></div>
<div class="line"><span class="lineno"> 2490</span>            <span class="comment">// error C4319: &#39;~&#39;: zero extending &#39;unsigned int&#39; to &#39;upx_uint64_t&#39; of greater size</span></div>
<div class="line"><span class="lineno"> 2491</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> off = ~page_mask &amp; (unsigned)<a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>;</div>
<div class="line"><span class="lineno"> 2492</span> </div>
<div class="line"><span class="lineno"> 2493</span>            <span class="keywordflow">if</span> (off &amp;&amp; off == p_offset) { <span class="comment">// specific hint</span></div>
<div class="line"><span class="lineno"> 2494</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;Go-language PT_LOAD: try hemfix.c, or try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2495</span>                <span class="comment">// Fixing it inside upx fails because packExtent() reads original file.</span></div>
<div class="line"><span class="lineno"> 2496</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2497</span>            }</div>
<div class="line"><span class="lineno"> 2498</span>            <span class="keywordflow">if</span> (0 != p_offset) { <span class="comment">// 1st PT_LOAD must cover Ehdr and Phdr</span></div>
<div class="line"><span class="lineno"> 2499</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;first PT_LOAD.p_offset != 0; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2500</span>                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2501</span>            }</div>
<div class="line"><span class="lineno"> 2502</span>            <a class="code hl_variable" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a> = ~3u &amp; (3+ <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">p_memsz</a>));</div>
<div class="line"><span class="lineno"> 2503</span>        }</div>
<div class="line"><span class="lineno"> 2504</span>        <span class="keywordflow">if</span> (EM_MIPS == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno"> 2505</span>        &amp;&amp;  (Elf32_Phdr::PT_MIPS_ABIFLAGS == p_type</div>
<div class="line"><span class="lineno"> 2506</span>          || Elf32_Phdr::PT_MIPS_REGINFO  == p_type)</div>
<div class="line"><span class="lineno"> 2507</span>        ) {</div>
<div class="line"><span class="lineno"> 2508</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx</a>(phdr);  <span class="comment">// PT_MIPS_*</span></div>
<div class="line"><span class="lineno"> 2509</span>            <span class="keywordtype">unsigned</span> mask = -1+ <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">p_align</a>);</div>
<div class="line"><span class="lineno"> 2510</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a> = ~mask &amp; (mask + <a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>);</div>
<div class="line"><span class="lineno"> 2511</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a> += <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">p_memsz</a>);</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>        }</div>
<div class="line"><span class="lineno"> 2514</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a59eb0ef71e7b110186c324070f393316">PT_NOTE32</a> == p_type) {</div>
<div class="line"><span class="lineno"> 2515</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">osabi_note</a> &amp;&amp; Elf32_Ehdr::ELFOSABI_NONE==osabi0) { <span class="comment">// Still seems to be generic.</span></div>
<div class="line"><span class="lineno"> 2516</span>                <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 2517</span>                    <span class="keyword">struct </span>Elf32_Nhdr nhdr;</div>
<div class="line"><span class="lineno"> 2518</span>                    <span class="keywordtype">char</span> name[8];</div>
<div class="line"><span class="lineno"> 2519</span>                    <span class="keywordtype">unsigned</span> body;</div>
<div class="line"><span class="lineno"> 2520</span>                } note;</div>
<div class="line"><span class="lineno"> 2521</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;note, 0, <span class="keyword">sizeof</span>(note));</div>
<div class="line"><span class="lineno"> 2522</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(p_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 2523</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;note, <span class="keyword">sizeof</span>(note));</div>
<div class="line"><span class="lineno"> 2524</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 2525</span>                <span class="keywordflow">if</span> (4==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;note.nhdr.descsz)</div>
<div class="line"><span class="lineno"> 2526</span>                &amp;&amp;  1==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;note.nhdr.type)</div>
<div class="line"><span class="lineno"> 2527</span>                <span class="comment">// &amp;&amp;  0==note.end</span></div>
<div class="line"><span class="lineno"> 2528</span>                &amp;&amp;  (1+ <a class="code hl_define" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">osabi_note</a>))==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;note.nhdr.namesz)</div>
<div class="line"><span class="lineno"> 2529</span>                &amp;&amp;  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">osabi_note</a>, (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;note.name[0])</div>
<div class="line"><span class="lineno"> 2530</span>                ) {</div>
<div class="line"><span class="lineno"> 2531</span>                    osabi0 = <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>;  <span class="comment">// Specified by PT_NOTE.</span></div>
<div class="line"><span class="lineno"> 2532</span>                }</div>
<div class="line"><span class="lineno"> 2533</span>            }</div>
<div class="line"><span class="lineno"> 2534</span>        }</div>
<div class="line"><span class="lineno"> 2535</span>    }</div>
<div class="line"><span class="lineno"> 2536</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::ELFOSABI_NONE ==osabi0</div>
<div class="line"><span class="lineno"> 2537</span>    ||  Elf32_Ehdr::ELFOSABI_LINUX==osabi0) { <span class="comment">// No EI_OSBAI, no PT_NOTE.</span></div>
<div class="line"><span class="lineno"> 2538</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> arm_eabi = 0xff000000u &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ehdr-&gt;e_flags);</div>
<div class="line"><span class="lineno"> 2539</span>        <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno"> 2540</span>        &amp;&amp;   (<a class="code hl_variable" href="p__lx__elf_8cpp.html#aeb2773fbcc29db90978759ce23647c86">EF_ARM_EABI_VER5</a>==arm_eabi</div>
<div class="line"><span class="lineno"> 2541</span>          ||  <a class="code hl_variable" href="p__lx__elf_8cpp.html#a19635b726a1e795870f05fef9bab7e76">EF_ARM_EABI_VER4</a>==arm_eabi ) ) {</div>
<div class="line"><span class="lineno"> 2542</span>            <span class="comment">// armel-eabi armeb-eabi ARM Linux EABI version 4 is a mess.</span></div>
<div class="line"><span class="lineno"> 2543</span>            <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a> = osabi0 = Elf32_Ehdr::ELFOSABI_LINUX;</div>
<div class="line"><span class="lineno"> 2544</span>        }</div>
<div class="line"><span class="lineno"> 2545</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2546</span>            osabi0 = <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.osabi0;  <span class="comment">// Possibly specified by command-line.</span></div>
<div class="line"><span class="lineno"> 2547</span>        }</div>
<div class="line"><span class="lineno"> 2548</span>    }</div>
<div class="line"><span class="lineno"> 2549</span>    <span class="keywordflow">if</span> (osabi0!=<a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>) {</div>
<div class="line"><span class="lineno"> 2550</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2551</span>    }</div>
<div class="line"><span class="lineno"> 2552</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;  <span class="comment">// good so far</span></div>
<div class="line"><span class="lineno"> 2553</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a26bcf782bacd0c3b94c981ad6272c0b8"><div class="ttname"><a href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">PackLinuxElf32::add_phdrx</a></div><div class="ttdeci">void add_phdrx(Elf32_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00983">p_lx_elf.cpp:983</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a63d39fd80fb77e53dd4d79b5042a2941"><div class="ttname"><a href="classPackLinuxElf.html#a63d39fd80fb77e53dd4d79b5042a2941">PackLinuxElf::note_size</a></div><div class="ttdeci">unsigned note_size</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00128">p_lx_elf.h:128</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a946ebc79f94eff58bd559c7b5bb60057"><div class="ttname"><a href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">PackLinuxElf::osabi_note</a></div><div class="ttdeci">char const  * osabi_note</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00118">p_lx_elf.h:118</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ad930777406ea601d200de0ab59de88d6"><div class="ttname"><a href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a></div><div class="ttdeci">unsigned char ei_osabi</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00116">p_lx_elf.h:116</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a19635b726a1e795870f05fef9bab7e76"><div class="ttname"><a href="p__lx__elf_8cpp.html#a19635b726a1e795870f05fef9bab7e76">EF_ARM_EABI_VER4</a></div><div class="ttdeci">static unsigned const EF_ARM_EABI_VER4</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00067">p_lx_elf.cpp:67</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a59eb0ef71e7b110186c324070f393316"><div class="ttname"><a href="p__lx__elf_8cpp.html#a59eb0ef71e7b110186c324070f393316">PT_NOTE32</a></div><div class="ttdeci">#define PT_NOTE32</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00055">p_lx_elf.cpp:55</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aeb2773fbcc29db90978759ce23647c86"><div class="ttname"><a href="p__lx__elf_8cpp.html#aeb2773fbcc29db90978759ce23647c86">EF_ARM_EABI_VER5</a></div><div class="ttdeci">static unsigned const EF_ARM_EABI_VER5</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00068">p_lx_elf.cpp:68</a></div></div>
<div class="ttc" id="asnprintf_8cpp_html_a417fef1b5cd577cfc9a2836bb40fa885"><div class="ttname"><a href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a></div><div class="ttdeci">#define strlen</div></div>
<div class="ttc" id="astructElf32__Phdr_html_afd09d9e4297b13fc94fd57d09f2a9f70"><div class="ttname"><a href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a></div><div class="ttdeci">Elf32_Word p_align</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00232">bsd.h:232</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx()</a>, <a class="el" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">Elf32_Ehdr::e_flags</a>, <a class="el" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="p__lx__elf_8cpp.html#a19635b726a1e795870f05fef9bab7e76">EF_ARM_EABI_VER4</a>, <a class="el" href="p__lx__elf_8cpp.html#aeb2773fbcc29db90978759ce23647c86">EF_ARM_EABI_VER5</a>, <a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a>, <a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf.html#a63d39fd80fb77e53dd4d79b5042a2941">PackLinuxElf::note_size</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">PackLinuxElf::osabi_note</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">Elf32_Phdr::p_memsz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="p__lx__elf_8cpp.html#a59eb0ef71e7b110186c324070f393316">PT_NOTE32</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>, <a class="el" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_cgraph" id="aclassPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_cgraph">
<area shape="rect" title=" " alt="" coords="5,242,228,267"/>
<area shape="rect" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8" title=" " alt="" coords="842,79,994,119"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1045,122,1164,147"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="276,291,405,317"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="303,365,379,390"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="279,242,402,267"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="282,193,399,218"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="307,438,374,463"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="471,318,585,343"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="453,269,603,294"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="655,291,786,317"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="873,193,963,218"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="676,417,765,442"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="652,242,789,267"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="839,325,997,365"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="470,167,586,193"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="692,94,749,119"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="653,193,789,218"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="651,143,791,169"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_icgraph" id="aclassPackLinuxElf32_a362f74f1bc69654c06e59aa1805f009a_icgraph">
<area shape="rect" title=" " alt="" coords="465,13,688,38"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="a89a8cceb7f8ef9df9542156c01118aa4" name="a89a8cceb7f8ef9df9542156c01118aa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89a8cceb7f8ef9df9542156c01118aa4">&#9670;&#160;</a></span>canUnpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tribool PackLinuxElf32::canUnpack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic Unix <a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack().">canUnpack()</a>. </p>

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32x86.html#a6086de6af98a8281ca82e9cbb0af4094">PackLinuxElf32x86</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02453">2453</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2454</span>{</div>
<div class="line"><span class="lineno"> 2455</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7">checkEhdr</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>)) {</div>
<div class="line"><span class="lineno"> 2456</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2457</span>    }</div>
<div class="line"><span class="lineno"> 2458</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>) &lt; 2) {</div>
<div class="line"><span class="lineno"> 2459</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;e_phnum must be &gt;= 2&quot;</span>);</div>
<div class="line"><span class="lineno"> 2460</span>    }</div>
<div class="line"><span class="lineno"> 2461</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::ET_DYN==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a>)) {</div>
<div class="line"><span class="lineno"> 2462</span>        <a class="code hl_function" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);</div>
<div class="line"><span class="lineno"> 2463</span>    }</div>
<div class="line"><span class="lineno"> 2464</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">super::canUnpack</a>()) {</div>
<div class="line"><span class="lineno"> 2465</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2466</span>    }</div>
<div class="line"><span class="lineno"> 2467</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2468</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_aa2acf155f6a76482cd3cbd17cef800e6"><div class="ttname"><a href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32::PackLinuxElf32help1</a></div><div class="ttdeci">virtual void PackLinuxElf32help1(InputFile *f)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00278">p_lx_elf.cpp:278</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a2749869eea115d88727ccd4f60b0c474"><div class="ttname"><a href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf::canUnpack</a></div><div class="ttdeci">virtual tribool canUnpack() override</div><div class="ttdoc">Generic Unix canUnpack().</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00049">p_lx_elf.h:49</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_aeec259360ad810df576d7012b3f054f3"><div class="ttname"><a href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a></div><div class="ttdeci">void throwCantUnpack(const char *msg)</div><div class="ttdoc">decompression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00109">except.cpp:109</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a49e40a791813c06e3b6ebcb53aef1bb8"><div class="ttname"><a href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a></div><div class="ttdeci">Elf32_Half e_type</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00190">bsd.h:190</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf::canUnpack()</a>, <a class="el" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7">checkEhdr()</a>, <a class="el" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_cgraph" id="aclassPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_cgraph">
<area shape="rect" title="Generic Unix canUnpack()." alt="" coords="5,301,205,326"/>
<area shape="rect" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack()." alt="" coords="259,250,442,275"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1247,125,1386,150"/>
<area shape="rect" href="classPackLinuxElf32.html#a3c404e04836d12a4840ccfc0f1c98ae7" title=" " alt="" coords="253,377,448,402"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="731,402,861,427"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="254,905,447,945"/>
<area shape="rect" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120" title="Generic Unix canUnpack()." alt="" coords="498,250,661,275"/>
<area shape="rect" href="classPackUnix.html#a4f1d471152b26686e619f2e8b6744366" title=" " alt="" coords="711,143,881,183"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="735,301,857,326"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="737,503,855,529"/>
<area shape="rect" href="classFileBase.html#a7ae5a36714da37350db8bf0c9e6618b3" title=" " alt="" coords="731,250,861,275"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1483,1373,1612,1398"/>
<area shape="rect" href="classPacker.html#afeee17a50e4f350eebc14b1704ec9a39" title=" " alt="" coords="960,50,1131,75"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="929,99,1161,125"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1488,713,1607,738"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="988,251,1103,277"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="971,301,1120,326"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1272,655,1361,681"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1248,453,1385,478"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="987,453,1103,478"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="537,477,621,502"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="979,1163,1112,1189"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="515,1038,643,1063"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="721,963,871,989"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="961,1639,1130,1665"/>
<area shape="rect" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9" title=" " alt="" coords="1233,884,1400,924"/>
<area shape="rect" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780" title=" " alt="" coords="1233,820,1400,860"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="723,1797,869,1837"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="973,1359,1118,1399"/>
<area shape="rect" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad" title=" " alt="" coords="723,791,869,831"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="496,1459,663,1499"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="510,1860,649,1900"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1279,1222,1355,1247"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1275,1050,1359,1075"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1276,1271,1357,1297"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1209,1149,1424,1174"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1239,1099,1394,1125"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1472,1264,1623,1304"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="711,1013,881,1038"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="772,1062,820,1087"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="1244,1625,1389,1665"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="950,1740,1141,1780"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="962,843,1129,869"/>
<area shape="rect" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd" title=" " alt="" coords="971,705,1120,745"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="1242,705,1391,745"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="959,893,1132,918"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="1012,794,1079,819"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="723,1365,869,1405"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="970,1575,1121,1615"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="719,1429,873,1469"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_icgraph" id="aclassPackLinuxElf32_a89a8cceb7f8ef9df9542156c01118aa4_icgraph">
<area shape="rect" title="Generic Unix canUnpack()." alt="" coords="465,13,665,38"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="aba7026f4211ff852ffc5fc17ba0ec2b9" name="aba7026f4211ff852ffc5fc17ba0ec2b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba7026f4211ff852ffc5fc17ba0ec2b9">&#9670;&#160;</a></span>check_pt_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::check_pt_dynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07683">7683</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7684</span>{</div>
<div class="line"><span class="lineno"> 7685</span>    <span class="keywordtype">unsigned</span> t = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_offset), s = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a>) + t;</div>
<div class="line"><span class="lineno"> 7686</span>    <span class="keywordtype">unsigned</span> vaddr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_vaddr);</div>
<div class="line"><span class="lineno"> 7687</span>    <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_filesz), memsz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_memsz);</div>
<div class="line"><span class="lineno"> 7688</span>    <span class="keywordtype">unsigned</span> align = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno"> 7689</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; t || s &lt; t</div>
<div class="line"><span class="lineno"> 7690</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; filesz</div>
<div class="line"><span class="lineno"> 7691</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; (filesz + t)</div>
<div class="line"><span class="lineno"> 7692</span>    ||  t &lt; (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>*<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>))</div>
<div class="line"><span class="lineno"> 7693</span>    ||  (3 &amp; t) || (7 &amp; (filesz | memsz))  <span class="comment">// .balign 4; 8==sizeof(Elf32_Dyn)</span></div>
<div class="line"><span class="lineno"> 7694</span>    ||  (-1+ align) &amp; (t ^ vaddr)</div>
<div class="line"><span class="lineno"> 7695</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= memsz</div>
<div class="line"><span class="lineno"> 7696</span>    ||  filesz &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a>)</div>
<div class="line"><span class="lineno"> 7697</span>    ||  memsz  &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a>)</div>
<div class="line"><span class="lineno"> 7698</span>    ||  filesz &lt; memsz) {</div>
<div class="line"><span class="lineno"> 7699</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad PT_DYNAMIC phdr[%u]&quot;</span>,</div>
<div class="line"><span class="lineno"> 7700</span>            (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>));</div>
<div class="line"><span class="lineno"> 7701</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7702</span>    }</div>
<div class="line"><span class="lineno"> 7703</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#af1b4b28858fe215fd7bcd305f3a58c1b">sz_dynseg</a> = memsz;</div>
<div class="line"><span class="lineno"> 7704</span>    <span class="keywordflow">return</span> t;</div>
<div class="line"><span class="lineno"> 7705</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_af1b4b28858fe215fd7bcd305f3a58c1b"><div class="ttname"><a href="classPackLinuxElf32.html#af1b4b28858fe215fd7bcd305f3a58c1b">PackLinuxElf32::sz_dynseg</a></div><div class="ttdeci">unsigned sz_dynseg</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00233">p_lx_elf.h:233</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">Elf32_Phdr::p_memsz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf32.html#af1b4b28858fe215fd7bcd305f3a58c1b">sz_dynseg</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_cgraph" id="aclassPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,172,63"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="220,5,349,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="225,55,344,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_icgraph" id="aclassPackLinuxElf32_aba7026f4211ff852ffc5fc17ba0ec2b9_icgraph">
<area shape="rect" title=" " alt="" coords="965,35,1132,75"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,63,917,103"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,38,671,63"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,88,676,128"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,152,675,192"/>
</map>
</div>

</div>
</div>
<a id="a117c75deef89749d3998463ab14ad780" name="a117c75deef89749d3998463ab14ad780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a117c75deef89749d3998463ab14ad780">&#9670;&#160;</a></span>check_pt_load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> PackLinuxElf32::check_pt_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07652">7652</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7653</span>{</div>
<div class="line"><span class="lineno"> 7654</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 7655</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_offset), offend = filesz + offset;</div>
<div class="line"><span class="lineno"> 7656</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> vaddr  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_vaddr);</div>
<div class="line"><span class="lineno"> 7657</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> paddr  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_paddr);</div>
<div class="line"><span class="lineno"> 7658</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> align  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno"> 7659</span> </div>
<div class="line"><span class="lineno"> 7660</span>    <span class="keywordflow">if</span> ((-1+ align) &amp; (paddr ^ vaddr)</div>
<div class="line"><span class="lineno"> 7661</span>    ||  <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a> &lt;= (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)offset</div>
<div class="line"><span class="lineno"> 7662</span>    ||  <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a> &lt;  (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)offend</div>
<div class="line"><span class="lineno"> 7663</span>    ||  <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a> &lt;  (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)filesz) {</div>
<div class="line"><span class="lineno"> 7664</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad PT_LOAD phdr[%u]&quot;</span>,</div>
<div class="line"><span class="lineno"> 7665</span>            (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>));</div>
<div class="line"><span class="lineno"> 7666</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7667</span>    }</div>
<div class="line"><span class="lineno"> 7668</span>    <span class="keywordflow">return</span> offset;</div>
<div class="line"><span class="lineno"> 7669</span>}</div>
<div class="ttc" id="aclassPackerBase_html_a4ccd780b4c08de5d2868a0ffbcf1f6f3"><div class="ttname"><a href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a></div><div class="ttdeci">const upx_uint32_t file_size_u32</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00094">packer.h:94</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">Elf32_Phdr::p_paddr</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a117c75deef89749d3998463ab14ad780_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a117c75deef89749d3998463ab14ad780_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a117c75deef89749d3998463ab14ad780_cgraph" id="aclassPackLinuxElf32_a117c75deef89749d3998463ab14ad780_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,172,63"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="220,5,349,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="225,55,344,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a117c75deef89749d3998463ab14ad780_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a117c75deef89749d3998463ab14ad780_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a117c75deef89749d3998463ab14ad780_icgraph" id="aclassPackLinuxElf32_a117c75deef89749d3998463ab14ad780_icgraph">
<area shape="rect" title=" " alt="" coords="965,35,1132,75"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,63,917,103"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,38,671,63"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,88,676,128"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,152,675,192"/>
</map>
</div>

</div>
</div>
<a id="a3c404e04836d12a4840ccfc0f1c98ae7" name="a3c404e04836d12a4840ccfc0f1c98ae7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c404e04836d12a4840ccfc0f1c98ae7">&#9670;&#160;</a></span>checkEhdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf32::checkEhdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> const *&#160;</td>
          <td class="paramname"><em>ehdr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00150">150</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  151</span>{</div>
<div class="line"><span class="lineno">  152</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a> = ehdr-&gt;e_ident;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <span class="stringliteral">&quot;\x7f\x45\x4c\x46&quot;</span>, 4)  <span class="comment">// &quot;\177ELF&quot;</span></div>
<div class="line"><span class="lineno">  155</span>    ||  <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf32_Ehdr::EI_CLASS]!=<a class="code hl_variable" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">ei_class</a></div>
<div class="line"><span class="lineno">  156</span>    ||  <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf32_Ehdr::EI_DATA] !=<a class="code hl_variable" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">ei_data</a></div>
<div class="line"><span class="lineno">  157</span>    ) {</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>+8, <span class="stringliteral">&quot;FreeBSD&quot;</span>, 7))                   <span class="comment">// branded</span></div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordtype">int</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_type);</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> (type != Elf32_Ehdr::ET_EXEC &amp;&amp; type != Elf32_Ehdr::ET_DYN)</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">return</span> 2;</div>
<div class="line"><span class="lineno">  166</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine) != (<span class="keywordtype">unsigned</span>) <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>)</div>
<div class="line"><span class="lineno">  167</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ehdr-&gt;e_version) != Elf32_Ehdr::EV_CURRENT)</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">return</span> 4;</div>
<div class="line"><span class="lineno">  170</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> &lt; 1)</div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">return</span> 5;</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_phentsize) != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>))</div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">return</span> 6;</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">if</span> (type == Elf32_Ehdr::ET_EXEC) {</div>
<div class="line"><span class="lineno">  176</span>        <span class="comment">// check for Linux kernels</span></div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> entry = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ehdr-&gt;e_entry);</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">if</span> (entry == 0xC0100000)    <span class="comment">// uncompressed vmlinux</span></div>
<div class="line"><span class="lineno">  179</span>            <span class="keywordflow">return</span> 1000;</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span> (entry == 0x00001000)    <span class="comment">// compressed vmlinux</span></div>
<div class="line"><span class="lineno">  181</span>            <span class="keywordflow">return</span> 1001;</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">if</span> (entry == 0x00100000)    <span class="comment">// compressed bvmlinux</span></div>
<div class="line"><span class="lineno">  183</span>            <span class="keywordflow">return</span> 1002;</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="comment">// FIXME: add more checks for kernels</span></div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">// FIXME: add special checks for other ELF i386 formats, like</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="comment">//        NetBSD, OpenBSD, Solaris, ....</span></div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <span class="comment">// success</span></div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  193</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a5dabe40d6f7f71e6b9bce64b9cc3290f"><div class="ttname"><a href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">PackLinuxElf::ei_data</a></div><div class="ttdeci">unsigned char ei_data</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00115">p_lx_elf.h:115</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_af6c2c447099336ae2bc5cc1539c36610"><div class="ttname"><a href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">PackLinuxElf::ei_class</a></div><div class="ttdeci">unsigned char ei_class</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00114">p_lx_elf.h:114</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <a class="el" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">Elf32_Ehdr::e_entry</a>, <a class="el" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a>, <a class="el" href="structElf32__Ehdr.html#afa2289f96d86fcc568a3b1f40cc8953e">Elf32_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">Elf32_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">PackLinuxElf::ei_class</a>, <a class="el" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">PackLinuxElf::ei_data</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, and <a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">canUnpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_cgraph" id="aclassPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_cgraph">
<area shape="rect" title=" " alt="" coords="5,55,200,80"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="248,5,377,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="248,55,377,80"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="271,128,355,153"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_icgraph" id="aclassPackLinuxElf32_a3c404e04836d12a4840ccfc0f1c98ae7_icgraph">
<area shape="rect" title=" " alt="" coords="713,13,908,38"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="465,38,665,63"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="a6714d3d54a016578688207074404d0dc" name="a6714d3d54a016578688207074404d0dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6714d3d54a016578688207074404d0dc">&#9670;&#160;</a></span>compileTimeAssertions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PackLinuxElf32::compileTimeAssertions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00294">294</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>                                        {</div>
<div class="line"><span class="lineno">  295</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(cprElfHdr1) == 52 + 1*32 + 12)</div>
<div class="line"><span class="lineno">  296</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr2) == 52 + 2*32 + 12)</div>
<div class="line"><span class="lineno">  297</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr3) == 52 + 3*32 + 12)</div>
<div class="line"><span class="lineno">  298</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdrNetBSD) == 52 + 4*32 + 512)</div>
<div class="line"><span class="lineno">  299</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr1)</div>
<div class="line"><span class="lineno">  300</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr2)</div>
<div class="line"><span class="lineno">  301</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr3)</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdrNetBSD)</div>
<div class="line"><span class="lineno">  303</span>    }</div>
<div class="ttc" id="aconf_8h_html_a20a79123be4e1110319dc90522f4b563"><div class="ttname"><a href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT_ALIGNED1(a)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00432">conf.h:432</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, and <a class="el" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>.</p>

</div>
</div>
<a id="a42b1cda087bb627b537152b283c9419b" name="a42b1cda087bb627b537152b283c9419b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42b1cda087bb627b537152b283c9419b">&#9670;&#160;</a></span>defineSymbols()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::defineSymbols </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32x86.html#af385de8ecd4da90bdc675b32bdcc8fde">PackLinuxElf32x86</a>, <a class="el" href="classPackLinuxElf32armLe.html#a9e09fa4d0193751ca6866465ccdb97b3">PackLinuxElf32armLe</a>, <a class="el" href="classPackLinuxElf32armBe.html#a3c3ef6474fdf3b84b9d613c89f7cc4cf">PackLinuxElf32armBe</a>, <a class="el" href="classPackLinuxElf32mipseb.html#aae9d4ccad876bec19a8c98cfdac9962b">PackLinuxElf32mipseb</a>, and <a class="el" href="classPackLinuxElf32mipsel.html#a557bc93b9e4577ba9de4d9a5569443c9">PackLinuxElf32mipsel</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00951">951</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  952</span>{</div>
<div class="line"><span class="lineno">  953</span>    <a class="code hl_function" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno">  954</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_addaacfe47a36eb9d70929a58ba311e29"><div class="ttname"><a href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols</a></div><div class="ttdeci">virtual void defineSymbols(Filter const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00944">p_lx_elf.cpp:944</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a247c49c374e4a7c27cafadafb01f5642">ARM_defineSymbols()</a>, <a class="el" href="classPackLinuxElf32.html#a2de3b0ba7a17f5de7f5a62f5df6a0bb3">buildLinuxLoader()</a>, <a class="el" href="classPackLinuxElf32x86.html#af385de8ecd4da90bdc675b32bdcc8fde">PackLinuxElf32x86::defineSymbols()</a>, <a class="el" href="classPackLinuxElf32mipseb.html#aae9d4ccad876bec19a8c98cfdac9962b">PackLinuxElf32mipseb::defineSymbols()</a>, and <a class="el" href="classPackLinuxElf32mipsel.html#a557bc93b9e4577ba9de4d9a5569443c9">PackLinuxElf32mipsel::defineSymbols()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_cgraph" id="aclassPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,229,31"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="277,5,484,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_icgraph" id="aclassPackLinuxElf32_a42b1cda087bb627b537152b283c9419b_icgraph">
<area shape="rect" title=" " alt="" coords="516,415,740,441"/>
<area shape="rect" href="classPackLinuxElf32.html#a247c49c374e4a7c27cafadafb01f5642" title=" " alt="" coords="291,69,450,109"/>
<area shape="rect" href="classPackLinuxElf32.html#a2de3b0ba7a17f5de7f5a62f5df6a0bb3" title=" " alt="" coords="273,344,468,384"/>
<area shape="rect" href="classPackLinuxElf32x86.html#af385de8ecd4da90bdc675b32bdcc8fde" title=" " alt="" coords="295,408,447,448"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#aae9d4ccad876bec19a8c98cfdac9962b" title=" " alt="" coords="287,472,455,512"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#a557bc93b9e4577ba9de4d9a5569443c9" title=" " alt="" coords="289,536,453,576"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#a9e09fa4d0193751ca6866465ccdb97b3" title=" " alt="" coords="35,5,196,45"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a3c3ef6474fdf3b84b9d613c89f7cc4cf" title=" " alt="" coords="34,69,197,109"/>
<area shape="rect" href="classPackLinuxElf32ppc.html#a837a4d1bf96e44b0ecd11e7150c5565b" title=" " alt="" coords="40,133,191,173"/>
<area shape="rect" href="classPackLinuxElf32x86.html#a69d1831a5732ba82bc6a21e187003b81" title=" " alt="" coords="39,197,191,237"/>
<area shape="rect" href="classPackBSDElf32x86.html#a28fe533055d17e4e4570bc890dd802b4" title=" " alt="" coords="5,262,225,287"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#abf40ab0b8e777d22c12eebf77a8dde2a" title=" " alt="" coords="35,312,196,352"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a4eaf1a02af96f64941c82e06aff51237" title=" " alt="" coords="34,376,197,416"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#af1b1d619d6cf7810897aa82c57a7638d" title=" " alt="" coords="31,440,199,480"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#abb9c15cc5a974ec3554d78bfc7999b09" title=" " alt="" coords="33,504,197,544"/>
<area shape="rect" href="classPackNetBSDElf32x86.html#a52476626884e67e577a2e37a8a934634" title=" " alt="" coords="36,568,195,608"/>
<area shape="rect" href="classPackOpenBSDElf32x86.html#a814d4f91e539a066454d1d2f360d5b79" title=" " alt="" coords="30,632,201,672"/>
</map>
</div>

</div>
</div>
<a id="a0582ead69b6b3552ad4f751c2fa3f882" name="a0582ead69b6b3552ad4f751c2fa3f882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0582ead69b6b3552ad4f751c2fa3f882">&#9670;&#160;</a></span>elf_find_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * PackLinuxElf32::elf_find_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07742">7742</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7743</span>{</div>
<div class="line"><span class="lineno"> 7744</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_function" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr</a>(key);</div>
<div class="line"><span class="lineno"> 7745</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 7746</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> t= <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_val));</div>
<div class="line"><span class="lineno"> 7747</span>        <span class="keywordflow">if</span> (t &amp;&amp; t &lt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a>) {</div>
<div class="line"><span class="lineno"> 7748</span>            <span class="keywordflow">return</span> t + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>;</div>
<div class="line"><span class="lineno"> 7749</span>        }</div>
<div class="line"><span class="lineno"> 7750</span>    }</div>
<div class="line"><span class="lineno"> 7751</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7752</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_ab12506f897a258211fa947e556cb2615"><div class="ttname"><a href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">PackLinuxElf32::elf_find_dynptr</a></div><div class="ttdeci">Elf32_Dyn * elf_find_dynptr(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07707">p_lx_elf.cpp:7707</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, and <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, <a class="el" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_cgraph" id="aclassPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,151,103"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="452,5,597,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="847,95,976,121"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="199,120,389,160"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="437,145,612,185"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="660,171,799,211"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="670,235,789,261"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_icgraph" id="aclassPackLinuxElf32_a0582ead69b6b3552ad4f751c2fa3f882_icgraph">
<area shape="rect" title=" " alt="" coords="1180,198,1325,238"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,27,417,52"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,198,1132,238"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,141,917,181"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,256,893,296"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="977,316,1121,356"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,20,188,60"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,27,671,52"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,77,676,117"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,141,675,181"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,295,658,320"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="749,320,893,360"/>
</map>
</div>

</div>
</div>
<a id="ab12506f897a258211fa947e556cb2615" name="ab12506f897a258211fa947e556cb2615"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab12506f897a258211fa947e556cb2615">&#9670;&#160;</a></span>elf_find_dynptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> * PackLinuxElf32::elf_find_dynptr </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07707">7707</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7708</span>{</div>
<div class="line"><span class="lineno"> 7709</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *dynp= <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>;</div>
<div class="line"><span class="lineno"> 7710</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 7711</span>        <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *<span class="keyword">const</span> last = (<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)(<a class="code hl_variable" href="classPackLinuxElf32.html#af1b4b28858fe215fd7bcd305f3a58c1b">sz_dynseg</a> + (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>);</div>
<div class="line"><span class="lineno"> 7712</span>        <span class="keywordflow">for</span> (; dynp &lt; last; ++dynp) {</div>
<div class="line"><span class="lineno"> 7713</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_tag)==key) {</div>
<div class="line"><span class="lineno"> 7714</span>                <span class="keywordflow">return</span> dynp;</div>
<div class="line"><span class="lineno"> 7715</span>            }</div>
<div class="line"><span class="lineno"> 7716</span>            <span class="keywordflow">if</span> (Elf32_Dyn::DT_NULL == dynp-&gt;d_tag) {</div>
<div class="line"><span class="lineno"> 7717</span>                <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7718</span>            }</div>
<div class="line"><span class="lineno"> 7719</span>        }</div>
<div class="line"><span class="lineno"> 7720</span>    }</div>
<div class="line"><span class="lineno"> 7721</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7722</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf32.html#af1b4b28858fe215fd7bcd305f3a58c1b">sz_dynseg</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ab12506f897a258211fa947e556cb2615_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_ab12506f897a258211fa947e556cb2615_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ab12506f897a258211fa947e556cb2615_cgraph" id="aclassPackLinuxElf32_ab12506f897a258211fa947e556cb2615_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ab12506f897a258211fa947e556cb2615_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_ab12506f897a258211fa947e556cb2615_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ab12506f897a258211fa947e556cb2615_icgraph" id="aclassPackLinuxElf32_ab12506f897a258211fa947e556cb2615_icgraph">
<area shape="rect" title=" " alt="" coords="1593,228,1739,268"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="1191,385,1336,425"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,105,893,145"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="1395,185,1545,225"/>
<area shape="rect" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c" title=" " alt="" coords="1180,335,1347,361"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,259,417,285"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,213,1132,253"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,335,917,375"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="977,328,1121,368"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,252,188,292"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,285,671,310"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,335,676,375"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,399,675,439"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,113,658,138"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="749,169,893,209"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="1191,271,1336,311"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="1187,156,1340,196"/>
</map>
</div>

</div>
</div>
<a id="a7dbc6cc573876410e6b5fe1ed235a6e0" name="a7dbc6cc573876410e6b5fe1ed235a6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dbc6cc573876410e6b5fe1ed235a6e0">&#9670;&#160;</a></span>elf_find_Phdr_for_va()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const  * PackLinuxElf32::elf_find_Phdr_for_va </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00454">454</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  455</span>{</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno">  457</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> align = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type)</div>
<div class="line"><span class="lineno">  459</span>        &amp;&amp; <a class="code hl_function" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a>(align) &amp;&amp; !((-1+ align) &amp;</div>
<div class="line"><span class="lineno">  460</span>            (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_vaddr) ^ <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_offset)))</div>
<div class="line"><span class="lineno">  461</span>        &amp;&amp;  (addr - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_vaddr)) &lt; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_filesz)) {</div>
<div class="line"><span class="lineno">  462</span>            <span class="keywordflow">return</span> phdr;</div>
<div class="line"><span class="lineno">  463</span>        }</div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  466</span>}</div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a0a26281ee961fe926e04c93f395d76cf"><div class="ttname"><a href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a></div><div class="ttdeci">static unsigned is_pow2(u64_t x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00448">p_lx_elf.cpp:448</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2()</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, and <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">sort_DT32_offsets()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_cgraph" id="aclassPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,151,63"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,5,328,31"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="226,55,301,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_icgraph" id="aclassPackLinuxElf32_a7dbc6cc573876410e6b5fe1ed235a6e0_icgraph">
<area shape="rect" title=" " alt="" coords="1395,92,1540,132"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="1191,63,1336,103"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,5,893,45"/>
<area shape="rect" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c" title=" " alt="" coords="1180,127,1347,153"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="1187,177,1340,217"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,63,1132,103"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,127,417,153"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,149,917,189"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,120,188,160"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,185,671,210"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,235,676,275"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,120,675,160"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,13,658,38"/>
</map>
</div>

</div>
</div>
<a id="a0f2fa5dca83b3dc674c10277cd57c909" name="a0f2fa5dca83b3dc674c10277cd57c909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f2fa5dca83b3dc674c10277cd57c909">&#9670;&#160;</a></span>elf_find_ptype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const  * PackLinuxElf32::elf_find_ptype </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02278">2278</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2279</span>{</div>
<div class="line"><span class="lineno"> 2280</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 2281</span>        <span class="keywordflow">if</span> (type == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type)) {</div>
<div class="line"><span class="lineno"> 2282</span>            <span class="keywordflow">return</span> phdr;</div>
<div class="line"><span class="lineno"> 2283</span>        }</div>
<div class="line"><span class="lineno"> 2284</span>    }</div>
<div class="line"><span class="lineno"> 2285</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2286</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_cgraph" id="aclassPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_icgraph" id="aclassPackLinuxElf32_a0f2fa5dca83b3dc674c10277cd57c909_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,373,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a313f7710d0510a233bbda02e91d359a5" name="a313f7710d0510a233bbda02e91d359a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a313f7710d0510a233bbda02e91d359a5">&#9670;&#160;</a></span>elf_find_section_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> const  * PackLinuxElf32::elf_find_section_name </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02299">2299</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2302</span>{</div>
<div class="line"><span class="lineno"> 2303</span>    <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> <span class="keyword">const</span> *shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>;</div>
<div class="line"><span class="lineno"> 2304</span>    <span class="keywordflow">if</span> (!shdr) {</div>
<div class="line"><span class="lineno"> 2305</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2306</span>    }</div>
<div class="line"><span class="lineno"> 2307</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>;</div>
<div class="line"><span class="lineno"> 2308</span>    <span class="keywordflow">for</span> (; 0 &lt;=--j; ++shdr) {</div>
<div class="line"><span class="lineno"> 2309</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_name);</div>
<div class="line"><span class="lineno"> 2310</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= sh_name) {  <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 2311</span>            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2312</span>                <span class="stringliteral">&quot;bad Elf32_Shdr[%d].sh_name %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2313</span>                -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> -j, sh_name);</div>
<div class="line"><span class="lineno"> 2314</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2315</span>        }</div>
<div class="line"><span class="lineno"> 2316</span>        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[sh_name])) {</div>
<div class="line"><span class="lineno"> 2317</span>            <span class="keywordflow">return</span> shdr;</div>
<div class="line"><span class="lineno"> 2318</span>        }</div>
<div class="line"><span class="lineno"> 2319</span>    }</div>
<div class="line"><span class="lineno"> 2320</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2321</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_cgraph" id="aclassPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,156,111"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="204,5,333,31"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="235,79,302,104"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="209,128,328,153"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_icgraph" id="aclassPackLinuxElf32_a313f7710d0510a233bbda02e91d359a5_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,371,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a86f5c0bb23dea2f02777b2bd551f3756" name="a86f5c0bb23dea2f02777b2bd551f3756"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86f5c0bb23dea2f02777b2bd551f3756">&#9670;&#160;</a></span>elf_find_section_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> * PackLinuxElf32::elf_find_section_type </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02347">2347</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2350</span>{</div>
<div class="line"><span class="lineno"> 2351</span>    <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>;</div>
<div class="line"><span class="lineno"> 2352</span>    <span class="keywordflow">if</span> (!shdr) {</div>
<div class="line"><span class="lineno"> 2353</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2354</span>    }</div>
<div class="line"><span class="lineno"> 2355</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>;</div>
<div class="line"><span class="lineno"> 2356</span>    <span class="keywordflow">for</span> (; 0 &lt;=--j; ++shdr) {</div>
<div class="line"><span class="lineno"> 2357</span>        <span class="keywordflow">if</span> (type==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type)) {</div>
<div class="line"><span class="lineno"> 2358</span>            <span class="keywordflow">return</span> shdr;</div>
<div class="line"><span class="lineno"> 2359</span>        }</div>
<div class="line"><span class="lineno"> 2360</span>    }</div>
<div class="line"><span class="lineno"> 2361</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2362</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_cgraph" id="aclassPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_icgraph" id="aclassPackLinuxElf32_a86f5c0bb23dea2f02777b2bd551f3756_icgraph">
<area shape="rect" title=" " alt="" coords="1395,141,1540,181"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,159,417,184"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="1191,141,1336,181"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,209,917,249"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="1180,256,1347,282"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="1191,65,1335,105"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,152,188,192"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,141,1132,181"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,94,893,134"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,338,671,363"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,209,676,249"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,273,675,313"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,72,658,98"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="977,44,1121,84"/>
</map>
</div>

</div>
</div>
<a id="aa3f2721b58e10a1d02b398f398fb7812" name="aa3f2721b58e10a1d02b398f398fb7812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3f2721b58e10a1d02b398f398fb7812">&#9670;&#160;</a></span>elf_find_table_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::elf_find_table_size </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dt_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>sh_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02061">2061</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2062</span>{</div>
<div class="line"><span class="lineno"> 2063</span>    <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> <span class="keyword">const</span> *sec = <a class="code hl_function" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type</a>(sh_type);</div>
<div class="line"><span class="lineno"> 2064</span>    <span class="keywordflow">if</span> (sec) { <span class="comment">// Cheat the easy way: use _Shdr.  (No _Shdr anyway for de-compression)</span></div>
<div class="line"><span class="lineno"> 2065</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sec-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 2066</span>    }</div>
<div class="line"><span class="lineno"> 2067</span>    <span class="comment">// Honest hard work: use _Phdr</span></div>
<div class="line"><span class="lineno"> 2068</span>    <span class="keywordtype">unsigned</span> x_rva;</div>
<div class="line"><span class="lineno"> 2069</span>    <span class="keywordflow">if</span> (dt_type &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) {</div>
<div class="line"><span class="lineno"> 2070</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> x_ndx = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[dt_type];</div>
<div class="line"><span class="lineno"> 2071</span>        <span class="keywordflow">if</span> (!x_ndx) { <span class="comment">// no such entry</span></div>
<div class="line"><span class="lineno"> 2072</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 2073</span>        }</div>
<div class="line"><span class="lineno"> 2074</span>        x_rva = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>[-1+ x_ndx].d_val);</div>
<div class="line"><span class="lineno"> 2075</span>    }</div>
<div class="line"><span class="lineno"> 2076</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2077</span>        x_rva = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(dt_type);</div>
<div class="line"><span class="lineno"> 2078</span>    }</div>
<div class="line"><span class="lineno"> 2079</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> x_phdr = <a class="code hl_function" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va</a>(x_rva, <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 2080</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>           d_off =             x_rva - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;x_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 2081</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>           y_ndx = <a class="code hl_function" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c">find_dt_ndx</a>(d_off + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;x_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>));</div>
<div class="line"><span class="lineno"> 2082</span>    <span class="keywordflow">if</span> (~0u != y_ndx) {</div>
<div class="line"><span class="lineno"> 2083</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[1+ y_ndx] - <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[y_ndx];</div>
<div class="line"><span class="lineno"> 2084</span>    }</div>
<div class="line"><span class="lineno"> 2085</span>    <span class="keywordflow">return</span> ~0u;</div>
<div class="line"><span class="lineno"> 2086</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a7dbc6cc573876410e6b5fe1ed235a6e0"><div class="ttname"><a href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">PackLinuxElf32::elf_find_Phdr_for_va</a></div><div class="ttdeci">virtual Elf32_Phdr const * elf_find_Phdr_for_va(unsigned addr, Elf32_Phdr const *phdr, unsigned phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00454">p_lx_elf.cpp:454</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_ae126d225cb28e675a4261204a3872e2c"><div class="ttname"><a href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c">PackLinuxElf32::find_dt_ndx</a></div><div class="ttdeci">unsigned find_dt_ndx(unsigned rva)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02049">p_lx_elf.cpp:2049</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a7515af27403f7b035c02bc0f92dee48c"><div class="ttname"><a href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a></div><div class="ttdeci">static unsigned const DT_NUM</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00120">p_lx_elf.h:120</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_acbe0a4831f0aafe74de573ca657ea430"><div class="ttname"><a href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a></div><div class="ttdeci">unsigned * dt_offsets</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00086">p_lx_elf.h:86</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c">find_dt_ndx()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, and <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_cgraph" id="aclassPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_cgraph">
<area shape="rect" title=" " alt="" coords="5,139,151,179"/>
<area shape="rect" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0" title=" " alt="" coords="202,24,347,64"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="616,140,745,165"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="202,139,347,179"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="199,203,350,243"/>
<area shape="rect" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c" title=" " alt="" coords="199,298,351,338"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="446,38,521,64"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="411,240,556,280"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="408,305,559,330"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="399,354,568,380"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_icgraph" id="aclassPackLinuxElf32_aa3f2721b58e10a1d02b398f398fb7812_icgraph">
<area shape="rect" title=" " alt="" coords="1180,88,1325,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,88,1132,128"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,88,917,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,180,893,220"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,38,671,63"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,88,676,128"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,152,675,192"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,217,658,242"/>
</map>
</div>

</div>
</div>
<a id="aed8111e8e63b6f87ff03edd42538ecaf" name="aed8111e8e63b6f87ff03edd42538ecaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed8111e8e63b6f87ff03edd42538ecaf">&#9670;&#160;</a></span>elf_get_offset_from_address()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::elf_get_offset_from_address </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07625">7625</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7626</span>{</div>
<div class="line"><span class="lineno"> 7627</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53">elf_get_offset_from_Phdrs</a>(addr, <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>);</div>
<div class="line"><span class="lineno"> 7628</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_aa0fe8832b28a69327c9c65628f13dc53"><div class="ttname"><a href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53">PackLinuxElf32::elf_get_offset_from_Phdrs</a></div><div class="ttdeci">virtual unsigned elf_get_offset_from_Phdrs(unsigned, Elf32_Phdr const *phdr0) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07631">p_lx_elf.cpp:7631</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53">elf_get_offset_from_Phdrs()</a>, and <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, and <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_cgraph" id="aclassPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_cgraph">
<area shape="rect" title=" " alt="" coords="5,26,196,66"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="244,26,419,66"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="653,5,783,31"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="467,26,605,66"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="477,91,595,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_icgraph" id="aclassPackLinuxElf32_aed8111e8e63b6f87ff03edd42538ecaf_icgraph">
<area shape="rect" title=" " alt="" coords="1375,254,1565,294"/>
<area shape="rect" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe" title=" " alt="" coords="1180,82,1327,122"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,260,417,285"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="1181,282,1326,322"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,253,1132,293"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="965,5,1132,31"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,253,188,293"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,195,917,235"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,310,893,350"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="977,370,1121,410"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,235,671,260"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,170,676,210"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,106,675,146"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,359,658,384"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="749,374,893,414"/>
</map>
</div>

</div>
</div>
<a id="aa0fe8832b28a69327c9c65628f13dc53" name="aa0fe8832b28a69327c9c65628f13dc53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0fe8832b28a69327c9c65628f13dc53">&#9670;&#160;</a></span>elf_get_offset_from_Phdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::elf_get_offset_from_Phdrs </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07631">7631</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7632</span>{</div>
<div class="line"><span class="lineno"> 7633</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = phdr0;</div>
<div class="line"><span class="lineno"> 7634</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>;</div>
<div class="line"><span class="lineno"> 7635</span>    <span class="keywordflow">for</span> (; --j&gt;=0; ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7636</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> t = addr - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7637</span>        <span class="keywordflow">if</span> (t &lt; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>)) {</div>
<div class="line"><span class="lineno"> 7638</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7639</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= p_offset) { <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 7640</span>                <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 7641</span>                    <span class="stringliteral">&quot;bad Elf32_Phdr[%d].p_offset %x&quot;</span>,</div>
<div class="line"><span class="lineno"> 7642</span>                    -1+ <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - j, p_offset);</div>
<div class="line"><span class="lineno"> 7643</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7644</span>            }</div>
<div class="line"><span class="lineno"> 7645</span>            <span class="keywordflow">return</span> t + p_offset;</div>
<div class="line"><span class="lineno"> 7646</span>        }</div>
<div class="line"><span class="lineno"> 7647</span>    }</div>
<div class="line"><span class="lineno"> 7648</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7649</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_cgraph" id="aclassPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_cgraph">
<area shape="rect" title=" " alt="" coords="5,26,180,66"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="415,5,544,31"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="228,26,367,66"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="238,91,357,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_icgraph" id="aclassPackLinuxElf32_aa0fe8832b28a69327c9c65628f13dc53_icgraph">
<area shape="rect" title=" " alt="" coords="1613,254,1788,294"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="1375,254,1565,294"/>
<area shape="rect" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe" title=" " alt="" coords="1180,82,1327,122"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,260,417,285"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="1181,282,1326,322"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,253,1132,293"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="965,5,1132,31"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,253,188,293"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,195,917,235"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,310,893,350"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="977,370,1121,410"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,235,671,260"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,170,676,210"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,106,675,146"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,359,658,384"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="749,374,893,414"/>
</map>
</div>

</div>
</div>
<a id="a7c2f68dcc6a3caecbcb5cf7ad6e7866a" name="a7c2f68dcc6a3caecbcb5cf7ad6e7866a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2f68dcc6a3caecbcb5cf7ad6e7866a">&#9670;&#160;</a></span>elf_has_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> const  * PackLinuxElf32::elf_has_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07672">7672</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7673</span>{</div>
<div class="line"><span class="lineno"> 7674</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>;</div>
<div class="line"><span class="lineno"> 7675</span>    <span class="keywordflow">if</span> (dynp)</div>
<div class="line"><span class="lineno"> 7676</span>    <span class="keywordflow">for</span> (; Elf32_Dyn::DT_NULL!=dynp-&gt;d_tag; ++dynp) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_tag)==key) {</div>
<div class="line"><span class="lineno"> 7677</span>        <span class="keywordflow">return</span> dynp;</div>
<div class="line"><span class="lineno"> 7678</span>    }</div>
<div class="line"><span class="lineno"> 7679</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7680</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, and <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_cgraph" id="aclassPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_icgraph" id="aclassPackLinuxElf32_a7c2f68dcc6a3caecbcb5cf7ad6e7866a_icgraph">
<area shape="rect" title=" " alt="" coords="465,5,611,45"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="aa1d8db1d83d751bf6acfdde1045403ad" name="aa1d8db1d83d751bf6acfdde1045403ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1d8db1d83d751bf6acfdde1045403ad">&#9670;&#160;</a></span>elf_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> const  * PackLinuxElf32::elf_lookup </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08159">8159</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8160</span>{</div>
<div class="line"><span class="lineno"> 8161</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>) {</div>
<div class="line"><span class="lineno"> 8162</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> nbucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8163</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>[2];</div>
<div class="line"><span class="lineno"> 8164</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> chains = &amp;buckets[nbucket];</div>
<div class="line"><span class="lineno"> 8165</span>        <span class="keywordflow">if</span> (nbucket) {</div>
<div class="line"><span class="lineno"> 8166</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> m = <a class="code hl_function" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">elf_hash</a>(name) % nbucket;</div>
<div class="line"><span class="lineno"> 8167</span>            <span class="keywordtype">unsigned</span> nvisit = 0;</div>
<div class="line"><span class="lineno"> 8168</span>            <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>;</div>
<div class="line"><span class="lineno"> 8169</span>            <span class="keywordflow">for</span> (<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>= <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[m]); <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>; ) {</div>
<div class="line"><span class="lineno"> 8170</span>                <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> p= <a class="code hl_function" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name</a>(<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>, (<span class="keywordtype">unsigned</span>)-1);</div>
<div class="line"><span class="lineno"> 8171</span>                <span class="keywordflow">if</span> (p &amp;&amp; 0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, p)) {</div>
<div class="line"><span class="lineno"> 8172</span>                    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>];</div>
<div class="line"><span class="lineno"> 8173</span>                }</div>
<div class="line"><span class="lineno"> 8174</span>                <span class="keywordflow">if</span> (nbucket &lt;= ++nvisit) {</div>
<div class="line"><span class="lineno"> 8175</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;circular DT_HASH chain %d\n&quot;</span>, <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>);</div>
<div class="line"><span class="lineno"> 8176</span>                }</div>
<div class="line"><span class="lineno"> 8177</span>                <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>= <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;chains[<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>]);</div>
<div class="line"><span class="lineno"> 8178</span>                <span class="keywordflow">if</span> (nbucket &lt;= <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>) { <span class="comment">// bad hashtab</span></div>
<div class="line"><span class="lineno"> 8179</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8180</span>                }</div>
<div class="line"><span class="lineno"> 8181</span>            }</div>
<div class="line"><span class="lineno"> 8182</span>        }</div>
<div class="line"><span class="lineno"> 8183</span>    }</div>
<div class="line"><span class="lineno"> 8184</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>) {</div>
<div class="line"><span class="lineno"> 8185</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8186</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symbias  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[1]);</div>
<div class="line"><span class="lineno"> 8187</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bitmask = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[2]);</div>
<div class="line"><span class="lineno"> 8188</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> gnu_shift = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[3]);</div>
<div class="line"><span class="lineno"> 8189</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> bitmask = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[4];</div>
<div class="line"><span class="lineno"> 8190</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;bitmask[n_bitmask];</div>
<div class="line"><span class="lineno"> 8191</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> hasharr = &amp;buckets[n_bucket];</div>
<div class="line"><span class="lineno"> 8192</span>        <span class="keywordflow">if</span> (31 &lt; gnu_shift) {</div>
<div class="line"><span class="lineno"> 8193</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_shift %#x&quot;</span>, gnu_shift);</div>
<div class="line"><span class="lineno"> 8194</span>        }</div>
<div class="line"><span class="lineno"> 8195</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) &lt;= (<span class="keywordtype">void</span> <span class="keyword">const</span> *)hasharr) {</div>
<div class="line"><span class="lineno"> 8196</span>            <span class="keywordtype">char</span> msg[80]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 8197</span>                <span class="stringliteral">&quot;bad n_bucket %#x\n&quot;</span>, n_bucket);</div>
<div class="line"><span class="lineno"> 8198</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 8199</span>        }</div>
<div class="line"><span class="lineno"> 8200</span>        <span class="keywordflow">if</span> (!n_bitmask</div>
<div class="line"><span class="lineno"> 8201</span>        || (<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)bitmask - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 8202</span>                &lt;= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*n_bitmask ) {</div>
<div class="line"><span class="lineno"> 8203</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bitmask %#x\n&quot;</span>, n_bitmask);</div>
<div class="line"><span class="lineno"> 8204</span>        }</div>
<div class="line"><span class="lineno"> 8205</span>        <span class="keywordflow">if</span> (n_bucket) {</div>
<div class="line"><span class="lineno"> 8206</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> h = <a class="code hl_function" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">gnu_hash</a>(name);</div>
<div class="line"><span class="lineno"> 8207</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hbit1 = 037&amp; h;</div>
<div class="line"><span class="lineno"> 8208</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hbit2 = 037&amp; (h&gt;&gt;gnu_shift);</div>
<div class="line"><span class="lineno"> 8209</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bitmask[(n_bitmask -1) &amp; (h&gt;&gt;5)]);</div>
<div class="line"><span class="lineno"> 8210</span> </div>
<div class="line"><span class="lineno"> 8211</span>            <span class="keywordflow">if</span> (1&amp; (w&gt;&gt;hbit1) &amp; (w&gt;&gt;hbit2)) {</div>
<div class="line"><span class="lineno"> 8212</span>                <span class="keywordtype">unsigned</span> bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[h % n_bucket]);</div>
<div class="line"><span class="lineno"> 8213</span>                <span class="keywordflow">if</span> (n_bucket &lt;= bucket) {</div>
<div class="line"><span class="lineno"> 8214</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH n_bucket{%#x} &lt;= buckets[%d]{%#x}\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 8215</span>                            n_bucket, h % n_bucket, bucket);</div>
<div class="line"><span class="lineno"> 8216</span>                }</div>
<div class="line"><span class="lineno"> 8217</span>                <span class="keywordflow">if</span> (0!=bucket) {</div>
<div class="line"><span class="lineno"> 8218</span>                    <a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> <span class="keyword">const</span> *dsp = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[bucket];</div>
<div class="line"><span class="lineno"> 8219</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *hp = &amp;hasharr[bucket - symbias];</div>
<div class="line"><span class="lineno"> 8220</span>                    <span class="keywordflow">do</span> <span class="keywordflow">if</span> (0==((h ^ <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(hp))&gt;&gt;1)) {</div>
<div class="line"><span class="lineno"> 8221</span>                        <span class="keywordtype">unsigned</span> st_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dsp-&gt;st_name);</div>
<div class="line"><span class="lineno"> 8222</span>                        <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> p = <a class="code hl_function" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name</a>(st_name, (<span class="keywordtype">unsigned</span>)-1);</div>
<div class="line"><span class="lineno"> 8223</span>                        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, p)) {</div>
<div class="line"><span class="lineno"> 8224</span>                            <span class="keywordflow">return</span> dsp;</div>
<div class="line"><span class="lineno"> 8225</span>                        }</div>
<div class="line"><span class="lineno"> 8226</span>                    } <span class="keywordflow">while</span> (++dsp,</div>
<div class="line"><span class="lineno"> 8227</span>                        ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)hp &lt; (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 8228</span>                        &amp;&amp;  0==(1u&amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(hp++)));</div>
<div class="line"><span class="lineno"> 8229</span>                }</div>
<div class="line"><span class="lineno"> 8230</span>            }</div>
<div class="line"><span class="lineno"> 8231</span>        }</div>
<div class="line"><span class="lineno"> 8232</span>    }</div>
<div class="line"><span class="lineno"> 8233</span>    <span class="comment">// 2021-12-25  FIXME: Some Rust programs use</span></div>
<div class="line"><span class="lineno"> 8234</span>    <span class="comment">//    (1==n_bucket &amp;&amp; 0==buckets[0] &amp;&amp; 1==n_bitmask &amp;&amp; 0==bitmask[0])</span></div>
<div class="line"><span class="lineno"> 8235</span>    <span class="comment">// to minimize space in DT_GNU_HASH. This causes the fancy lookup to fail.</span></div>
<div class="line"><span class="lineno"> 8236</span>    <span class="comment">// Is a fallback to linear search assumed?</span></div>
<div class="line"><span class="lineno"> 8237</span>    <span class="comment">// 2022-03-12  Some Rust programs have 0==n_bucket.</span></div>
<div class="line"><span class="lineno"> 8238</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8239</span> </div>
<div class="line"><span class="lineno"> 8240</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a504fe912dd96ebfcd443b89dd425317f"><div class="ttname"><a href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">PackLinuxElf::gnu_hash</a></div><div class="ttdeci">static unsigned gnu_hash(char const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08134">p_lx_elf.cpp:8134</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a9cdb0429d3e2faba00ef2d67b2c628c0"><div class="ttname"><a href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">PackLinuxElf::elf_hash</a></div><div class="ttdeci">static unsigned elf_hash(char const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08145">p_lx_elf.cpp:8145</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a9bd631b0b513dae0e31c1042265af539"><div class="ttname"><a href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov si</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00258">lzma_m.h:258</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>, <a class="el" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">PackLinuxElf::elf_hash()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>, <a class="el" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name()</a>, <a class="el" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">PackLinuxElf::gnu_hash()</a>, <a class="el" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>, <a class="el" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_cgraph" id="aclassPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_cgraph">
<area shape="rect" title=" " alt="" coords="5,163,151,203"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="202,5,369,31"/>
<area shape="rect" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd" title=" " alt="" coords="211,106,360,146"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="420,106,569,146"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="617,168,736,193"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="430,171,559,196"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="199,272,372,297"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="252,345,319,371"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_icgraph" id="aclassPackLinuxElf32_aa1d8db1d83d751bf6acfdde1045403ad_icgraph">
<area shape="rect" title=" " alt="" coords="965,63,1111,103"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,63,917,103"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,13,671,38"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,63,676,103"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,127,675,167"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="a3cc398e82caa74060ec330d678f7e142" name="a3cc398e82caa74060ec330d678f7e142"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cc398e82caa74060ec330d678f7e142">&#9670;&#160;</a></span>elf_unsigned_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf32::elf_unsigned_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#ac7cb95fd27c29245be62f4e388fc3f09">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07778">7778</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7779</span>{</div>
<div class="line"><span class="lineno"> 7780</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_function" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr</a>(key);</div>
<div class="line"><span class="lineno"> 7781</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 7782</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_val);</div>
<div class="line"><span class="lineno"> 7783</span>    }</div>
<div class="line"><span class="lineno"> 7784</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7785</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr()</a>, and <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">sort_DT32_offsets()</a>, <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>, and <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_cgraph" id="aclassPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,156,75"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="204,5,349,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="397,42,527,67"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_icgraph" id="aclassPackLinuxElf32_a3cc398e82caa74060ec330d678f7e142_icgraph">
<area shape="rect" title=" " alt="" coords="1395,190,1545,230"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,46,417,72"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="1191,132,1336,172"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,151,1132,191"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,275,893,315"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,310,658,336"/>
<area shape="rect" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c" title=" " alt="" coords="1180,298,1347,324"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="1187,68,1340,108"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,39,188,79"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,124,917,164"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,46,671,72"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,96,676,136"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,160,675,200"/>
</map>
</div>

</div>
</div>
<a id="ae126d225cb28e675a4261204a3872e2c" name="ae126d225cb28e675a4261204a3872e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae126d225cb28e675a4261204a3872e2c">&#9670;&#160;</a></span>find_dt_ndx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::find_dt_ndx </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>rva</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02049">2049</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2050</span>{</div>
<div class="line"><span class="lineno"> 2051</span>    <span class="keywordtype">unsigned</span> *<span class="keyword">const</span> dto = (<span class="keywordtype">unsigned</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 2052</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> dto_size = <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() / <span class="keyword">sizeof</span>(*dto);</div>
<div class="line"><span class="lineno"> 2053</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; dto_size &amp;&amp; dto[j]; ++j) { <span class="comment">// linear search of short table</span></div>
<div class="line"><span class="lineno"> 2054</span>        <span class="keywordflow">if</span> (rva == dto[j]) {</div>
<div class="line"><span class="lineno"> 2055</span>            <span class="keywordflow">return</span> j;</div>
<div class="line"><span class="lineno"> 2056</span>        }</div>
<div class="line"><span class="lineno"> 2057</span>    }</div>
<div class="line"><span class="lineno"> 2058</span>    <span class="keywordflow">return</span> ~0u;</div>
<div class="line"><span class="lineno"> 2059</span>}</div>
<div class="ttc" id="aclassMemBuffer_html_a50cf45756c991e8d65a6b90b8e6a5be2"><div class="ttname"><a href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr</a></div><div class="ttdeci">void * getVoidPtr() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00205">membuffer.h:205</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a834063e926d1118a24f23a8106edcd4e"><div class="ttname"><a href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a></div><div class="ttdeci">MemBuffer mb_dt_offsets</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00085">p_lx_elf.h:85</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, and <a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_cgraph" id="aclassPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,157,63"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="215,5,365,31"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="205,55,375,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_icgraph" id="aclassPackLinuxElf32_ae126d225cb28e675a4261204a3872e2c_icgraph">
<area shape="rect" title=" " alt="" coords="1373,88,1525,128"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="1180,88,1325,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,88,1132,128"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,88,917,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,180,893,220"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,38,671,63"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,88,676,128"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,152,675,192"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,217,658,242"/>
</map>
</div>

</div>
</div>
<a id="a26ea5f1df204c3f64aa7d4bea4da1dd2" name="a26ea5f1df204c3f64aa7d4bea4da1dd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26ea5f1df204c3f64aa7d4bea4da1dd2">&#9670;&#160;</a></span>find_LOAD_gap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::find_LOAD_gap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *const&#160;</td>
          <td class="paramname"><em>phdri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04949">4949</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4954</span>{</div>
<div class="line"><span class="lineno"> 4955</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(&amp;phdr[k])) {</div>
<div class="line"><span class="lineno"> 4956</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 4957</span>    }</div>
<div class="line"><span class="lineno"> 4958</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hi = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[k].p_offset) +</div>
<div class="line"><span class="lineno"> 4959</span>                        <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[k].p_filesz);</div>
<div class="line"><span class="lineno"> 4960</span>    <span class="keywordtype">unsigned</span> lo = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">u_file_size</a>;</div>
<div class="line"><span class="lineno"> 4961</span>    <span class="keywordflow">if</span> (lo &lt; hi)</div>
<div class="line"><span class="lineno"> 4962</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad input: PT_LOAD beyond end-of-file&quot;</span>);</div>
<div class="line"><span class="lineno"> 4963</span>    <span class="keywordtype">unsigned</span> j = k;</div>
<div class="line"><span class="lineno"> 4964</span>    <span class="keywordflow">for</span> (;;) { <span class="comment">// circular search, optimize for adjacent ascending</span></div>
<div class="line"><span class="lineno"> 4965</span>        ++j;</div>
<div class="line"><span class="lineno"> 4966</span>        <span class="keywordflow">if</span> (nph==j) {</div>
<div class="line"><span class="lineno"> 4967</span>            j = 0;</div>
<div class="line"><span class="lineno"> 4968</span>        }</div>
<div class="line"><span class="lineno"> 4969</span>        <span class="keywordflow">if</span> (k==j) {</div>
<div class="line"><span class="lineno"> 4970</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4971</span>        }</div>
<div class="line"><span class="lineno"> 4972</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(&amp;phdr[j])) {</div>
<div class="line"><span class="lineno"> 4973</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> t = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_offset);</div>
<div class="line"><span class="lineno"> 4974</span>            <span class="keywordflow">if</span> ((t - hi) &lt; (lo - hi)) {</div>
<div class="line"><span class="lineno"> 4975</span>                lo = t;</div>
<div class="line"><span class="lineno"> 4976</span>                <span class="keywordflow">if</span> (hi==lo) {</div>
<div class="line"><span class="lineno"> 4977</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4978</span>                }</div>
<div class="line"><span class="lineno"> 4979</span>            }</div>
<div class="line"><span class="lineno"> 4980</span>        }</div>
<div class="line"><span class="lineno"> 4981</span>    }</div>
<div class="line"><span class="lineno"> 4982</span>    <span class="keywordflow">return</span> lo - hi;</div>
<div class="line"><span class="lineno"> 4983</span>}</div>
<div class="ttc" id="astructPackHeader_html_ae3a40ba7325ebc8b86301bc9e7c5d3d6"><div class="ttname"><a href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a></div><div class="ttdeci">unsigned u_file_size</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00058">packhead.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, and <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_cgraph" id="aclassPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_cgraph">
<area shape="rect" title=" " alt="" coords="5,26,157,66"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="392,5,521,31"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="205,26,344,66"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="215,91,334,116"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_icgraph" id="aclassPackLinuxElf32_a26ea5f1df204c3f64aa7d4bea4da1dd2_icgraph">
<area shape="rect" title=" " alt="" coords="228,47,380,87"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="9,5,176,31"/>
<area shape="rect" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c" title=" " alt="" coords="9,55,176,80"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,104,180,129"/>
</map>
</div>

</div>
</div>
<a id="a4b9fc35299e310d90855abb422cd660a" name="a4b9fc35299e310d90855abb422cd660a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b9fc35299e310d90855abb422cd660a">&#9670;&#160;</a></span>forward_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::forward_Shdrs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>ehdro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05603">5603</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5604</span>{</div>
<div class="line"><span class="lineno"> 5605</span>    <span class="keywordflow">if</span> (!fo) {</div>
<div class="line"><span class="lineno"> 5606</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 5607</span>    }</div>
<div class="line"><span class="lineno"> 5608</span>    <span class="keywordtype">unsigned</span> penalty = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 5609</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a>) { <span class="comment">// Forward select _Shdr</span></div>
<div class="line"><span class="lineno"> 5610</span>        <span class="comment">// Keep _Shdr for rtld data (below xct_off).</span></div>
<div class="line"><span class="lineno"> 5611</span>        <span class="comment">// Discard _Shdr for compressed regions, except &quot;.text&quot; for gdb.</span></div>
<div class="line"><span class="lineno"> 5612</span>        <span class="comment">// Keep _Shdr for SHF_WRITE.</span></div>
<div class="line"><span class="lineno"> 5613</span>        <span class="comment">// Discard _Shdr with (0==sh_addr), except _Shdr[0]</span></div>
<div class="line"><span class="lineno"> 5614</span>        <span class="comment">// Keep ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 5615</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> want_types_mask =</div>
<div class="line"><span class="lineno"> 5616</span>              1u&lt;&lt;SHT_SYMTAB</div>
<div class="line"><span class="lineno"> 5617</span>            | 1u&lt;&lt;SHT_RELA</div>
<div class="line"><span class="lineno"> 5618</span>            | 1u&lt;&lt;SHT_PROGBITS  <span class="comment">// see comment above</span></div>
<div class="line"><span class="lineno"> 5619</span>            | 1u&lt;&lt;SHT_HASH</div>
<div class="line"><span class="lineno"> 5620</span>            | 1u&lt;&lt;SHT_DYNAMIC</div>
<div class="line"><span class="lineno"> 5621</span>            | 1u&lt;&lt;SHT_NOTE</div>
<div class="line"><span class="lineno"> 5622</span>            | 1u&lt;&lt;SHT_REL</div>
<div class="line"><span class="lineno"> 5623</span>            | 1u&lt;&lt;SHT_DYNSYM</div>
<div class="line"><span class="lineno"> 5624</span>            | 1u&lt;&lt;SHT_STRTAB  <span class="comment">// .shstrtab and .dynstr</span></div>
<div class="line"><span class="lineno"> 5625</span>            | 1u&lt;&lt;SHT_INIT_ARRAY</div>
<div class="line"><span class="lineno"> 5626</span>            | 1u&lt;&lt;SHT_FINI_ARRAY</div>
<div class="line"><span class="lineno"> 5627</span>            | 1u&lt;&lt;SHT_PREINIT_ARRAY</div>
<div class="line"><span class="lineno"> 5628</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_versym)</div>
<div class="line"><span class="lineno"> 5629</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_verneed)</div>
<div class="line"><span class="lineno"> 5630</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_verdef)</div>
<div class="line"><span class="lineno"> 5631</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 5632</span> </div>
<div class="line"><span class="lineno"> 5633</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> xct_off_hi = 0;</div>
<div class="line"><span class="lineno"> 5634</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, *ptr_end = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>];</div>
<div class="line"><span class="lineno"> 5635</span>        <span class="keywordflow">for</span> (; <a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> &lt; ptr_end; ++<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>) {</div>
<div class="line"><span class="lineno"> 5636</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_type)) {</div>
<div class="line"><span class="lineno"> 5637</span>                <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> hi = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_filesz)</div>
<div class="line"><span class="lineno"> 5638</span>                    + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 5639</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; hi) {</div>
<div class="line"><span class="lineno"> 5640</span>                    xct_off_hi = hi;</div>
<div class="line"><span class="lineno"> 5641</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5642</span>                }</div>
<div class="line"><span class="lineno"> 5643</span>            }</div>
<div class="line"><span class="lineno"> 5644</span>        }</div>
<div class="line"><span class="lineno"> 5645</span> </div>
<div class="line"><span class="lineno"> 5646</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_ask_for(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(eho-&gt;e_shnum));</div>
<div class="line"><span class="lineno"> 5647</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(mb_ask_for, 0, mb_ask_for.getSize());</div>
<div class="line"><span class="lineno"> 5648</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *<span class="keyword">const</span> ask_for = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)mb_ask_for.getVoidPtr();</div>
<div class="line"><span class="lineno"> 5649</span> </div>
<div class="line"><span class="lineno"> 5650</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_shdro(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>));</div>
<div class="line"><span class="lineno"> 5651</span>        <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *sh_out0 = (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)mb_shdro.getVoidPtr();</div>
<div class="line"><span class="lineno"> 5652</span>        <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *sh_out = sh_out0;</div>
<div class="line"><span class="lineno"> 5653</span>        <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *sh_in = <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>;</div>
<div class="line"><span class="lineno"> 5654</span> </div>
<div class="line"><span class="lineno"> 5655</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(sh_out, 0, <span class="keyword">sizeof</span>(*sh_out));  <span class="comment">// blank sh_out[0]</span></div>
<div class="line"><span class="lineno"> 5656</span>        ++sh_in; ++sh_out; <span class="keywordtype">unsigned</span> n_sh_out = 1;</div>
<div class="line"><span class="lineno"> 5657</span> </div>
<div class="line"><span class="lineno"> 5658</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 1; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++j, ++sh_in) {</div>
<div class="line"><span class="lineno"> 5659</span>            <span class="keywordtype">unsigned</span> sh_type   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 5660</span>            <span class="keywordtype">unsigned</span> sh_info   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_info);</div>
<div class="line"><span class="lineno"> 5661</span>            <span class="keywordtype">unsigned</span> sh_flags  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_flags);</div>
<div class="line"><span class="lineno"> 5662</span>            <span class="keywordtype">unsigned</span> sh_addr   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 5663</span>            <span class="keywordtype">unsigned</span> sh_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 5664</span>            <span class="keywordtype">unsigned</span> sh_size   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 5665</span>            <span class="keywordflow">if</span> (ask_for[j]) { <span class="comment">// Some previous _Shdr requested  me</span></div>
<div class="line"><span class="lineno"> 5666</span>                <span class="comment">// Tell them my new index</span></div>
<div class="line"><span class="lineno"> 5667</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out0[ask_for[j]].sh_info, n_sh_out);  <span class="comment">// sh_info vs st_shndx</span></div>
<div class="line"><span class="lineno"> 5668</span>            }</div>
<div class="line"><span class="lineno"> 5669</span>            <span class="keywordflow">if</span> (sh_info &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) { <span class="comment">// wild sh_info abounds!</span></div>
<div class="line"><span class="lineno"> 5670</span>                ask_for[sh_info] = j;  <span class="comment">// Enter my request, if any</span></div>
<div class="line"><span class="lineno"> 5671</span>            }</div>
<div class="line"><span class="lineno"> 5672</span>            <span class="keywordflow">if</span> (   (sh_offset &amp;&amp; sh_offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>)</div>
<div class="line"><span class="lineno"> 5673</span>                || (Elf32_Shdr::SHF_WRITE &amp; sh_flags)</div>
<div class="line"><span class="lineno"> 5674</span>                || (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>)</div>
<div class="line"><span class="lineno"> 5675</span>                || (<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a> == sh_in)</div>
<div class="line"><span class="lineno"> 5676</span>                || (want_types_mask &amp; (1&lt;&lt;(0x1f &amp; sh_type)))</div>
<div class="line"><span class="lineno"> 5677</span>            ) {</div>
<div class="line"><span class="lineno"> 5678</span>                *sh_out = *sh_in;</div>
<div class="line"><span class="lineno"> 5679</span>                <span class="keywordflow">if</span> (sh_offset &gt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// may slide down: earlier compression</span></div>
<div class="line"><span class="lineno"> 5680</span>                    <span class="keywordflow">if</span> (sh_offset &gt;= xct_off_hi) { <span class="comment">// easy: so_slide down</span></div>
<div class="line"><span class="lineno"> 5681</span>                        <span class="keywordflow">if</span> (sh_out-&gt;sh_addr) <span class="comment">// change only if non-zero</span></div>
<div class="line"><span class="lineno"> 5682</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_addr,   <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_addr);</div>
<div class="line"><span class="lineno"> 5683</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 5684</span>                    }</div>
<div class="line"><span class="lineno"> 5685</span>                    <span class="keywordflow">else</span> { <span class="comment">// somewhere in compressed; try proportional (aligned)</span></div>
<div class="line"><span class="lineno"> 5686</span>                        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> <span class="keyword">const</span> slice = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + (~0xFu &amp; (unsigned)(</div>
<div class="line"><span class="lineno"> 5687</span>                             (sh_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) *</div>
<div class="line"><span class="lineno"> 5688</span>                            ((sh_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) / (<span class="keywordtype">float</span>)(xct_off_hi - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>))));</div>
<div class="line"><span class="lineno"> 5689</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_addr,   slice);</div>
<div class="line"><span class="lineno"> 5690</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_offset, slice);</div>
<div class="line"><span class="lineno"> 5691</span>                    }</div>
<div class="line"><span class="lineno"> 5692</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> <span class="keyword">const</span> max_sz = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_out-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 5693</span>                    <span class="keywordflow">if</span> (sh_size &gt; max_sz) { <span class="comment">// avoid complaint &quot;extends beyond EOF&quot;</span></div>
<div class="line"><span class="lineno"> 5694</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_size, max_sz);</div>
<div class="line"><span class="lineno"> 5695</span>                    }</div>
<div class="line"><span class="lineno"> 5696</span>                }</div>
<div class="line"><span class="lineno"> 5697</span>                <span class="keywordflow">if</span> (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) { <span class="comment">// changes Elf32_Ehdr itself</span></div>
<div class="line"><span class="lineno"> 5698</span>                    <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shstrndx, sh_out -</div>
<div class="line"><span class="lineno"> 5699</span>                        (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)mb_shdro.getVoidPtr());</div>
<div class="line"><span class="lineno"> 5700</span>                }</div>
<div class="line"><span class="lineno"> 5701</span>                <span class="keywordflow">if</span> (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></div>
<div class="line"><span class="lineno"> 5702</span>                ||  <a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a> == sh_in</div>
<div class="line"><span class="lineno"> 5703</span>                ||  (SHT_NOTE == sh_type &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_offset)</div>
<div class="line"><span class="lineno"> 5704</span>                ) { <span class="comment">// append a copy</span></div>
<div class="line"><span class="lineno"> 5705</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5706</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>((<a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>)sh_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5707</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>,  sh_size);</div>
<div class="line"><span class="lineno"> 5708</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sh_size);</div>
<div class="line"><span class="lineno"> 5709</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> +=    sh_size;</div>
<div class="line"><span class="lineno"> 5710</span>                } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5711</span>                <span class="keywordflow">if</span> (SHT_PROGBITS == sh_type) {</div>
<div class="line"><span class="lineno"> 5712</span>                    <span class="keywordflow">if</span> (sh_offset &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 5713</span>                    &amp;&amp;  0 == <a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.text&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_name)) ) {</div>
<div class="line"><span class="lineno"> 5714</span>                        <span class="comment">// .text was compressed (but perhaps omitting some leading</span></div>
<div class="line"><span class="lineno"> 5715</span>                        <span class="comment">// portion, if less than 4 PT_LOAD)</span></div>
<div class="line"><span class="lineno"> 5716</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_size, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_size);</div>
<div class="line"><span class="lineno"> 5717</span>                    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5718</span>                    <span class="keywordflow">if</span> (0 == sh_in-&gt;sh_addr) { <span class="comment">// .gnu_debuglink etc</span></div>
<div class="line"><span class="lineno"> 5719</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 5720</span>                    }</div>
<div class="line"><span class="lineno"> 5721</span>                }</div>
<div class="line"><span class="lineno"> 5722</span>                ++sh_out; ++n_sh_out;</div>
<div class="line"><span class="lineno"> 5723</span>            }</div>
<div class="line"><span class="lineno"> 5724</span>        }</div>
<div class="line"><span class="lineno"> 5725</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5726</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;eho-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5727</span>        <span class="keywordtype">unsigned</span> len = (<span class="keywordtype">char</span> *)sh_out - (<span class="keywordtype">char</span> *)mb_shdro.getVoidPtr();</div>
<div class="line"><span class="lineno"> 5728</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shnum, len / <span class="keyword">sizeof</span>(*sh_out));</div>
<div class="line"><span class="lineno"> 5729</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 5730</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(mb_shdro, len);</div>
<div class="line"><span class="lineno"> 5731</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 5732</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5733</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(*eho));</div>
<div class="line"><span class="lineno"> 5734</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 5735</span>    }</div>
<div class="line"><span class="lineno"> 5736</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>) {</div>
<div class="line"><span class="lineno"> 5737</span>        <span class="comment">// Forward just ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 5738</span>        <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> shdr_aa[3];</div>
<div class="line"><span class="lineno"> 5739</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> attr_len = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 5740</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> str_aa[] = <span class="stringliteral">&quot;\x00&quot;</span> <span class="stringliteral">&quot;.shstrtab\x00&quot;</span> <span class="stringliteral">&quot;.ARM.attributes\x00&quot;</span>;</div>
<div class="line"><span class="lineno"> 5741</span> </div>
<div class="line"><span class="lineno"> 5742</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(shdr_aa, 0, <span class="keyword">sizeof</span> shdr_aa);</div>
<div class="line"><span class="lineno"> 5743</span>            <span class="comment">// shstrtab</span></div>
<div class="line"><span class="lineno"> 5744</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_name, 1);</div>
<div class="line"><span class="lineno"> 5745</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_type, Elf32_Shdr::SHT_STRTAB);</div>
<div class="line"><span class="lineno"> 5746</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5747</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_size, <span class="keyword">sizeof</span>(str_aa));</div>
<div class="line"><span class="lineno"> 5748</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_addralign, 1);</div>
<div class="line"><span class="lineno"> 5749</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(str_aa, <span class="keyword">sizeof</span>(str_aa)); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(str_aa);</div>
<div class="line"><span class="lineno"> 5750</span> </div>
<div class="line"><span class="lineno"> 5751</span>            <span class="comment">// ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 5752</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_name, 11);</div>
<div class="line"><span class="lineno"> 5753</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_type, Elf32_Shdr::SHT_ARM_ATTRIBUTES);</div>
<div class="line"><span class="lineno"> 5754</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5755</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_size, attr_len);</div>
<div class="line"><span class="lineno"> 5756</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_addralign, 1);</div>
<div class="line"><span class="lineno"> 5757</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>-&gt;sh_offset)], attr_len);</div>
<div class="line"><span class="lineno"> 5758</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += attr_len);</div>
<div class="line"><span class="lineno"> 5759</span> </div>
<div class="line"><span class="lineno"> 5760</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shnum, 3);</div>
<div class="line"><span class="lineno"> 5761</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 5762</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;eho-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5763</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shstrndx, 1);</div>
<div class="line"><span class="lineno"> 5764</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(shdr_aa, <span class="keyword">sizeof</span>(shdr_aa));</div>
<div class="line"><span class="lineno"> 5765</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(shdr_aa);</div>
<div class="line"><span class="lineno"> 5766</span> </div>
<div class="line"><span class="lineno"> 5767</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5768</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(*eho));</div>
<div class="line"><span class="lineno"> 5769</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 5770</span>    }</div>
<div class="line"><span class="lineno"> 5771</span>    penalty = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - penalty;</div>
<div class="line"><span class="lineno"> 5772</span>    <a class="code hl_function" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a>(<span class="stringliteral">&quot;Android penalty = %d bytes&quot;</span>, penalty);</div>
<div class="line"><span class="lineno"> 5773</span>    <span class="keywordflow">return</span> penalty;</div>
<div class="line"><span class="lineno"> 5774</span>}</div>
<div class="ttc" id="aclassInputFile_html_ae6797787eefa57fdc7191461a47109f6"><div class="ttname"><a href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read</a></div><div class="ttdeci">int read(SPAN_P(void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00190">file.cpp:190</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a6dcc27c7627119f073cf47775984fcad"><div class="ttname"><a href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite</a></div><div class="ttdeci">void rewrite(SPAN_P(const void) buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00314">file.cpp:314</a></div></div>
<div class="ttc" id="aclassPacker_html_a860499fa0849a7c7a7c4d43ee084f76e"><div class="ttname"><a href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16</a></div><div class="ttdeci">void set_te16(void *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00264">packer.h:264</a></div></div>
<div class="ttc" id="aclassPacker_html_a95d40264330fe966e66718440b450ec8"><div class="ttname"><a href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a></div><div class="ttdeci">MemBuffer ibuf</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00321">packer.h:321</a></div></div>
<div class="ttc" id="aconf_8h_html_a7e40dc9a8b2c00d7675df0cd2bd7c91e"><div class="ttname"><a href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a></div><div class="ttdeci">long long upx_off_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00199">conf.h:199</a></div></div>
<div class="ttc" id="alinux_8h_html_ad2a2e6c114780c3071efd24f16c7f7d8"><div class="ttname"><a href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a></div><div class="ttdeci">#define SEEK_END</div><div class="ttdef"><b>Definition:</b> <a href="linux_8h_source.html#l00111">linux.h:111</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a7b01bc9a5d719e0ece76d9b8dd822dde"><div class="ttname"><a href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov cx endm macro M_shld_diax_8_bxcx mov di mov bl mov ah mov al xor al mov bx endm macro M_shld_8_bp h l mov word ptr[bp+h] mov word ptr[bp+l] M_shld_8 mov word ptr[bp+h]</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00292">lzma_m.h:292</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a961610ff2ac229f29f7d03d3a2ccc084"><div class="ttname"><a href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a></div><div class="ttdeci">static off_t fpad4(OutputFile *fo, unsigned pos)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00099">p_lx_elf.cpp:99</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#ab53c709a841960e499da68e2316ed428">Elf32_Ehdr::e_shentsize</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">Elf32_Ehdr::e_shnum</a>, <a class="el" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_cgraph" id="aclassPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_cgraph">
<area shape="rect" title=" " alt="" coords="5,630,184,670"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="287,460,346,485"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="449,233,580,259"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="252,612,381,637"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="241,661,392,687"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="232,711,401,736"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="293,760,340,785"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="279,833,355,859"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="638,409,753,435"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="245,245,388,271"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="456,637,573,663"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="451,587,579,612"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="253,883,381,908"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="253,932,381,957"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="283,1005,350,1031"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="1003,485,1145,511"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1421,347,1558,372"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="628,157,763,183"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1631,372,1761,397"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="834,283,923,308"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1029,372,1119,397"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="651,108,740,133"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1211,107,1338,132"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="814,157,943,183"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1396,5,1583,31"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1668,5,1724,31"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1011,157,1137,183"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1201,208,1348,233"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1462,208,1517,233"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1419,739,1559,764"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="995,297,1153,337"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1215,357,1334,383"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="637,688,753,713"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="850,789,907,815"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="811,587,947,612"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_icgraph" id="aclassPackLinuxElf32_a4b9fc35299e310d90855abb422cd660a_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,399,45"/>
<area shape="rect" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="aa3a1446667e5e41721ae1ed8d40e3a82" name="aa3a1446667e5e41721ae1ed8d40e3a82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3a1446667e5e41721ae1ed8d40e3a82">&#9670;&#160;</a></span>generateElfHdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::generateElfHdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>brka</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a378dd6608963beeae5bb6393ef4b23d5">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackNetBSDElf32x86.html#a0c62b46de263a0090a154eb0c108c5f2">PackNetBSDElf32x86</a>, and <a class="el" href="classPackOpenBSDElf32x86.html#ab9f48389630e6c44c3580ca1a9c52289">PackOpenBSDElf32x86</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03454">3454</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3459</span>{</div>
<div class="line"><span class="lineno"> 3460</span>    cprElfHdr2 *<span class="keyword">const</span> h2 = (cprElfHdr2 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>;</div>
<div class="line"><span class="lineno"> 3461</span>    cprElfHdr3 *<span class="keyword">const</span> h3 = (cprElfHdr3 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>;</div>
<div class="line"><span class="lineno"> 3462</span>    h3-&gt;ehdr =         ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;ehdr;</div>
<div class="line"><span class="lineno"> 3463</span>    h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>] = ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;phdr[1];  <span class="comment">// .data; .p_align</span></div>
<div class="line"><span class="lineno"> 3464</span>    h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>] = ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;phdr[0];  <span class="comment">// .text</span></div>
<div class="line"><span class="lineno"> 3465</span> </div>
<div class="line"><span class="lineno"> 3466</span>    h3-&gt;ehdr.e_type = <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a>;  <span class="comment">// ET_EXEC vs ET_DYN (gcc -pie -fPIC)</span></div>
<div class="line"><span class="lineno"> 3467</span>    h3-&gt;ehdr.e_ident[Elf32_Ehdr::EI_OSABI] = <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>;</div>
<div class="line"><span class="lineno"> 3468</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::EM_MIPS==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) { <span class="comment">// MIPS R3000  FIXME</span></div>
<div class="line"><span class="lineno"> 3469</span>        h3-&gt;ehdr.e_ident[Elf32_Ehdr::EI_OSABI] = Elf32_Ehdr::ELFOSABI_NONE;</div>
<div class="line"><span class="lineno"> 3470</span>        h3-&gt;ehdr.e_flags = <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">e_flags</a>;</div>
<div class="line"><span class="lineno"> 3471</span>    }</div>
<div class="line"><span class="lineno"> 3472</span> </div>
<div class="line"><span class="lineno"> 3473</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">format</a> != <a class="code hl_function" href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60">getFormat</a>()) {</div>
<div class="line"><span class="lineno"> 3474</span>        assert(<span class="keyword">false</span>);  <span class="comment">// unknown ph.format, PackLinuxElf32</span></div>
<div class="line"><span class="lineno"> 3475</span>    }</div>
<div class="line"><span class="lineno"> 3476</span>    assert(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;h2-&gt;ehdr.e_phoff)     == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 3477</span>    assert(<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_ehsize)    == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 3478</span>    assert(<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_phentsize) == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));</div>
<div class="line"><span class="lineno"> 3479</span> </div>
<div class="line"><span class="lineno"> 3480</span>    h2-&gt;ehdr.e_shoff = 0;</div>
<div class="line"><span class="lineno"> 3481</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a>) {</div>
<div class="line"><span class="lineno"> 3482</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h2-&gt;ehdr.e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 3483</span>        h2-&gt;ehdr.e_shnum = <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a>;</div>
<div class="line"><span class="lineno"> 3484</span>        h2-&gt;ehdr.e_shstrndx = <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a> - 1;</div>
<div class="line"><span class="lineno"> 3485</span>    }</div>
<div class="line"><span class="lineno"> 3486</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3487</span>        <span class="comment">// https://bugzilla.redhat.com/show_bug.cgi?id=2131609</span></div>
<div class="line"><span class="lineno"> 3488</span>        <span class="comment">// 0==.e_shnum is a special case for libbfd</span></div>
<div class="line"><span class="lineno"> 3489</span>        <span class="comment">// that requires 0==.e_shentsize in order to force &quot;no Shdrs&quot;</span></div>
<div class="line"><span class="lineno"> 3490</span>        h2-&gt;ehdr.e_shentsize = 0;</div>
<div class="line"><span class="lineno"> 3491</span>        h2-&gt;ehdr.e_shnum = 0;</div>
<div class="line"><span class="lineno"> 3492</span>        h2-&gt;ehdr.e_shstrndx = 0;</div>
<div class="line"><span class="lineno"> 3493</span>    }</div>
<div class="line"><span class="lineno"> 3494</span> </div>
<div class="line"><span class="lineno"> 3495</span>    <span class="keywordtype">unsigned</span> phnum_o = 2 + <a class="code hl_variable" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>;  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 3496</span>    <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h2-&gt;ehdr.e_phnum, phnum_o);</div>
<div class="line"><span class="lineno"> 3497</span> </div>
<div class="line"><span class="lineno"> 3498</span>    <span class="comment">// Info for OS kernel to set the brk()</span></div>
<div class="line"><span class="lineno"> 3499</span>    <span class="keywordflow">if</span> (brka) {</div>
<div class="line"><span class="lineno"> 3500</span>        <span class="comment">// linux-2.6.14 binfmt_elf.c: SIGKILL if (0==.p_memsz) on a page boundary</span></div>
<div class="line"><span class="lineno"> 3501</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> lo_va_user = ~0u;  <span class="comment">// infinity</span></div>
<div class="line"><span class="lineno"> 3502</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ) {</div>
<div class="line"><span class="lineno"> 3503</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[j])) {</div>
<div class="line"><span class="lineno"> 3504</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> vaddr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[j].p_vaddr);</div>
<div class="line"><span class="lineno"> 3505</span>                lo_va_user = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(lo_va_user, vaddr);</div>
<div class="line"><span class="lineno"> 3506</span>            }</div>
<div class="line"><span class="lineno"> 3507</span>        }</div>
<div class="line"><span class="lineno"> 3508</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(                 &amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr, lo_va_user);</div>
<div class="line"><span class="lineno"> 3509</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_paddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 3510</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 3511</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_paddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 3512</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_type, <a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>);  <span class="comment">// be sure</span></div>
<div class="line"><span class="lineno"> 3513</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_offset = 0;</div>
<div class="line"><span class="lineno"> 3514</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz = 0;</div>
<div class="line"><span class="lineno"> 3515</span>        <span class="comment">// .p_memsz = brka;  temporary until sz_pack2</span></div>
<div class="line"><span class="lineno"> 3516</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_memsz, brka - lo_va_user);</div>
<div class="line"><span class="lineno"> 3517</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, Elf32_Phdr::PF_R | Elf32_Phdr::PF_W);</div>
<div class="line"><span class="lineno"> 3518</span>    }</div>
<div class="line"><span class="lineno"> 3519</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 3520</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 3521</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags, ~Elf32_Phdr::PF_W &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags));</div>
<div class="line"><span class="lineno"> 3522</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(h2, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + 2* <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 3523</span> </div>
<div class="line"><span class="lineno"> 3524</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> zero_pad = 0;</div>
<div class="line"><span class="lineno"> 3525</span>    <span class="keywordtype">unsigned</span> uva0 = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 3526</span>    <span class="keywordtype">unsigned</span> off_o = 0;</div>
<div class="line"><span class="lineno"> 3527</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> phase = 0; phase &lt; 2; ++phase) { <span class="comment">// 0: Phdrs;  1: bodies</span></div>
<div class="line"><span class="lineno"> 3528</span>        off_o = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>);</div>
<div class="line"><span class="lineno"> 3529</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3530</span>            <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> phtmp = *<a class="code hl_variable" href="classPackLinuxElf32.html#af6320858ad11e1f2a16f29d6554fbbca">phdrx</a>[j];</div>
<div class="line"><span class="lineno"> 3531</span>            phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a> = phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">p_paddr</a> = 0;</div>
<div class="line"><span class="lineno"> 3532</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> off_i = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 3533</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> align = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">p_align</a>);</div>
<div class="line"><span class="lineno"> 3534</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 3535</span>            <span class="keywordtype">unsigned</span> pad = 0;</div>
<div class="line"><span class="lineno"> 3536</span>            <span class="keywordflow">if</span> (filesz &amp;&amp; align &amp;&amp; <a class="code hl_function" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a>(align)) {</div>
<div class="line"><span class="lineno"> 3537</span>                <span class="keywordtype">unsigned</span> alm1 = -1 + <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(8u, align);</div>
<div class="line"><span class="lineno"> 3538</span>                pad = alm1 &amp; (0u - off_o);</div>
<div class="line"><span class="lineno"> 3539</span>                off_o += pad;</div>
<div class="line"><span class="lineno"> 3540</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>, off_o + uva0); phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">p_paddr</a> = phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>;</div>
<div class="line"><span class="lineno"> 3541</span>            }</div>
<div class="line"><span class="lineno"> 3542</span>            <span class="keywordflow">if</span> (0==phase) {</div>
<div class="line"><span class="lineno"> 3543</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phtmp.<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>, (filesz ? off_o : 0));</div>
<div class="line"><span class="lineno"> 3544</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;phtmp, <span class="keyword">sizeof</span>(phtmp));  <span class="comment">// Phdr</span></div>
<div class="line"><span class="lineno"> 3545</span>            }</div>
<div class="line"><span class="lineno"> 3546</span>            <span class="keywordflow">if</span> (1==phase) {</div>
<div class="line"><span class="lineno"> 3547</span>                <span class="keywordflow">if</span> (pad) fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;zero_pad, pad);</div>
<div class="line"><span class="lineno"> 3548</span>                <span class="keywordflow">if</span> (filesz) fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[off_i], filesz);  <span class="comment">// body</span></div>
<div class="line"><span class="lineno"> 3549</span>            }</div>
<div class="line"><span class="lineno"> 3550</span>            off_o += filesz;</div>
<div class="line"><span class="lineno"> 3551</span>        }</div>
<div class="line"><span class="lineno"> 3552</span>    }</div>
<div class="line"><span class="lineno"> 3553</span>    off_o = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, off_o);</div>
<div class="line"><span class="lineno"> 3554</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a> = off_o - (<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));</div>
<div class="line"><span class="lineno"> 3555</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz, off_o);</div>
<div class="line"><span class="lineno"> 3556</span> </div>
<div class="line"><span class="lineno"> 3557</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>) + <a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>;</div>
<div class="line"><span class="lineno"> 3558</span>    <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>);</div>
<div class="line"><span class="lineno"> 3559</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a>        = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structp__info.html">p_info</a>);</div>
<div class="line"><span class="lineno"> 3560</span> </div>
<div class="line"><span class="lineno"> 3561</span>    <a class="code hl_struct" href="structl__info.html">l_info</a> linfo2; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;linfo2, 0, <span class="keyword">sizeof</span>(linfo2));</div>
<div class="line"><span class="lineno"> 3562</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;linfo2, <span class="keyword">sizeof</span>(linfo2));</div>
<div class="line"><span class="lineno"> 3563</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a1a02a5314fbdff34469cfa4b59ddde10"><div class="ttname"><a href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a></div><div class="ttdeci">int o_elf_shnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00129">p_lx_elf.h:129</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a371519bdb05124340b9d78e067bee1e0"><div class="ttname"><a href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">PackLinuxElf::o_binfo</a></div><div class="ttdeci">unsigned o_binfo</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00101">p_lx_elf.h:101</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a80989e5fdaa51b0650d6f5d66eaf3766"><div class="ttname"><a href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a></div><div class="ttdeci">unsigned page_size</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00096">p_lx_elf.h:96</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aa3e227135d766557eb3e012e610d72a0"><div class="ttname"><a href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a></div><div class="ttdeci">unsigned overlay_offset</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00096">p_unix.h:96</a></div></div>
<div class="ttc" id="aclassPackerBase_html_aa6132cc9ef747b35947837d463aeac60"><div class="ttname"><a href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60">PackerBase::getFormat</a></div><div class="ttdeci">virtual int getFormat() const =0</div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b"><div class="ttname"><a href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a></div><div class="ttdeci">@ C_BASE</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00509">p_lx_elf.cpp:508</a></div></div>
<div class="ttc" id="ap__lx__elf_8h_html_add593f4cfdc5ddcbd94ea2638b7a96e7"><div class="ttname"><a href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a></div><div class="ttdeci">upx_uint64_t u64_t</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00038">p_lx_elf.h:38</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a87cf481be7917fafde0c4ecf78c8e574"><div class="ttname"><a href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">Elf32_Ehdr::e_flags</a></div><div class="ttdeci">Elf32_Word e_flags</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00196">bsd.h:196</a></div></div>
<div class="ttc" id="astructPackHeader_html_aafa1c316f2be9a01d43d36a5aa5473bf"><div class="ttname"><a href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">PackHeader::format</a></div><div class="ttdeci">int format</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00051">packhead.h:51</a></div></div>
<div class="ttc" id="astructp__info_html"><div class="ttname"><a href="structp__info.html">p_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00340">bsd.h:341</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">Elf32_Ehdr::e_flags</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a>, <a class="el" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">PackHeader::format</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60">PackerBase::getFormat()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>, <a class="el" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">PackLinuxElf::o_binfo</a>, <a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#af18f0a179a5fca09e3c04bcdce3fac2f">Elf32_Phdr::p_paddr</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classPackLinuxElf32.html#af6320858ad11e1f2a16f29d6554fbbca">phdrx</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>, and <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70">PackLinuxElf32ppc::pack1()</a>, <a class="el" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54">PackLinuxElf32x86::pack1()</a>, <a class="el" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19">PackBSDElf32x86::pack1()</a>, <a class="el" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828">PackLinuxElf32armLe::pack1()</a>, <a class="el" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849">PackLinuxElf32armBe::pack1()</a>, <a class="el" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667">PackLinuxElf32mipseb::pack1()</a>, <a class="el" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed">PackLinuxElf32mipsel::pack1()</a>, and <a class="el" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845">PackLinuxElf32x86interp::pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_cgraph" id="aclassPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_cgraph">
<area shape="rect" title=" " alt="" coords="5,363,192,403"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="296,132,355,157"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="459,183,589,208"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="261,233,390,259"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="459,312,589,337"/>
<area shape="rect" href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60" title=" " alt="" coords="240,399,411,424"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="256,334,395,374"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="288,448,363,473"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="287,521,363,547"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="261,571,389,596"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="261,620,389,645"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="820,5,963,31"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1437,109,1574,135"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="637,208,772,233"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1647,132,1777,157"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="847,283,936,308"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1045,337,1135,363"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="660,107,749,132"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1227,257,1354,283"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="827,157,956,183"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1412,257,1599,283"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1684,257,1740,283"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1027,157,1153,183"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1217,208,1364,233"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1478,159,1533,184"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1435,208,1575,233"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1011,273,1169,313"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1231,321,1350,347"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_icgraph" id="aclassPackLinuxElf32_aa3a1446667e5e41721ae1ed8d40e3a82_icgraph">
<area shape="rect" title=" " alt="" coords="467,216,653,256"/>
<area shape="rect" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70" title=" " alt="" coords="252,5,403,45"/>
<area shape="rect" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54" title=" " alt="" coords="251,69,403,109"/>
<area shape="rect" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19" title=" " alt="" coords="5,106,188,131"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828" title=" " alt="" coords="247,184,408,224"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849" title=" " alt="" coords="246,248,409,288"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667" title=" " alt="" coords="243,312,411,352"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed" title=" " alt="" coords="245,376,409,416"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845" title=" " alt="" coords="236,440,419,480"/>
</map>
</div>

</div>
</div>
<a id="ae84aeb851cffb6a47f23a5f2ae01c1cd" name="ae84aeb851cffb6a47f23a5f2ae01c1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae84aeb851cffb6a47f23a5f2ae01c1cd">&#9670;&#160;</a></span>get_dynsym_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char const  * PackLinuxElf32::get_dynsym_name </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>symnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02427">2427</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2428</span>{</div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a> &lt;= symnum) {</div>
<div class="line"><span class="lineno"> 2430</span>        (void)relnum;</div>
<div class="line"><span class="lineno"> 2431</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2432</span>    }</div>
<div class="line"><span class="lineno"> 2433</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[symnum].st_name), symnum);</div>
<div class="line"><span class="lineno"> 2434</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a4cc33d310cb391da2166a1dd3857ee4d"><div class="ttname"><a href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a></div><div class="ttdeci">unsigned symnum_max</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00087">p_lx_elf.h:87</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>, <a class="el" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">calls_crt1()</a>, and <a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_cgraph" id="aclassPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,155,75"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="203,5,352,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="213,70,342,95"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="400,13,519,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_icgraph" id="aclassPackLinuxElf32_ae84aeb851cffb6a47f23a5f2ae01c1cd_icgraph">
<area shape="rect" title=" " alt="" coords="1159,39,1308,79"/>
<area shape="rect" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6" title=" " alt="" coords="725,5,916,31"/>
<area shape="rect" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad" title=" " alt="" coords="965,67,1111,107"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,17,417,43"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,10,188,50"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,67,917,107"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,43,671,68"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,93,676,133"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,157,675,197"/>
</map>
</div>

</div>
</div>
<a id="aaad617181a6e644a245633fc306f6fca" name="aaad617181a6e644a245633fc306f6fca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaad617181a6e644a245633fc306f6fca">&#9670;&#160;</a></span>get_str_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char const  * PackLinuxElf32::get_str_name </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>st_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>symnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02417">2417</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2418</span>{</div>
<div class="line"><span class="lineno"> 2419</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> &lt;= st_name) {</div>
<div class="line"><span class="lineno"> 2420</span>        <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2421</span>            <span class="stringliteral">&quot;bad .st_name %#x in DT_SYMTAB[%d]\n&quot;</span>, st_name, symnum);</div>
<div class="line"><span class="lineno"> 2422</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2423</span>    }</div>
<div class="line"><span class="lineno"> 2424</span>    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>[st_name];</div>
<div class="line"><span class="lineno"> 2425</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a4c581148f2345d127c21f0ba5a33a656"><div class="ttname"><a href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a></div><div class="ttdeci">unsigned strtab_max</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00088">p_lx_elf.h:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">adjABS()</a>, <a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup()</a>, and <a class="el" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_cgraph" id="aclassPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="203,13,321,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_icgraph" id="aclassPackLinuxElf32_aaad617181a6e644a245633fc306f6fca_icgraph">
<area shape="rect" title=" " alt="" coords="1383,136,1532,176"/>
<area shape="rect" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f" title=" " alt="" coords="1160,77,1335,102"/>
<area shape="rect" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad" title=" " alt="" coords="966,152,1111,192"/>
<area shape="rect" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd" title=" " alt="" coords="1173,193,1322,233"/>
<area shape="rect" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe" title=" " alt="" coords="965,5,1112,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="967,69,1111,109"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="737,13,904,38"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="749,65,893,105"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,53,658,78"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,152,917,192"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,102,671,127"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,152,676,192"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,216,675,256"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,191,417,217"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,184,188,224"/>
<area shape="rect" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6" title=" " alt="" coords="725,249,916,274"/>
</map>
</div>

</div>
</div>
<a id="a5ccea780c95ceb2ad3e29a234d3f2863" name="a5ccea780c95ceb2ad3e29a234d3f2863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ccea780c95ceb2ad3e29a234d3f2863">&#9670;&#160;</a></span>getbase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf32::getbase </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03417">3417</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3418</span>{</div>
<div class="line"><span class="lineno"> 3419</span>    <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> <a class="code hl_variable" href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a> = ~0u;</div>
<div class="line"><span class="lineno"> 3420</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nph; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3421</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 3422</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> vaddr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 3423</span>            <span class="keywordflow">if</span> (vaddr &lt; (<span class="keywordtype">unsigned</span>) <a class="code hl_variable" href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a>)</div>
<div class="line"><span class="lineno"> 3424</span>                <a class="code hl_variable" href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a> = vaddr;</div>
<div class="line"><span class="lineno"> 3425</span>        }</div>
<div class="line"><span class="lineno"> 3426</span>    }</div>
<div class="line"><span class="lineno"> 3427</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a>) {</div>
<div class="line"><span class="lineno"> 3428</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a>;</div>
<div class="line"><span class="lineno"> 3429</span>    }</div>
<div class="line"><span class="lineno"> 3430</span>    <span class="keywordflow">return</span> 0x12000;</div>
<div class="line"><span class="lineno"> 3431</span>}</div>
<div class="ttc" id="absd_8h_html_af83497edef361523a95b06deda0b4c2d"><div class="ttname"><a href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a></div><div class="ttdeci">long off_t</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00073">bsd.h:73</a></div></div>
<div class="ttc" id="axspan__impl__common_8h_html_a91546a13edf6356c341bb755807b3e30"><div class="ttname"><a href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a></div><div class="ttdeci">pointer base</div><div class="ttdef"><b>Definition:</b> <a href="xspan__impl__common_8h_source.html#l00057">xspan_impl_common.h:57</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="xspan__impl__common_8h.html#a91546a13edf6356c341bb755807b3e30">base</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, and <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161">PackLinuxElf32x86interp::pack3()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_cgraph" id="aclassPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,185,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="420,5,549,31"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="233,26,372,66"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_icgraph" id="aclassPackLinuxElf32_a5ccea780c95ceb2ad3e29a234d3f2863_icgraph">
<area shape="rect" title=" " alt="" coords="236,13,416,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="a69001fad2a5e68585846d1fb1abd2afb" name="a69001fad2a5e68585846d1fb1abd2afb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69001fad2a5e68585846d1fb1abd2afb">&#9670;&#160;</a></span>getbrk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf32::getbrk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03403">3403</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3404</span>{</div>
<div class="line"><span class="lineno"> 3405</span>    <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> brka = 0;</div>
<div class="line"><span class="lineno"> 3406</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nph; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3407</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 3408</span>            <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>) + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">p_memsz</a>);</div>
<div class="line"><span class="lineno"> 3409</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> &gt; brka)</div>
<div class="line"><span class="lineno"> 3410</span>                brka = <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 3411</span>        }</div>
<div class="line"><span class="lineno"> 3412</span>    }</div>
<div class="line"><span class="lineno"> 3413</span>    <span class="keywordflow">return</span> brka;</div>
<div class="line"><span class="lineno"> 3414</span>}</div>
<div class="ttc" id="axspan__fwd_8h_html_af71ddeb3e6a1edbdfadd8f044c60fa66"><div class="ttname"><a href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a></div><div class="ttdeci">const C&lt; U &gt; &amp; b</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00080">xspan_fwd.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">Elf32_Phdr::p_memsz</a>, and <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70">PackLinuxElf32ppc::pack1()</a>, <a class="el" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54">PackLinuxElf32x86::pack1()</a>, <a class="el" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19">PackBSDElf32x86::pack1()</a>, <a class="el" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828">PackLinuxElf32armLe::pack1()</a>, <a class="el" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849">PackLinuxElf32armBe::pack1()</a>, <a class="el" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667">PackLinuxElf32mipseb::pack1()</a>, <a class="el" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed">PackLinuxElf32mipsel::pack1()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845">PackLinuxElf32x86interp::pack1()</a>, and <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_cgraph" id="aclassPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,176,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="411,5,540,31"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="224,26,363,66"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_icgraph" id="aclassPackLinuxElf32_a69001fad2a5e68585846d1fb1abd2afb_icgraph">
<area shape="rect" title=" " alt="" coords="467,255,637,281"/>
<area shape="rect" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70" title=" " alt="" coords="252,5,403,45"/>
<area shape="rect" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54" title=" " alt="" coords="251,69,403,109"/>
<area shape="rect" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19" title=" " alt="" coords="5,106,188,131"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828" title=" " alt="" coords="247,184,408,224"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849" title=" " alt="" coords="246,248,409,288"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667" title=" " alt="" coords="243,312,411,352"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed" title=" " alt="" coords="245,376,409,416"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845" title=" " alt="" coords="236,440,419,480"/>
<area shape="rect" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c" title=" " alt="" coords="244,505,411,530"/>
</map>
</div>

</div>
</div>
<a id="a18b74d82d2a2993873377ac87e6393d4" name="a18b74d82d2a2993873377ac87e6393d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18b74d82d2a2993873377ac87e6393d4">&#9670;&#160;</a></span>invert_pt_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::invert_pt_dynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> const *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dt_filesz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02089">2089</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2090</span>{</div>
<div class="line"><span class="lineno"> 2091</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_NULL]) {</div>
<div class="line"><span class="lineno"> 2092</span>        <span class="keywordflow">return</span>;  <span class="comment">// not 1st time; do not change upx_dt_init</span></div>
<div class="line"><span class="lineno"> 2093</span>    }</div>
<div class="line"><span class="lineno"> 2094</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> <span class="keyword">const</span> *<span class="keyword">const</span> dynp0 = dynp;</div>
<div class="line"><span class="lineno"> 2095</span>    <span class="keywordtype">unsigned</span> ndx = 0;</div>
<div class="line"><span class="lineno"> 2096</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> limit = headway / <span class="keyword">sizeof</span>(*dynp);</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keywordflow">if</span> (dynp)</div>
<div class="line"><span class="lineno"> 2098</span>    <span class="keywordflow">for</span> (; ; ++ndx, ++dynp) {</div>
<div class="line"><span class="lineno"> 2099</span>        <span class="keywordflow">if</span> (limit &lt;= ndx) {</div>
<div class="line"><span class="lineno"> 2100</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;DT_NULL not found&quot;</span>);</div>
<div class="line"><span class="lineno"> 2101</span>        }</div>
<div class="line"><span class="lineno"> 2102</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> <span class="keyword">const</span> d_tag = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 2103</span>        <span class="keywordflow">if</span> (d_tag &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) {</div>
<div class="line"><span class="lineno"> 2104</span>            <span class="keywordflow">if</span> (Elf32_Dyn::DT_NEEDED != d_tag</div>
<div class="line"><span class="lineno"> 2105</span>            &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag]</div>
<div class="line"><span class="lineno"> 2106</span>            &amp;&amp;    <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp-&gt;d_val)</div>
<div class="line"><span class="lineno"> 2107</span>               != <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp0[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag]].d_val)) {</div>
<div class="line"><span class="lineno"> 2108</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;duplicate DT_%#x: [%#x] [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 2109</span>                    (<span class="keywordtype">unsigned</span>)d_tag, -1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag], ndx);</div>
<div class="line"><span class="lineno"> 2110</span>            }</div>
<div class="line"><span class="lineno"> 2111</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag] = 1+ ndx;</div>
<div class="line"><span class="lineno"> 2112</span>        }</div>
<div class="line"><span class="lineno"> 2113</span>        <span class="keywordflow">if</span> (Elf32_Dyn::DT_NULL == d_tag) {</div>
<div class="line"><span class="lineno"> 2114</span>            <span class="keywordflow">break</span>;  <span class="comment">// check here so that dt_table[DT_NULL] is set</span></div>
<div class="line"><span class="lineno"> 2115</span>        }</div>
<div class="line"><span class="lineno"> 2116</span>    }</div>
<div class="line"><span class="lineno"> 2117</span>    <a class="code hl_function" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">sort_DT32_offsets</a>(dynp0);</div>
<div class="line"><span class="lineno"> 2118</span> </div>
<div class="line"><span class="lineno"> 2119</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = 0;</div>
<div class="line"><span class="lineno"> 2120</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_INIT])          <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf32_Dyn::DT_INIT;</div>
<div class="line"><span class="lineno"> 2121</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_PREINIT_ARRAY]) <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf32_Dyn::DT_PREINIT_ARRAY;</div>
<div class="line"><span class="lineno"> 2122</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_INIT_ARRAY])    <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf32_Dyn::DT_INIT_ARRAY;</div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> z_str = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_STRSZ];</div>
<div class="line"><span class="lineno"> 2125</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> = !z_str ? 0 : <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp0[-1+ z_str].d_val);</div>
<div class="line"><span class="lineno"> 2126</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> z_tab = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_STRTAB];</div>
<div class="line"><span class="lineno"> 2127</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> tmp1 = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp0[-1+ z_tab].d_val);</div>
<div class="line"><span class="lineno"> 2128</span>    <span class="keywordflow">if</span> (tmp1 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) {</div>
<div class="line"><span class="lineno"> 2129</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_STRTAB %#x&quot;</span>, tmp1);</div>
<div class="line"><span class="lineno"> 2130</span>    }</div>
<div class="line"><span class="lineno"> 2131</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> strtab_beg = !z_tab ? 0 : <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(tmp1);</div>
<div class="line"><span class="lineno"> 2132</span> </div>
<div class="line"><span class="lineno"> 2133</span>    <span class="keywordflow">if</span> (!z_str || !z_tab</div>
<div class="line"><span class="lineno"> 2134</span>    || (this-&gt;<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - strtab_beg) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a>  <span class="comment">// strtab overlaps EOF</span></div>
<div class="line"><span class="lineno"> 2135</span>        <span class="comment">// last string in table must have terminating NUL</span></div>
<div class="line"><span class="lineno"> 2136</span>    ||  <span class="charliteral">&#39;\0&#39;</span> != ((<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>())[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> + strtab_beg]</div>
<div class="line"><span class="lineno"> 2137</span>    ) {</div>
<div class="line"><span class="lineno"> 2138</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_STRSZ %#x&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a>);</div>
<div class="line"><span class="lineno"> 2139</span>    }</div>
<div class="line"><span class="lineno"> 2140</span> </div>
<div class="line"><span class="lineno"> 2141</span>    <span class="comment">// Find end of DT_SYMTAB</span></div>
<div class="line"><span class="lineno"> 2142</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> tmp2 = <a class="code hl_function" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size</a>(Elf32_Dyn::DT_SYMTAB,</div>
<div class="line"><span class="lineno"> 2143</span>        Elf32_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 2144</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a> = (~0u == tmp2) ? 0 : tmp1 / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a>);</div>
<div class="line"><span class="lineno"> 2145</span> </div>
<div class="line"><span class="lineno"> 2146</span>    <span class="keywordtype">unsigned</span> v_sym = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_SYMTAB];</div>
<div class="line"><span class="lineno"> 2147</span>    <span class="keywordflow">if</span> (v_sym) {</div>
<div class="line"><span class="lineno"> 2148</span>        v_sym = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp0[-1+ v_sym].d_val));</div>
<div class="line"><span class="lineno"> 2149</span>    }</div>
<div class="line"><span class="lineno"> 2150</span>    <span class="keywordtype">unsigned</span> v_hsh = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf32_Dyn::DT_HASH];</div>
<div class="line"><span class="lineno"> 2151</span>    <span class="keywordflow">if</span> (v_hsh) {</div>
<div class="line"><span class="lineno"> 2152</span>        v_hsh = <a class="code hl_function" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp0[-1+ v_hsh].d_val));</div>
<div class="line"><span class="lineno"> 2153</span>    }</div>
<div class="line"><span class="lineno"> 2154</span>    <span class="keywordflow">if</span> (v_hsh &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) {</div>
<div class="line"><span class="lineno"> 2155</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 2156</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>) {</div>
<div class="line"><span class="lineno"> 2157</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH %#x&quot;</span>, v_hsh);</div>
<div class="line"><span class="lineno"> 2158</span>        }</div>
<div class="line"><span class="lineno"> 2159</span>        <span class="comment">// Find end of DT_HASH</span></div>
<div class="line"><span class="lineno"> 2160</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#ac22a29dfaad87f15dc1d1a09aed4fa7e">hashend</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)(<a class="code hl_function" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size</a>(</div>
<div class="line"><span class="lineno"> 2161</span>            Elf32_Dyn::DT_HASH, Elf32_Shdr::SHT_HASH) + (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>);</div>
<div class="line"><span class="lineno"> 2162</span> </div>
<div class="line"><span class="lineno"> 2163</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> nbucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 2164</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>[2];</div>
<div class="line"><span class="lineno"> 2165</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> chains = &amp;buckets[nbucket]; (void)chains;</div>
<div class="line"><span class="lineno"> 2166</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)buckets - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 2167</span>                &lt;= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*nbucket ) {</div>
<div class="line"><span class="lineno"> 2168</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad nbucket %#x\n&quot;</span>, nbucket);</div>
<div class="line"><span class="lineno"> 2169</span>        }</div>
<div class="line"><span class="lineno"> 2170</span> </div>
<div class="line"><span class="lineno"> 2171</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackLinuxElf32.html#ac22a29dfaad87f15dc1d1a09aed4fa7e">hashend</a> - buckets) &lt; nbucket</div>
<div class="line"><span class="lineno"> 2172</span>        || !v_sym || (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= v_sym</div>
<div class="line"><span class="lineno"> 2173</span>        || ((v_hsh &lt; v_sym) &amp;&amp; (v_sym - v_hsh) &lt; <span class="keyword">sizeof</span>(*buckets)*(2+ nbucket))</div>
<div class="line"><span class="lineno"> 2174</span>        ) {</div>
<div class="line"><span class="lineno"> 2175</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH nbucket=%#x  len=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2176</span>                nbucket, (v_sym - v_hsh));</div>
<div class="line"><span class="lineno"> 2177</span>        }</div>
<div class="line"><span class="lineno"> 2178</span>        <span class="keywordtype">unsigned</span> chmax = 0;</div>
<div class="line"><span class="lineno"> 2179</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j= 0; j &lt; nbucket; ++j) {</div>
<div class="line"><span class="lineno"> 2180</span>            <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno"> 2181</span>            <span class="keywordflow">if</span> (chmax &lt; x) {</div>
<div class="line"><span class="lineno"> 2182</span>                chmax = x;</div>
<div class="line"><span class="lineno"> 2183</span>            }</div>
<div class="line"><span class="lineno"> 2184</span>        }</div>
<div class="line"><span class="lineno"> 2185</span>        <span class="keywordflow">if</span> ((v_hsh &lt; v_sym) &amp;&amp; (v_sym - v_hsh) &lt;</div>
<div class="line"><span class="lineno"> 2186</span>                (<span class="keyword">sizeof</span>(*buckets)*(2+ nbucket) + <span class="keyword">sizeof</span>(*chains)*(1+ chmax))) {</div>
<div class="line"><span class="lineno"> 2187</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH nbucket=%#x  len=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2188</span>                nbucket, (v_sym - v_hsh));</div>
<div class="line"><span class="lineno"> 2189</span>        }</div>
<div class="line"><span class="lineno"> 2190</span>    }</div>
<div class="line"><span class="lineno"> 2191</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> v_gsh = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 2192</span>    <span class="keywordflow">if</span> (v_gsh &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) {</div>
<div class="line"><span class="lineno"> 2193</span>        <span class="comment">// Not similar to DT_HASH because DT_GNU_HASH is not small (0x6ffffef5).</span></div>
<div class="line"><span class="lineno"> 2194</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 2195</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>) {</div>
<div class="line"><span class="lineno"> 2196</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH %#x&quot;</span>, v_gsh);</div>
<div class="line"><span class="lineno"> 2197</span>        }</div>
<div class="line"><span class="lineno"> 2198</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a81eaf2981770e46ea4d5895612a3bab7">gashend</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)(<a class="code hl_function" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size</a>(</div>
<div class="line"><span class="lineno"> 2199</span>            Elf32_Dyn::DT_GNU_HASH, Elf32_Shdr::SHT_GNU_HASH) + (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>);</div>
<div class="line"><span class="lineno"> 2200</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 2201</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symbias  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[1]);</div>
<div class="line"><span class="lineno"> 2202</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bitmask = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[2]);</div>
<div class="line"><span class="lineno"> 2203</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> gnu_shift = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[3]);</div>
<div class="line"><span class="lineno"> 2204</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> <span class="keyword">const</span> *<span class="keyword">const</span> bitmask = (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>[4];</div>
<div class="line"><span class="lineno"> 2205</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> buckets = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)&amp;bitmask[n_bitmask];</div>
<div class="line"><span class="lineno"> 2206</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> hasharr = &amp;buckets[n_bucket]; (void)hasharr;</div>
<div class="line"><span class="lineno"> 2207</span>        <span class="keywordflow">if</span> (!n_bucket || (1u&lt;&lt;31) &lt;= n_bucket  <span class="comment">/* fie on fuzzers */</span></div>
<div class="line"><span class="lineno"> 2208</span>        || (unsigned)(<a class="code hl_variable" href="classPackLinuxElf32.html#a81eaf2981770e46ea4d5895612a3bab7">gashend</a> - buckets) &lt; n_bucket</div>
<div class="line"><span class="lineno"> 2209</span>        || (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) &lt;= (<span class="keywordtype">void</span> <span class="keyword">const</span> *)hasharr) {</div>
<div class="line"><span class="lineno"> 2210</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bucket %#x\n&quot;</span>, n_bucket);</div>
<div class="line"><span class="lineno"> 2211</span>        }</div>
<div class="line"><span class="lineno"> 2212</span>        <span class="comment">// It would be better to detect zeroes shifted into low 5 bits of:</span></div>
<div class="line"><span class="lineno"> 2213</span>        <span class="comment">//    (037 &amp; (hash_32 &gt;&gt; gnu_shift))</span></div>
<div class="line"><span class="lineno"> 2214</span>        <span class="comment">// but compilers can be stupid.</span></div>
<div class="line"><span class="lineno"> 2215</span>        <span class="keywordflow">if</span> (31 &lt; gnu_shift) {</div>
<div class="line"><span class="lineno"> 2216</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_shift %#x&quot;</span>, gnu_shift);</div>
<div class="line"><span class="lineno"> 2217</span>        }</div>
<div class="line"><span class="lineno"> 2218</span>        <span class="comment">// unsigned const *const gashend = &amp;hasharr[n_bucket];</span></div>
<div class="line"><span class="lineno"> 2219</span>        <span class="comment">// minimum, except:</span></div>
<div class="line"><span class="lineno"> 2220</span>        <span class="comment">// Rust and Android trim unused zeroes from high end of hasharr[]</span></div>
<div class="line"><span class="lineno"> 2221</span>        <span class="keywordtype">unsigned</span> bmax = 0;</div>
<div class="line"><span class="lineno"> 2222</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j= 0; j &lt; n_bucket; ++j) {</div>
<div class="line"><span class="lineno"> 2223</span>            <span class="keywordtype">unsigned</span> bj = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno"> 2224</span>            <span class="keywordflow">if</span> (bj) {</div>
<div class="line"><span class="lineno"> 2225</span>                <span class="keywordflow">if</span> (bj &lt; symbias) {</div>
<div class="line"><span class="lineno"> 2226</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH bucket[%d] &lt; symbias{%#x}\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2227</span>                        bj, symbias);</div>
<div class="line"><span class="lineno"> 2228</span>                }</div>
<div class="line"><span class="lineno"> 2229</span>                <span class="keywordflow">if</span> (bmax &lt; bj) {</div>
<div class="line"><span class="lineno"> 2230</span>                    bmax = bj;</div>
<div class="line"><span class="lineno"> 2231</span>                }</div>
<div class="line"><span class="lineno"> 2232</span>            }</div>
<div class="line"><span class="lineno"> 2233</span>        }</div>
<div class="line"><span class="lineno"> 2234</span>        <span class="keywordflow">if</span> (1==n_bucket  &amp;&amp; 0==buckets[0]</div>
<div class="line"><span class="lineno"> 2235</span>        &amp;&amp;  1==n_bitmask &amp;&amp; 0==bitmask[0]) {</div>
<div class="line"><span class="lineno"> 2236</span>            <span class="comment">// 2021-09-11 Rust on RaspberryPi apparently uses this to minimize space.</span></div>
<div class="line"><span class="lineno"> 2237</span>            <span class="comment">// But then the DT_GNU_HASH symbol lookup algorithm always fails?</span></div>
<div class="line"><span class="lineno"> 2238</span>            <span class="comment">// https://github.com/upx/upx/issues/525</span></div>
<div class="line"><span class="lineno"> 2239</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2240</span>        <span class="keywordflow">if</span> (bmax) {</div>
<div class="line"><span class="lineno"> 2241</span>            <span class="keywordflow">if</span> ((1+ bmax) &lt; symbias) {</div>
<div class="line"><span class="lineno"> 2242</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH (1+ max_bucket)=%#x &lt; symbias=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2243</span>                    1+ bmax, symbias);</div>
<div class="line"><span class="lineno"> 2244</span>            }</div>
<div class="line"><span class="lineno"> 2245</span>            bmax -= symbias;</div>
<div class="line"><span class="lineno"> 2246</span>        }</div>
<div class="line"><span class="lineno"> 2247</span> </div>
<div class="line"><span class="lineno"> 2248</span>        <span class="keywordtype">unsigned</span> r = 0;</div>
<div class="line"><span class="lineno"> 2249</span>        <span class="keywordflow">if</span> (!n_bucket || !n_bitmask || !v_sym</div>
<div class="line"><span class="lineno"> 2250</span>        || (r=1, ((-1+ n_bitmask) &amp; n_bitmask))  <span class="comment">// not a power of 2</span></div>
<div class="line"><span class="lineno"> 2251</span>        || (r=2, (8*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>) &lt;= gnu_shift))  <span class="comment">// shifted result always == 0</span></div>
<div class="line"><span class="lineno"> 2252</span>        || (r=3, (n_bucket&gt;&gt;30))  <span class="comment">// fie on fuzzers</span></div>
<div class="line"><span class="lineno"> 2253</span>        || (r=4, (n_bitmask&gt;&gt;30))</div>
<div class="line"><span class="lineno"> 2254</span>        || (r=5, ((<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))</div>
<div class="line"><span class="lineno"> 2255</span>                &lt;= ((<span class="keyword">sizeof</span>(*bitmask)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))*n_bitmask + 2*n_bucket)))  <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 2256</span>        || (r=6, ((v_gsh &lt; v_sym) &amp;&amp; (v_sym - v_gsh) &lt; (<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*4  <span class="comment">// headers</span></div>
<div class="line"><span class="lineno"> 2257</span>                + <span class="keyword">sizeof</span>(*bitmask)*n_bitmask  <span class="comment">// bitmask</span></div>
<div class="line"><span class="lineno"> 2258</span>                + <span class="keyword">sizeof</span>(*buckets)*n_bucket  <span class="comment">// buckets</span></div>
<div class="line"><span class="lineno"> 2259</span>                + <span class="keyword">sizeof</span>(*hasharr)*(!bmax ? 0 : (1+ bmax))  <span class="comment">// hasharr</span></div>
<div class="line"><span class="lineno"> 2260</span>            )) )</div>
<div class="line"><span class="lineno"> 2261</span>        ) {</div>
<div class="line"><span class="lineno"> 2262</span>            <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2263</span>                <span class="stringliteral">&quot;bad DT_GNU_HASH n_bucket=%#x  n_bitmask=%#x  len=%#lx  r=%d&quot;</span>,</div>
<div class="line"><span class="lineno"> 2264</span>                n_bucket, n_bitmask, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)(v_sym - v_gsh), r);</div>
<div class="line"><span class="lineno"> 2265</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2266</span>        }</div>
<div class="line"><span class="lineno"> 2267</span>    }</div>
<div class="line"><span class="lineno"> 2268</span>    <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">e_shstrndx</a>);  <span class="comment">// who omitted this?</span></div>
<div class="line"><span class="lineno"> 2269</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></div>
<div class="line"><span class="lineno"> 2270</span>    &amp;&amp;  !(0==<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; 0==<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) ) {</div>
<div class="line"><span class="lineno"> 2271</span>        <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2272</span>            <span class="stringliteral">&quot;bad .e_shstrndx %d &gt;= .e_shnum %d&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 2273</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2274</span>    }</div>
<div class="line"><span class="lineno"> 2275</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a34521f96ea9eb8d358528d794fa9345b"><div class="ttname"><a href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">PackLinuxElf32::sort_DT32_offsets</a></div><div class="ttdeci">void sort_DT32_offsets(Elf32_Dyn const *const dynp0)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02009">p_lx_elf.cpp:2009</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_aa3f2721b58e10a1d02b398f398fb7812"><div class="ttname"><a href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">PackLinuxElf32::elf_find_table_size</a></div><div class="ttdeci">unsigned elf_find_table_size(unsigned dt_type, unsigned sh_type)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02061">p_lx_elf.cpp:2061</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf32.html#a81eaf2981770e46ea4d5895612a3bab7">gashend</a>, <a class="el" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf32.html#ac22a29dfaad87f15dc1d1a09aed4fa7e">hashend</a>, <a class="el" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">sort_DT32_offsets()</a>, <a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a>, <a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_cgraph" id="aclassPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_cgraph">
<area shape="rect" title=" " alt="" coords="5,354,172,394"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="224,158,369,198"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1158,232,1287,257"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="421,182,612,222"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="951,614,1069,640"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="224,354,369,394"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="441,246,592,286"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="683,1064,852,1089"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="232,1057,361,1082"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="220,614,373,654"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="695,124,840,164"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="680,191,855,231"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="941,195,1079,235"/>
<area shape="rect" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0" title=" " alt="" coords="444,430,589,470"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="937,360,1083,400"/>
<area shape="rect" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c" title=" " alt="" coords="441,840,593,880"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="730,462,805,488"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="692,1014,843,1040"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="450,790,583,816"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="449,689,584,714"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="455,956,579,981"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="723,665,812,690"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="972,740,1048,765"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="725,866,809,892"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="727,916,808,941"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="660,965,875,990"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1145,816,1300,841"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="935,964,1085,1004"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="1147,964,1298,1004"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="1147,1028,1298,1068"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="708,714,827,740"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="923,866,1097,892"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1181,865,1264,890"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1153,914,1293,940"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1348,858,1499,898"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1547,826,1697,866"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1547,890,1697,930"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_icgraph" id="aclassPackLinuxElf32_a18b74d82d2a2993873377ac87e6393d4_icgraph">
<area shape="rect" title=" " alt="" coords="965,88,1132,128"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,88,917,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,180,893,220"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,38,671,63"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,88,676,128"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,152,675,192"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,217,658,242"/>
</map>
</div>

</div>
</div>
<a id="a9929af0daa1854fea2672c0c50bddb84" name="a9929af0daa1854fea2672c0c50bddb84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9929af0daa1854fea2672c0c50bddb84">&#9670;&#160;</a></span>is_LOAD32()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf32::is_LOAD32 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00265">265</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  266</span>{</div>
<div class="line"><span class="lineno">  267</span>    <span class="comment">// (1+ PT_LOPROC) can confuse!</span></div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type);</div>
<div class="line"><span class="lineno">  269</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, and <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53">elf_get_offset_from_Phdrs()</a>, <a class="el" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap()</a>, <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf32.html#a5ccea780c95ceb2ad3e29a234d3f2863">getbase()</a>, <a class="el" href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb">getbrk()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_cgraph" id="aclassPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="192,13,321,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_icgraph" id="aclassPackLinuxElf32_a9929af0daa1854fea2672c0c50bddb84_icgraph">
<area shape="rect" title=" " alt="" coords="1884,447,2023,487"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,145,417,170"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="1655,331,1830,371"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,204,917,244"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,360,893,400"/>
<area shape="rect" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2" title=" " alt="" coords="1667,497,1819,537"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82" title=" " alt="" coords="1649,869,1836,909"/>
<area shape="rect" href="classPackLinuxElf32.html#a5ccea780c95ceb2ad3e29a234d3f2863" title=" " alt="" coords="1653,1058,1833,1083"/>
<area shape="rect" href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb" title=" " alt="" coords="1657,781,1828,806"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,137,188,177"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="1411,303,1601,343"/>
<area shape="rect" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe" title=" " alt="" coords="1198,360,1345,400"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="1199,245,1344,285"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,360,1132,400"/>
<area shape="rect" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5" title=" " alt="" coords="965,475,1132,501"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="977,245,1121,285"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,195,671,221"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,245,676,285"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,309,675,349"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,374,658,399"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="749,287,893,327"/>
<area shape="rect" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c" title=" " alt="" coords="1423,577,1589,602"/>
<area shape="rect" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70" title=" " alt="" coords="1431,741,1581,781"/>
<area shape="rect" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54" title=" " alt="" coords="1430,933,1582,973"/>
<area shape="rect" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19" title=" " alt="" coords="1180,941,1363,966"/>
<area shape="rect" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828" title=" " alt="" coords="1425,805,1587,845"/>
<area shape="rect" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849" title=" " alt="" coords="1425,869,1587,909"/>
<area shape="rect" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667" title=" " alt="" coords="1422,997,1590,1037"/>
<area shape="rect" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed" title=" " alt="" coords="1424,1061,1588,1101"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845" title=" " alt="" coords="1415,677,1597,717"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161" title=" " alt="" coords="1415,1176,1597,1216"/>
</map>
</div>

</div>
</div>
<a id="a5bafd32333cb29e162b3a21d3cd4c625" name="a5bafd32333cb29e162b3a21d3cd4c625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bafd32333cb29e162b3a21d3cd4c625">&#9670;&#160;</a></span>pack1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::pack1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#af01b0f8403997790f28a72329e7b28f6">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70">PackLinuxElf32ppc</a>, <a class="el" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54">PackLinuxElf32x86</a>, <a class="el" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19">PackBSDElf32x86</a>, <a class="el" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828">PackLinuxElf32armLe</a>, <a class="el" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849">PackLinuxElf32armBe</a>, <a class="el" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667">PackLinuxElf32mipseb</a>, <a class="el" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed">PackLinuxElf32mipsel</a>, and <a class="el" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845">PackLinuxElf32x86interp</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03890">3890</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3891</span>{</div>
<div class="line"><span class="lineno"> 3892</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3893</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>));</div>
<div class="line"><span class="lineno"> 3894</span>    assert(<a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>));  <span class="comment">// checked by canPack()</span></div>
<div class="line"><span class="lineno"> 3895</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#afa2289f96d86fcc568a3b1f40cc8953e">e_phentsize</a>);</div>
<div class="line"><span class="lineno"> 3896</span> </div>
<div class="line"><span class="lineno"> 3897</span><span class="comment">// We compress separate pieces (usually each PT_LOAD, plus the gaps in the file</span></div>
<div class="line"><span class="lineno"> 3898</span><span class="comment">// that are not covered by any PT_LOAD), but currently at run time there can be</span></div>
<div class="line"><span class="lineno"> 3899</span><span class="comment">// only one decompressor method.</span></div>
<div class="line"><span class="lineno"> 3900</span><span class="comment">// Therefore we must plan ahead because Packer::compressWithFilters tries</span></div>
<div class="line"><span class="lineno"> 3901</span><span class="comment">// to find the smallest result among the available methods, for one piece only.</span></div>
<div class="line"><span class="lineno"> 3902</span><span class="comment">// In the future we may allow more than one decompression method at run time.</span></div>
<div class="line"><span class="lineno"> 3903</span><span class="comment">// For now we must choose only one, and force PackUnix::packExtent</span></div>
<div class="line"><span class="lineno"> 3904</span><span class="comment">// (==&gt; compressWithFilters) to use it.</span></div>
<div class="line"><span class="lineno"> 3905</span>    <span class="keywordtype">int</span> nfilters = 0;</div>
<div class="line"><span class="lineno"> 3906</span>    {</div>
<div class="line"><span class="lineno"> 3907</span>        <span class="keywordtype">int</span> <span class="keyword">const</span> *fp = <a class="code hl_function" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">getFilters</a>();</div>
<div class="line"><span class="lineno"> 3908</span>        <span class="keywordflow">while</span> (<a class="code hl_define" href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a> != *fp++) {</div>
<div class="line"><span class="lineno"> 3909</span>            ++nfilters;</div>
<div class="line"><span class="lineno"> 3910</span>        }</div>
<div class="line"><span class="lineno"> 3911</span>    }</div>
<div class="line"><span class="lineno"> 3912</span>    {</div>
<div class="line"><span class="lineno"> 3913</span>        <span class="keywordtype">int</span> npieces = 1;  <span class="comment">// tail after highest PT_LOAD</span></div>
<div class="line"><span class="lineno"> 3914</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 3915</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3916</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 3917</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span>  flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>);</div>
<div class="line"><span class="lineno"> 3918</span>                <span class="keywordtype">unsigned</span>       offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 3919</span>                <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 3920</span>                  <span class="comment">// new-style shlib: PT_LOAD[0] has symbol table</span></div>
<div class="line"><span class="lineno"> 3921</span>                  <span class="comment">// which must not be compressed, but also lacks PF_X</span></div>
<div class="line"><span class="lineno"> 3922</span>                ||    (Elf32_Phdr::PF_X &amp; flags)</div>
<div class="line"><span class="lineno"> 3923</span>                  <span class="comment">// Read-only, non-first PT_LOAD is _assumed_ to be compressible</span></div>
<div class="line"><span class="lineno"> 3924</span>                ||  (!(Elf32_Phdr::PF_W &amp; flags) &amp;&amp; 0!=offset))</div>
<div class="line"><span class="lineno"> 3925</span>                {</div>
<div class="line"><span class="lineno"> 3926</span>                    ++npieces;  <span class="comment">// will attempt compression of this PT_LOAD</span></div>
<div class="line"><span class="lineno"> 3927</span>                }</div>
<div class="line"><span class="lineno"> 3928</span>            }</div>
<div class="line"><span class="lineno"> 3929</span>        }</div>
<div class="line"><span class="lineno"> 3930</span>        uip-&gt;ui_total_passes += npieces;</div>
<div class="line"><span class="lineno"> 3931</span>    }</div>
<div class="line"><span class="lineno"> 3932</span>    <span class="keywordtype">int</span> methods[256];</div>
<div class="line"><span class="lineno"> 3933</span>    <span class="keywordtype">unsigned</span> nmethods = <a class="code hl_function" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">prepareMethods</a>(methods, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>, <a class="code hl_function" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">getCompressionMethods</a>(<a class="code hl_define" href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">level</a>));</div>
<div class="line"><span class="lineno"> 3934</span>    <span class="keywordflow">if</span> (1 &lt; nmethods) { <span class="comment">// Many are available, but we must choose only one</span></div>
<div class="line"><span class="lineno"> 3935</span>        uip-&gt;ui_total_passes += 1;  <span class="comment">// the batch for output</span></div>
<div class="line"><span class="lineno"> 3936</span>        uip-&gt;ui_total_passes *= nmethods * (1+ nfilters);  <span class="comment">// finding smallest total</span></div>
<div class="line"><span class="lineno"> 3937</span>        <a class="code hl_struct" href="structPackHeader.html">PackHeader</a> orig_ph = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>;</div>
<div class="line"><span class="lineno"> 3938</span>        <a class="code hl_class" href="classFilter.html">Filter</a> orig_ft = ft;</div>
<div class="line"><span class="lineno"> 3939</span>        <span class="keywordtype">unsigned</span> max_offset = 0;</div>
<div class="line"><span class="lineno"> 3940</span>        <span class="keywordtype">unsigned</span> sz_best= ~0u;</div>
<div class="line"><span class="lineno"> 3941</span>        <span class="keywordtype">int</span> method_best = 0;</div>
<div class="line"><span class="lineno"> 3942</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; nmethods; ++k) { <span class="comment">// FIXME: parallelize; cost: working space</span></div>
<div class="line"><span class="lineno"> 3943</span>            <span class="keywordtype">unsigned</span> sz_this = 0;</div>
<div class="line"><span class="lineno"> 3944</span>            <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 3945</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3946</span>                <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 3947</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>  flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>);</div>
<div class="line"><span class="lineno"> 3948</span>                    <span class="keywordtype">unsigned</span>       offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 3949</span>                    <span class="keywordtype">unsigned</span>       filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 3950</span>                    max_offset = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_offset, filesz + offset);</div>
<div class="line"><span class="lineno"> 3951</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 3952</span>                      <span class="comment">// new-style shlib: PT_LOAD[0] has symbol table</span></div>
<div class="line"><span class="lineno"> 3953</span>                      <span class="comment">// which must not be compressed, but also lacks PF_X</span></div>
<div class="line"><span class="lineno"> 3954</span>                    ||    (Elf32_Phdr::PF_X &amp; flags)</div>
<div class="line"><span class="lineno"> 3955</span>                      <span class="comment">// Read-only, non-first PT_LOAD is _assumed_ to be compressible</span></div>
<div class="line"><span class="lineno"> 3956</span>                    ||  (!(Elf32_Phdr::PF_W &amp; flags) &amp;&amp; 0!=offset))</div>
<div class="line"><span class="lineno"> 3957</span>                    {</div>
<div class="line"><span class="lineno"> 3958</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &amp;&amp; 0==offset) { <span class="comment">// old-style shlib</span></div>
<div class="line"><span class="lineno"> 3959</span>                            offset  = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 3960</span>                            filesz -= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 3961</span>                        }</div>
<div class="line"><span class="lineno"> 3962</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3963</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 3964</span>                        ft = orig_ft;</div>
<div class="line"><span class="lineno"> 3965</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 3966</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(methods[k]);</div>
<div class="line"><span class="lineno"> 3967</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = filesz;</div>
<div class="line"><span class="lineno"> 3968</span>                        <a class="code hl_function" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a>(&amp;ft, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>, <a class="code hl_define" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, 10, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3969</span>                        sz_this += <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>;</div>
<div class="line"><span class="lineno"> 3970</span>                    }</div>
<div class="line"><span class="lineno"> 3971</span>                }</div>
<div class="line"><span class="lineno"> 3972</span>            }</div>
<div class="line"><span class="lineno"> 3973</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_tail = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - max_offset;  <span class="comment">// debuginfo, etc.</span></div>
<div class="line"><span class="lineno"> 3974</span>            <span class="keywordflow">if</span> (sz_tail) {</div>
<div class="line"><span class="lineno"> 3975</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(max_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3976</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sz_tail);</div>
<div class="line"><span class="lineno"> 3977</span>                ft = orig_ft;</div>
<div class="line"><span class="lineno"> 3978</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 3979</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(methods[k]);</div>
<div class="line"><span class="lineno"> 3980</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = sz_tail;</div>
<div class="line"><span class="lineno"> 3981</span>                <a class="code hl_function" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a>(&amp;ft, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>, <a class="code hl_define" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, 10, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3982</span>                sz_this += <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>;</div>
<div class="line"><span class="lineno"> 3983</span>            }</div>
<div class="line"><span class="lineno"> 3984</span>            <span class="comment">// FIXME: loader size also depends on method</span></div>
<div class="line"><span class="lineno"> 3985</span>            <span class="keywordflow">if</span> (sz_best &gt; sz_this) {</div>
<div class="line"><span class="lineno"> 3986</span>                sz_best = sz_this;</div>
<div class="line"><span class="lineno"> 3987</span>                method_best = methods[k];</div>
<div class="line"><span class="lineno"> 3988</span>            }</div>
<div class="line"><span class="lineno"> 3989</span>        }</div>
<div class="line"><span class="lineno"> 3990</span>        ft = orig_ft;</div>
<div class="line"><span class="lineno"> 3991</span>        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 3992</span>        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(method_best);</div>
<div class="line"><span class="lineno"> 3993</span>    }</div>
<div class="line"><span class="lineno"> 3994</span> </div>
<div class="line"><span class="lineno"> 3995</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 3996</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3997</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>);</div>
<div class="line"><span class="lineno"> 3998</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a2763e101c247310abeb7b69e17dbebc2">PT_GNU_STACK32</a> == type || <a class="code hl_define" href="p__lx__elf_8cpp.html#a59eb0ef71e7b110186c324070f393316">PT_NOTE32</a> == type) {</div>
<div class="line"><span class="lineno"> 3999</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx</a>(phdr);  <span class="comment">// PT_GNU_STACK32, PT_NOTE32</span></div>
<div class="line"><span class="lineno"> 4000</span>        }</div>
<div class="line"><span class="lineno"> 4001</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == type) {</div>
<div class="line"><span class="lineno"> 4002</span>            <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">p_align</a>) &gt;&gt; <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4003</span>            <span class="keywordflow">while</span> (x&gt;&gt;=1) {</div>
<div class="line"><span class="lineno"> 4004</span>                ++<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4005</span>            }</div>
<div class="line"><span class="lineno"> 4006</span>        }</div>
<div class="line"><span class="lineno"> 4007</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a842b75b2b1bb8f1ecaf89d8cabee935b">PT_GNU_RELRO32</a> == type</div>
<div class="line"><span class="lineno"> 4008</span>        &amp;&amp;  16 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>) {</div>
<div class="line"><span class="lineno"> 4009</span>            <span class="comment">// x86* allows 4K, 2M, 1G</span></div>
<div class="line"><span class="lineno"> 4010</span>            <span class="comment">// arm32 and arm64 both allow 4K, 16K, 64K; Apple Silicon uses 16K</span></div>
<div class="line"><span class="lineno"> 4011</span>            <span class="comment">// Oracle 5.4.17-2136.314.6.2.el8uek.aarch64 demands 64K</span></div>
<div class="line"><span class="lineno"> 4012</span>            <span class="comment">// PowerPC and PowerPC64 has 4K, 64K, 1M (?), 16M (?)</span></div>
<div class="line"><span class="lineno"> 4013</span>            <span class="comment">// MIPS  allows any power of 2 from 4K through 64K</span></div>
<div class="line"><span class="lineno"> 4014</span> </div>
<div class="line"><span class="lineno"> 4015</span>            <span class="comment">// If 64K &lt; .p_align then we assume that 4K is also accepted.</span></div>
<div class="line"><span class="lineno"> 4016</span>            <span class="comment">// .p_align can be like 2M, which is a huge over-estimate.</span></div>
<div class="line"><span class="lineno"> 4017</span>            <span class="comment">// RELRO ends on a page boundary: usually close to actual page_size</span></div>
<div class="line"><span class="lineno"> 4018</span>            <span class="keywordtype">unsigned</span> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4019</span>            <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 4020</span>            <span class="keywordflow">if</span> (!(0xfff &amp; (filesz + offset))) { <span class="comment">// a 4KiB boundary</span></div>
<div class="line"><span class="lineno"> 4021</span>                <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> = 12;</div>
<div class="line"><span class="lineno"> 4022</span>                <span class="keywordflow">while</span> (!(~(~0u &lt;&lt; <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>) &amp; (filesz + offset))) {</div>
<div class="line"><span class="lineno"> 4023</span>                    ++<a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 4024</span>                }</div>
<div class="line"><span class="lineno"> 4025</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a> = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>, -1+ <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>);</div>
<div class="line"><span class="lineno"> 4026</span>            }</div>
<div class="line"><span class="lineno"> 4027</span>        }</div>
<div class="line"><span class="lineno"> 4028</span>    }</div>
<div class="line"><span class="lineno"> 4029</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a> =  1u  &lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4030</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a> = ~0ull&lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4031</span> </div>
<div class="line"><span class="lineno"> 4032</span>    <a class="code hl_variable" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">progid</a> = 0;  <span class="comment">// getRandomId();  not useful, so do not clutter</span></div>
<div class="line"><span class="lineno"> 4033</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a>;</div>
<div class="line"><span class="lineno"> 4034</span> </div>
<div class="line"><span class="lineno"> 4035</span>    <span class="comment">// only execute if option present</span></div>
<div class="line"><span class="lineno"> 4036</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.preserve_build_id) {</div>
<div class="line"><span class="lineno"> 4037</span>        <span class="comment">// set this so we can use elf_find_section_name</span></div>
<div class="line"><span class="lineno"> 4038</span>        <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 4039</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>) {</div>
<div class="line"><span class="lineno"> 4040</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4041</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 4042</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 4043</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4044</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4045</span>        }</div>
<div class="line"><span class="lineno"> 4046</span>        <span class="comment">//set the shstrtab</span></div>
<div class="line"><span class="lineno"> 4047</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>[<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">e_shstrndx</a>)];</div>
<div class="line"><span class="lineno"> 4048</span> </div>
<div class="line"><span class="lineno"> 4049</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> sh_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4050</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(sh_size); <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 4051</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4052</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>-&gt;sh_offset,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4053</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>, sh_size);</div>
<div class="line"><span class="lineno"> 4054</span> </div>
<div class="line"><span class="lineno"> 4055</span>        <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> <span class="keyword">const</span> *buildid = <a class="code hl_function" href="classPackLinuxElf32.html#a313f7710d0510a233bbda02e91d359a5">elf_find_section_name</a>(<span class="stringliteral">&quot;.note.gnu.build-id&quot;</span>);</div>
<div class="line"><span class="lineno"> 4056</span>        <span class="keywordflow">if</span> (buildid) {</div>
<div class="line"><span class="lineno"> 4057</span>            <span class="keywordtype">unsigned</span> bid_sh_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buildid-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4058</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(bid_sh_size);</div>
<div class="line"><span class="lineno"> 4059</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>.<a class="code hl_function" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">clear</a>();</div>
<div class="line"><span class="lineno"> 4060</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4061</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(buildid-&gt;sh_offset,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4062</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>((<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>, bid_sh_size);</div>
<div class="line"><span class="lineno"> 4063</span> </div>
<div class="line"><span class="lineno"> 4064</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a> = 3;</div>
<div class="line"><span class="lineno"> 4065</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>,0,<span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>));</div>
<div class="line"><span class="lineno"> 4066</span> </div>
<div class="line"><span class="lineno"> 4067</span>            <span class="comment">//setup the build-id</span></div>
<div class="line"><span class="lineno"> 4068</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[1], buildid, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[1]));</div>
<div class="line"><span class="lineno"> 4069</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[1].sh_name, 1);</div>
<div class="line"><span class="lineno"> 4070</span> </div>
<div class="line"><span class="lineno"> 4071</span>            <span class="comment">//setup the shstrtab</span></div>
<div class="line"><span class="lineno"> 4072</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[2], <a class="code hl_variable" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[2]));</div>
<div class="line"><span class="lineno"> 4073</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[2].sh_name, 20);</div>
<div class="line"><span class="lineno"> 4074</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[2].sh_size, 29); <span class="comment">//size of our static shstrtab</span></div>
<div class="line"><span class="lineno"> 4075</span>        }</div>
<div class="line"><span class="lineno"> 4076</span>    }</div>
<div class="line"><span class="lineno"> 4077</span>}</div>
<div class="ttc" id="aclassFilter_html"><div class="ttname"><a href="classFilter.html">Filter</a></div><div class="ttdoc">A filter is a reversible operation that modifies a given block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00047">filter.h:47</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a440e8db9c9010226d9778185f66529f5"><div class="ttname"><a href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc</a></div><div class="ttdeci">void alloc(upx_uint64_t bytes) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8cpp_source.html#l00170">membuffer.cpp:170</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_acea3f3781a8c941186b5777f13691c8c"><div class="ttname"><a href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear</a></div><div class="ttdeci">forceinline void clear(unsigned off, unsigned len) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00212">membuffer.h:212</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a313f7710d0510a233bbda02e91d359a5"><div class="ttname"><a href="classPackLinuxElf32.html#a313f7710d0510a233bbda02e91d359a5">PackLinuxElf32::elf_find_section_name</a></div><div class="ttdeci">Elf32_Shdr const * elf_find_section_name(char const *) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02299">p_lx_elf.cpp:2299</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a8c03f5577e3a79a7900f4159318998b8"><div class="ttname"><a href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">PackLinuxElf32::shdrout</a></div><div class="ttdeci">cprElfShdr3 shdrout</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00285">p_lx_elf.h:285</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a4036b37656b78e0053108ad8f9a17ef8"><div class="ttname"><a href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a></div><div class="ttdeci">MemBuffer buildid_data</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00126">p_lx_elf.h:126</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a55541b4f9e0f8f1fe16cb785b093ab1c"><div class="ttname"><a href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a></div><div class="ttdeci">MemBuffer mb_shdr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00084">p_lx_elf.h:84</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a622b799334a48cb6634e790f2566248a"><div class="ttname"><a href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">PackLinuxElf::getCompressionMethods</a></div><div class="ttdeci">virtual const int * getCompressionMethods(int method, int level) const override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01133">p_lx_elf.cpp:1133</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a76c2a145b6739ad4cd1035af406a821a"><div class="ttname"><a href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">PackLinuxElf::mb_shstrtab</a></div><div class="ttdeci">MemBuffer mb_shstrtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00123">p_lx_elf.h:123</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ab3ca408b94c072437e9e96a3b4e3ab1f"><div class="ttname"><a href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a></div><div class="ttdeci">unsigned sz_phdrs</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00091">p_lx_elf.h:91</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73"><div class="ttname"><a href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a></div><div class="ttdeci">@ OVERHEAD</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00135">p_unix.h:135</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a4e6db1e979cfd371114262e2887980ee"><div class="ttname"><a href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">PackUnix::progid</a></div><div class="ttdeci">unsigned progid</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00095">p_unix.h:95</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a6bbbfbba5b4b2b33de9d7801bd58b2cb"><div class="ttname"><a href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">PackUnix::getFilters</a></div><div class="ttdeci">virtual const int * getFilters() const override</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00052">p_unix.h:52</a></div></div>
<div class="ttc" id="aclassPacker_html_a476d801b02376434abccfd4b84e057fe"><div class="ttname"><a href="classPacker.html#a476d801b02376434abccfd4b84e057fe">Packer::prepareMethods</a></div><div class="ttdeci">int prepareMethods(int *methods, int ph_method, const int *all_methods) const</div><div class="ttdoc">void Packer::compressWithFilters(): Try compression with several methods and filters,...</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00907">packer.cpp:907</a></div></div>
<div class="ttc" id="aclassPacker_html_ad0ae5b698e68d64585e5be87a256f675"><div class="ttname"><a href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters</a></div><div class="ttdeci">void compressWithFilters(Filter *ft, const unsigned overlap_range, const upx_compress_config_t *cconf, int filter_strategy=0, bool inhibit_compression_check=false)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l01210">packer.cpp:1210</a></div></div>
<div class="ttc" id="aconf_8h_html_a273ac851b4231e7ae380d36191040548"><div class="ttname"><a href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a></div><div class="ttdeci">#define M_ALL</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00604">conf.h:604</a></div></div>
<div class="ttc" id="aconf_8h_html_a28c3ab53e0d5633976245bf127fe9a40"><div class="ttname"><a href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a></div><div class="ttdeci">#define NULL_cconf</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00720">conf.h:720</a></div></div>
<div class="ttc" id="aconf_8h_html_a75519eeb326c3b15b3059db3f3098881"><div class="ttname"><a href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a></div><div class="ttdeci">#define FT_END</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00620">conf.h:620</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a2763e101c247310abeb7b69e17dbebc2"><div class="ttname"><a href="p__lx__elf_8cpp.html#a2763e101c247310abeb7b69e17dbebc2">PT_GNU_STACK32</a></div><div class="ttdeci">#define PT_GNU_STACK32</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00057">p_lx_elf.cpp:57</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a842b75b2b1bb8f1ecaf89d8cabee935b"><div class="ttname"><a href="p__lx__elf_8cpp.html#a842b75b2b1bb8f1ecaf89d8cabee935b">PT_GNU_RELRO32</a></div><div class="ttdeci">#define PT_GNU_RELRO32</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00059">p_lx_elf.cpp:59</a></div></div>
<div class="ttc" id="apackhead_8cpp_html_ae33d5198af6a4110c9533bb4fdccffe6"><div class="ttname"><a href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a></div><div class="ttdeci">int ph_force_method(int method) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00295">packhead.cpp:295</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a11249bd7e61642742a68a3e7f69ac721"><div class="ttname"><a href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">Elf32_Ehdr::e_shnum</a></div><div class="ttdeci">Elf32_Half e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00201">bsd.h:201</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_afa2289f96d86fcc568a3b1f40cc8953e"><div class="ttname"><a href="structElf32__Ehdr.html#afa2289f96d86fcc568a3b1f40cc8953e">Elf32_Ehdr::e_phentsize</a></div><div class="ttdeci">Elf32_Half e_phentsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00198">bsd.h:198</a></div></div>
<div class="ttc" id="astructPackHeader_html"><div class="ttname"><a href="structPackHeader.html">PackHeader</a></div><div class="ttdoc">PackHeader also see stub/src/include/header.S.</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00037">packhead.h:37</a></div></div>
<div class="ttc" id="astructPackHeader_html_a1115672eeb2a2bb05760ce5c7fc0b5cf"><div class="ttname"><a href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a></div><div class="ttdeci">unsigned u_len</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00054">packhead.h:54</a></div></div>
<div class="ttc" id="astructPackHeader_html_a19b4cdc8a27935b591bcb85cb5ec3e9d"><div class="ttname"><a href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">PackHeader::level</a></div><div class="ttdeci">int level</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00053">packhead.h:53</a></div></div>
<div class="ttc" id="astructPackHeader_html_a448fca0da6280454a321894c7eb29e79"><div class="ttname"><a href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a></div><div class="ttdeci">unsigned c_len</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00055">packhead.h:55</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx()</a>, <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear()</a>, <a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters()</a>, <a class="el" href="structElf32__Ehdr.html#afa2289f96d86fcc568a3b1f40cc8953e">Elf32_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">Elf32_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a313f7710d0510a233bbda02e91d359a5">elf_find_section_name()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">PackLinuxElf::getCompressionMethods()</a>, <a class="el" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">PackUnix::getFilters()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">PackHeader::level</a>, <a class="el" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">PackLinuxElf::lg2_page</a>, <a class="el" href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">PackLinuxElf::mb_shstrtab</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a>, <a class="el" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, <a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a>, <a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method()</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">Packer::prepareMethods()</a>, <a class="el" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">PackUnix::progid</a>, <a class="el" href="p__lx__elf_8cpp.html#a842b75b2b1bb8f1ecaf89d8cabee935b">PT_GNU_RELRO32</a>, <a class="el" href="p__lx__elf_8cpp.html#a2763e101c247310abeb7b69e17dbebc2">PT_GNU_STACK32</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="p__lx__elf_8cpp.html#a59eb0ef71e7b110186c324070f393316">PT_NOTE32</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf32.html#a014f24da8144d063099bf9c9fc45f442">sec_strndx</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a5bafd32333cb29e162b3a21d3cd4c625_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a5bafd32333cb29e162b3a21d3cd4c625_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a5bafd32333cb29e162b3a21d3cd4c625_cgraph" id="aclassPackLinuxElf32_a5bafd32333cb29e162b3a21d3cd4c625_cgraph">
<area shape="rect" title=" " alt="" coords="5,706,172,731"/>
<area shape="rect" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8" title=" " alt="" coords="1027,421,1179,461"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="532,246,665,271"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="829,321,905,346"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="261,358,396,383"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="226,483,431,509"/>
<area shape="rect" href="classPackLinuxElf32.html#a313f7710d0510a233bbda02e91d359a5" title=" " alt="" coords="253,533,404,573"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="534,610,663,635"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="264,649,393,674"/>
<area shape="rect" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a" title=" " alt="" coords="220,699,437,739"/>
<area shape="rect" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb" title=" " alt="" coords="253,763,404,789"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="244,813,413,838"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="289,886,368,911"/>
<area shape="rect" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6" title=" " alt="" coords="261,935,396,961"/>
<area shape="rect" href="classPacker.html#a476d801b02376434abccfd4b84e057fe" title="void Packer::compressWithFilters(): Try compression with several methods and filters,..." alt="" coords="509,725,688,750"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="267,1086,390,1111"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="270,1037,387,1062"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="265,1135,393,1161"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1248,486,1367,511"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1059,837,1148,862"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="825,554,909,579"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="827,45,908,70"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="760,146,975,171"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1026,123,1181,149"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1028,37,1179,77"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="1232,5,1383,45"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="1232,69,1383,109"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="539,358,658,383"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="780,195,955,221"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1062,195,1145,221"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1033,786,1173,811"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1232,188,1383,228"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1431,156,1581,196"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1431,220,1581,260"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="565,561,632,586"/>
<area shape="rect" href="classPacker.html#ac91d266e1612ca6108035e22fe8b1203" title=" " alt="" coords="485,660,712,700"/>
<area shape="rect" href="classPacker.html#a4a969f788c3bad61abe0eec73fca0f0c" title="compression method util" alt="" coords="767,672,967,712"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="796,737,939,762"/>
<area shape="rect" href="util_8cpp.html#aa6941e20228b3e1dc459a36773b99633" title=" " alt="" coords="826,622,909,647"/>
<area shape="rect" href="packhead_8cpp.html#a99fd3f5cbc734f9863205a1e892ea48c" title="ph method util" alt="" coords="1023,737,1184,762"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="541,1086,656,1111"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="524,1037,673,1062"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="802,937,933,962"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="823,1111,912,1137"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="799,986,936,1011"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1024,996,1183,1036"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="541,911,657,937"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="839,887,896,913"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="799,838,935,863"/>
</map>
</div>

</div>
</div>
<a id="a475c24cd3f9652ad82ea69cdf377aca5" name="a475c24cd3f9652ad82ea69cdf377aca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a475c24cd3f9652ad82ea69cdf377aca5">&#9670;&#160;</a></span>pack2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf32::pack2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a619d0ed2f97d37150ed5b1437c67b6f1">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32x86interp.html#a71aac86ac0cc1e995dbe23e89d0967e8">PackLinuxElf32x86interp</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04985">4985</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4986</span>{</div>
<div class="line"><span class="lineno"> 4987</span>    Extent x;</div>
<div class="line"><span class="lineno"> 4988</span>    <span class="keywordtype">unsigned</span> k;</div>
<div class="line"><span class="lineno"> 4989</span>    <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = (!!<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib) &lt;&lt; 1;  <span class="comment">// bit 1; see is_shlib</span></div>
<div class="line"><span class="lineno"> 4990</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> is_shlib = (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) | <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>;</div>
<div class="line"><span class="lineno"> 4991</span>    <span class="keywordtype">unsigned</span> pre_xct_top = 0;  <span class="comment">// offset of end of PT_LOAD _before_ xct_off</span></div>
<div class="line"><span class="lineno"> 4992</span> </div>
<div class="line"><span class="lineno"> 4993</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>)) {</div>
<div class="line"><span class="lineno"> 4994</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a> = <a class="code hl_function" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type</a>(Elf32_Shdr::SHT_ARM_ATTRIBUTES);</div>
<div class="line"><span class="lineno"> 4995</span>    }</div>
<div class="line"><span class="lineno"> 4996</span>    <span class="comment">// count passes, set ptload vars</span></div>
<div class="line"><span class="lineno"> 4997</span>    uip-&gt;ui_total_passes = 0;</div>
<div class="line"><span class="lineno"> 4998</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno"> 4999</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_type)) {</div>
<div class="line"><span class="lineno"> 5000</span>            <span class="keywordflow">if</span> (!is_shlib) {</div>
<div class="line"><span class="lineno"> 5001</span>                uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5002</span>            }</div>
<div class="line"><span class="lineno"> 5003</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5004</span>                <span class="keywordtype">unsigned</span> p_flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_flags);</div>
<div class="line"><span class="lineno"> 5005</span>                <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_offset);</div>
<div class="line"><span class="lineno"> 5006</span>                <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5007</span>                <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset) &lt; p_filesz) { <span class="comment">// PT_LOAD covers xct_off</span></div>
<div class="line"><span class="lineno"> 5008</span>                    <span class="keywordflow">if</span> (!pre_xct_top &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> != p_offset) {</div>
<div class="line"><span class="lineno"> 5009</span>                        pre_xct_top = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5010</span>                    }</div>
<div class="line"><span class="lineno"> 5011</span>                }</div>
<div class="line"><span class="lineno"> 5012</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p_offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// candidate for pre_xct_top</span></div>
<div class="line"><span class="lineno"> 5013</span>                    <span class="keywordtype">unsigned</span> top = p_filesz + p_offset;</div>
<div class="line"><span class="lineno"> 5014</span>                    <span class="keywordflow">if</span> (pre_xct_top &lt; top) {</div>
<div class="line"><span class="lineno"> 5015</span>                        pre_xct_top = top;</div>
<div class="line"><span class="lineno"> 5016</span>                    }</div>
<div class="line"><span class="lineno"> 5017</span>                }</div>
<div class="line"><span class="lineno"> 5018</span>                <span class="keywordflow">if</span> (Elf32_Phdr::PF_W &amp; p_flags) {</div>
<div class="line"><span class="lineno"> 5019</span>                    <span class="comment">// rtld might write, so cannot compress</span></div>
<div class="line"><span class="lineno"> 5020</span>                }</div>
<div class="line"><span class="lineno"> 5021</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5022</span>                    <span class="comment">// First PT_LOAD (partial) only if has instructions</span></div>
<div class="line"><span class="lineno"> 5023</span>                    <span class="keywordflow">if</span> (k || <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; p_filesz) {</div>
<div class="line"><span class="lineno"> 5024</span>                        uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5025</span>                    }</div>
<div class="line"><span class="lineno"> 5026</span>                }</div>
<div class="line"><span class="lineno"> 5027</span>            }</div>
<div class="line"><span class="lineno"> 5028</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>)) {</div>
<div class="line"><span class="lineno"> 5029</span>                uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5030</span>            }</div>
<div class="line"><span class="lineno"> 5031</span>        }</div>
<div class="line"><span class="lineno"> 5032</span>    }</div>
<div class="line"><span class="lineno"> 5033</span> </div>
<div class="line"><span class="lineno"> 5034</span>    <span class="comment">// compress extents</span></div>
<div class="line"><span class="lineno"> 5035</span>    <span class="keywordtype">unsigned</span> hdr_u_len = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a>;</div>
<div class="line"><span class="lineno"> 5036</span> </div>
<div class="line"><span class="lineno"> 5037</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> =  0;</div>
<div class="line"><span class="lineno"> 5038</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = 0;</div>
<div class="line"><span class="lineno"> 5039</span>    uip-&gt;ui_pass = 0;</div>
<div class="line"><span class="lineno"> 5040</span>    ft.<a class="code hl_variable" href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">addvalue</a> = 0;</div>
<div class="line"><span class="lineno"> 5041</span> </div>
<div class="line"><span class="lineno"> 5042</span>    <span class="keywordflow">if</span> (is_shlib) { <span class="comment">// prepare to alter Phdrs and Shdrs</span></div>
<div class="line"><span class="lineno"> 5043</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + (!<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a></div>
<div class="line"><span class="lineno"> 5044</span>            ? 0</div>
<div class="line"><span class="lineno"> 5045</span>            : <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>))));</div>
<div class="line"><span class="lineno"> 5046</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// android omits Shdr here</span></div>
<div class="line"><span class="lineno"> 5047</span>    }</div>
<div class="line"><span class="lineno"> 5048</span>    <span class="keywordtype">unsigned</span> nk_f = 0; <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> xsz_f = 0;</div>
<div class="line"><span class="lineno"> 5049</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k)</div>
<div class="line"><span class="lineno"> 5050</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_type)</div>
<div class="line"><span class="lineno"> 5051</span>    &amp;&amp;  Elf32_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_flags)) {</div>
<div class="line"><span class="lineno"> 5052</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> xsz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5053</span>        <span class="keywordflow">if</span> (xsz_f &lt; xsz) {</div>
<div class="line"><span class="lineno"> 5054</span>            xsz_f = xsz;</div>
<div class="line"><span class="lineno"> 5055</span>            nk_f = k;</div>
<div class="line"><span class="lineno"> 5056</span>        }</div>
<div class="line"><span class="lineno"> 5057</span>    }</div>
<div class="line"><span class="lineno"> 5058</span>    <span class="keywordtype">int</span> nx = 0;</div>
<div class="line"><span class="lineno"> 5059</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k)</div>
<div class="line"><span class="lineno"> 5060</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_type)) {</div>
<div class="line"><span class="lineno"> 5061</span>        <span class="keywordflow">if</span> (ft.<a class="code hl_variable" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">id</a> &lt; 0x40) {</div>
<div class="line"><span class="lineno"> 5062</span>            <span class="comment">// FIXME: ??    ft.addvalue = phdri[k].p_vaddr;</span></div>
<div class="line"><span class="lineno"> 5063</span>        }</div>
<div class="line"><span class="lineno"> 5064</span>        <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_offset);</div>
<div class="line"><span class="lineno"> 5065</span>        <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5066</span>        x.offset = p_offset;</div>
<div class="line"><span class="lineno"> 5067</span>        x.size   = p_filesz;</div>
<div class="line"><span class="lineno"> 5068</span>        <span class="keywordflow">if</span> (is_shlib) {</div>
<div class="line"><span class="lineno"> 5069</span>            <span class="keywordflow">if</span> (x.offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// perhaps compressible: PT_LOAD[0] or PT_LOAD[1]</span></div>
<div class="line"><span class="lineno"> 5070</span>                <span class="comment">// Bytes below xct_off belong to rtld, so must be literal.</span></div>
<div class="line"><span class="lineno"> 5071</span>                <span class="comment">// Note that asl_pack2_Shdrs() copies up to xct_off, then adds extra info</span></div>
<div class="line"><span class="lineno"> 5072</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) { <span class="comment">// Copy up to xct_off, then add 2nd copy of Shdrs</span></div>
<div class="line"><span class="lineno"> 5073</span>                    <a class="code hl_function" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs</a>(fo, pre_xct_top);</div>
<div class="line"><span class="lineno"> 5074</span>                }</div>
<div class="line"><span class="lineno"> 5075</span>                <span class="keywordflow">else</span> { <span class="comment">// Just copy up to xct_off</span></div>
<div class="line"><span class="lineno"> 5076</span>                    x.size = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(uintmax_t(x.size), uintmax_t(0ull + <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - x.offset));</div>
<div class="line"><span class="lineno"> 5077</span>                    <span class="keywordflow">if</span> (0) { <span class="comment">// DEBUG paranoia</span></div>
<div class="line"><span class="lineno"> 5078</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(x.offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5079</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, x.size);</div>
<div class="line"><span class="lineno"> 5080</span>                        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5081</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *fip = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 5082</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *ibp = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 5083</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; x.size&gt;&gt;2; ++j) {</div>
<div class="line"><span class="lineno"> 5084</span>                            <span class="keywordflow">if</span> (fip[j] != ibp[j]) {</div>
<div class="line"><span class="lineno"> 5085</span>                                printf(<span class="stringliteral">&quot;[%#x]: file_image %#x  ibuf %#x\n&quot;</span>, j, fip[j], ibp[j]);</div>
<div class="line"><span class="lineno"> 5086</span>                            }</div>
<div class="line"><span class="lineno"> 5087</span>                        }</div>
<div class="line"><span class="lineno"> 5088</span>                    }</div>
<div class="line"><span class="lineno"> 5089</span> </div>
<div class="line"><span class="lineno"> 5090</span>                    <span class="comment">// FIXME: adler2 ?</span></div>
<div class="line"><span class="lineno"> 5091</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(x.offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5092</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[x.offset], x.size);</div>
<div class="line"><span class="lineno"> 5093</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += x.size;</div>
<div class="line"><span class="lineno"> 5094</span>                    <span class="comment">// Keep the input side in sync</span></div>
<div class="line"><span class="lineno"> 5095</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  += x.size;</div>
<div class="line"><span class="lineno"> 5096</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(x.size + x.offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5097</span>                }</div>
<div class="line"><span class="lineno"> 5098</span>                <span class="keywordflow">if</span> (hdr_u_len) { <span class="comment">// first time</span></div>
<div class="line"><span class="lineno"> 5099</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 5100</span> </div>
<div class="line"><span class="lineno"> 5101</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#abf70c0a5d8293e74153673a988cd61a4">l_checksum</a> = 0;  <span class="comment">// preliminary</span></div>
<div class="line"><span class="lineno"> 5102</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a> = <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>;</div>
<div class="line"><span class="lineno"> 5103</span>                    <a class="code hl_function" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1">set_le16</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_lsize</a>, <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);  <span class="comment">// preliminary (0)</span></div>
<div class="line"><span class="lineno"> 5104</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#a5dce623f92874cf890dc2f1d89f7c722">l_version</a> = (<span class="keywordtype">unsigned</span> char)<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">version</a>;</div>
<div class="line"><span class="lineno"> 5105</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#a86eb402570f0f7c31f1ffcf001f4e0b7">l_format</a> =  (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">format</a>;</div>
<div class="line"><span class="lineno"> 5106</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 5107</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 5108</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 5109</span> </div>
<div class="line"><span class="lineno"> 5110</span>                    <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 5111</span> </div>
<div class="line"><span class="lineno"> 5112</span>                    <a class="code hl_struct" href="structp__info.html">p_info</a> hbuf;</div>
<div class="line"><span class="lineno"> 5113</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a673ef061863e733588f4b12a7938d009">p_progid</a>, 0);</div>
<div class="line"><span class="lineno"> 5114</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_filesize</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 5115</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_blocksize</a>, <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>);</div>
<div class="line"><span class="lineno"> 5116</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;hbuf, <span class="keyword">sizeof</span>(hbuf));</div>
<div class="line"><span class="lineno"> 5117</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(hbuf);</div>
<div class="line"><span class="lineno"> 5118</span> </div>
<div class="line"><span class="lineno"> 5119</span>                    x.offset = 0;  <span class="comment">// save for decompress to restore original Elf headers</span></div>
<div class="line"><span class="lineno"> 5120</span>                    x.size = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5121</span>                    <span class="keywordtype">unsigned</span> in_size = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5122</span>                    <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, <span class="keyword">nullptr</span>, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5123</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> -= in_size;</div>
<div class="line"><span class="lineno"> 5124</span> </div>
<div class="line"><span class="lineno"> 5125</span>                    x.offset = p_offset + hdr_u_len;</div>
<div class="line"><span class="lineno"> 5126</span>                    x.size   = p_filesz - hdr_u_len;</div>
<div class="line"><span class="lineno"> 5127</span> </div>
<div class="line"><span class="lineno"> 5128</span>                    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = k + (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5129</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>, Elf32_Phdr::PF_X | <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>));</div>
<div class="line"><span class="lineno"> 5130</span>                    hdr_u_len = 0;  <span class="comment">// no longer the first time</span></div>
<div class="line"><span class="lineno"> 5131</span>                }</div>
<div class="line"><span class="lineno"> 5132</span>                <span class="comment">// The remainder above xct_off in first compressible PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5133</span>                <span class="keywordflow">if</span> (         p_filesz &gt;= (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset)) {</div>
<div class="line"><span class="lineno"> 5134</span>                    x.size = p_filesz -  (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset);</div>
<div class="line"><span class="lineno"> 5135</span>                    x.offset = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5136</span>                    <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5137</span>                }</div>
<div class="line"><span class="lineno"> 5138</span> </div>
<div class="line"><span class="lineno"> 5139</span>            }</div>
<div class="line"><span class="lineno"> 5140</span>            <span class="keywordflow">else</span> { <span class="comment">// definitely compressible unless writeable</span></div>
<div class="line"><span class="lineno"> 5141</span>                <span class="keywordflow">if</span> (!(Elf32_Phdr::PF_W &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_flags))) {</div>
<div class="line"><span class="lineno"> 5142</span>                    <span class="comment">// Read-only PT_LOAD, assume not written by relocations.</span></div>
<div class="line"><span class="lineno"> 5143</span>                    <span class="comment">// Also assume not the source for R_*_COPY relocation,</span></div>
<div class="line"><span class="lineno"> 5144</span>                    <span class="comment">// therefore compress it.</span></div>
<div class="line"><span class="lineno"> 5145</span>                    <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5146</span>                    <span class="comment">// De-compressing will re-create it, but otherwise ignore it.</span></div>
<div class="line"><span class="lineno"> 5147</span>                    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdro = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5148</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdro[k].p_type, Elf32_Phdr::PT_NULL);</div>
<div class="line"><span class="lineno"> 5149</span>                }</div>
<div class="line"><span class="lineno"> 5150</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5151</span>                    <span class="comment">// Read-write PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 5152</span>                    <span class="comment">// rtld might relocate, so we cannot compress.</span></div>
<div class="line"><span class="lineno"> 5153</span>                    <span class="comment">// (Could compress if not relocated; complicates run-time.)</span></div>
<div class="line"><span class="lineno"> 5154</span>                    <span class="comment">// Postpone writing until &quot;slide&quot;, but account for its size.</span></div>
<div class="line"><span class="lineno"> 5155</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> +=  x.size;</div>
<div class="line"><span class="lineno"> 5156</span>                }</div>
<div class="line"><span class="lineno"> 5157</span>            }</div>
<div class="line"><span class="lineno"> 5158</span>        }</div>
<div class="line"><span class="lineno"> 5159</span>        <span class="keywordflow">else</span>  <span class="comment">// main program, not shared library</span></div>
<div class="line"><span class="lineno"> 5160</span>        <span class="keywordflow">if</span> (hdr_u_len &lt;= (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)x.size) {</div>
<div class="line"><span class="lineno"> 5161</span>            <span class="keywordflow">if</span> (0 == nx) { <span class="comment">// 1st PT_LOAD32 must cover Ehdr at 0==p_offset</span></div>
<div class="line"><span class="lineno"> 5162</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> delta = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5163</span>                <span class="keywordflow">if</span> (ft.<a class="code hl_variable" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">id</a> &lt; 0x40) {</div>
<div class="line"><span class="lineno"> 5164</span>                    <span class="comment">// FIXME: ??     ft.addvalue += asl_delta;</span></div>
<div class="line"><span class="lineno"> 5165</span>                }</div>
<div class="line"><span class="lineno"> 5166</span>                <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)delta == x.size) { <span class="comment">// PT_LOAD[0] with ElfXX.Ehdr only</span></div>
<div class="line"><span class="lineno"> 5167</span>                    <span class="comment">// QBE backend - http://c9x.me/compile/</span></div>
<div class="line"><span class="lineno"> 5168</span>                    hdr_u_len = 0;  <span class="comment">// no fiddling necessary!</span></div>
<div class="line"><span class="lineno"> 5169</span>                    <span class="comment">// &amp;ft arg to packExtent will be zero because (k != nk_f)</span></div>
<div class="line"><span class="lineno"> 5170</span>                }</div>
<div class="line"><span class="lineno"> 5171</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5172</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += delta - hdr_u_len;</div>
<div class="line"><span class="lineno"> 5173</span>                    x.offset += delta;</div>
<div class="line"><span class="lineno"> 5174</span>                    x.size   -= delta;</div>
<div class="line"><span class="lineno"> 5175</span>                }</div>
<div class="line"><span class="lineno"> 5176</span>            }</div>
<div class="line"><span class="lineno"> 5177</span>            <span class="comment">// compressWithFilters() always assumes a &quot;loader&quot;, so would</span></div>
<div class="line"><span class="lineno"> 5178</span>            <span class="comment">// throw NotCompressible for small .data Extents, which PowerPC</span></div>
<div class="line"><span class="lineno"> 5179</span>            <span class="comment">// sometimes marks as PF_X anyway.  So filter only first segment.</span></div>
<div class="line"><span class="lineno"> 5180</span>            <span class="keywordflow">if</span> (k == nk_f || !is_shlib) {</div>
<div class="line"><span class="lineno"> 5181</span>                <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x,</div>
<div class="line"><span class="lineno"> 5182</span>                    (k==nk_f ? &amp;ft : <span class="keyword">nullptr</span> ), fo, hdr_u_len, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5183</span>            }</div>
<div class="line"><span class="lineno"> 5184</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5185</span>                <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5186</span>            }</div>
<div class="line"><span class="lineno"> 5187</span>            hdr_u_len = 0;</div>
<div class="line"><span class="lineno"> 5188</span>        }</div>
<div class="line"><span class="lineno"> 5189</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5190</span>                <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5191</span>        }</div>
<div class="line"><span class="lineno"> 5192</span>        ++nx;</div>
<div class="line"><span class="lineno"> 5193</span>    }</div>
<div class="line"><span class="lineno"> 5194</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">sz_pack2a</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);  <span class="comment">// MATCH01</span></div>
<div class="line"><span class="lineno"> 5195</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5196</span> </div>
<div class="line"><span class="lineno"> 5197</span>    <span class="comment">// Accounting only; ::pack3 will do the compression and output</span></div>
<div class="line"><span class="lineno"> 5198</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno"> 5199</span>        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += <a class="code hl_function" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 5200</span>    }</div>
<div class="line"><span class="lineno"> 5201</span> </div>
<div class="line"><span class="lineno"> 5202</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> != (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>)</div>
<div class="line"><span class="lineno"> 5203</span>        <a class="code hl_function" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a>();</div>
<div class="line"><span class="lineno"> 5204</span> </div>
<div class="line"><span class="lineno"> 5205</span>    <span class="keywordflow">return</span> 0;  <span class="comment">// omit end-of-compression bhdr for now</span></div>
<div class="line"><span class="lineno"> 5206</span>}</div>
<div class="ttc" id="abele_8h_html_ad88deaac7f8abe77334fa9f1efc73fa1"><div class="ttname"><a href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1">set_le16</a></div><div class="ttdeci">REQUIRE_XE16 bele_constexpr void set_le16(XE16 *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00344">bele.h:344</a></div></div>
<div class="ttc" id="absd_8h_html_a4c8d0b76b470ba65a43ca46a88320f39"><div class="ttname"><a href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a></div><div class="ttdeci">#define SEEK_CUR</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00102">bsd.h:102</a></div></div>
<div class="ttc" id="aclassFilter_html_a2f300af4994c93ee536e9002b315b1ea"><div class="ttname"><a href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">Filter::addvalue</a></div><div class="ttdeci">unsigned addvalue</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00071">filter.h:71</a></div></div>
<div class="ttc" id="aclassFilter_html_aac773bd22bdb2ba33014b5d58405d19f"><div class="ttname"><a href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">Filter::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00086">filter.h:86</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a12904e259a31849e8633faf26b5e07fe"><div class="ttname"><a href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">PackLinuxElf32::asl_pack2_Shdrs</a></div><div class="ttdeci">virtual void asl_pack2_Shdrs(OutputFile *, unsigned pre_xct_top)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l04405">p_lx_elf.cpp:4405</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a26ea5f1df204c3f64aa7d4bea4da1dd2"><div class="ttname"><a href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">PackLinuxElf32::find_LOAD_gap</a></div><div class="ttdeci">virtual unsigned find_LOAD_gap(Elf32_Phdr const *const phdri, unsigned const k, unsigned const e_phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l04949">p_lx_elf.cpp:4949</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a888f94bd6a90f535ea5567e3f8b39ccc"><div class="ttname"><a href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a></div><div class="ttdeci">unsigned linfo_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00110">p_lx_elf.h:110</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ae86e3eeb56091063ef73bbcab2c1262a"><div class="ttname"><a href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">PackLinuxElf::sz_pack2a</a></div><div class="ttdeci">unsigned sz_pack2a</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00094">p_lx_elf.h:94</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_af8b16212a7cce313d106777dc6c198af"><div class="ttname"><a href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a></div><div class="ttdeci">unsigned is_asl</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00098">p_lx_elf.h:98</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a8a994baf32174356ff73af67ad5d15ba"><div class="ttname"><a href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a></div><div class="ttdeci">struct l_info linfo</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00132">p_unix.h:132</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a914345298d86f797a6c960ca80afdeb7"><div class="ttname"><a href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a></div><div class="ttdeci">int lsize</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00099">p_unix.h:99</a></div></div>
<div class="ttc" id="aclassPackUnix_html_ad3f398fa4a3b34fd79f441e3069f78b1"><div class="ttname"><a href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent</a></div><div class="ttdeci">virtual void packExtent(const Extent &amp;x, Filter *, OutputFile *, unsigned hdr_len=0, unsigned b_extra=0, bool inhibit_compression_check=false)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00331">p_unix.cpp:331</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_ab8961782cfe1b9b4f96796b45672f762"><div class="ttname"><a href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a></div><div class="ttdeci">void throwEOFException(const char *msg, int e)</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00140">except.cpp:140</a></div></div>
<div class="ttc" id="astructPackHeader_html_ae01f8532b828892b503c900efe3b7f6f"><div class="ttname"><a href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a></div><div class="ttdeci">int version</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00050">packhead.h:50</a></div></div>
<div class="ttc" id="astructl__info_html_a5dce623f92874cf890dc2f1d89f7c722"><div class="ttname"><a href="structl__info.html#a5dce623f92874cf890dc2f1d89f7c722">l_info::l_version</a></div><div class="ttdeci">uint8_t l_version</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00336">bsd.h:336</a></div></div>
<div class="ttc" id="astructl__info_html_a86eb402570f0f7c31f1ffcf001f4e0b7"><div class="ttname"><a href="structl__info.html#a86eb402570f0f7c31f1ffcf001f4e0b7">l_info::l_format</a></div><div class="ttdeci">uint8_t l_format</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00337">bsd.h:337</a></div></div>
<div class="ttc" id="astructl__info_html_aa0149de209589df53c7af51a2fb2eba6"><div class="ttname"><a href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a></div><div class="ttdeci">uint32_t l_magic</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00334">bsd.h:334</a></div></div>
<div class="ttc" id="astructl__info_html_aa0f743c0ef6a36494c5ad64218a6a86f"><div class="ttname"><a href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a></div><div class="ttdeci">uint16_t l_lsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00335">bsd.h:335</a></div></div>
<div class="ttc" id="astructl__info_html_abf70c0a5d8293e74153673a988cd61a4"><div class="ttname"><a href="structl__info.html#abf70c0a5d8293e74153673a988cd61a4">l_info::l_checksum</a></div><div class="ttdeci">uint32_t l_checksum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00333">bsd.h:333</a></div></div>
<div class="ttc" id="astructp__info_html_a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0"><div class="ttname"><a href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a></div><div class="ttdeci">uint32_t p_filesize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00343">bsd.h:343</a></div></div>
<div class="ttc" id="astructp__info_html_a461ce9b60cfbb8fa0faab3b7e404c702"><div class="ttname"><a href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a></div><div class="ttdeci">uint32_t p_blocksize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00344">bsd.h:344</a></div></div>
<div class="ttc" id="astructp__info_html_a673ef061863e733588f4b12a7938d009"><div class="ttname"><a href="structp__info.html#a673ef061863e733588f4b12a7938d009">p_info::p_progid</a></div><div class="ttdeci">uint32_t p_progid</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00342">bsd.h:342</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">Filter::addvalue</a>, <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap()</a>, <a class="el" href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">PackHeader::format</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">Filter::id</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="structl__info.html#abf70c0a5d8293e74153673a988cd61a4">l_info::l_checksum</a>, <a class="el" href="structl__info.html#a86eb402570f0f7c31f1ffcf001f4e0b7">l_info::l_format</a>, <a class="el" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a>, <a class="el" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a>, <a class="el" href="structl__info.html#a5dce623f92874cf890dc2f1d89f7c722">l_info::l_version</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a>, <a class="el" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a>, <a class="el" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a>, <a class="el" href="structp__info.html#a673ef061863e733588f4b12a7938d009">p_info::p_progid</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1">set_le16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">PackLinuxElf::sz_pack2a</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="classPackLinuxElf32.html#a188a0aa12a6b1d42437cd1bb391424c1">sz_phdrx</a>, <a class="el" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, <a class="el" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8()</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a475c24cd3f9652ad82ea69cdf377aca5_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a475c24cd3f9652ad82ea69cdf377aca5_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a475c24cd3f9652ad82ea69cdf377aca5_cgraph" id="aclassPackLinuxElf32_a475c24cd3f9652ad82ea69cdf377aca5_cgraph">
<area shape="rect" title=" " alt="" coords="5,1173,172,1198"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="771,698,904,723"/>
<area shape="rect" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe" title=" " alt="" coords="231,1332,378,1372"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="773,1815,902,1841"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="772,1098,903,1123"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="511,1641,641,1666"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="537,974,615,999"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="512,747,640,773"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="512,1073,640,1098"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="553,1690,599,1715"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="553,1739,599,1765"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="232,1904,377,1944"/>
<area shape="rect" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2" title=" " alt="" coords="229,1840,381,1880"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="547,1023,605,1049"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="220,1969,389,1994"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="223,510,386,535"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="515,55,637,81"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="763,6,912,31"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="517,157,635,182"/>
<area shape="rect" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1" title=" " alt="" coords="266,2037,343,2062"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1223,762,1312,787"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1029,849,1105,874"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1025,563,1109,589"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1027,662,1108,687"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="960,613,1175,638"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="990,711,1145,737"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1360,1425,1479,1450"/>
<area shape="rect" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f" title=" " alt="" coords="489,1539,663,1565"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="481,1475,671,1515"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="547,1223,605,1249"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5" title=" " alt="" coords="545,1122,607,1147"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="505,1273,647,1298"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="766,1037,909,1062"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="999,359,1136,385"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="1000,1098,1135,1123"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="999,514,1135,539"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="779,359,895,385"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="997,259,1137,285"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="507,1891,645,1931"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="457,698,695,723"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="509,309,643,334"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="766,258,909,283"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="786,511,889,537"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="779,209,895,234"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="473,547,679,573"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="493,597,659,622"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="437,358,715,383"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="482,408,670,448"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="780,55,895,81"/>
<area shape="rect" href="bele_8h.html#af742fab6657d96b869354c0155245023" title=" " alt="" coords="535,2057,617,2082"/>
</map>
</div>

</div>
</div>
<a id="aaea43508f7513692cf3da5e91677c52c" name="aaea43508f7513692cf3da5e91677c52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaea43508f7513692cf3da5e91677c52c">&#9670;&#160;</a></span>pack3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf32::pack3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161">PackLinuxElf32x86interp</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00514">514</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  515</span>{</div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a>) {</div>
<div class="line"><span class="lineno">  517</span>        <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>) + (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> : <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno">  518</span>    }</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">super::pack3</a>(fo, ft);  <span class="comment">// loader follows compressed PT_LOADs</span></div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &amp;&amp; Elf32_Dyn::DT_INIT != <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>) { <span class="comment">// patch user_init_rp</span></div>
<div class="line"><span class="lineno">  522</span>        <span class="comment">// init_array[0] must have R_$(ARCH)_RELATIVE relocation.</span></div>
<div class="line"><span class="lineno">  523</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>((<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0], <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  524</span>        <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> rel(*(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>);</div>
<div class="line"><span class="lineno">  525</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> r_info = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;((<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>)-&gt;r_info);</div>
<div class="line"><span class="lineno">  526</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> r_type = (Elf32_Ehdr::EM_386  == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_386_RELATIVE</div>
<div class="line"><span class="lineno">  527</span>                     : (Elf32_Ehdr::EM_ARM  == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_ARM_RELATIVE</div>
<div class="line"><span class="lineno">  528</span>                     : (Elf32_Ehdr::EM_PPC  == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_PPC_RELATIVE</div>
<div class="line"><span class="lineno">  529</span>                     : (Elf32_Ehdr::EM_MIPS == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_MIPS_32</div>
<div class="line"><span class="lineno">  530</span>                     : 0;</div>
<div class="line"><span class="lineno">  531</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rel.r_info, ELF32_R_INFO(ELF32_R_SYM(r_info), r_type));</div>
<div class="line"><span class="lineno">  532</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;rel, <span class="keyword">sizeof</span>(rel));</div>
<div class="line"><span class="lineno">  533</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>        <span class="comment">// Value of init_array[0] will be changed later.</span></div>
<div class="line"><span class="lineno">  536</span>        <span class="comment">// See write() of &#39;cpr_entry&#39; below.</span></div>
<div class="line"><span class="lineno">  537</span>    }</div>
<div class="line"><span class="lineno">  538</span>    <span class="comment">// NOTE: PackLinuxElf::pack3  adjusted xct_off for the extra page</span></div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">// Then compressed gaps (including debuginfo.)</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno">  542</span>        Extent x;</div>
<div class="line"><span class="lineno">  543</span>        x.size = <a class="code hl_function" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">if</span> (x.size) {</div>
<div class="line"><span class="lineno">  545</span>            x.offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_offset) +</div>
<div class="line"><span class="lineno">  546</span>                       <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno">  547</span>            <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, <span class="keyword">nullptr</span>, fo);</div>
<div class="line"><span class="lineno">  548</span>        }</div>
<div class="line"><span class="lineno">  549</span>    }</div>
<div class="line"><span class="lineno">  550</span>    <span class="comment">// write block end marker (uncompressed size 0)</span></div>
<div class="line"><span class="lineno">  551</span>    <a class="code hl_struct" href="structb__info.html">b_info</a> hdr; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;hdr, 0, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno">  552</span>    <a class="code hl_function" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a>(&amp;hdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>, <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>);</div>
<div class="line"><span class="lineno">  553</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;hdr, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno">  554</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// not shared library</span></div>
<div class="line"><span class="lineno">  557</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_align, 0u - <a class="code hl_variable" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a>);</div>
<div class="line"><span class="lineno">  558</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_paddr = <a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno">  559</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_offset = 0;</div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordtype">unsigned</span> abrk = <a class="code hl_function" href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb">getbrk</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  561</span>        <span class="comment">// vbase handles ET_EXEC.  FIXME: pre-linking?</span></div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordtype">unsigned</span> vbase = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr);</div>
<div class="line"><span class="lineno">  563</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz, 0x1000);  <span class="comment">// Linux kernel SIGSEGV if (0==.p_filesz)</span></div>
<div class="line"><span class="lineno">  564</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_memsz, abrk - vbase);</div>
<div class="line"><span class="lineno">  565</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, Elf32_Phdr::PF_W|Elf32_Phdr::PF_R);</div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  567</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz,  <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  568</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr, abrk= (<a class="code hl_variable" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a> &amp; (~<a class="code hl_variable" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a> + abrk)));</div>
<div class="line"><span class="lineno">  569</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_paddr = <a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr;</div>
<div class="line"><span class="lineno">  570</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.ehdr.e_entry, abrk + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.ehdr.e_entry) - vbase);</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// shared library</span></div>
<div class="line"><span class="lineno">  573</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> cpr_entry = (Elf32_Ehdr::EM_ARM==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a>;  <span class="comment">// Thumb mode</span></div>
<div class="line"><span class="lineno">  574</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>], cpr_entry);  <span class="comment">// set the hook</span></div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>) { <span class="comment">// decompressor needs hint for DT_INIT_ARRAY</span></div>
<div class="line"><span class="lineno">  577</span>            <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *dynp = (<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)<a class="code hl_function" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr</a>(Elf32_Dyn::DT_NULL);</div>
<div class="line"><span class="lineno">  578</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;dynp-&gt;d_val, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0]);</div>
<div class="line"><span class="lineno">  579</span>        }</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *<span class="keyword">const</span> phdr0 = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno">  582</span>                <span class="stringliteral">&quot;bad e_phoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));</div>
<div class="line"><span class="lineno">  583</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdr = phdr0;</div>
<div class="line"><span class="lineno">  584</span>        <a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a> off = fo-&gt;<a class="code hl_function" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">st_size</a>();  <span class="comment">// 64 bits</span></div>
<div class="line"><span class="lineno">  585</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> = 0;</div>
<div class="line"><span class="lineno">  586</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) {</div>
<div class="line"><span class="lineno">  587</span>            <span class="comment">// p_vaddr and p_paddr do not change!</span></div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno">  589</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ioff = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[j].p_offset);  <span class="comment">// without asl_delta</span></div>
<div class="line"><span class="lineno">  590</span>            <span class="keywordtype">unsigned</span>       align= <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">p_align</a>);</div>
<div class="line"><span class="lineno">  591</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>);</div>
<div class="line"><span class="lineno">  592</span>            <span class="keywordflow">if</span> (Elf32_Phdr::PT_INTERP==type) {</div>
<div class="line"><span class="lineno">  593</span>                <span class="comment">// Rotate to highest position, so it can be lopped</span></div>
<div class="line"><span class="lineno">  594</span>                <span class="comment">// by decrementing e_phnum.</span></div>
<div class="line"><span class="lineno">  595</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, phdr, <span class="keyword">sizeof</span>(*phdr));  <span class="comment">// extract</span></div>
<div class="line"><span class="lineno">  596</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove</a>(phdr, 1+phdr, (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - (1+ j))*<span class="keyword">sizeof</span>(*phdr));  <span class="comment">// overlapping</span></div>
<div class="line"><span class="lineno">  597</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;phdr[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - (1+ j)], (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <span class="keyword">sizeof</span>(*phdr));  <span class="comment">// to top</span></div>
<div class="line"><span class="lineno">  598</span>                --phdr; --<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>;</div>
<div class="line"><span class="lineno">  599</span>                <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  600</span>                <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;((<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>)-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  601</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  602</span>            }</div>
<div class="line"><span class="lineno">  603</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> == type) {</div>
<div class="line"><span class="lineno">  604</span>                <span class="keywordflow">if</span> (!ioff) { <span class="comment">// first PT_LOAD must contain everything written so far</span></div>
<div class="line"><span class="lineno">  605</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);  <span class="comment">// is this correct?</span></div>
<div class="line"><span class="lineno">  606</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">p_memsz</a>,  <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  607</span>                }</div>
<div class="line"><span class="lineno">  608</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - ioff) &lt; len) { <span class="comment">// Change length of compressed PT_LOAD.</span></div>
<div class="line"><span class="lineno">  609</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - ioff);  <span class="comment">// FIXME  (sz_pack2 + lsize - ioff) ?</span></div>
<div class="line"><span class="lineno">  610</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">p_memsz</a>,  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - ioff);</div>
<div class="line"><span class="lineno">  611</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// MIPS puts PT_DYNAMIC here</span></div>
<div class="line"><span class="lineno">  612</span>                        <span class="comment">// Allow for DT_INIT in a new [stolen] slot</span></div>
<div class="line"><span class="lineno">  613</span>                        <span class="keywordtype">unsigned</span> off2 = <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> - <span class="keyword">sizeof</span>(unsigned);</div>
<div class="line"><span class="lineno">  614</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off2, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  615</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[off2], 2*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>));</div>
<div class="line"><span class="lineno">  616</span>                    }</div>
<div class="line"><span class="lineno">  617</span>                }</div>
<div class="line"><span class="lineno">  618</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; ioff) { <span class="comment">// Slide subsequent PT_LOAD.</span></div>
<div class="line"><span class="lineno">  619</span>                    <span class="keywordflow">if</span> ((1u&lt;&lt;12) &lt; align</div>
<div class="line"><span class="lineno">  620</span>                    &amp;&amp;  (  Elf32_Ehdr::EM_386 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno">  621</span>                        || Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>)  <span class="comment">// FIXME: other $ARCH ?</span></div>
<div class="line"><span class="lineno">  622</span>                    ) {</div>
<div class="line"><span class="lineno">  623</span>                        align = 1u&lt;&lt;12;</div>
<div class="line"><span class="lineno">  624</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">p_align</a>, align);</div>
<div class="line"><span class="lineno">  625</span>                    }</div>
<div class="line"><span class="lineno">  626</span>                    off = <a class="code hl_function" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a>(fo, (-1 + align) &amp; (ioff - off));</div>
<div class="line"><span class="lineno">  627</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>) {</div>
<div class="line"><span class="lineno">  628</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> = off - ((<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0) + ioff);</div>
<div class="line"><span class="lineno">  629</span>                        <span class="comment">//asl_slide_Shdrs();</span></div>
<div class="line"><span class="lineno">  630</span>                    }</div>
<div class="line"><span class="lineno">  631</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>, off);</div>
<div class="line"><span class="lineno">  632</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  633</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[ioff], len);</div>
<div class="line"><span class="lineno">  634</span>                    off += len;</div>
<div class="line"><span class="lineno">  635</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = off;</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>                    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> - ioff) &lt; len) {</div>
<div class="line"><span class="lineno">  638</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  639</span>                        <span class="keywordtype">unsigned</span> word = cpr_entry;</div>
<div class="line"><span class="lineno">  640</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;word, cpr_entry);</div>
<div class="line"><span class="lineno">  641</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;word, <span class="keyword">sizeof</span>(word));</div>
<div class="line"><span class="lineno">  642</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno">  643</span>                    }</div>
<div class="line"><span class="lineno">  644</span>                }</div>
<div class="line"><span class="lineno">  645</span>                <span class="keywordflow">continue</span>;  <span class="comment">// all done with this PT_LOAD</span></div>
<div class="line"><span class="lineno">  646</span>            }</div>
<div class="line"><span class="lineno">  647</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; ioff) {</div>
<div class="line"><span class="lineno">  648</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0) + ioff);</div>
<div class="line"><span class="lineno">  649</span>            }</div>
<div class="line"><span class="lineno">  650</span>        }  <span class="comment">// end each Phdr</span></div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a> || <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) { <span class="comment">// must update Shdr.sh_offset for so_slide</span></div>
<div class="line"><span class="lineno">  653</span>            <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>;</div>
<div class="line"><span class="lineno">  654</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++shdr, ++j) {</div>
<div class="line"><span class="lineno">  655</span>                <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno">  656</span>                <span class="keywordflow">if</span> (Elf32_Shdr::SHT_REL == sh_type</div>
<div class="line"><span class="lineno">  657</span>                &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>  <span class="comment">// FIXME  who sets this?</span></div>
<div class="line"><span class="lineno">  658</span>                &amp;&amp;  !<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rel.plt&quot;</span>, <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_name) + <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>)) {</div>
<div class="line"><span class="lineno">  659</span>                    <span class="keywordtype">unsigned</span> va = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_PLTGOT)</div>
<div class="line"><span class="lineno">  660</span>                        - (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0);</div>
<div class="line"><span class="lineno">  661</span>                    <span class="comment">// Now use the old Phdrs (phdri)</span></div>
<div class="line"><span class="lineno">  662</span>                    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phva;</div>
<div class="line"><span class="lineno">  663</span>                    phva = <a class="code hl_function" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va</a>(va, <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  664</span>                    <span class="keywordtype">unsigned</span> old_off = (va - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>))</div>
<div class="line"><span class="lineno">  665</span>                        + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>                    <span class="comment">// Now use the new Phdrs (phdr0)</span></div>
<div class="line"><span class="lineno">  668</span>                    va += (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0);</div>
<div class="line"><span class="lineno">  669</span>                    phva = <a class="code hl_function" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va</a>(va, phdr0, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  670</span>                    <span class="keywordtype">unsigned</span> new_off = (va - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>))</div>
<div class="line"><span class="lineno">  671</span>                        + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>                    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>) {</div>
<div class="line"><span class="lineno">  674</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(new_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  675</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[old_off], <a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a> * 4);</div>
<div class="line"><span class="lineno">  676</span>                    }</div>
<div class="line"><span class="lineno">  677</span>                }</div>
<div class="line"><span class="lineno">  678</span>                <span class="keywordflow">if</span> (j &amp;&amp; shdr-&gt;sh_addr == 0</div>
<div class="line"><span class="lineno">  679</span>                &amp;&amp;  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno">  680</span>                    <span class="comment">// Try to be nice by sliding; but still fails if compressed.</span></div>
<div class="line"><span class="lineno">  681</span>                    <span class="comment">// So don&#39;t do it unless appending plain text of shstrtab.</span></div>
<div class="line"><span class="lineno">  682</span>                    <span class="keywordtype">unsigned</span> sh_off = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno">  683</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_off) {</div>
<div class="line"><span class="lineno">  684</span>                        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr-&gt;sh_offset, sh_off + <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>);</div>
<div class="line"><span class="lineno">  685</span>                    }</div>
<div class="line"><span class="lineno">  686</span>                }</div>
<div class="line"><span class="lineno">  687</span>            }</div>
<div class="line"><span class="lineno">  688</span>            <span class="comment">// Maybe: append plain text of shstrtab strings?</span></div>
<div class="line"><span class="lineno">  689</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  690</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>) {</div>
<div class="line"><span class="lineno">  691</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;((<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>())-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno">  692</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno">  693</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*shdr));</div>
<div class="line"><span class="lineno">  694</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*shdr);</div>
<div class="line"><span class="lineno">  695</span>                }</div>
<div class="line"><span class="lineno">  696</span>            }</div>
<div class="line"><span class="lineno">  697</span>        }</div>
<div class="line"><span class="lineno">  698</span>        <span class="keywordflow">else</span> { <span class="comment">// output has no Shdr</span></div>
<div class="line"><span class="lineno">  699</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">e_shnum</a> = 0;</div>
<div class="line"><span class="lineno">  700</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">e_shoff</a> = 0;</div>
<div class="line"><span class="lineno">  701</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">e_shstrndx</a> = 0;</div>
<div class="line"><span class="lineno">  702</span>        }</div>
<div class="line"><span class="lineno">  703</span>    }</div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno">  705</span>}</div>
<div class="ttc" id="abele_8h_html_ab07367b17d1a80bb3cd4eeb48b4fdde5"><div class="ttname"><a href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr void set_le32(XE32 *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00346">bele.h:346</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a05fb6e81deb6d535c8192cfbb1eb5732"><div class="ttname"><a href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">OutputFile::st_size</a></div><div class="ttdeci">virtual upx_off_t st_size() const override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00303">file.cpp:303</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a69001fad2a5e68585846d1fb1abd2afb"><div class="ttname"><a href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb">PackLinuxElf32::getbrk</a></div><div class="ttdeci">virtual off_t getbrk(const Elf32_Phdr *phdr, int e_phnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03403">p_lx_elf.cpp:3403</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3409fd940ae9b30dc51e68f69e0160f6"><div class="ttname"><a href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf::pack3</a></div><div class="ttdeci">virtual off_t pack3(OutputFile *, Filter &amp;) override=0</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00383">p_lx_elf.cpp:383</a></div></div>
<div class="ttc" id="astructb__info_html_a29bbf0f18e0c39a8f826067d7ed80602"><div class="ttname"><a href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a></div><div class="ttdeci">uint32_t sz_cpr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00324">bsd.h:324</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a8012d8687b040cb0d6a7ad890856cf49"><div class="ttname"><a href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove</a></div><div class="ttdeci">void * memmove(C&lt; T &gt; a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00117">xspan_fwd.h:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">Elf32_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb">getbrk()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf32__Phdr.html#afd09d9e4297b13fc94fd57d09f2a9f70">Elf32_Phdr::p_align</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ada1cdd3d6ccb79a17bed0e3c21379c84">Elf32_Phdr::p_memsz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf::pack3()</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackLinuxElf32.html#ae1048a909a2fce5d2c861b88974f81d6">page_mask</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32()</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, <a class="el" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">OutputFile::st_size()</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aaea43508f7513692cf3da5e91677c52c_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aaea43508f7513692cf3da5e91677c52c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aaea43508f7513692cf3da5e91677c52c_cgraph" id="aclassPackLinuxElf32_aaea43508f7513692cf3da5e91677c52c_cgraph">
<area shape="rect" title=" " alt="" coords="5,711,172,736"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="505,25,650,65"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="775,140,904,166"/>
<area shape="rect" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0" title=" " alt="" coords="233,184,378,224"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="230,82,381,122"/>
<area shape="rect" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2" title=" " alt="" coords="229,292,381,332"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="548,608,607,634"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="768,559,911,584"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="774,760,905,786"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5" title=" " alt="" coords="547,559,608,584"/>
<area shape="rect" href="classPackLinuxElf32.html#a69001fad2a5e68585846d1fb1abd2afb" title=" " alt="" coords="220,356,391,382"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="221,2182,390,2207"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="538,1187,617,1212"/>
<area shape="rect" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49" title=" " alt="" coords="793,1147,886,1172"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="995,2052,1071,2078"/>
<area shape="rect" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6" title=" " alt="" coords="230,862,381,887"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="513,1012,641,1038"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="513,1062,641,1087"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="224,1579,387,1604"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="234,660,377,686"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="513,1402,641,1427"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="267,1842,344,1867"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="272,2255,339,2280"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="234,458,377,483"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="540,191,615,216"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="508,292,647,332"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="780,432,899,458"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="964,1014,1101,1039"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="772,608,907,634"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="513,862,642,887"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="764,1018,915,1043"/>
<area shape="rect" href="classPackUnix.html#a573f3c8c4c540f51c2a7b168535d4741" title=" " alt="" coords="513,911,642,936"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="554,760,601,786"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="773,1979,906,2004"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="458,1979,697,2004"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="510,1604,645,1630"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="768,1554,911,1579"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="963,1528,1103,1554"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="788,1704,891,1730"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="781,1655,897,1680"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="475,1831,680,1856"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="494,1880,661,1906"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="516,1930,639,1955"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="519,1352,636,1378"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="439,1503,716,1528"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="483,1288,671,1328"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="992,1979,1073,2004"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="781,1351,897,1376"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="965,1376,1101,1402"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="488,458,667,483"/>
</map>
</div>

</div>
</div>
<a id="ad190f7b83d9aaccf78119ebb0f00eb41" name="ad190f7b83d9aaccf78119ebb0f00eb41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad190f7b83d9aaccf78119ebb0f00eb41">&#9670;&#160;</a></span>pack4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::pack4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05996">5996</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5997</span>{</div>
<div class="line"><span class="lineno"> 5998</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 5999</span>        <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 6000</span>    }</div>
<div class="line"><span class="lineno"> 6001</span> </div>
<div class="line"><span class="lineno"> 6002</span>    cprElfHdr4 *eho = !<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 6003</span>            ? (cprElfHdr4 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>  <span class="comment">// not shlib  FIXME: ugly casting</span></div>
<div class="line"><span class="lineno"> 6004</span>            : (cprElfHdr4 *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();  <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 6005</span>    <span class="keywordtype">unsigned</span> penalty = <a class="code hl_function" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">forward_Shdrs</a>(fo, &amp;eho-&gt;ehdr); (void)penalty;</div>
<div class="line"><span class="lineno"> 6006</span> </div>
<div class="line"><span class="lineno"> 6007</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.preserve_build_id) { <span class="comment">// FIXME: co-ordinate with forward_Shdrs</span></div>
<div class="line"><span class="lineno"> 6008</span>        <span class="comment">// calc e_shoff here and write shdrout, then o_shstrtab</span></div>
<div class="line"><span class="lineno"> 6009</span>        <span class="comment">//NOTE: these are pushed last to ensure nothing is stepped on</span></div>
<div class="line"><span class="lineno"> 6010</span>        <span class="comment">//for the UPX structure.</span></div>
<div class="line"><span class="lineno"> 6011</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6012</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;eho-&gt;ehdr.e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6013</span> </div>
<div class="line"><span class="lineno"> 6014</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>);</div>
<div class="line"><span class="lineno"> 6015</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize1 = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[1].sh_size);</div>
<div class="line"><span class="lineno"> 6016</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize2 = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[2].sh_size);</div>
<div class="line"><span class="lineno"> 6017</span> </div>
<div class="line"><span class="lineno"> 6018</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[2].sh_offset,          ssize + <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6019</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>.shdr[1].sh_offset, ssize2 + ssize + <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6020</span> </div>
<div class="line"><span class="lineno"> 6021</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>, ssize); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize;</div>
<div class="line"><span class="lineno"> 6022</span> </div>
<div class="line"><span class="lineno"> 6023</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">o_shstrtab</a>, ssize2); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize2;</div>
<div class="line"><span class="lineno"> 6024</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>, ssize1); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize1;</div>
<div class="line"><span class="lineno"> 6025</span>    }</div>
<div class="line"><span class="lineno"> 6026</span> </div>
<div class="line"><span class="lineno"> 6027</span>    <span class="comment">// ph.u_len and ph.c_len are leftover from earliest days when there was</span></div>
<div class="line"><span class="lineno"> 6028</span>    <span class="comment">// only one compressed extent.  Use a good analogy for multiple extents.</span></div>
<div class="line"><span class="lineno"> 6029</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;</div>
<div class="line"><span class="lineno"> 6030</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 6031</span>    <a class="code hl_function" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">super::pack4</a>(fo, ft);  <span class="comment">// write PackHeader and overlay_offset</span></div>
<div class="line"><span class="lineno"> 6032</span> </div>
<div class="line"><span class="lineno"> 6033</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6034</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {  <span class="comment">// shared library</span></div>
<div class="line"><span class="lineno"> 6035</span>        { <span class="comment">// Shouldn&#39;t this special case be handled earlier?</span></div>
<div class="line"><span class="lineno"> 6036</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 6037</span>                <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *phdro = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)&amp;eho-&gt;phdr;</div>
<div class="line"><span class="lineno"> 6038</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdro-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>, Elf32_Phdr::PF_X | <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdro-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>));</div>
<div class="line"><span class="lineno"> 6039</span>            }</div>
<div class="line"><span class="lineno"> 6040</span>        }</div>
<div class="line"><span class="lineno"> 6041</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a> &amp;&amp; !<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a>) {</div>
<div class="line"><span class="lineno"> 6042</span>            <span class="comment">// Make it abundantly clear that there are no Elf32_Shdr in this shlib</span></div>
<div class="line"><span class="lineno"> 6043</span>            eho-&gt;ehdr.e_shoff = 0;</div>
<div class="line"><span class="lineno"> 6044</span>            <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;ehdr.e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>));  <span class="comment">// Android bug: cannot use 0</span></div>
<div class="line"><span class="lineno"> 6045</span>            eho-&gt;ehdr.e_shnum = 0;</div>
<div class="line"><span class="lineno"> 6046</span>            eho-&gt;ehdr.e_shstrndx = 0;</div>
<div class="line"><span class="lineno"> 6047</span>        }</div>
<div class="line"><span class="lineno"> 6048</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>));</div>
<div class="line"><span class="lineno"> 6049</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6050</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));  <span class="comment">// new info: l_checksum, l_size</span></div>
<div class="line"><span class="lineno"> 6051</span> </div>
<div class="line"><span class="lineno"> 6052</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a>) {</div>
<div class="line"><span class="lineno"> 6053</span>            <span class="keywordtype">unsigned</span> tmp = <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 6054</span>            tmp |= (Elf32_Ehdr::EM_ARM==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);  <span class="comment">// THUMB mode</span></div>
<div class="line"><span class="lineno"> 6055</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;tmp, tmp);</div>
<div class="line"><span class="lineno"> 6056</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_function" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a>-&gt;st_value, <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6057</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;tmp, <span class="keyword">sizeof</span>(tmp));</div>
<div class="line"><span class="lineno"> 6058</span>        }</div>
<div class="line"><span class="lineno"> 6059</span>    }</div>
<div class="line"><span class="lineno"> 6060</span>    <span class="keywordflow">else</span> { <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 6061</span>        <span class="comment">// Cannot pre-round .p_memsz.  If .p_filesz &lt; .p_memsz, then kernel</span></div>
<div class="line"><span class="lineno"> 6062</span>        <span class="comment">// tries to make .bss, which requires PF_W.</span></div>
<div class="line"><span class="lineno"> 6063</span>        <span class="comment">// But strict SELinux (or PaX, grSecurity) disallows PF_W with PF_X.</span></div>
<div class="line"><span class="lineno"> 6064</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno"> 6065</span>                  eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz = eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz;</div>
<div class="line"><span class="lineno"> 6066</span> </div>
<div class="line"><span class="lineno"> 6067</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6068</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;eho-&gt;ehdr, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + 2* <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 6069</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6070</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 6071</span>    }</div>
<div class="line"><span class="lineno"> 6072</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a4b9fc35299e310d90855abb422cd660a"><div class="ttname"><a href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">PackLinuxElf32::forward_Shdrs</a></div><div class="ttdeci">virtual unsigned forward_Shdrs(OutputFile *fo, Elf32_Ehdr *ehdro)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05603">p_lx_elf.cpp:5603</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a539c946c8c36fa509670ec9948ccb1fc"><div class="ttname"><a href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a></div><div class="ttdeci">upx_uint64_t jni_onload_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00105">p_lx_elf.h:105</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a793632661a0af5efd197304078be1ed0"><div class="ttname"><a href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">PackLinuxElf::o_shstrtab</a></div><div class="ttdeci">static const unsigned char o_shstrtab[]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00130">p_lx_elf.h:130</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a7d92de9aedc1747be87ef5968952838c"><div class="ttname"><a href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix::pack4</a></div><div class="ttdeci">virtual void pack4(OutputFile *, Filter &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00274">p_unix.cpp:274</a></div></div>
<div class="ttc" id="autil_8cpp_html_a49db04c61486d695f7f04b44ac2201c0"><div class="ttname"><a href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a></div><div class="ttdeci">unsigned ptr_udiff_bytes(const void *a, const void *b) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00126">util.cpp:126</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">forward_Shdrs()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a>, <a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">PackLinuxElf::o_shstrtab</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a>, <a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix::pack4()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf32.html#a6a46ce4ee2f2878d9122e12b8106e0ae">sec_arm_attr</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a8c03f5577e3a79a7900f4159318998b8">shdrout</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_ad190f7b83d9aaccf78119ebb0f00eb41_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_ad190f7b83d9aaccf78119ebb0f00eb41_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_ad190f7b83d9aaccf78119ebb0f00eb41_cgraph" id="aclassPackLinuxElf32_ad190f7b83d9aaccf78119ebb0f00eb41_cgraph">
<area shape="rect" title=" " alt="" coords="5,642,172,668"/>
<area shape="rect" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a" title=" " alt="" coords="220,435,399,475"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="517,169,576,194"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="722,581,853,606"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="482,70,611,96"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="462,120,631,145"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="475,644,618,669"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="483,268,611,293"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="483,693,611,718"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="483,794,611,820"/>
<area shape="rect" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c" title=" " alt="" coords="245,845,374,870"/>
<area shape="rect" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0" title=" " alt="" coords="1238,1145,1357,1170"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="471,442,622,468"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="523,492,570,517"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="749,693,825,718"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="973,380,1088,405"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="488,218,605,244"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="513,393,580,418"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="716,26,859,52"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1486,229,1623,254"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="963,581,1098,606"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1716,430,1847,456"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1253,654,1342,680"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1253,430,1342,456"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="1253,756,1342,781"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1234,532,1361,557"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="1233,581,1362,606"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1461,532,1648,557"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1475,694,1634,734"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1722,805,1841,830"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="729,217,845,242"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="1002,229,1059,254"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="963,278,1099,304"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1485,856,1625,881"/>
<area shape="rect" href="classPackUnix.html#aced1a9bb3fee3c231bfc90051224a6dd" title=" " alt="" coords="447,896,647,921"/>
<area shape="rect" href="classPacker.html#af51db683baf7d75a65f48429b77db475" title="patch util for loader" alt="" coords="958,885,1103,910"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="1181,805,1413,830"/>
<area shape="rect" href="classPacker.html#ad1f9499f529513c9d26fc647968dfe7e" title=" " alt="" coords="695,936,880,961"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="1259,1070,1336,1096"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1273,1008,1321,1033"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="1233,906,1361,932"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1485,805,1624,830"/>
<area shape="rect" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156" title=" " alt="" coords="990,1085,1071,1110"/>
<area shape="rect" href="classPacker.html#a02f8ef879cf94330288554bc525e8fd3" title="filter util; see class FilterImpl" alt="" coords="957,1036,1105,1061"/>
<area shape="rect" href="structPackHeader.html#a3c61166ce01a954f2c2ec5c9a563f478" title="see stub/src/include/header.S" alt="" coords="928,934,1133,960"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1514,1044,1595,1069"/>
<area shape="rect" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225" title="ptr util" alt="" coords="1499,1145,1610,1170"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="1696,1120,1867,1145"/>
<area shape="rect" href="util_8h.html#a38df66b3eff123e66d6b92ceb76eb4c3" title=" " alt="" coords="1733,1169,1830,1194"/>
<area shape="rect" href="util_8h.html#ada5fbeddd8d88707d5b8dd9fa6557c65" title="ptr util" alt="" coords="1915,1169,2041,1194"/>
</map>
</div>

</div>
</div>
<a id="adad4336fa530cb9da3d195d9e300317c" name="adad4336fa530cb9da3d195d9e300317c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adad4336fa530cb9da3d195d9e300317c">&#9670;&#160;</a></span>packed_struct() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr1&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00249">249</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  249</span>                              {</div>
<div class="line"><span class="lineno">  250</span>        <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  251</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> phdr[1];</div>
<div class="line"><span class="lineno">  252</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  253</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a1b210d9e6476af2004d00b23c4a00c95" name="a1b210d9e6476af2004d00b23c4a00c95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b210d9e6476af2004d00b23c4a00c95">&#9670;&#160;</a></span>packed_struct() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr2&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00255">255</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  255</span>                              {</div>
<div class="line"><span class="lineno">  256</span>        <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  257</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> phdr[2];</div>
<div class="line"><span class="lineno">  258</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  259</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="ab163d7a5984874e85649cc44c8b73793" name="ab163d7a5984874e85649cc44c8b73793"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab163d7a5984874e85649cc44c8b73793">&#9670;&#160;</a></span>packed_struct() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr3&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00261">261</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>                              {</div>
<div class="line"><span class="lineno">  262</span>        <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> phdr[3];</div>
<div class="line"><span class="lineno">  264</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  265</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="abddcb05bd923d39c073a529a0cc36f78" name="abddcb05bd923d39c073a529a0cc36f78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abddcb05bd923d39c073a529a0cc36f78">&#9670;&#160;</a></span>packed_struct() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr4&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00267">267</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  267</span>                              {</div>
<div class="line"><span class="lineno">  268</span>        <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  269</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> phdr[4];</div>
<div class="line"><span class="lineno">  270</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  271</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a51dbad0e6cf4a9326f7ec267e2f9b3cf" name="a51dbad0e6cf4a9326f7ec267e2f9b3cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51dbad0e6cf4a9326f7ec267e2f9b3cf">&#9670;&#160;</a></span>packed_struct() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdrNetBSD&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00273">273</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  273</span>                                   {</div>
<div class="line"><span class="lineno">  274</span>        <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  275</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> phdr[4];</div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> notes[512];</div>
<div class="line"><span class="lineno">  277</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a53fbaa32428822f238a62aac48e9cb56" name="a53fbaa32428822f238a62aac48e9cb56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53fbaa32428822f238a62aac48e9cb56">&#9670;&#160;</a></span>packed_struct() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf32::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfShdr3&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00281">281</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>                               {</div>
<div class="line"><span class="lineno">  282</span>        <a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> shdr[3];</div>
<div class="line"><span class="lineno">  283</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2acf155f6a76482cd3cbd17cef800e6" name="aa2acf155f6a76482cd3cbd17cef800e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2acf155f6a76482cd3cbd17cef800e6">&#9670;&#160;</a></span>PackLinuxElf32help1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::PackLinuxElf32help1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInputFile.html">InputFile</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00278">278</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  279</span>{</div>
<div class="line"><span class="lineno">  280</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>  = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a>);</div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>);</div>
<div class="line"><span class="lineno">  282</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">e_shnum</a>);</div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> e_phentsize = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#afa2289f96d86fcc568a3b1f40cc8953e">e_phentsize</a>);</div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>((<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <span class="stringliteral">&quot;\x7f\x45\x4c\x46&quot;</span>, 4)  <span class="comment">// &quot;\177ELF&quot;</span></div>
<div class="line"><span class="lineno">  285</span>    || <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>[Elf32_Ehdr::EI_CLASS]!=Elf32_Ehdr::ELFCLASS32</div>
<div class="line"><span class="lineno">  286</span>    || <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>) != e_phentsize</div>
<div class="line"><span class="lineno">  287</span>    || (Elf32_Ehdr::ELFDATA2MSB == <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>[Elf32_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno">  288</span>            &amp;&amp; &amp;<a class="code hl_variable" href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a> != <a class="code hl_variable" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a>)</div>
<div class="line"><span class="lineno">  289</span>    || (Elf32_Ehdr::ELFDATA2LSB == <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>[Elf32_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno">  290</span>            &amp;&amp; &amp;<a class="code hl_variable" href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a> != <a class="code hl_variable" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a>)) {</div>
<div class="line"><span class="lineno">  291</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> = 0;</div>
<div class="line"><span class="lineno">  292</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> = 0;</div>
<div class="line"><span class="lineno">  293</span>        <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = 0;</div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  295</span>    }</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;0==e_phnum&quot;</span>);</div>
<div class="line"><span class="lineno">  297</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a25c36fc010284a928604aae005b67ad1">e_phoff</a>);</div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> last_Phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>);</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">if</span> (last_Phdr &lt; <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>  <span class="comment">// wrap-around</span></div>
<div class="line"><span class="lineno">  300</span>    ||  <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>)  <span class="comment">// must be contiguous</span></div>
<div class="line"><span class="lineno">  301</span>    ||  (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; last_Phdr) {</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_phoff %#x&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>);</div>
<div class="line"><span class="lineno">  303</span>    }</div>
<div class="line"><span class="lineno">  304</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">e_shoff</a>);</div>
<div class="line"><span class="lineno">  305</span>    <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">e_shstrndx</a>);</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> last_Shdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>);</div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">if</span> (last_Shdr &lt; <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>  <span class="comment">// wrap-around</span></div>
<div class="line"><span class="lineno">  308</span>    ||  (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> &lt; last_Phdr)</div>
<div class="line"><span class="lineno">  309</span>    ||  (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; last_Shdr) {</div>
<div class="line"><span class="lineno">  310</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd == <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>) {</div>
<div class="line"><span class="lineno">  311</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_shoff %#x&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>);</div>
<div class="line"><span class="lineno">  312</span>        }</div>
<div class="line"><span class="lineno">  313</span>    }</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * e_phentsize;</div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) +</div>
<div class="line"><span class="lineno">  316</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>);  <span class="comment">// phdrx bodies later: ::generateElfHdr</span></div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">if</span> (f &amp;&amp; Elf32_Ehdr::ET_DYN!=<a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;  <span class="comment">// (sz_phdrs + e_phoff) except --preserve-build-id</span></div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, len);</div>
<div class="line"><span class="lineno">  321</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  322</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, len);</div>
<div class="line"><span class="lineno">  323</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>= (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>       *)(<a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">if</span> (f &amp;&amp; Elf32_Ehdr::ET_DYN==<a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno">  326</span>        <span class="comment">// The DT_SYMTAB has no designated length.  Read the whole file.</span></div>
<div class="line"><span class="lineno">  327</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno">  328</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  329</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno">  330</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>= (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)(<a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno">  331</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd != <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a> || !<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> ||  <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>) {</div>
<div class="line"><span class="lineno">  332</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  333</span>        }</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  335</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  336</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() != <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno">  337</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno">  338</span>            }</div>
<div class="line"><span class="lineno">  339</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno">  340</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno">  341</span>        }</div>
<div class="line"><span class="lineno">  342</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type</a>(Elf32_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno">  343</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno">  344</span>            <span class="keywordtype">unsigned</span> t = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>-&gt;sh_link);</div>
<div class="line"><span class="lineno">  345</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= t)</div>
<div class="line"><span class="lineno">  346</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad dynsym-&gt;sh_link&quot;</span>);</div>
<div class="line"><span class="lineno">  347</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">sec_dynstr</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>[t];</div>
<div class="line"><span class="lineno">  348</span>        }</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr= <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ++phdr)</div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">if</span> (Elf32_Phdr::PT_DYNAMIC==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno">  353</span>            <span class="keywordtype">unsigned</span> offset = <a class="code hl_function" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic</a>(phdr);</div>
<div class="line"><span class="lineno">  354</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)(offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno">  355</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>,</div>
<div class="line"><span class="lineno">  356</span>                <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>), (<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> - offset)));</div>
<div class="line"><span class="lineno">  357</span>        }</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno">  359</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">check_pt_load</a>(phdr);</div>
<div class="line"><span class="lineno">  360</span>        }</div>
<div class="line"><span class="lineno">  361</span>        <span class="comment">// elf_find_dynamic() returns 0 if 0==dynseg.</span></div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> =          (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno">  363</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> <span class="comment">/*const*/</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_SYMTAB);</div>
<div class="line"><span class="lineno">  364</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a> =     (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno">  365</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a> =     (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">if</span> (3&amp; ((<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a> | (<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a> | (<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>)) {</div>
<div class="line"><span class="lineno">  367</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;unaligned DT_SYMTAB, DT_GNU_HASH, or DT_HASH/n&quot;</span>);</div>
<div class="line"><span class="lineno">  368</span>        }</div>
<div class="line"><span class="lineno">  369</span>        <a class="code hl_variable" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a> = <a class="code hl_function" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup</a>(<span class="stringliteral">&quot;JNI_OnLoad&quot;</span>);</div>
<div class="line"><span class="lineno">  370</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a>) {</div>
<div class="line"><span class="lineno">  371</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a>-&gt;st_value);</div>
<div class="line"><span class="lineno">  372</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a> = 0;  <span class="comment">// FIXME not understood; need example</span></div>
<div class="line"><span class="lineno">  373</span>        }</div>
<div class="line"><span class="lineno">  374</span>    }</div>
<div class="line"><span class="lineno">  375</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_aa1d8db1d83d751bf6acfdde1045403ad"><div class="ttname"><a href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">PackLinuxElf32::elf_lookup</a></div><div class="ttdeci">virtual Elf32_Sym const * elf_lookup(char const *) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08159">p_lx_elf.cpp:8159</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aaf175264167b93a8ce865a34937584e6"><div class="ttname"><a href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a></div><div class="ttdeci">unsigned e_type</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00078">p_lx_elf.h:78</a></div></div>
<div class="ttc" id="aclassPacker_html_a18d294254872108f1373a26ccabbd821"><div class="ttname"><a href="classPacker.html#a18d294254872108f1373a26ccabbd821">Packer::bele</a></div><div class="ttdeci">const N_BELE_RTP::AbstractPolicy * bele</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00314">packer.h:314</a></div></div>
<div class="ttc" id="aconf_8h_html_a0290c1b714a32ca216f00e6446342dd8"><div class="ttname"><a href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a></div><div class="ttdeci">acc_uintptr_t upx_uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00172">conf.h:172</a></div></div>
<div class="ttc" id="anamespaceN__BELE__RTP_html_a800eaf3ed4e72268ac7ac7a800df07cd"><div class="ttname"><a href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a></div><div class="ttdeci">const LEPolicy le_policy</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00782">util.cpp:782</a></div></div>
<div class="ttc" id="anamespaceN__BELE__RTP_html_af72fe6f323f96796c843a2e019005de6"><div class="ttname"><a href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a></div><div class="ttdeci">const BEPolicy be_policy</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00781">util.cpp:781</a></div></div>
<div class="ttc" id="aoptions_8h_html_a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86"><div class="ttname"><a href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a></div><div class="ttdeci">@ CMD_COMPRESS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00046">options.h:46</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a25c36fc010284a928604aae005b67ad1"><div class="ttname"><a href="structElf32__Ehdr.html#a25c36fc010284a928604aae005b67ad1">Elf32_Ehdr::e_phoff</a></div><div class="ttdeci">Elf32_Off e_phoff</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00194">bsd.h:194</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image()</a>, <a class="el" href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a>, <a class="el" href="classPacker.html#a18d294254872108f1373a26ccabbd821">Packer::bele</a>, <a class="el" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">check_pt_load()</a>, <a class="el" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>, <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>, <a class="el" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a>, <a class="el" href="structElf32__Ehdr.html#afa2289f96d86fcc568a3b1f40cc8953e">Elf32_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="el" href="structElf32__Ehdr.html#a25c36fc010284a928604aae005b67ad1">Elf32_Ehdr::e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf32__Ehdr.html#a11249bd7e61642742a68a3e7f69ac721">Elf32_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf32__Ehdr.html#a3b3070ccd7d971e8cb6ea58d4c6fab09">Elf32_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackLinuxElf32.html#a6df504485b4e0c1cce47eca10de37b94">gashtab</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf32.html#aaa5a2328d0273f004e496796df5d0ae8">hashtab</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="classPackLinuxElf32.html#a034060e8e938b65cdd961851dea44420">jni_onload_sym</a>, <a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a>, <a class="el" href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="classPackLinuxElf32.html#a21816e305175e291da2cbe8f85e5b6c0">n_phdrx</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf32.html#a8006727271622c8955b9d2cd87282a28">sec_dynstr</a>, <a class="el" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, and <a class="el" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">canUnpack()</a>, <a class="el" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c">PackLinuxElf32Be::PackLinuxElf32Be()</a>, and <a class="el" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8">PackLinuxElf32Le::PackLinuxElf32Le()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_cgraph" id="aclassPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_cgraph">
<area shape="rect" title=" " alt="" coords="5,929,199,969"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="691,216,825,241"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1180,885,1299,911"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="474,191,602,216"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="933,5,1084,31"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="924,1025,1093,1051"/>
<area shape="rect" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9" title=" " alt="" coords="925,961,1092,1001"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1363,1493,1492,1519"/>
<area shape="rect" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780" title=" " alt="" coords="925,471,1092,511"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="465,1715,611,1755"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="1170,1818,1309,1858"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="685,1773,831,1813"/>
<area shape="rect" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad" title=" " alt="" coords="465,626,611,666"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="473,1012,603,1037"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="247,1355,413,1395"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="288,1840,372,1865"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="269,1964,391,1989"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="271,2063,389,2088"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="261,860,399,885"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="964,860,1053,885"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="971,177,1047,203"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="967,227,1051,252"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="968,276,1049,301"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="901,325,1116,351"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="931,104,1086,129"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1164,269,1315,309"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="673,167,843,192"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="734,117,782,143"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="963,55,1054,80"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="936,1709,1081,1749"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="663,1607,853,1647"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="921,1594,1096,1634"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="675,608,841,633"/>
<area shape="rect" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd" title=" " alt="" coords="683,493,833,533"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="934,586,1083,626"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="671,657,845,683"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="725,443,791,468"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="465,1458,611,1498"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="683,1543,833,1583"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="461,1257,615,1297"/>
<area shape="rect" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0" title=" " alt="" coords="685,1429,831,1469"/>
<area shape="rect" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c" title=" " alt="" coords="682,1314,834,1354"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="691,1215,825,1240"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="696,1264,820,1289"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="481,1964,595,1989"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="463,2013,613,2039"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="693,2063,823,2088"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="713,2013,803,2039"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="689,2112,827,2137"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="480,2063,596,2088"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_icgraph" id="aclassPackLinuxElf32_aa2acf155f6a76482cd3cbd17cef800e6_icgraph">
<area shape="rect" title=" " alt="" coords="724,63,917,103"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,13,671,38"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,63,676,103"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,127,675,167"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<a id="ae71afa0e6f24dc33a224f2225b7c4bbe" name="ae71afa0e6f24dc33a224f2225b7c4bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae71afa0e6f24dc33a224f2225b7c4bbe">&#9670;&#160;</a></span>patchLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::patchLoader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackUnix.html#ac4b328c80b7172751702a447aed1afb2">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01196">1196</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1197</span>{</div>
<div class="line"><span class="lineno"> 1198</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a34521f96ea9eb8d358528d794fa9345b" name="a34521f96ea9eb8d358528d794fa9345b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34521f96ea9eb8d358528d794fa9345b">&#9670;&#160;</a></span>sort_DT32_offsets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::sort_DT32_offsets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> const *const&#160;</td>
          <td class="paramname"><em>dynp0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02009">2009</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2010</span>{</div>
<div class="line"><span class="lineno"> 2011</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>) * <span class="keyword">sizeof</span>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>)/<span class="keyword">sizeof</span>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>[0]));</div>
<div class="line"><span class="lineno"> 2012</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">clear</a>();</div>
<div class="line"><span class="lineno"> 2013</span>    <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a> = (<span class="keywordtype">unsigned</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 2014</span>    <span class="keywordtype">unsigned</span> n_off = 0, k;</div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; ((k = <a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>[j]),  k); ++j) {</div>
<div class="line"><span class="lineno"> 2016</span>        <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off] = 0;  <span class="comment">// default to &quot;not found&quot;</span></div>
<div class="line"><span class="lineno"> 2017</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> rva = 0;</div>
<div class="line"><span class="lineno"> 2018</span>        <span class="keywordflow">if</span> (k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) { <span class="comment">// in range of easy table</span></div>
<div class="line"><span class="lineno"> 2019</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[k]) {</div>
<div class="line"><span class="lineno"> 2020</span>                <span class="keywordflow">continue</span>;  <span class="comment">// not present in input</span></div>
<div class="line"><span class="lineno"> 2021</span>            }</div>
<div class="line"><span class="lineno"> 2022</span>            rva = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynp0[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[k]].d_val);</div>
<div class="line"><span class="lineno"> 2023</span>        }</div>
<div class="line"><span class="lineno"> 2024</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) { <span class="comment">// why is this guard necessary?</span></div>
<div class="line"><span class="lineno"> 2025</span>            rva = <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(k);  <span class="comment">// zero if not found</span></div>
<div class="line"><span class="lineno"> 2026</span>        }</div>
<div class="line"><span class="lineno"> 2027</span>        <span class="keywordflow">if</span> (!rva) {</div>
<div class="line"><span class="lineno"> 2028</span>            <span class="keywordflow">continue</span>;  <span class="comment">// not present in input</span></div>
<div class="line"><span class="lineno"> 2029</span>        }</div>
<div class="line"><span class="lineno"> 2030</span>        <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_function" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va</a>(rva, <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 2031</span>        <span class="keywordflow">if</span> (!phdr) {</div>
<div class="line"><span class="lineno"> 2032</span>            <span class="keywordtype">char</span> msg[60]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad  DT_{%#x} = %#x (no Phdr)&quot;</span>,</div>
<div class="line"><span class="lineno"> 2033</span>                k, rva);</div>
<div class="line"><span class="lineno"> 2034</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2035</span>        }</div>
<div class="line"><span class="lineno"> 2036</span>        <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off] = (rva - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>)) + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 2037</span> </div>
<div class="line"><span class="lineno"> 2038</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off]) {</div>
<div class="line"><span class="lineno"> 2039</span>            <span class="keywordtype">char</span> msg[60]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad DT_{%#x} = %#x (beyond EOF)&quot;</span>,</div>
<div class="line"><span class="lineno"> 2040</span>                k, <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off]);</div>
<div class="line"><span class="lineno"> 2041</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2042</span>        }</div>
<div class="line"><span class="lineno"> 2043</span>        n_off += !!<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off];</div>
<div class="line"><span class="lineno"> 2044</span>    }</div>
<div class="line"><span class="lineno"> 2045</span>    <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off++] = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;  <span class="comment">// sentinel</span></div>
<div class="line"><span class="lineno"> 2046</span>    <a class="code hl_define" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>(<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>, n_off, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[0]), <a class="code hl_function" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned</a>);</div>
<div class="line"><span class="lineno"> 2047</span>}</div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a153fe8a7e59d11eee850dcf7aac446dd"><div class="ttname"><a href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned</a></div><div class="ttdeci">static int __acc_cdecl_qsort qcmp_unsigned(void const *const aa, void const *const bb)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01999">p_lx_elf.cpp:1999</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4b2bd0c0bbfe083032e496ebbb7ad5f9"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a></div><div class="ttdeci">static unsigned const dt_keys[]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01982">p_lx_elf.cpp:1982</a></div></div>
<div class="ttc" id="autil_8h_html_afafc04a977e45706ac9f76ed6122ee54"><div class="ttname"><a href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a></div><div class="ttdeci">#define upx_qsort</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00205">util.h:205</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear()</a>, <a class="el" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>, <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_cgraph" id="aclassPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_cgraph">
<area shape="rect" title=" " alt="" coords="5,406,159,446"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="225,232,358,258"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="715,32,833,58"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="224,132,359,158"/>
<area shape="rect" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0" title=" " alt="" coords="219,498,364,538"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="709,470,839,495"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="216,434,367,474"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="207,563,376,588"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="229,612,353,638"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="487,32,576,58"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="736,175,812,200"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="489,131,573,156"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="491,334,572,359"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="424,232,639,258"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="909,182,1064,207"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="699,333,849,373"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="911,365,1062,405"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="911,301,1062,341"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="472,82,591,107"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="687,95,861,120"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="945,120,1028,146"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="917,71,1057,96"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1112,113,1263,153"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1311,81,1461,121"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1311,145,1461,185"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="494,550,569,575"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="459,434,604,474"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_icgraph" id="aclassPackLinuxElf32_a34521f96ea9eb8d358528d794fa9345b_icgraph">
<area shape="rect" title=" " alt="" coords="1180,88,1333,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="965,88,1132,128"/>
<area shape="rect" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552" title=" " alt="" coords="236,13,417,38"/>
<area shape="rect" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6" title=" " alt="" coords="724,88,917,128"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="749,180,893,220"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a7d53132b64a33ce3f11cdd6fcf43b7d5" title=" " alt="" coords="5,5,188,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4" title="Generic Unix canUnpack()." alt="" coords="471,38,671,63"/>
<area shape="rect" href="classPackLinuxElf32Be.html#a18670e7f4d65aebf8e9999e0de1c336c" title=" " alt="" coords="465,88,676,128"/>
<area shape="rect" href="classPackLinuxElf32Le.html#a356a54ab9b1106939873d829ce2b7ce8" title=" " alt="" coords="467,152,675,192"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="483,217,658,242"/>
</map>
</div>

</div>
</div>
<a id="a9cec931e83f51aaba944196c3476154c" name="a9cec931e83f51aaba944196c3476154c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cec931e83f51aaba944196c3476154c">&#9670;&#160;</a></span>un_asl_dynsym()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::un_asl_dynsym </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>orig_file_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06325">6325</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6329</span>{</div>
<div class="line"><span class="lineno"> 6330</span>    <span class="comment">// un-Relocate dynsym (DT_SYMTAB) which is below xct_off</span></div>
<div class="line"><span class="lineno"> 6331</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 6332</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type</a>(Elf32_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 6333</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 6334</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> off_dynsym = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 6335</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> sz_dynsym  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 6336</span>        <span class="keywordflow">if</span> (orig_file_size &lt; sz_dynsym</div>
<div class="line"><span class="lineno"> 6337</span>        ||  orig_file_size &lt; off_dynsym</div>
<div class="line"><span class="lineno"> 6338</span>        || (orig_file_size - off_dynsym) &lt; sz_dynsym) {</div>
<div class="line"><span class="lineno"> 6339</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad SHT_DYNSYM&quot;</span>);</div>
<div class="line"><span class="lineno"> 6340</span>        }</div>
<div class="line"><span class="lineno"> 6341</span>        <a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *<span class="keyword">const</span> sym0 = (<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 6342</span>            <span class="stringliteral">&quot;bad dynsym&quot;</span>, off_dynsym, sz_dynsym);</div>
<div class="line"><span class="lineno"> 6343</span>        <a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> *sym = sym0;</div>
<div class="line"><span class="lineno"> 6344</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = sz_dynsym / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a>); --j&gt;=0; ++sym) {</div>
<div class="line"><span class="lineno"> 6345</span>            <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> symval = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sym-&gt;st_value);</div>
<div class="line"><span class="lineno"> 6346</span>            <span class="keywordtype">unsigned</span> symsec = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;sym-&gt;st_shndx);</div>
<div class="line"><span class="lineno"> 6347</span>            <span class="keywordflow">if</span> (Elf32_Sym::SHN_UNDEF != symsec</div>
<div class="line"><span class="lineno"> 6348</span>            &amp;&amp;  Elf32_Sym::SHN_ABS   != symsec</div>
<div class="line"><span class="lineno"> 6349</span>            &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 6350</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sym-&gt;st_value, symval - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6351</span>            }</div>
<div class="line"><span class="lineno"> 6352</span>            <span class="keywordflow">if</span> (Elf32_Sym::SHN_ABS == symsec &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 6353</span>                <a class="code hl_function" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">adjABS</a>(sym, 0u - (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6354</span>            }</div>
<div class="line"><span class="lineno"> 6355</span>        }</div>
<div class="line"><span class="lineno"> 6356</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6357</span>            <span class="keywordtype">unsigned</span> pos = fo-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6358</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off_dynsym, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6359</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(sym0, sz_dynsym);</div>
<div class="line"><span class="lineno"> 6360</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6361</span>        }</div>
<div class="line"><span class="lineno"> 6362</span>    }</div>
<div class="line"><span class="lineno"> 6363</span>}</div>
<div class="ttc" id="aclassFileBase_html_ac5cf6444d65c14d76b14ae420dd50eff"><div class="ttname"><a href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell</a></div><div class="ttdeci">upx_off_t tell() const</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00151">file.cpp:151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f">adjABS()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackLinuxElf32.html#ac06c59607bfc28297c4739e3df424ca7">sec_dynsym</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_cgraph" id="aclassPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_cgraph">
<area shape="rect" title=" " alt="" coords="5,599,149,639"/>
<area shape="rect" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f" title=" " alt="" coords="852,64,1027,89"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1089,216,1219,241"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="197,320,343,360"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="413,100,559,140"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="205,557,335,582"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="199,606,341,632"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="422,860,550,885"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="206,705,334,730"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="199,884,341,909"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="663,1138,770,1164"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="201,656,339,681"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="1079,132,1229,172"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="1121,64,1187,89"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1295,664,1414,689"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="413,284,559,324"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="391,354,581,394"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="629,358,804,398"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="870,367,1009,407"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="421,606,551,632"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="649,505,784,530"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1711,1088,1841,1113"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1501,689,1638,714"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="895,606,984,632"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1109,664,1199,689"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="672,657,761,682"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1291,502,1418,528"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="875,533,1004,558"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1476,509,1663,534"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1748,509,1804,534"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1091,498,1217,524"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1281,562,1428,588"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1542,562,1597,588"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1499,913,1639,938"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1075,599,1233,639"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="871,860,1007,885"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="659,986,775,1012"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="911,1113,968,1138"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="397,910,575,936"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="647,1238,786,1264"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="866,1265,1013,1290"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1130,1265,1178,1290"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1309,1265,1400,1290"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="1506,1265,1633,1290"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_icgraph" id="aclassPackLinuxElf32_a9cec931e83f51aaba944196c3476154c_icgraph">
<area shape="rect" title=" " alt="" coords="420,5,564,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a52055eaaf3a28d1986937825c9382ae7" name="a52055eaaf3a28d1986937825c9382ae7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52055eaaf3a28d1986937825c9382ae7">&#9670;&#160;</a></span>un_DT_INIT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::un_DT_INIT </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>old_dtinit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>dynhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06788">6788</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6794</span>{</div>
<div class="line"><span class="lineno"> 6795</span>    <span class="comment">// DT_INIT must be restored.</span></div>
<div class="line"><span class="lineno"> 6796</span>    <span class="comment">// If android_shlib, then the asl_delta relocations must be un-done.</span></div>
<div class="line"><span class="lineno"> 6797</span>    <span class="keywordtype">unsigned</span> n_plt = 0;</div>
<div class="line"><span class="lineno"> 6798</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> dt_pltrelsz(0), dt_jmprel(0), dt_pltgot(0);</div>
<div class="line"><span class="lineno"> 6799</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> dt_relsz(0), dt_rel(0);</div>
<div class="line"><span class="lineno"> 6800</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> dyn_len = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynhdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 6801</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> dyn_off = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dynhdr-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 6802</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a> &lt; (dyn_len + dyn_off)) {</div>
<div class="line"><span class="lineno"> 6803</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 6804</span>                <span class="stringliteral">&quot;bad PT_DYNAMIC .p_filesz %#lx&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)dyn_len);</div>
<div class="line"><span class="lineno"> 6805</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 6806</span>    }</div>
<div class="line"><span class="lineno"> 6807</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(dyn_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6808</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, dyn_len);</div>
<div class="line"><span class="lineno"> 6809</span>    <a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *dyn = (<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)(<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>;</div>
<div class="line"><span class="lineno"> 6810</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a> = dyn; <a class="code hl_function" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>,</div>
<div class="line"><span class="lineno"> 6811</span>        <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(dyn_len, <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a> - dyn_off));</div>
<div class="line"><span class="lineno"> 6812</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j2= 0; j2 &lt; dyn_len; ++dyn, j2 += <span class="keyword">sizeof</span>(*dyn)) {</div>
<div class="line"><span class="lineno"> 6813</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> tag = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dyn-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 6814</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>       val = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dyn-&gt;d_val);</div>
<div class="line"><span class="lineno"> 6815</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) <span class="keywordflow">switch</span> (tag) {</div>
<div class="line"><span class="lineno"> 6816</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_RELASZ:   { dt_relsz   = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6817</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_RELA:     { dt_rel     = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6818</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_JMPREL:   { dt_jmprel   = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6819</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_PLTRELSZ: { dt_pltrelsz = val;</div>
<div class="line"><span class="lineno"> 6820</span>            n_plt = dt_pltrelsz / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>);</div>
<div class="line"><span class="lineno"> 6821</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6822</span>                n_plt += 3;  <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 6823</span>            }</div>
<div class="line"><span class="lineno"> 6824</span>        };  <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6825</span> </div>
<div class="line"><span class="lineno"> 6826</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_PLTGOT:   { <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = dt_pltgot = val; (void)dt_pltgot; }</div>
<div class="line"><span class="lineno"> 6827</span>        <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 6828</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_PREINIT_ARRAY:</div>
<div class="line"><span class="lineno"> 6829</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_INIT_ARRAY:</div>
<div class="line"><span class="lineno"> 6830</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_FINI_ARRAY:</div>
<div class="line"><span class="lineno"> 6831</span>        <span class="keywordflow">case</span> Elf32_Dyn::DT_FINI: <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6832</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;dyn-&gt;d_val, val - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6833</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6834</span>        } <span class="comment">// end switch() on tag when is_asl</span></div>
<div class="line"><span class="lineno"> 6835</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> == tag) {</div>
<div class="line"><span class="lineno"> 6836</span>            <span class="keywordflow">if</span> (Elf32_Dyn::DT_INIT == tag) { <span class="comment">// the easy case</span></div>
<div class="line"><span class="lineno"> 6837</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;dyn-&gt;d_val, old_dtinit);</div>
<div class="line"><span class="lineno"> 6838</span>                <span class="keywordflow">if</span> (!old_dtinit) { <span class="comment">// compressor took the slot</span></div>
<div class="line"><span class="lineno"> 6839</span>                    dyn-&gt;d_tag = Elf32_Dyn::DT_NULL;</div>
<div class="line"><span class="lineno"> 6840</span>                    dyn-&gt;d_val = 0;</div>
<div class="line"><span class="lineno"> 6841</span>                }</div>
<div class="line"><span class="lineno"> 6842</span>            }</div>
<div class="line"><span class="lineno"> 6843</span>            <span class="comment">// Apparently the hard case is common for some Android IDEs.</span></div>
<div class="line"><span class="lineno"> 6844</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Dyn::DT_INIT_ARRAY    == tag</div>
<div class="line"><span class="lineno"> 6845</span>            ||       Elf32_Dyn::DT_PREINIT_ARRAY == tag) {</div>
<div class="line"><span class="lineno"> 6846</span>                <span class="comment">// &#39;val&#39; is the RVA of the first slot, which is the slot that</span></div>
<div class="line"><span class="lineno"> 6847</span>                <span class="comment">// the compressor changed to be the entry to the run-time stub.</span></div>
<div class="line"><span class="lineno"> 6848</span>                <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *rp = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)<a class="code hl_function" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic</a>(Elf32_Dyn::DT_NULL);</div>
<div class="line"><span class="lineno"> 6849</span>                ((<a class="code hl_typedef" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a> *)<a class="code hl_function" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr</a>(Elf32_Dyn::DT_NULL))-&gt;d_val = 0;</div>
<div class="line"><span class="lineno"> 6850</span>                <span class="keywordflow">if</span> (rp) {</div>
<div class="line"><span class="lineno"> 6851</span>                    <span class="comment">// Compressor saved the original *rp in dynsym[0]</span></div>
<div class="line"><span class="lineno"> 6852</span>                    <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *rp_unc = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>[0];  <span class="comment">// pointer</span></div>
<div class="line"><span class="lineno"> 6853</span>                    rp-&gt;r_info = rp_unc-&gt;r_info;  <span class="comment">// restore original r_info; r_offset not touched</span></div>
<div class="line"><span class="lineno"> 6854</span> </div>
<div class="line"><span class="lineno"> 6855</span>                    <span class="keywordtype">unsigned</span> e_entry = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">e_entry</a>);</div>
<div class="line"><span class="lineno"> 6856</span>                    <span class="keywordtype">unsigned</span> init_rva = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[e_entry - 3*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)]);</div>
<div class="line"><span class="lineno"> 6857</span>                    <span class="keywordtype">unsigned</span> arr_rva = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rp_unc-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 6858</span>                    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_function" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va</a>(arr_rva, phdro, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 6859</span>                    <span class="keywordtype">unsigned</span> arr_off = (arr_rva - <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>)) + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6860</span> </div>
<div class="line"><span class="lineno"> 6861</span>                    rp_unc-&gt;r_offset = 0;    rp_unc-&gt;r_info = 0;</div>
<div class="line"><span class="lineno"> 6862</span>                    <span class="keywordflow">if</span> (fo)  {</div>
<div class="line"><span class="lineno"> 6863</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_SYMTAB), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6864</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rp_unc, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>));  <span class="comment">// clear dynsym[0]</span></div>
<div class="line"><span class="lineno"> 6865</span> </div>
<div class="line"><span class="lineno"> 6866</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>((<span class="keywordtype">char</span> *)rp - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0], <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6867</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rp, <span class="keyword">sizeof</span>(*rp));  <span class="comment">// restore original *rp</span></div>
<div class="line"><span class="lineno"> 6868</span>                    }</div>
<div class="line"><span class="lineno"> 6869</span> </div>
<div class="line"><span class="lineno"> 6870</span>                    <span class="comment">// Set arr[0] to the first user init routine.</span></div>
<div class="line"><span class="lineno"> 6871</span>                    <span class="keywordtype">unsigned</span> r_info = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rp-&gt;r_info);</div>
<div class="line"><span class="lineno"> 6872</span>                    <span class="keywordtype">unsigned</span> r_type = ELF32_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 6873</span>                    <span class="keywordtype">unsigned</span> word;</div>
<div class="line"><span class="lineno"> 6874</span>                    <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 6875</span>                        <span class="keywordflow">if</span> (R_ARM_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6876</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;word, init_rva);</div>
<div class="line"><span class="lineno"> 6877</span>                        }</div>
<div class="line"><span class="lineno"> 6878</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_ARM_ABS32 == r_type) {</div>
<div class="line"><span class="lineno"> 6879</span>                            word = 0;</div>
<div class="line"><span class="lineno"> 6880</span>                        }</div>
<div class="line"><span class="lineno"> 6881</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6882</span>                            <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;unknown relocation: %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 6883</span>                                r_type);</div>
<div class="line"><span class="lineno"> 6884</span>                            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 6885</span>                        }</div>
<div class="line"><span class="lineno"> 6886</span>                    }</div>
<div class="line"><span class="lineno"> 6887</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Ehdr::EM_386 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 6888</span>                        <span class="keywordflow">if</span> (R_386_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6889</span>                        }</div>
<div class="line"><span class="lineno"> 6890</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_386_32 == r_type) {</div>
<div class="line"><span class="lineno"> 6891</span>                        }</div>
<div class="line"><span class="lineno"> 6892</span>                        <span class="keywordflow">if</span> (R_386_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6893</span>                            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;word, init_rva);</div>
<div class="line"><span class="lineno"> 6894</span>                        }</div>
<div class="line"><span class="lineno"> 6895</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_386_32 == r_type) {</div>
<div class="line"><span class="lineno"> 6896</span>                            word = 0;</div>
<div class="line"><span class="lineno"> 6897</span>                        }</div>
<div class="line"><span class="lineno"> 6898</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6899</span>                            <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;unknown relocation: %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 6900</span>                                r_type);</div>
<div class="line"><span class="lineno"> 6901</span>                            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 6902</span>                        }</div>
<div class="line"><span class="lineno"> 6903</span>                    }</div>
<div class="line"><span class="lineno"> 6904</span>                    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6905</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(arr_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6906</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;word, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>));</div>
<div class="line"><span class="lineno"> 6907</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 6908</span>                    }</div>
<div class="line"><span class="lineno"> 6909</span>                }</div>
<div class="line"><span class="lineno"> 6910</span>            }</div>
<div class="line"><span class="lineno"> 6911</span>        }</div>
<div class="line"><span class="lineno"> 6912</span>    }</div>
<div class="line"><span class="lineno"> 6913</span>    <span class="keywordflow">if</span> (fo) { <span class="comment">// Write updated dt_*.val</span></div>
<div class="line"><span class="lineno"> 6914</span>        <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> dyn_offo = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdro[dynhdr - <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>].p_offset);</div>
<div class="line"><span class="lineno"> 6915</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(dyn_offo, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6916</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, dyn_len);</div>
<div class="line"><span class="lineno"> 6917</span>    }</div>
<div class="line"><span class="lineno"> 6918</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6919</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> ptload1;  <span class="comment">// FIXME.  file_image has the whole file; ibuf is available</span></div>
<div class="line"><span class="lineno"> 6920</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 6921</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6922</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// contains relocation tables</span></div>
<div class="line"><span class="lineno"> 6923</span>        <span class="keywordflow">if</span> (dt_relsz &amp;&amp; dt_rel) {</div>
<div class="line"><span class="lineno"> 6924</span>            <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *<span class="keyword">const</span> rel0 = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 6925</span>                <span class="stringliteral">&quot;bad Rel offset&quot;</span>, dt_rel, dt_relsz);</div>
<div class="line"><span class="lineno"> 6926</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97">unRel32</a>(dt_rel, rel0, dt_relsz, ptload1, old_dtinit, fo);</div>
<div class="line"><span class="lineno"> 6927</span>        }</div>
<div class="line"><span class="lineno"> 6928</span>        <span class="keywordflow">if</span> (dt_pltrelsz &amp;&amp; dt_jmprel) { <span class="comment">// FIXME:  overlap w/ DT_REL ?</span></div>
<div class="line"><span class="lineno"> 6929</span>            <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *<span class="keyword">const</span> jmp0 = (<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 6930</span>                <span class="stringliteral">&quot;bad Jmprel offset&quot;</span>, dt_jmprel, dt_pltrelsz);</div>
<div class="line"><span class="lineno"> 6931</span>            <a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>));</div>
<div class="line"><span class="lineno"> 6932</span>            <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 6933</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 6934</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> vaddr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 6935</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 6936</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d = <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> - vaddr;</div>
<div class="line"><span class="lineno"> 6937</span>                <span class="keywordflow">if</span> (d &lt; filesz) {</div>
<div class="line"><span class="lineno"> 6938</span>                    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6939</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(d + offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6940</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>, n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>));</div>
<div class="line"><span class="lineno"> 6941</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6942</span>                }</div>
<div class="line"><span class="lineno"> 6943</span>            }</div>
<div class="line"><span class="lineno"> 6944</span>            <a class="code hl_function" href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97">unRel32</a>(dt_jmprel, jmp0, dt_pltrelsz, ptload1, old_dtinit, fo);</div>
<div class="line"><span class="lineno"> 6945</span> </div>
<div class="line"><span class="lineno"> 6946</span>            <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> o_ehdr = (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>;</div>
<div class="line"><span class="lineno"> 6947</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> o_phnum = o_ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>;</div>
<div class="line"><span class="lineno"> 6948</span>            phdr = phdro;</div>
<div class="line"><span class="lineno"> 6949</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; o_phnum; ++j, ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 6950</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> vaddr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 6951</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 6952</span>                <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> d = <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> - vaddr - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6953</span>                <span class="keywordflow">if</span> (d &lt; filesz) {</div>
<div class="line"><span class="lineno"> 6954</span>                    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6955</span>                    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6956</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(d + offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6957</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>, n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>));</div>
<div class="line"><span class="lineno"> 6958</span>                    }</div>
<div class="line"><span class="lineno"> 6959</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6960</span>                }</div>
<div class="line"><span class="lineno"> 6961</span>            }</div>
<div class="line"><span class="lineno"> 6962</span>        }</div>
<div class="line"><span class="lineno"> 6963</span>        <span class="comment">// Modified relocation tables are re-written by unRel32</span></div>
<div class="line"><span class="lineno"> 6964</span>    }</div>
<div class="line"><span class="lineno"> 6965</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a9885ff5b4641396d7e4604d44e4cbe97"><div class="ttname"><a href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97">PackLinuxElf32::unRel32</a></div><div class="ttdeci">virtual void unRel32(unsigned dt_rel, Elf32_Rel *rel0, unsigned relsz, MemBuffer &amp;membuf, unsigned const load_off, OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06154">p_lx_elf.cpp:6154</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ab0f4c33a259ca5c14cdc2384285e274f"><div class="ttname"><a href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a></div><div class="ttdeci">MemBuffer jump_slots</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00125">p_lx_elf.h:125</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf32.html#aa4994d4daac1ceef79bff5afb8c9dcf5">dynseg</a>, <a class="el" href="classPackLinuxElf32.html#aa25b2132cbfb2fb5a02219fbae96ad5e">dynsym</a>, <a class="el" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">Elf32_Ehdr::e_entry</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84">is_LOAD32()</a>, <a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97">unRel32()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_cgraph" id="aclassPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_cgraph">
<area shape="rect" title=" " alt="" coords="5,637,149,677"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="657,934,790,959"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="431,1695,576,1735"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="901,1785,1047,1825"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1353,1347,1482,1373"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="1135,1423,1274,1463"/>
<area shape="rect" href="classPackLinuxElf32.html#a7dbc6cc573876410e6b5fe1ed235a6e0" title=" " alt="" coords="651,1315,796,1355"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="648,1631,799,1671"/>
<area shape="rect" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4" title=" " alt="" coords="205,1452,371,1492"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="666,99,781,125"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="442,99,565,125"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="432,391,575,417"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="445,341,562,366"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="439,442,567,467"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="439,543,567,569"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="217,594,359,619"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1348,594,1487,619"/>
<area shape="rect" href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97" title=" " alt="" coords="197,493,379,518"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1160,493,1249,518"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="936,970,1012,995"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="932,1019,1016,1045"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="933,847,1015,873"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="867,897,1081,922"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="897,1069,1051,1094"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1555,594,1673,619"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1129,840,1280,880"/>
<area shape="rect" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf" title=" " alt="" coords="628,1695,819,1735"/>
<area shape="rect" href="classPackLinuxElf32.html#aa0fe8832b28a69327c9c65628f13dc53" title=" " alt="" coords="887,1541,1061,1581"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="937,1373,1011,1398"/>
<area shape="rect" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812" title=" " alt="" coords="431,1252,576,1292"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="889,1271,1059,1297"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="439,1538,568,1563"/>
<area shape="rect" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b" title=" " alt="" coords="427,1423,580,1463"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="1132,1169,1277,1209"/>
<area shape="rect" href="classPackLinuxElf32.html#ae126d225cb28e675a4261204a3872e2c" title=" " alt="" coords="647,1251,799,1291"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="656,1530,791,1555"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="661,1481,785,1506"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="909,191,1039,217"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1160,193,1249,218"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="905,93,1043,118"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1338,332,1497,372"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="649,50,798,75"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="658,237,789,262"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="907,142,1041,167"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="929,293,1019,318"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="665,394,781,419"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="945,443,1003,469"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="906,493,1042,518"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="904,394,1044,419"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="1328,545,1507,570"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_icgraph" id="aclassPackLinuxElf32_a52055eaaf3a28d1986937825c9382ae7_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a6a054376b40ab2dc536ce43302d2c989" name="a6a054376b40ab2dc536ce43302d2c989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a054376b40ab2dc536ce43302d2c989">&#9670;&#160;</a></span>un_shlib_1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::un_shlib_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *const&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>o_elfhdrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>c_adler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>u_adler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>orig_file_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06588">6588</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6595</span>{</div>
<div class="line"><span class="lineno"> 6596</span>    <span class="comment">// xct_off [input side] was set by ::unpack when is_shlib</span></div>
<div class="line"><span class="lineno"> 6597</span>    <span class="comment">// yct_off [output side] set here unless is_asl in next &#39;if&#39; block</span></div>
<div class="line"><span class="lineno"> 6598</span>    <span class="keywordtype">unsigned</span> yct_off = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 6599</span> </div>
<div class="line"><span class="lineno"> 6600</span>    <span class="comment">// Below xct_off is not compressed (for benefit of rtld.)</span></div>
<div class="line"><span class="lineno"> 6601</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6602</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>, <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a>));</div>
<div class="line"><span class="lineno"> 6603</span> </div>
<div class="line"><span class="lineno"> 6604</span>    <span class="comment">// Determine if the extra page with copy of _Shdrs was spliced in.</span></div>
<div class="line"><span class="lineno"> 6605</span>    <span class="comment">// This used to be the result of --android-shlib.</span></div>
<div class="line"><span class="lineno"> 6606</span>    <span class="comment">// But in 2023-02 the forwarding of ARM_ATTRIBUTES (by appending)</span></div>
<div class="line"><span class="lineno"> 6607</span>    <span class="comment">// takes care of this, so the 5th word before e_entry does not</span></div>
<div class="line"><span class="lineno"> 6608</span>    <span class="comment">// have the low bit 1, so is_asl should not be set.</span></div>
<div class="line"><span class="lineno"> 6609</span>    <span class="comment">// However, .so that were compressed before 2023-03</span></div>
<div class="line"><span class="lineno"> 6610</span>    <span class="comment">// may be marked.</span></div>
<div class="line"><span class="lineno"> 6611</span>    <a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 6612</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a></div>
<div class="line"><span class="lineno"> 6613</span>            <span class="comment">// +36: (sizeof(PackHeader) + sizeof(overlay_offset))</span></div>
<div class="line"><span class="lineno"> 6614</span>            <span class="comment">//    after Shdrs for ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 6615</span>    &amp;&amp;  (((<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a> + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) + 36) &lt; <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a>)</div>
<div class="line"><span class="lineno"> 6616</span>    ) { <span class="comment">// possible --android-shlib</span></div>
<div class="line"><span class="lineno"> 6617</span>        <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">e_entry</a>) - (1+ 4)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)]);</div>
<div class="line"><span class="lineno"> 6618</span>        <span class="keywordflow">if</span> (1 &amp; x) { <span class="comment">// the clincher</span></div>
<div class="line"><span class="lineno"> 6619</span>            <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = 1;</div>
<div class="line"><span class="lineno"> 6620</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6621</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 6622</span>            <a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 6623</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 6624</span>            yct_off = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>-&gt;sh_offset);  <span class="comment">// for the output file (de-compressed)</span></div>
<div class="line"><span class="lineno"> 6625</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + yct_off;  <span class="comment">// for the input file (compressed)</span></div>
<div class="line"><span class="lineno"> 6626</span>        }</div>
<div class="line"><span class="lineno"> 6627</span>    }</div>
<div class="line"><span class="lineno"> 6628</span> </div>
<div class="line"><span class="lineno"> 6629</span>    <span class="comment">// Decompress first Extent.  Old style covers [0, xct_off)</span></div>
<div class="line"><span class="lineno"> 6630</span>    <span class="comment">// which includes rtld constant data and eXecutable app code below DT_INIT.</span></div>
<div class="line"><span class="lineno"> 6631</span>    <span class="comment">// In old style, the first compressed Extent is redundant</span></div>
<div class="line"><span class="lineno"> 6632</span>    <span class="comment">// except for the compressed original Elf headers.</span></div>
<div class="line"><span class="lineno"> 6633</span>    <span class="comment">// New style covers just Elf headers: the rest below xct_off is</span></div>
<div class="line"><span class="lineno"> 6634</span>    <span class="comment">// rtld constant data: DT_*HASH, DT_SYMTAB, DT_STRTAB, etc.</span></div>
<div class="line"><span class="lineno"> 6635</span>    <span class="comment">// New style puts eXecutable app code in second PT_LOAD</span></div>
<div class="line"><span class="lineno"> 6636</span>    <span class="comment">// in order to mark Elf headers and rtld data as non-eXecutable.</span></div>
<div class="line"><span class="lineno"> 6637</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6638</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 6639</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structl__info.html">l_info</a> l;</div>
<div class="line"><span class="lineno"> 6640</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structp__info.html">p_info</a> p;</div>
<div class="line"><span class="lineno"> 6641</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structb__info.html">b_info</a> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 6642</span>    } hdr;</div>
<div class="line"><span class="lineno"> 6643</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;hdr, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno"> 6644</span>    <span class="keywordflow">if</span> (hdr.l.l_magic != <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a></div>
<div class="line"><span class="lineno"> 6645</span>    ||  <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hdr.l.l_lsize) != (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a></div>
<div class="line"><span class="lineno"> 6646</span>    ||  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hdr.p.p_filesize) != <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">u_file_size</a></div>
<div class="line"><span class="lineno"> 6647</span>    ||  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hdr.b.sz_unc) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>  <span class="comment">// peek: 1st b_info covers Elf headers</span></div>
<div class="line"><span class="lineno"> 6648</span>    ) {</div>
<div class="line"><span class="lineno"> 6649</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;corrupt l_info/p_info/b_info&quot;</span>);</div>
<div class="line"><span class="lineno"> 6650</span>    }</div>
<div class="line"><span class="lineno"> 6651</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(-(<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structb__info.html">b_info</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>); <span class="comment">// hdr.b_info was a peek</span></div>
<div class="line"><span class="lineno"> 6652</span> </div>
<div class="line"><span class="lineno"> 6653</span><span class="comment">// The default layout for a shared library created by binutils-2.29</span></div>
<div class="line"><span class="lineno"> 6654</span><span class="comment">// (Fedora 28; 2018) has two PT_LOAD: permissions r-x and rw-.</span></div>
<div class="line"><span class="lineno"> 6655</span><span class="comment">// xct_off (the lowest address of executable instructions;</span></div>
<div class="line"><span class="lineno"> 6656</span><span class="comment">// the highest address of read-only data used by rtld (ld-linux))</span></div>
<div class="line"><span class="lineno"> 6657</span><span class="comment">// will be somewhere in the first PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 6658</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6659</span><span class="comment">// The default layout for a shared library created by binutils-2.31</span></div>
<div class="line"><span class="lineno"> 6660</span><span class="comment">// (Fedora 29; 2018) has four PT_LOAD: permissions r--, r-x, r--, rw-.</span></div>
<div class="line"><span class="lineno"> 6661</span><span class="comment">// xct_off will be the base of the second [r-x] PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 6662</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6663</span><span class="comment">// Bytes below xct_off cannot be compressed because they are used</span></div>
<div class="line"><span class="lineno"> 6664</span><span class="comment">// by rtld *before* the UPX run-time de-compression stub gets control</span></div>
<div class="line"><span class="lineno"> 6665</span><span class="comment">// via DT_INIT. Bytes in a Writeable PT_LOAD cannot be compressed</span></div>
<div class="line"><span class="lineno"> 6666</span><span class="comment">// because they may be relocated by rtld, again before stub execution.</span></div>
<div class="line"><span class="lineno"> 6667</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6668</span><span class="comment">// We need to know which layout of PT_LOAD. It seems risky to steal</span></div>
<div class="line"><span class="lineno"> 6669</span><span class="comment">// bits in the input ElfXX_Ehdr or ElfXX_Phdr, so we decompress</span></div>
<div class="line"><span class="lineno"> 6670</span><span class="comment">// the first compressed block.  For an old-style shared library</span></div>
<div class="line"><span class="lineno"> 6671</span><span class="comment">// the first compressed block covers [0, xct_off) which is redundant</span></div>
<div class="line"><span class="lineno"> 6672</span><span class="comment">// with the interval [sz_elf_hdrs, xct_off) because those bytes</span></div>
<div class="line"><span class="lineno"> 6673</span><span class="comment">// must be present for use by rtl  (So that is a large inefficiency.)</span></div>
<div class="line"><span class="lineno"> 6674</span><span class="comment">// Fortunately p_info.p_blocksize fits in ibuf, and unpackExtent</span></div>
<div class="line"><span class="lineno"> 6675</span><span class="comment">// will just decompress it all.  For new style, the first compressed</span></div>
<div class="line"><span class="lineno"> 6676</span><span class="comment">// block covers [0, sz_elf_hdrs).</span></div>
<div class="line"><span class="lineno"> 6677</span> </div>
<div class="line"><span class="lineno"> 6678</span>    <span class="comment">// Peek: unpack into ibuf, but do not write</span></div>
<div class="line"><span class="lineno"> 6679</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_block1 = <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno"> 6680</span>        c_adler, u_adler, <span class="keyword">false</span>, -1);</div>
<div class="line"><span class="lineno"> 6681</span>    <span class="keywordflow">if</span> (sz_block1 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) {</div>
<div class="line"><span class="lineno"> 6682</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;corrupt b_info&quot;</span>);</div>
<div class="line"><span class="lineno"> 6683</span>    }</div>
<div class="line"><span class="lineno"> 6684</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(o_elfhdrs, <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>); <span class="comment">// save de-compressed Elf headers</span></div>
<div class="line"><span class="lineno"> 6685</span>    <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> ehdro = (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)o_elfhdrs;</div>
<div class="line"><span class="lineno"> 6686</span>    <span class="keywordflow">if</span> (ehdro-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a>   !=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a></div>
<div class="line"><span class="lineno"> 6687</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>!=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a></div>
<div class="line"><span class="lineno"> 6688</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">e_version</a>!=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">e_version</a></div>
<div class="line"><span class="lineno"> 6689</span>        <span class="comment">// less strict for EM_PPC to workaround earlier bug</span></div>
<div class="line"><span class="lineno"> 6690</span>    ||  !( ehdro-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">e_flags</a>==<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">e_flags</a></div>
<div class="line"><span class="lineno"> 6691</span>        || Elf32_Ehdr::EM_PPC == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>))</div>
<div class="line"><span class="lineno"> 6692</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">e_ehsize</a> !=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">e_ehsize</a></div>
<div class="line"><span class="lineno"> 6693</span>        <span class="comment">// check EI_MAG[0-3], EI_CLASS, EI_DATA, EI_VERSION</span></div>
<div class="line"><span class="lineno"> 6694</span>    ||  <a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(ehdro-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>, <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>, Elf32_Ehdr::EI_OSABI)) {</div>
<div class="line"><span class="lineno"> 6695</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;ElfXX_Ehdr corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 6696</span>    }</div>
<div class="line"><span class="lineno"> 6697</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6698</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sz_block1);</div>
<div class="line"><span class="lineno"> 6699</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = sz_block1;</div>
<div class="line"><span class="lineno"> 6700</span>    }</div>
<div class="line"><span class="lineno"> 6701</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *o_phdr = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *)(1+ ehdro);</div>
<div class="line"><span class="lineno"> 6702</span>    <span class="comment">// Handle compressed PT_LOADs (must not have PF_W)</span></div>
<div class="line"><span class="lineno"> 6703</span>    <span class="keywordtype">unsigned</span> not_first_LOAD = 0;</div>
<div class="line"><span class="lineno"> 6704</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++o_phdr) {</div>
<div class="line"><span class="lineno"> 6705</span>        <span class="keywordtype">unsigned</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>);</div>
<div class="line"><span class="lineno"> 6706</span>        <span class="keywordtype">unsigned</span> flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>);</div>
<div class="line"><span class="lineno"> 6707</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> != type || Elf32_Phdr::PF_W &amp; flags) {</div>
<div class="line"><span class="lineno"> 6708</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 6709</span>        }</div>
<div class="line"><span class="lineno"> 6710</span>        <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6711</span>        <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 6712</span>        <span class="keywordtype">unsigned</span> wanted = p_filesz;</div>
<div class="line"><span class="lineno"> 6713</span>        <span class="keywordflow">if</span> (!not_first_LOAD++) { <span class="comment">// first PT_LOAD</span></div>
<div class="line"><span class="lineno"> 6714</span>            wanted -= sz_block1;</div>
<div class="line"><span class="lineno"> 6715</span>            <span class="keywordflow">if</span> (sz_block1 &gt;  <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) { <span class="comment">// old style</span></div>
<div class="line"><span class="lineno"> 6716</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6717</span>                    <a class="code hl_function" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym</a>(orig_file_size, fo);</div>
<div class="line"><span class="lineno"> 6718</span>                }</div>
<div class="line"><span class="lineno"> 6719</span>                p_offset += sz_block1;</div>
<div class="line"><span class="lineno"> 6720</span>            }</div>
<div class="line"><span class="lineno"> 6721</span>            <span class="keywordflow">if</span> (sz_block1 == <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) { <span class="comment">// new style</span></div>
<div class="line"><span class="lineno"> 6722</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = (yct_off ? yct_off : <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 6723</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ipos = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6724</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6725</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>], len);</div>
<div class="line"><span class="lineno"> 6726</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6727</span>                    <a class="code hl_function" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym</a>(orig_file_size, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 6728</span>                }</div>
<div class="line"><span class="lineno"> 6729</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6730</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>], len);</div>
<div class="line"><span class="lineno"> 6731</span>                }</div>
<div class="line"><span class="lineno"> 6732</span>                <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 6733</span> </div>
<div class="line"><span class="lineno"> 6734</span><span class="comment">// github-issue629: (overlay_offset = 0xa500), so initially (xct_off = 0xa494).</span></div>
<div class="line"><span class="lineno"> 6735</span><span class="comment">// But &quot;yct_off = get_te32(&amp;shdri-&gt;sh_offset)&quot; so if _Shdrs are aligned (??)</span></div>
<div class="line"><span class="lineno"> 6736</span><span class="comment">// then (0x10500 == (xct_off = asl_delta + yct_off)), and we read+write</span></div>
<div class="line"><span class="lineno"> 6737</span><span class="comment">// more than we need.</span></div>
<div class="line"><span class="lineno"> 6738</span><span class="comment">// So assume the excess just lives there, or is overwritten later by seek+write.</span></div>
<div class="line"><span class="lineno"> 6739</span>                <span class="keywordflow">if</span> (wanted &lt; len) { <span class="comment">// FIXME: why does this happen?</span></div>
<div class="line"><span class="lineno"> 6740</span>                    wanted = 0;</div>
<div class="line"><span class="lineno"> 6741</span>                }</div>
<div class="line"><span class="lineno"> 6742</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6743</span>                    wanted -= len;</div>
<div class="line"><span class="lineno"> 6744</span>                }</div>
<div class="line"><span class="lineno"> 6745</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(ipos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6746</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> == p_filesz) {</div>
<div class="line"><span class="lineno"> 6747</span>                    <span class="keywordflow">continue</span>;   <span class="comment">// already entirely re-generated</span></div>
<div class="line"><span class="lineno"> 6748</span>                }</div>
<div class="line"><span class="lineno"> 6749</span>                p_offset = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 6750</span>            }</div>
<div class="line"><span class="lineno"> 6751</span>        }</div>
<div class="line"><span class="lineno"> 6752</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6753</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(p_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6754</span>        }</div>
<div class="line"><span class="lineno"> 6755</span>        <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(wanted, fo, c_adler, u_adler, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 6756</span>    }</div>
<div class="line"><span class="lineno"> 6757</span>    <a class="code hl_function" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);</div>
<div class="line"><span class="lineno"> 6758</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6759</span> </div>
<div class="line"><span class="lineno"> 6760</span>    <span class="comment">// Handle PT_LOAD with PF_W: writeable, so not compressed.  &quot;Slide&quot;</span></div>
<div class="line"><span class="lineno"> 6761</span>    o_phdr = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *)(1+ ehdro);</div>
<div class="line"><span class="lineno"> 6762</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *i_phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 6763</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++o_phdr, ++i_phdr) {</div>
<div class="line"><span class="lineno"> 6764</span>        <span class="keywordtype">unsigned</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_type);</div>
<div class="line"><span class="lineno"> 6765</span>        <span class="keywordtype">unsigned</span> flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_flags);</div>
<div class="line"><span class="lineno"> 6766</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a> != type || !(Elf32_Phdr::PF_W &amp; flags)) {</div>
<div class="line"><span class="lineno"> 6767</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 6768</span>        }</div>
<div class="line"><span class="lineno"> 6769</span>        <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 6770</span>        <span class="keywordtype">unsigned</span> o_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 6771</span>        <span class="keywordtype">unsigned</span> i_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;i_phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6772</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(i_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6773</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 6774</span>        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += filesz;</div>
<div class="line"><span class="lineno"> 6775</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6776</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(o_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6777</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 6778</span>        }</div>
<div class="line"><span class="lineno"> 6779</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = filesz + o_offset;  <span class="comment">// high-water mark</span></div>
<div class="line"><span class="lineno"> 6780</span>    }</div>
<div class="line"><span class="lineno"> 6781</span> </div>
<div class="line"><span class="lineno"> 6782</span>    <span class="comment">// Gaps between PT_LOAD will be handled by ::unpack()</span></div>
<div class="line"><span class="lineno"> 6783</span> </div>
<div class="line"><span class="lineno"> 6784</span>    <span class="comment">// position fi at loader offset</span></div>
<div class="line"><span class="lineno"> 6785</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6786</span>}</div>
<div class="ttc" id="aclassPackLinuxElf32_html_a9cec931e83f51aaba944196c3476154c"><div class="ttname"><a href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">PackLinuxElf32::un_asl_dynsym</a></div><div class="ttdeci">virtual void un_asl_dynsym(unsigned orig_file_size, OutputFile *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06325">p_lx_elf.cpp:6325</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a4920cc3ff82dcbc60f2a87fdd276d025"><div class="ttname"><a href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a></div><div class="ttdeci">unsigned loader_offset</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00111">p_lx_elf.h:111</a></div></div>
<div class="ttc" id="aclassPackUnix_html_ab16d64e1b95f1dcf5f128665b83660f6"><div class="ttname"><a href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent</a></div><div class="ttdeci">virtual unsigned unpackExtent(unsigned wanted, OutputFile *fo, unsigned &amp;c_adler, unsigned &amp;u_adler, bool first_PF_X, int is_rewrite=false)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00470">p_unix.cpp:470</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae2f3660cdb0ae37f901276a8f136e6a9"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a></div><div class="ttdeci">static unsigned funpad4(InputFile *fi)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00131">p_lx_elf.cpp:131</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_a04c658023e50479eed64f6d1b00a2504"><div class="ttname"><a href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">Elf32_Ehdr::e_ehsize</a></div><div class="ttdeci">Elf32_Half e_ehsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00197">bsd.h:197</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html_aa27627bda53281221325df4dd782e800"><div class="ttname"><a href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">Elf32_Ehdr::e_version</a></div><div class="ttdeci">Elf32_Word e_version</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00192">bsd.h:192</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">Elf32_Ehdr::e_ehsize</a>, <a class="el" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">Elf32_Ehdr::e_entry</a>, <a class="el" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">Elf32_Ehdr::e_flags</a>, <a class="el" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a>, <a class="el" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf32.html#a46cb564e37f90259226b0fa81fe8b496">e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a00601af5187a1b3f8babfe9cddd95c15">Elf32_Ehdr::e_shoff</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">Elf32_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a>, <a class="el" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf32.html#a37a0e7b21ef6ab9036a71fe7101eb9fc">shdri</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a>, <a class="el" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym()</a>, <a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent()</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_cgraph" id="aclassPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_cgraph">
<area shape="rect" title=" " alt="" coords="5,1065,149,1105"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="220,921,353,947"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9" title=" " alt="" coords="249,72,324,97"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="473,21,590,47"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="721,323,827,348"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="467,1540,596,1565"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="915,1325,1044,1351"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="202,1601,371,1627"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="245,1675,329,1700"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="247,1748,326,1773"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="470,71,593,96"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="467,1073,595,1099"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="462,1123,601,1148"/>
<area shape="rect" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c" title=" " alt="" coords="215,1242,359,1282"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="709,573,839,599"/>
<area shape="rect" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6" title=" " alt="" coords="197,497,376,523"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1127,860,1217,885"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="493,723,569,748"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="732,779,816,804"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="491,972,572,997"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="424,821,639,847"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="454,871,609,896"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1295,1124,1413,1149"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="699,958,849,998"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="716,372,832,397"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="911,323,1048,348"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="914,421,1045,447"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="951,372,1008,397"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="911,809,1047,835"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="909,471,1049,496"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="717,272,831,297"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="699,72,849,97"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1127,548,1217,573"/>
<area shape="rect" href="classPackLinuxElf32.html#a71dfe9e1479de8e093db3320b9b4588f" title=" " alt="" coords="687,1224,861,1249"/>
<area shape="rect" href="classPackLinuxElf32.html#a0582ead69b6b3552ad4f751c2fa3f882" title=" " alt="" coords="459,1325,604,1365"/>
<area shape="rect" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756" title=" " alt="" coords="701,1461,847,1501"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="460,772,603,797"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="467,1439,595,1464"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="460,1389,603,1415"/>
<area shape="rect" href="classPackLinuxElf32.html#aaad617181a6e644a245633fc306f6fca" title=" " alt="" coords="1097,1174,1247,1214"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="946,1256,1013,1281"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="701,1375,847,1415"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="912,624,1047,649"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="935,673,1024,699"/>
<area shape="rect" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29" title="decompress" alt="" coords="456,296,607,321"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="456,345,607,371"/>
<area shape="rect" href="classFilter.html#a9ebf9984c147460e8e734225354023df" title=" " alt="" coords="489,497,573,523"/>
<area shape="rect" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49" title=" " alt="" coords="485,247,578,272"/>
<area shape="rect" href="classFilter.html#a34aee2c034f2a84b0b8af53287066c1a" title=" " alt="" coords="477,547,586,572"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="723,421,825,447"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_icgraph" id="aclassPackLinuxElf32_a6a054376b40ab2dc536ce43302d2c989_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a09edcb8bd331405f99b25b09d37f5040" name="a09edcb8bd331405f99b25b09d37f5040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09edcb8bd331405f99b25b09d37f5040">&#9670;&#160;</a></span>unpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::unpack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic Unix <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack().">unpack()</a>. </p>
<p>This code looks much like the one in stub/l_linux.c See notes there. </p>

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32x86interp.html#a977fd6c88fdd7d1176701c170ceb031b">PackLinuxElf32x86interp</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08325">8325</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8326</span>{</div>
<div class="line"><span class="lineno"> 8327</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a> != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>)) {<span class="comment">// Phdrs not contiguous with Ehdr</span></div>
<div class="line"><span class="lineno"> 8328</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_phoff&quot;</span>);</div>
<div class="line"><span class="lineno"> 8329</span>    }</div>
<div class="line"><span class="lineno"> 8330</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> c_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 8331</span>    <span class="keywordtype">unsigned</span> u_phnum = 0;</div>
<div class="line"><span class="lineno"> 8332</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> old_dtinit = 0;</div>
<div class="line"><span class="lineno"> 8333</span> </div>
<div class="line"><span class="lineno"> 8334</span>    <span class="keywordflow">if</span> (Elf32_Ehdr::ET_EXEC == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a>)) {</div>
<div class="line"><span class="lineno"> 8335</span><span class="comment">// 40fddf17153ee3db73a04ff1bf288b91676138d6 2001-02-01 ph.version 11; b_info 12 bytes</span></div>
<div class="line"><span class="lineno"> 8336</span><span class="comment">// df9db96bd1c013c07da1d7ec740021d588ab2815 2001-01-17 ph.version 11; no b_info (==&gt; 8 bytes)</span></div>
<div class="line"><span class="lineno"> 8337</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">version</a> &lt;= 11</div>
<div class="line"><span class="lineno"> 8338</span>        &amp;&amp;  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">e_entry</a>) &lt; 0x401180</div>
<div class="line"><span class="lineno"> 8339</span>        &amp;&amp;  <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>)==Elf32_Ehdr::EM_386) {</div>
<div class="line"><span class="lineno"> 8340</span>            <span class="comment">// old style, 8-byte b_info:</span></div>
<div class="line"><span class="lineno"> 8341</span>            <span class="comment">// sizeof(b_info.sz_unc) + sizeof(b_info.sz_cpr);</span></div>
<div class="line"><span class="lineno"> 8342</span>            <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> = 2*<span class="keyword">sizeof</span>(unsigned);</div>
<div class="line"><span class="lineno"> 8343</span>        }</div>
<div class="line"><span class="lineno"> 8344</span>    }</div>
<div class="line"><span class="lineno"> 8345</span> </div>
<div class="line"><span class="lineno"> 8346</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8347</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 8348</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> != <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a>)) {</div>
<div class="line"><span class="lineno"> 8349</span>        <a class="code hl_struct" href="structLE32.html">NE32</a> <span class="keyword">const</span> *<span class="keyword">const</span> lp = (<a class="code hl_struct" href="structLE32.html">NE32</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno"> 8350</span>        <span class="comment">// Workaround for bug of extra linfo by some asl_pack2_Shdrs().</span></div>
<div class="line"><span class="lineno"> 8351</span>        <span class="keywordflow">if</span> (0==lp[0] &amp;&amp; 0==lp[1] &amp;&amp; 0==lp[2]) { <span class="comment">// looks like blank extra</span></div>
<div class="line"><span class="lineno"> 8352</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 8353</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> == <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a>)) {</div>
<div class="line"><span class="lineno"> 8354</span>                <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> += <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 8355</span>            }</div>
<div class="line"><span class="lineno"> 8356</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8357</span>                <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;l_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 8358</span>            }</div>
<div class="line"><span class="lineno"> 8359</span>        }</div>
<div class="line"><span class="lineno"> 8360</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8361</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;l_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 8362</span>        }</div>
<div class="line"><span class="lineno"> 8363</span>    }</div>
<div class="line"><span class="lineno"> 8364</span>    <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_lsize</a>);</div>
<div class="line"><span class="lineno"> 8365</span>    <a class="code hl_struct" href="structp__info.html">p_info</a> hbuf;  <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;hbuf, <span class="keyword">sizeof</span>(hbuf));</div>
<div class="line"><span class="lineno"> 8366</span>    <span class="keywordtype">unsigned</span> orig_file_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_filesize</a>);</div>
<div class="line"><span class="lineno"> 8367</span>    <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_blocksize</a>);</div>
<div class="line"><span class="lineno"> 8368</span>    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &gt; orig_file_size || <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> &gt; orig_file_size</div>
<div class="line"><span class="lineno"> 8369</span>        || !<a class="code hl_function" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid</a>(1, <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>))</div>
<div class="line"><span class="lineno"> 8370</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;p_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 8371</span> </div>
<div class="line"><span class="lineno"> 8372</span>    <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> + <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>);</div>
<div class="line"><span class="lineno"> 8373</span>    <a class="code hl_struct" href="structb__info.html">b_info</a> bhdr; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;bhdr, 0, <span class="keyword">sizeof</span>(bhdr));</div>
<div class="line"><span class="lineno"> 8374</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 8375</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 8376</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 8377</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> &gt; (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> == 0 || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> == 0</div>
<div class="line"><span class="lineno"> 8378</span>    ||  <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> &gt; orig_file_size)</div>
<div class="line"><span class="lineno"> 8379</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;b_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 8380</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">filter_cto</a> = bhdr.<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 8381</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a> = bhdr.<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;  <span class="comment">// FIXME if multiple de-compressors</span></div>
<div class="line"><span class="lineno"> 8382</span> </div>
<div class="line"><span class="lineno"> 8383</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> u(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a>);</div>
<div class="line"><span class="lineno"> 8384</span>    <a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *<span class="keyword">const</span> ehdr = (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)&amp;u[0];</div>
<div class="line"><span class="lineno"> 8385</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *phdr = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8386</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = 0;</div>
<div class="line"><span class="lineno"> 8387</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = 0;</div>
<div class="line"><span class="lineno"> 8388</span>    <span class="keywordtype">unsigned</span> c_adler = <a class="code hl_function" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><span class="lineno"> 8389</span>    <span class="keywordtype">unsigned</span> u_adler = <a class="code hl_function" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><span class="lineno"> 8390</span> </div>
<div class="line"><span class="lineno"> 8391</span>    <span class="keywordtype">unsigned</span> is_shlib = 0;</div>
<div class="line"><span class="lineno"> 8392</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = 0;</div>
<div class="line"><span class="lineno"> 8393</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> o_elfhdrs;</div>
<div class="line"><span class="lineno"> 8394</span>    <a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> dynhdr = <a class="code hl_function" href="classPackLinuxElf32.html#a0f2fa5dca83b3dc674c10277cd57c909">elf_find_ptype</a>(Elf32_Phdr::PT_DYNAMIC, <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, c_phnum);</div>
<div class="line"><span class="lineno"> 8395</span>    <span class="comment">// dynseg was set by PackLinuxElf32help1</span></div>
<div class="line"><span class="lineno"> 8396</span>    <span class="keywordflow">if</span> (dynhdr &amp;&amp; !(Elf32_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic</a>(Elf32_Dyn::DT_FLAGS_1))) {</div>
<div class="line"><span class="lineno"> 8397</span>        <span class="comment">// Packed shlib? (ET_DYN without -fPIE)</span></div>
<div class="line"><span class="lineno"> 8398</span>        is_shlib = 1;</div>
<div class="line"><span class="lineno"> 8399</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>);</div>
<div class="line"><span class="lineno"> 8400</span>        u_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 8401</span>        o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno"> 8402</span>        <a class="code hl_function" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1</a>(fo, o_elfhdrs, c_adler, u_adler, orig_file_size);</div>
<div class="line"><span class="lineno"> 8403</span>        *ehdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>;</div>
<div class="line"><span class="lineno"> 8404</span>    }</div>
<div class="line"><span class="lineno"> 8405</span>    <span class="keywordflow">else</span> { <span class="comment">// main executable</span></div>
<div class="line"><span class="lineno"> 8406</span>        <span class="comment">// Uncompress Ehdr and Phdrs: info for control of unpacking</span></div>
<div class="line"><span class="lineno"> 8407</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() &lt; <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>)</div>
<div class="line"><span class="lineno"> 8408</span>            <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 8409</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>);</div>
<div class="line"><span class="lineno"> 8410</span>        <a class="code hl_function" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">decompress</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, (<a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> *)ehdr, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 8411</span>        <span class="keywordflow">if</span> (ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a>   !=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">e_type</a></div>
<div class="line"><span class="lineno"> 8412</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>!=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a></div>
<div class="line"><span class="lineno"> 8413</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">e_version</a>!=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">e_version</a></div>
<div class="line"><span class="lineno"> 8414</span>            <span class="comment">// less strict for EM_PPC to workaround earlier bug</span></div>
<div class="line"><span class="lineno"> 8415</span>        ||  !( ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">e_flags</a>==<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">e_flags</a></div>
<div class="line"><span class="lineno"> 8416</span>            || Elf32_Ehdr::EM_PPC == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">e_machine</a>))</div>
<div class="line"><span class="lineno"> 8417</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">e_ehsize</a> !=<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">e_ehsize</a></div>
<div class="line"><span class="lineno"> 8418</span>            <span class="comment">// check EI_MAG[0-3], EI_CLASS, EI_DATA, EI_VERSION</span></div>
<div class="line"><span class="lineno"> 8419</span>        ||  <a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>, <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>, Elf32_Ehdr::EI_OSABI)) {</div>
<div class="line"><span class="lineno"> 8420</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;ElfXX_Ehdr corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 8421</span>        }</div>
<div class="line"><span class="lineno"> 8422</span>        <span class="comment">// Rewind: prepare for data phase</span></div>
<div class="line"><span class="lineno"> 8423</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(- (<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>) (<a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> + <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 8424</span> </div>
<div class="line"><span class="lineno"> 8425</span>        u_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 8426</span>        <span class="keywordflow">if</span> ((<a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a>) - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>))/<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>) &lt; u_phnum) {</div>
<div class="line"><span class="lineno"> 8427</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad compressed e_phnum&quot;</span>);</div>
<div class="line"><span class="lineno"> 8428</span>        }</div>
<div class="line"><span class="lineno"> 8429</span>        o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a>) + u_phnum * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>));</div>
<div class="line"><span class="lineno"> 8430</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(o_elfhdrs, ehdr, o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>());</div>
<div class="line"><span class="lineno"> 8431</span> </div>
<div class="line"><span class="lineno"> 8432</span>        <span class="comment">// Decompress each PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 8433</span>        <span class="keywordtype">bool</span> first_PF_X = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8434</span>        phdr = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *) (<span class="keywordtype">void</span> *) (1+ ehdr);  <span class="comment">// uncompressed</span></div>
<div class="line"><span class="lineno"> 8435</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; u_phnum; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 8436</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 8437</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 8438</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 8439</span>                <span class="keywordflow">if</span> (fo)</div>
<div class="line"><span class="lineno"> 8440</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8441</span>                <span class="keywordflow">if</span> (Elf32_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">p_flags</a>)) {</div>
<div class="line"><span class="lineno"> 8442</span>                    <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(filesz, fo,</div>
<div class="line"><span class="lineno"> 8443</span>                        c_adler, u_adler, first_PF_X);</div>
<div class="line"><span class="lineno"> 8444</span>                    first_PF_X = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8445</span>                }</div>
<div class="line"><span class="lineno"> 8446</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8447</span>                    <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(filesz, fo,</div>
<div class="line"><span class="lineno"> 8448</span>                        c_adler, u_adler, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 8449</span>                }</div>
<div class="line"><span class="lineno"> 8450</span>            }</div>
<div class="line"><span class="lineno"> 8451</span>        }</div>
<div class="line"><span class="lineno"> 8452</span>    }</div>
<div class="line"><span class="lineno"> 8453</span> </div>
<div class="line"><span class="lineno"> 8454</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> <span class="keyword">const</span> e_entry = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">e_entry</a>);</div>
<div class="line"><span class="lineno"> 8455</span>    <span class="keywordtype">unsigned</span> off_entry = 0;</div>
<div class="line"><span class="lineno"> 8456</span>    phdr = <a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>;</div>
<div class="line"><span class="lineno"> 8457</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = 0;</div>
<div class="line"><span class="lineno"> 8458</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; c_phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 8459</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 8460</span>            <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">p_offset</a>);</div>
<div class="line"><span class="lineno"> 8461</span>            <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> vaddr  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 8462</span>            <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> filesz = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 8463</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>) {</div>
<div class="line"><span class="lineno"> 8464</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = vaddr;</div>
<div class="line"><span class="lineno"> 8465</span>            }</div>
<div class="line"><span class="lineno"> 8466</span>            <span class="keywordflow">if</span> ((e_entry - vaddr) &lt; filesz) {</div>
<div class="line"><span class="lineno"> 8467</span>                off_entry = (e_entry - vaddr) + offset;</div>
<div class="line"><span class="lineno"> 8468</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8469</span>            }</div>
<div class="line"><span class="lineno"> 8470</span>        }</div>
<div class="line"><span class="lineno"> 8471</span>    }</div>
<div class="line"><span class="lineno"> 8472</span>    <span class="keywordtype">unsigned</span> d_info[6];</div>
<div class="line"><span class="lineno"> 8473</span>    <span class="keywordtype">unsigned</span> sz_d_info = <span class="keyword">sizeof</span>(d_info);</div>
<div class="line"><span class="lineno"> 8474</span>    <span class="keywordflow">if</span> (!is_shlib) {</div>
<div class="line"><span class="lineno"> 8475</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[0].p_flags) &amp; Elf32_Phdr::PF_X) {</div>
<div class="line"><span class="lineno"> 8476</span>            <span class="comment">// Old style, such as upx-3.91 thru upx-3.95</span></div>
<div class="line"><span class="lineno"> 8477</span>            <span class="keywordflow">switch</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 8478</span>                <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 8479</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 8480</span>                        <span class="stringliteral">&quot;Unknown architecture %d&quot;</span>, this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);</div>
<div class="line"><span class="lineno"> 8481</span>                    <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 8482</span>                }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8483</span>                <span class="keywordflow">case</span> Elf32_Ehdr::EM_MIPS:sz_d_info = 1 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8484</span>                <span class="keywordflow">case</span> Elf32_Ehdr::EM_ARM: sz_d_info = 4 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8485</span>                <span class="keywordflow">case</span> Elf32_Ehdr::EM_PPC: sz_d_info = 3 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8486</span>                <span class="keywordflow">case</span> Elf32_Ehdr::EM_386: sz_d_info = 2 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8487</span>            }</div>
<div class="line"><span class="lineno"> 8488</span>        }</div>
<div class="line"><span class="lineno"> 8489</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = off_entry - sz_d_info;</div>
<div class="line"><span class="lineno"> 8490</span>    }</div>
<div class="line"><span class="lineno"> 8491</span> </div>
<div class="line"><span class="lineno"> 8492</span>    <span class="keywordflow">if</span> (0x1000==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[0].p_filesz)  <span class="comment">// detect C_BASE style</span></div>
<div class="line"><span class="lineno"> 8493</span>    &amp;&amp;  0==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[1].p_offset)</div>
<div class="line"><span class="lineno"> 8494</span>    &amp;&amp;  0==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[0].p_offset)</div>
<div class="line"><span class="lineno"> 8495</span>    &amp;&amp;     <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[1].p_filesz) == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[1].p_memsz)) {</div>
<div class="line"><span class="lineno"> 8496</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>[1].p_memsz)), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);  <span class="comment">// past the loader</span></div>
<div class="line"><span class="lineno"> 8497</span>    }</div>
<div class="line"><span class="lineno"> 8498</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_shlib</div>
<div class="line"><span class="lineno"> 8499</span>    ||  (off_entry + <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>) + <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_function" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">getPackHeaderSize</a>() + <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a>))</div>
<div class="line"><span class="lineno"> 8500</span>            &lt; <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>)) {</div>
<div class="line"><span class="lineno"> 8501</span>        <span class="comment">// Loader is not at end; skip past it.</span></div>
<div class="line"><span class="lineno"> 8502</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>) {</div>
<div class="line"><span class="lineno"> 8503</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8504</span>        }</div>
<div class="line"><span class="lineno"> 8505</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8506</span>            <a class="code hl_function" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);  <span class="comment">// MATCH01</span></div>
<div class="line"><span class="lineno"> 8507</span>        }</div>
<div class="line"><span class="lineno"> 8508</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(d_info, sz_d_info);</div>
<div class="line"><span class="lineno"> 8509</span>        <span class="keywordflow">if</span> (is_shlib &amp;&amp; 0==old_dtinit) {</div>
<div class="line"><span class="lineno"> 8510</span>            old_dtinit = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;d_info[2 + (0==d_info[0])]);</div>
<div class="line"><span class="lineno"> 8511</span>            <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = 1u&amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;d_info[0 + (0==d_info[0])]);</div>
<div class="line"><span class="lineno"> 8512</span>        }</div>
<div class="line"><span class="lineno"> 8513</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a> - sz_d_info, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 8514</span>    }</div>
<div class="line"><span class="lineno"> 8515</span> </div>
<div class="line"><span class="lineno"> 8516</span>    <span class="comment">// The gaps between PT_LOAD and after last PT_LOAD</span></div>
<div class="line"><span class="lineno"> 8517</span>    phdr = (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> <span class="keyword">const</span> *)(1+ (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)o_elfhdrs);</div>
<div class="line"><span class="lineno"> 8518</span>    <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> hi_offset(0);</div>
<div class="line"><span class="lineno"> 8519</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; u_phnum; ++j) {</div>
<div class="line"><span class="lineno"> 8520</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_type)</div>
<div class="line"><span class="lineno"> 8521</span>        &amp;&amp;  hi_offset &lt; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_offset))</div>
<div class="line"><span class="lineno"> 8522</span>            hi_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_offset);</div>
<div class="line"><span class="lineno"> 8523</span>    }</div>
<div class="line"><span class="lineno"> 8524</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; u_phnum; ++j) {</div>
<div class="line"><span class="lineno"> 8525</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> = <a class="code hl_function" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap</a>(phdr, j, u_phnum);</div>
<div class="line"><span class="lineno"> 8526</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>) {</div>
<div class="line"><span class="lineno"> 8527</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> where = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_offset) +</div>
<div class="line"><span class="lineno"> 8528</span>                                   <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_filesz);</div>
<div class="line"><span class="lineno"> 8529</span>            <span class="keywordflow">if</span> (fo)</div>
<div class="line"><span class="lineno"> 8530</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(where, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8531</span>            { <span class="comment">// Recover from some piracy [also serves as error tolerance :-) ]</span></div>
<div class="line"><span class="lineno"> 8532</span>              <span class="comment">// Getting past the loader is problematic, due to unintended</span></div>
<div class="line"><span class="lineno"> 8533</span>              <span class="comment">// variances between released versions:</span></div>
<div class="line"><span class="lineno"> 8534</span>              <span class="comment">//   l_info.l_lsize might be rounded up by 8 instead of by 4, and</span></div>
<div class="line"><span class="lineno"> 8535</span>              <span class="comment">//   sz_d_info might have changed.</span></div>
<div class="line"><span class="lineno"> 8536</span>                <a class="code hl_struct" href="structb__info.html">b_info</a> b_peek, *bp = &amp;b_peek;</div>
<div class="line"><span class="lineno"> 8537</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(bp, <span class="keyword">sizeof</span>(b_peek));</div>
<div class="line"><span class="lineno"> 8538</span>                <a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a> pos = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(-(<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)<span class="keyword">sizeof</span>(b_peek), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 8539</span>                <span class="keywordtype">unsigned</span> sz_unc = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 8540</span>                <span class="keywordtype">unsigned</span> sz_cpr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 8541</span>                <span class="keywordtype">unsigned</span> word3  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>);</div>
<div class="line"><span class="lineno"> 8542</span>                <span class="keywordtype">unsigned</span> method = bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;</div>
<div class="line"><span class="lineno"> 8543</span>                <span class="keywordtype">unsigned</span> ftid = bp-&gt;<a class="code hl_variable" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_ftid</a>;</div>
<div class="line"><span class="lineno"> 8544</span>                <span class="keywordtype">unsigned</span> cto8 = bp-&gt;<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 8545</span>                <span class="keywordflow">if</span> (!( ((sz_cpr == sz_unc) &amp;&amp; (0 == word3) &amp;&amp; (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> == sz_unc)) <span class="comment">// incompressible literal</span></div>
<div class="line"><span class="lineno"> 8546</span>                    || ((sz_cpr &lt;  sz_unc) &amp;&amp; (method == <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a>) &amp;&amp; (0 == ftid) &amp;&amp; (0 == cto8)))</div>
<div class="line"><span class="lineno"> 8547</span>                ) {</div>
<div class="line"><span class="lineno"> 8548</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode++;</div>
<div class="line"><span class="lineno"> 8549</span>                    <a class="code hl_function" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a>(<span class="stringliteral">&quot;bad b_info at %#zx&quot;</span>, (<span class="keywordtype">size_t</span>)pos);</div>
<div class="line"><span class="lineno"> 8550</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> N_PEEK(16 * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)), H_PEEK(N_PEEK &gt;&gt; 1);</div>
<div class="line"><span class="lineno"> 8551</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> peek_arr[N_PEEK];</div>
<div class="line"><span class="lineno"> 8552</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos - H_PEEK, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8553</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(peek_arr, <span class="keyword">sizeof</span>(peek_arr));</div>
<div class="line"><span class="lineno"> 8554</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8555</span>                    <span class="keywordtype">bool</span> <span class="keyword">const</span> is_be = ELFDATA2MSB == <a class="code hl_variable" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>.<a class="code hl_variable" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">e_ident</a>[EI_DATA];</div>
<div class="line"><span class="lineno"> 8556</span>                    <span class="keywordflow">if</span> (is_be) {</div>
<div class="line"><span class="lineno"> 8557</span>                        <span class="comment">// Does the right thing for sz_unc and sz_cpr,</span></div>
<div class="line"><span class="lineno"> 8558</span>                        <span class="comment">// but swaps b_method and b_extra.  Need find_be32() :-)</span></div>
<div class="line"><span class="lineno"> 8559</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; N_PEEK; k += <span class="keyword">sizeof</span>(int)) {</div>
<div class="line"><span class="lineno"> 8560</span>                            <a class="code hl_function" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a>(&amp;peek_arr[k], <a class="code hl_function" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32</a>(&amp;peek_arr[k]));</div>
<div class="line"><span class="lineno"> 8561</span>                        }</div>
<div class="line"><span class="lineno"> 8562</span>                    }</div>
<div class="line"><span class="lineno"> 8563</span>                    <span class="keywordtype">int</span> boff = <a class="code hl_function" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32</a>(peek_arr, <span class="keyword">sizeof</span>(peek_arr), <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>);</div>
<div class="line"><span class="lineno"> 8564</span>                    <span class="keywordflow">if</span> (boff &lt; 0 || <span class="keyword">sizeof</span>(peek_arr) &lt; (<span class="keyword">sizeof</span>(*bp) + boff)) {</div>
<div class="line"><span class="lineno"> 8565</span>                        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;b_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 8566</span>                    }</div>
<div class="line"><span class="lineno"> 8567</span>                    bp = (<a class="code hl_struct" href="structb__info.html">b_info</a> *)(<span class="keywordtype">void</span> *)&amp;peek_arr[boff];</div>
<div class="line"><span class="lineno"> 8568</span> </div>
<div class="line"><span class="lineno"> 8569</span>                    sz_unc = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 8570</span>                    sz_cpr = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 8571</span>                    word3  = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>);</div>
<div class="line"><span class="lineno"> 8572</span>                    ftid = bp-&gt;<a class="code hl_variable" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_ftid</a>;</div>
<div class="line"><span class="lineno"> 8573</span>                    cto8 = bp-&gt;<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 8574</span>                    <span class="keywordflow">if</span> (0 &lt;= boff  <span class="comment">// found</span></div>
<div class="line"><span class="lineno"> 8575</span>                    &amp;&amp; ( ((sz_cpr == sz_unc) &amp;&amp; (0 == word3) &amp;&amp; (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> == sz_unc)) <span class="comment">// incompressible literal</span></div>
<div class="line"><span class="lineno"> 8576</span>                      || ((sz_cpr &lt;  sz_unc) &amp;&amp; (0 == ftid) &amp;&amp; (0 == cto8)</div>
<div class="line"><span class="lineno"> 8577</span>                          &amp;&amp; ((is_be ? bp-&gt;b_extra : bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>) == <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a>)) )</div>
<div class="line"><span class="lineno"> 8578</span>                    ) {</div>
<div class="line"><span class="lineno"> 8579</span>                        pos -= H_PEEK;</div>
<div class="line"><span class="lineno"> 8580</span>                        pos += boff;</div>
<div class="line"><span class="lineno"> 8581</span>                        <a class="code hl_function" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a>(<span class="stringliteral">&quot;... recovery at %#zx&quot;</span>, (<span class="keywordtype">size_t</span>)pos);</div>
<div class="line"><span class="lineno"> 8582</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 8583</span>                    }</div>
<div class="line"><span class="lineno"> 8584</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode--;</div>
<div class="line"><span class="lineno"> 8585</span>                }</div>
<div class="line"><span class="lineno"> 8586</span>            }</div>
<div class="line"><span class="lineno"> 8587</span>            <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>, fo,</div>
<div class="line"><span class="lineno"> 8588</span>                c_adler, u_adler, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 8589</span>                is_shlib &amp;&amp; ((phdr[j].p_offset != hi_offset)));</div>
<div class="line"><span class="lineno"> 8590</span>                <span class="comment">// FIXME: should not depend on is_shlib ?</span></div>
<div class="line"><span class="lineno"> 8591</span>        }</div>
<div class="line"><span class="lineno"> 8592</span>    }</div>
<div class="line"><span class="lineno"> 8593</span> </div>
<div class="line"><span class="lineno"> 8594</span>    <span class="comment">// check for end-of-file</span></div>
<div class="line"><span class="lineno"> 8595</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 8596</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_unc = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 8597</span> </div>
<div class="line"><span class="lineno"> 8598</span>    <span class="keywordflow">if</span> (sz_unc == 0) { <span class="comment">// uncompressed size 0 -&gt; EOF</span></div>
<div class="line"><span class="lineno"> 8599</span>        <span class="comment">// note: magic is always stored le32</span></div>
<div class="line"><span class="lineno"> 8600</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_cpr = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 8601</span>        <span class="keywordflow">if</span> (sz_cpr != <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>)  <span class="comment">// sz_cpr must be h-&gt;magic</span></div>
<div class="line"><span class="lineno"> 8602</span>            <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 8603</span>    }</div>
<div class="line"><span class="lineno"> 8604</span>    <span class="keywordflow">else</span> { <span class="comment">// extra bytes after end?</span></div>
<div class="line"><span class="lineno"> 8605</span>        <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 8606</span>    }</div>
<div class="line"><span class="lineno"> 8607</span> </div>
<div class="line"><span class="lineno"> 8608</span>    <span class="keywordflow">if</span> (is_shlib) {</div>
<div class="line"><span class="lineno"> 8609</span>        <a class="code hl_function" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT</a>(old_dtinit, (<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)(<span class="keywordtype">void</span> *)o_elfhdrs), dynhdr, fo);</div>
<div class="line"><span class="lineno"> 8610</span>    }</div>
<div class="line"><span class="lineno"> 8611</span> </div>
<div class="line"><span class="lineno"> 8612</span>    <span class="comment">// update header with totals</span></div>
<div class="line"><span class="lineno"> 8613</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>;</div>
<div class="line"><span class="lineno"> 8614</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 8615</span> </div>
<div class="line"><span class="lineno"> 8616</span>    <span class="comment">// all bytes must be written</span></div>
<div class="line"><span class="lineno"> 8617</span>    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> != orig_file_size)</div>
<div class="line"><span class="lineno"> 8618</span>        <a class="code hl_function" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a>();</div>
<div class="line"><span class="lineno"> 8619</span> </div>
<div class="line"><span class="lineno"> 8620</span>    <span class="comment">// finally test the checksums</span></div>
<div class="line"><span class="lineno"> 8621</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">c_adler</a> != c_adler || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">u_adler</a> != u_adler)</div>
<div class="line"><span class="lineno"> 8622</span>        <a class="code hl_function" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError</a>();</div>
<div class="line"><span class="lineno"> 8623</span>}</div>
<div class="ttc" id="abele_8h_html_a16e4a11a30290f102ab4d44df1e0547d"><div class="ttname"><a href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_be32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00315">bele.h:315</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a0f2fa5dca83b3dc674c10277cd57c909"><div class="ttname"><a href="classPackLinuxElf32.html#a0f2fa5dca83b3dc674c10277cd57c909">PackLinuxElf32::elf_find_ptype</a></div><div class="ttdeci">Elf32_Phdr const * elf_find_ptype(unsigned type, Elf32_Phdr const *phdr0, unsigned phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02278">p_lx_elf.cpp:2278</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a52055eaaf3a28d1986937825c9382ae7"><div class="ttname"><a href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">PackLinuxElf32::un_DT_INIT</a></div><div class="ttdeci">virtual void un_DT_INIT(unsigned old_dtinit, Elf32_Phdr const *phdro, Elf32_Phdr const *dynhdr, OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06788">p_lx_elf.cpp:6788</a></div></div>
<div class="ttc" id="aclassPackLinuxElf32_html_a6a054376b40ab2dc536ce43302d2c989"><div class="ttname"><a href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">PackLinuxElf32::un_shlib_1</a></div><div class="ttdeci">virtual void un_shlib_1(OutputFile *const fo, MemBuffer &amp;o_elfhdrs, unsigned &amp;c_adler, unsigned &amp;u_adler, unsigned const orig_file_size)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06588">p_lx_elf.cpp:6588</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a691359a24fbf2963d4ac5f625dd0299c"><div class="ttname"><a href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">PackLinuxElf::prev_method</a></div><div class="ttdeci">unsigned char prev_method</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00117">p_lx_elf.h:117</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a05a8d9222b7627fa48786c128340b0c0"><div class="ttname"><a href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">PackUnix::szb_info</a></div><div class="ttdeci">unsigned szb_info</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00105">p_unix.h:105</a></div></div>
<div class="ttc" id="aclassPacker_html_ab53d9fc8308aa5467d38425ad3673b29"><div class="ttname"><a href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">Packer::decompress</a></div><div class="ttdeci">void decompress(SPAN_P(const byte) in, SPAN_P(byte) out, bool verify_checksum=true, Filter *ft=nullptr)</div><div class="ttdoc">decompress</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00305">packer.cpp:305</a></div></div>
<div class="ttc" id="acompress_8cpp_html_ac78c1624c94e1e6b82fc6d9882285671"><div class="ttname"><a href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a></div><div class="ttdeci">unsigned upx_adler32(const void *buf, unsigned len, unsigned adler)</div><div class="ttdef"><b>Definition:</b> <a href="compress_8cpp_source.html#l00035">compress.cpp:35</a></div></div>
<div class="ttc" id="aconf_8h_html_ad8f1b4770ed40d94738e95587f35d75e"><div class="ttname"><a href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a></div><div class="ttdeci">void void void infoWarning(const char *format,...) attribute_format(1</div></div>
<div class="ttc" id="aexcept_8cpp_html_a3b79341230572b77353447647a3cd498"><div class="ttname"><a href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a></div><div class="ttdeci">void throwCompressedDataViolation()</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00122">except.cpp:122</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a75193d7ea3127c37580a384eca372630"><div class="ttname"><a href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError</a></div><div class="ttdeci">void throwChecksumError()</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00120">except.cpp:120</a></div></div>
<div class="ttc" id="astructLE32_html"><div class="ttname"><a href="structLE32.html">LE32</a></div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00756">bele.h:756</a></div></div>
<div class="ttc" id="astructPackHeader_html_a4b3ba8dce6c3cc4eb44a412fd743125c"><div class="ttname"><a href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">PackHeader::u_adler</a></div><div class="ttdeci">unsigned u_adler</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00056">packhead.h:56</a></div></div>
<div class="ttc" id="astructPackHeader_html_abe9892837b086ae9e9d52c06e4ccffdb"><div class="ttname"><a href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">PackHeader::getPackHeaderSize</a></div><div class="ttdeci">int getPackHeaderSize() const</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00070">packhead.cpp:70</a></div></div>
<div class="ttc" id="astructPackHeader_html_af3810d94cc6ec509ce906269114169f9"><div class="ttname"><a href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">PackHeader::filter_cto</a></div><div class="ttdeci">int filter_cto</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00060">packhead.h:60</a></div></div>
<div class="ttc" id="astructPackHeader_html_af8203b5d7f51a8fb27e917c9d571087b"><div class="ttname"><a href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">PackHeader::c_adler</a></div><div class="ttdeci">unsigned c_adler</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00057">packhead.h:57</a></div></div>
<div class="ttc" id="astructb__info_html_a420b07fc7e6c56d5f59a6b169dfc1b6f"><div class="ttname"><a href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_info::b_cto8</a></div><div class="ttdeci">unsigned char b_cto8</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00327">bsd.h:327</a></div></div>
<div class="ttc" id="astructb__info_html_ab0002ff09884ac6ed5137f678d9ca865"><div class="ttname"><a href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a></div><div class="ttdeci">unsigned char b_method</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00325">bsd.h:325</a></div></div>
<div class="ttc" id="astructb__info_html_add96d538b23e18c8ab3223c184fd7960"><div class="ttname"><a href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a></div><div class="ttdeci">uint32_t sz_unc</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00323">bsd.h:323</a></div></div>
<div class="ttc" id="astructb__info_html_ae26f59906590a2fff73341fe397993d2"><div class="ttname"><a href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_info::b_ftid</a></div><div class="ttdeci">unsigned char b_ftid</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00326">bsd.h:326</a></div></div>
<div class="ttc" id="autil_8cpp_html_aa692c787bee35bf08628018de7aa42d1"><div class="ttname"><a href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid</a></div><div class="ttdeci">bool mem_size_valid(upx_uint64_t element_size, upx_uint64_t n, upx_uint64_t extra1, upx_uint64_t extra2) noexcept</div><div class="ttdoc">upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma...</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00056">util.cpp:56</a></div></div>
<div class="ttc" id="autil_8cpp_html_aca065128666a7d8af5864a1fc875c156"><div class="ttname"><a href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32</a></div><div class="ttdeci">int find_le32(const void *b, int blen, unsigned what) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00709">util.cpp:709</a></div></div>
<div class="ttc" id="axspan__impl__common_8h_html_a60304b65bf89363bcc3165d3cde67f86"><div class="ttname"><a href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="xspan__impl__common_8h_source.html#l00460">xspan_impl_common.h:460</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_info::b_cto8</a>, <a class="el" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_info::b_ftid</a>, <a class="el" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">PackHeader::c_adler</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">Packer::decompress()</a>, <a class="el" href="structElf32__Ehdr.html#a04c658023e50479eed64f6d1b00a2504">Elf32_Ehdr::e_ehsize</a>, <a class="el" href="structElf32__Ehdr.html#ab8a982696048d807017919b7d0145482">Elf32_Ehdr::e_entry</a>, <a class="el" href="structElf32__Ehdr.html#a87cf481be7917fafde0c4ecf78c8e574">Elf32_Ehdr::e_flags</a>, <a class="el" href="structElf32__Ehdr.html#aebd5576e5ae99cb99c2eb76d94c7f9f7">Elf32_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf32__Ehdr.html#a19bca7faba9e5573814643efc3574c7b">Elf32_Ehdr::e_machine</a>, <a class="el" href="structElf32__Ehdr.html#a360898812db1655f8cb8258780d9df5b">Elf32_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf32.html#a2d8e571980c32f2e706cc6f60f38e736">e_phoff</a>, <a class="el" href="structElf32__Ehdr.html#a49e40a791813c06e3b6ebcb53aef1bb8">Elf32_Ehdr::e_type</a>, <a class="el" href="structElf32__Ehdr.html#aa27627bda53281221325df4dd782e800">Elf32_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf32.html#a10cfe7410f5f1cdd4b1d4d8aa32c177e">ehdri</a>, <a class="el" href="classPackLinuxElf32.html#a0f2fa5dca83b3dc674c10277cd57c909">elf_find_ptype()</a>, <a class="el" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">PackHeader::filter_cto</a>, <a class="el" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32()</a>, <a class="el" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4()</a>, <a class="el" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32()</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">PackHeader::getPackHeaderSize()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a>, <a class="el" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="p__lx__elf_8cpp.html#a977c134df2e7ed6eb5533874edb9d791">MAX_ELF_HDR_32</a>, <a class="el" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid()</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a>, <a class="el" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a>, <a class="el" href="structElf32__Phdr.html#ac9151f2e11001284bf1c7d2d2659555c">Elf32_Phdr::p_filesz</a>, <a class="el" href="structElf32__Phdr.html#a35c457e6828894b7b275730593802050">Elf32_Phdr::p_flags</a>, <a class="el" href="structElf32__Phdr.html#ac590d4c4b26104216e53058b5b03eef0">Elf32_Phdr::p_offset</a>, <a class="el" href="structElf32__Phdr.html#a8b1d2942ddb9abcb85db1429b5116923">Elf32_Phdr::p_type</a>, <a class="el" href="structElf32__Phdr.html#a01a298ebc899bcf9c23211a7bf1155a6">Elf32_Phdr::p_vaddr</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf32.html#a16f49d5da05459eab08054620b8afa81">phdri</a>, <a class="el" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">PackLinuxElf::prev_method</a>, <a class="el" href="p__lx__elf_8cpp.html#a204ef936a203e18150dc61b25af76bb8">PT_LOAD32</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32()</a>, <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a>, <a class="el" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">PackUnix::szb_info</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError()</a>, <a class="el" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation()</a>, <a class="el" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">PackHeader::u_adler</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1()</a>, <a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent()</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, <a class="el" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32()</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a09edcb8bd331405f99b25b09d37f5040_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a09edcb8bd331405f99b25b09d37f5040_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a09edcb8bd331405f99b25b09d37f5040_cgraph" id="aclassPackLinuxElf32_a09edcb8bd331405f99b25b09d37f5040_cgraph">
<area shape="rect" title="Generic Unix unpack()." alt="" coords="5,1069,180,1095"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="444,791,577,816"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="687,888,763,913"/>
<area shape="rect" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29" title="decompress" alt="" coords="650,1040,801,1065"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1176,1217,1315,1243"/>
<area shape="rect" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630" title=" " alt="" coords="1166,5,1325,31"/>
<area shape="rect" href="except_8cpp.html#a3b79341230572b77353447647a3cd498" title=" " alt="" coords="1131,409,1360,435"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="1194,1091,1297,1116"/>
<area shape="rect" href="classPackLinuxElf32.html#a0f2fa5dca83b3dc674c10277cd57c909" title=" " alt="" coords="228,207,373,247"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="902,448,1031,473"/>
<area shape="rect" href="classPackLinuxElf32.html#a3cc398e82caa74060ec330d678f7e142" title=" " alt="" coords="435,574,586,614"/>
<area shape="rect" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156" title=" " alt="" coords="260,423,341,448"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="683,347,767,372"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="472,423,549,448"/>
<area shape="rect" href="classPackLinuxElf32.html#a26ea5f1df204c3f64aa7d4bea4da1dd2" title=" " alt="" coords="435,157,587,197"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9" title=" " alt="" coords="473,1804,548,1829"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="667,1828,784,1853"/>
<area shape="rect" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d" title=" " alt="" coords="259,272,342,297"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="261,321,340,347"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="446,1449,575,1475"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="851,1496,1083,1521"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="650,1293,801,1319"/>
<area shape="rect" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e" title=" " alt="" coords="251,1416,351,1441"/>
<area shape="rect" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="237,1465,365,1491"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="471,1929,550,1955"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="664,1549,787,1575"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="892,1600,1041,1625"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="447,1703,575,1728"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="277,1753,325,1779"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="229,827,373,867"/>
<area shape="rect" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989" title=" " alt="" coords="229,1515,373,1555"/>
<area shape="rect" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6" title=" " alt="" coords="421,1095,600,1120"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="277,2031,324,2056"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1408,1319,1497,1344"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="683,663,767,688"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="685,613,766,639"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1138,857,1353,883"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="648,712,803,737"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1545,1217,1664,1243"/>
<area shape="rect" href="packhead_8cpp.html#a9bc7fbed8b0117cf25aae706dff178cb" title="ph decompress util" alt="" coords="905,901,1029,927"/>
<area shape="rect" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615" title=" " alt="" coords="653,498,798,538"/>
<area shape="rect" href="util_8cpp.html#a579960b01d469d1969571dcf757871bc" title="find and mem_replace util" alt="" coords="487,373,534,399"/>
<area shape="rect" href="classPackLinuxElf32.html#a9929af0daa1854fea2672c0c50bddb84" title=" " alt="" coords="656,207,795,247"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="672,1779,779,1804"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="909,1728,1025,1753"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1177,1753,1314,1779"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="1177,1677,1313,1703"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1175,1549,1315,1575"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="469,272,552,297"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="909,1548,1024,1573"/>
</map>
</div>

</div>
</div>
<a id="a9885ff5b4641396d7e4604d44e4cbe97" name="a9885ff5b4641396d7e4604d44e4cbe97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9885ff5b4641396d7e4604d44e4cbe97">&#9670;&#160;</a></span>unRel32()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::unRel32 </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dt_rel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *&#160;</td>
          <td class="paramname"><em>rel0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relsz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>membuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>load_off</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06154">6154</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6162</span>{</div>
<div class="line"><span class="lineno"> 6163</span>    <a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a> *rel = rel0;</div>
<div class="line"><span class="lineno"> 6164</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = relsz / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>); --k &gt;= 0; ++rel) {</div>
<div class="line"><span class="lineno"> 6165</span>        <span class="keywordtype">unsigned</span> r_offset = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rel-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 6166</span>        <span class="keywordtype">unsigned</span> r_info   = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;rel-&gt;r_info);</div>
<div class="line"><span class="lineno"> 6167</span>        <span class="keywordtype">unsigned</span> r_type = ELF32_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 6168</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 6169</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;rel-&gt;r_offset, r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6170</span>        }</div>
<div class="line"><span class="lineno"> 6171</span>        <span class="keywordflow">if</span> (Elf32_Ehdr::EM_ARM == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 6172</span>            <span class="keywordflow">if</span> (R_ARM_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6173</span>                <span class="keywordtype">unsigned</span> d = r_offset - load_off - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6174</span>                <span class="keywordtype">unsigned</span> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ptload1[d]);</div>
<div class="line"><span class="lineno"> 6175</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 6176</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;ptload1[d], w - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6177</span>                }</div>
<div class="line"><span class="lineno"> 6178</span>            }</div>
<div class="line"><span class="lineno"> 6179</span>            <span class="keywordflow">if</span> (R_ARM_JUMP_SLOT == r_type) {</div>
<div class="line"><span class="lineno"> 6180</span>                ++<a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 6181</span>                <span class="comment">// .rel.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 6182</span>                <span class="keywordtype">unsigned</span> d = r_offset - load_off - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6183</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; d) {</div>
<div class="line"><span class="lineno"> 6184</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = d;</div>
<div class="line"><span class="lineno"> 6185</span>                }</div>
<div class="line"><span class="lineno"> 6186</span>                <span class="keywordtype">unsigned</span> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ptload1[d]);</div>
<div class="line"><span class="lineno"> 6187</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 6188</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;ptload1[d], w - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6189</span>                }</div>
<div class="line"><span class="lineno"> 6190</span>            }</div>
<div class="line"><span class="lineno"> 6191</span>        }</div>
<div class="line"><span class="lineno"> 6192</span>        <span class="keywordflow">if</span> (Elf32_Ehdr::EM_386 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 6193</span>            <span class="keywordflow">if</span> (R_386_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6194</span>                <span class="keywordtype">unsigned</span> d = r_offset - load_off - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6195</span>                <span class="keywordtype">unsigned</span> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ptload1[d]);</div>
<div class="line"><span class="lineno"> 6196</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 6197</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;ptload1[d], w - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6198</span>                }</div>
<div class="line"><span class="lineno"> 6199</span>            }</div>
<div class="line"><span class="lineno"> 6200</span>            <span class="keywordflow">if</span> (R_386_JMP_SLOT == r_type) {</div>
<div class="line"><span class="lineno"> 6201</span>                ++<a class="code hl_variable" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 6202</span>                <span class="comment">// .rel.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 6203</span>                <span class="keywordtype">unsigned</span> d = r_offset - load_off - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6204</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; d) {</div>
<div class="line"><span class="lineno"> 6205</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = d;</div>
<div class="line"><span class="lineno"> 6206</span>                }</div>
<div class="line"><span class="lineno"> 6207</span>                <span class="keywordtype">unsigned</span> w = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ptload1[d]);</div>
<div class="line"><span class="lineno"> 6208</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 6209</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;ptload1[d], w - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6210</span>                }</div>
<div class="line"><span class="lineno"> 6211</span>            }</div>
<div class="line"><span class="lineno"> 6212</span>        }</div>
<div class="line"><span class="lineno"> 6213</span>    }</div>
<div class="line"><span class="lineno"> 6214</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(dt_rel, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6215</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rel0, relsz);</div>
<div class="line"><span class="lineno"> 6216</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf32.html#a877d014b8498a8bfe5d40ebdebd5dfa0">n_jmp_slot</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_cgraph" id="aclassPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_cgraph">
<area shape="rect" title=" " alt="" coords="5,232,187,257"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="241,157,371,183"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="235,207,377,232"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="427,308,555,333"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="242,308,370,333"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="425,131,556,156"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="604,5,739,31"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1607,460,1737,485"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1397,156,1534,181"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="810,105,899,131"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1005,256,1095,281"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="627,55,716,80"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1187,44,1314,69"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="790,32,919,57"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1372,75,1559,100"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1644,75,1700,100"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="987,41,1113,67"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1177,207,1324,232"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1438,207,1493,232"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1395,332,1535,357"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="971,91,1129,131"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1191,256,1310,281"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="787,308,923,333"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="613,384,729,409"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="826,409,883,435"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_icgraph" id="aclassPackLinuxElf32_a9885ff5b4641396d7e4604d44e4cbe97_icgraph">
<area shape="rect" title=" " alt="" coords="420,13,601,38"/>
<area shape="rect" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a654efeae935871a2aa2032b61610ce33" name="a654efeae935871a2aa2032b61610ce33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654efeae935871a2aa2032b61610ce33">&#9670;&#160;</a></span>updateLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf32::updateLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackUnix.html#a2cee24303a1b5e7676c8d98acada2be0">PackUnix</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf32armLe.html#acd542d296a8ba1501712e7c11c4ff910">PackLinuxElf32armLe</a>, <a class="el" href="classPackLinuxElf32armBe.html#af5054235efb5ecacb2d9fd9022ca3987">PackLinuxElf32armBe</a>, <a class="el" href="classPackLinuxElf32mipseb.html#aba36624955a246a45e01becd0b4700bb">PackLinuxElf32mipseb</a>, and <a class="el" href="classPackLinuxElf32mipsel.html#ac57c5824382ab097c99de4809c14f300">PackLinuxElf32mipsel</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01231">1231</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1232</span>{</div>
<div class="line"><span class="lineno"> 1233</span>    <span class="keywordtype">unsigned</span> start = linker-&gt;getSymbolOffset(<span class="stringliteral">&quot;_start&quot;</span>);</div>
<div class="line"><span class="lineno"> 1234</span>    <span class="keywordtype">unsigned</span> vbase = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 1235</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>.ehdr.e_entry, start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase);</div>
<div class="line"><span class="lineno"> 1236</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf32.html#ac8a5249ca04607b3dcf5a09ca156da8f">elfout</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, and <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161">PackLinuxElf32x86interp::pack3()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_cgraph.png" border="0" usemap="#aclassPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_cgraph" id="aclassPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,223,56"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="271,5,400,31"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="271,55,399,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_icgraph.png" border="0" usemap="#aclassPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_icgraph" id="aclassPackLinuxElf32_a654efeae935871a2aa2032b61610ce33_icgraph">
<area shape="rect" title=" " alt="" coords="236,13,453,38"/>
<area shape="rect" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161" title=" " alt="" coords="5,5,188,45"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa4994d4daac1ceef79bff5afb8c9dcf5" name="aa4994d4daac1ceef79bff5afb8c9dcf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4994d4daac1ceef79bff5afb8c9dcf5">&#9670;&#160;</a></span>dynseg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a2670bbbc279f3f9d9ac6e3b009cbbb26">Elf32_Dyn</a>* PackLinuxElf32::dynseg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00238">238</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf32.html#a7c2f68dcc6a3caecbcb5cf7ad6e7866a">elf_has_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>

</div>
</div>
<a id="aa25b2132cbfb2fb5a02219fbae96ad5e" name="aa25b2132cbfb2fb5a02219fbae96ad5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25b2132cbfb2fb5a02219fbae96ad5e">&#9670;&#160;</a></span>dynsym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a>* PackLinuxElf32::dynsym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00241">241</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a57c8f63c6f5b8671a39cd8acf2b48bc6">calls_crt1()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup()</a>, <a class="el" href="classPackLinuxElf32.html#ae84aeb851cffb6a47f23a5f2ae01c1cd">get_dynsym_name()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>.</p>

</div>
</div>
<a id="a2d8e571980c32f2e706cc6f60f38e736" name="a2d8e571980c32f2e706cc6f60f38e736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d8e571980c32f2e706cc6f60f38e736">&#9670;&#160;</a></span>e_phoff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::e_phoff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00231">231</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>

</div>
</div>
<a id="a46cb564e37f90259226b0fa81fe8b496" name="a46cb564e37f90259226b0fa81fe8b496"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46cb564e37f90259226b0fa81fe8b496">&#9670;&#160;</a></span>e_shoff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::e_shoff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00232">232</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1()</a>.</p>

</div>
</div>
<a id="a10cfe7410f5f1cdd4b1d4d8aa32c177e" name="a10cfe7410f5f1cdd4b1d4d8aa32c177e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10cfe7410f5f1cdd4b1d4d8aa32c177e">&#9670;&#160;</a></span>ehdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf32__Ehdr.html">Elf32_Ehdr</a> PackLinuxElf32::ehdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00223">223</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">ARM_is_QNX()</a>, <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a89a8cceb7f8ef9df9542156c01118aa4">canUnpack()</a>, <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, <a class="el" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828">PackLinuxElf32armLe::pack1()</a>, <a class="el" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849">PackLinuxElf32armBe::pack1()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845">PackLinuxElf32x86interp::pack1()</a>, <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161">PackLinuxElf32x86interp::pack3()</a>, <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>, <a class="el" href="classPackLinuxElf32.html#ad4a70681445083e44ae8ac59d81077ae">PackLinuxElf32()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1()</a>, and <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>

</div>
</div>
<a id="ac8a5249ca04607b3dcf5a09ca156da8f" name="ac8a5249ca04607b3dcf5a09ca156da8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8a5249ca04607b3dcf5a09ca156da8f">&#9670;&#160;</a></span>elfout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cprElfHdrNetBSD PackLinuxElf32::elfout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00279">279</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aa515825407739bf3ca522be194de8b27">ARM_updateLoader()</a>, <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>, <a class="el" href="classPackNetBSDElf32x86.html#a0c62b46de263a0090a154eb0c108c5f2">PackNetBSDElf32x86::generateElfHdr()</a>, <a class="el" href="classPackOpenBSDElf32x86.html#ab9f48389630e6c44c3580ca1a9c52289">PackOpenBSDElf32x86::generateElfHdr()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845">PackLinuxElf32x86interp::pack1()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161">PackLinuxElf32x86interp::pack3()</a>, <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>, and <a class="el" href="classPackLinuxElf32.html#a654efeae935871a2aa2032b61610ce33">updateLoader()</a>.</p>

</div>
</div>
<a id="a652cb27d6ab7bd6d04199fe7da4886cd" name="a652cb27d6ab7bd6d04199fe7da4886cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a652cb27d6ab7bd6d04199fe7da4886cd">&#9670;&#160;</a></span>END_PHDRX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned const PackLinuxElf32::END_PHDRX = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00227">227</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx()</a>.</p>

</div>
</div>
<a id="a81eaf2981770e46ea4d5895612a3bab7" name="a81eaf2981770e46ea4d5895612a3bab7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81eaf2981770e46ea4d5895612a3bab7">&#9670;&#160;</a></span>gashend</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const * PackLinuxElf32::gashend</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00240">240</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>.</p>

</div>
</div>
<a id="a6df504485b4e0c1cce47eca10de37b94" name="a6df504485b4e0c1cce47eca10de37b94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df504485b4e0c1cce47eca10de37b94">&#9670;&#160;</a></span>gashtab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const* PackLinuxElf32::gashtab</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00240">240</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup()</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>

</div>
</div>
<a id="ac22a29dfaad87f15dc1d1a09aed4fa7e" name="ac22a29dfaad87f15dc1d1a09aed4fa7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac22a29dfaad87f15dc1d1a09aed4fa7e">&#9670;&#160;</a></span>hashend</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const * PackLinuxElf32::hashend</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00239">239</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>.</p>

</div>
</div>
<a id="aaa5a2328d0273f004e496796df5d0ae8" name="aaa5a2328d0273f004e496796df5d0ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa5a2328d0273f004e496796df5d0ae8">&#9670;&#160;</a></span>hashtab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const* PackLinuxElf32::hashtab</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00239">239</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aa1d8db1d83d751bf6acfdde1045403ad">elf_lookup()</a>, <a class="el" href="classPackLinuxElf32.html#a18b74d82d2a2993873377ac87e6393d4">invert_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>

</div>
</div>
<a id="a034060e8e938b65cdd961851dea44420" name="a034060e8e938b65cdd961851dea44420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a034060e8e938b65cdd961851dea44420">&#9670;&#160;</a></span>jni_onload_sym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a113e9bb6ba2f2774bff6f3aadd35a6ba">Elf32_Sym</a> const* PackLinuxElf32::jni_onload_sym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00242">242</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>

</div>
</div>
<a id="a877d014b8498a8bfe5d40ebdebd5dfa0" name="a877d014b8498a8bfe5d40ebdebd5dfa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a877d014b8498a8bfe5d40ebdebd5dfa0">&#9670;&#160;</a></span>n_jmp_slot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::n_jmp_slot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00234">234</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32.html#ad4a70681445083e44ae8ac59d81077ae">PackLinuxElf32()</a>, and <a class="el" href="classPackLinuxElf32.html#a9885ff5b4641396d7e4604d44e4cbe97">unRel32()</a>.</p>

</div>
</div>
<a id="a21816e305175e291da2cbe8f85e5b6c0" name="a21816e305175e291da2cbe8f85e5b6c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21816e305175e291da2cbe8f85e5b6c0">&#9670;&#160;</a></span>n_phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::n_phdrx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00229">229</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx()</a>, <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>

</div>
</div>
<a id="ae1048a909a2fce5d2c861b88974f81d6" name="ae1048a909a2fce5d2c861b88974f81d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1048a909a2fce5d2c861b88974f81d6">&#9670;&#160;</a></span>page_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::page_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00236">236</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">ARM_is_QNX()</a>, <a class="el" href="classPackOpenBSDElf32x86.html#ab9f48389630e6c44c3580ca1a9c52289">PackOpenBSDElf32x86::generateElfHdr()</a>, <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, and <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>.</p>

</div>
</div>
<a id="a16f49d5da05459eab08054620b8afa81" name="a16f49d5da05459eab08054620b8afa81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f49d5da05459eab08054620b8afa81">&#9670;&#160;</a></span>phdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a>* PackLinuxElf32::phdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00224">224</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx()</a>, <a class="el" href="classPackLinuxElf32.html#a379f1a6161600dea7e368dabb0819f71">ARM_is_QNX()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">canPackOSABI()</a>, <a class="el" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf32.html#a117c75deef89749d3998463ab14ad780">check_pt_load()</a>, <a class="el" href="classPackLinuxElf32.html#aa3f2721b58e10a1d02b398f398fb7812">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf32.html#aed8111e8e63b6f87ff03edd42538ecaf">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, <a class="el" href="classPackLinuxElf32ppc.html#a9ffb643ede9f5d69fd23d375b0b93f70">PackLinuxElf32ppc::pack1()</a>, <a class="el" href="classPackLinuxElf32x86.html#ad3be0573c453deca4d9fe0c7d0c22a54">PackLinuxElf32x86::pack1()</a>, <a class="el" href="classPackBSDElf32x86.html#a2f31eed4b4e6b3394d2c148541af6d19">PackBSDElf32x86::pack1()</a>, <a class="el" href="classPackLinuxElf32armLe.html#ab7b8f3770ef00045a5c7af71f7b61828">PackLinuxElf32armLe::pack1()</a>, <a class="el" href="classPackLinuxElf32armBe.html#a2efb5521c4b87d93cb24e1d6785b1849">PackLinuxElf32armBe::pack1()</a>, <a class="el" href="classPackLinuxElf32mipseb.html#a29448c7736c4f1c8669f68c04b364667">PackLinuxElf32mipseb::pack1()</a>, <a class="el" href="classPackLinuxElf32mipsel.html#aad59d0358612602107619628e5b742ed">PackLinuxElf32mipsel::pack1()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#aedad7ae5d51a2985fcb81f4f10287845">PackLinuxElf32x86interp::pack1()</a>, <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32x86interp.html#a4ad35fc93fad001c1fdaaaf5e7382161">PackLinuxElf32x86interp::pack3()</a>, <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, <a class="el" href="classPackLinuxElf32.html#a34521f96ea9eb8d358528d794fa9345b">sort_DT32_offsets()</a>, <a class="el" href="classPackLinuxElf32.html#a52055eaaf3a28d1986937825c9382ae7">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1()</a>, and <a class="el" href="classPackLinuxElf32.html#a09edcb8bd331405f99b25b09d37f5040">unpack()</a>.</p>

</div>
</div>
<a id="af6320858ad11e1f2a16f29d6554fbbca" name="af6320858ad11e1f2a16f29d6554fbbca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6320858ad11e1f2a16f29d6554fbbca">&#9670;&#160;</a></span>phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf32__Phdr.html">Elf32_Phdr</a> const* PackLinuxElf32::phdrx[<a class="el" href="classPackLinuxElf32.html#a652cb27d6ab7bd6d04199fe7da4886cd">END_PHDRX</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00228">228</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a26bcf782bacd0c3b94c981ad6272c0b8">add_phdrx()</a>, and <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>.</p>

</div>
</div>
<a id="a8080878f78d400b2c84e1d4efdf4af04" name="a8080878f78d400b2c84e1d4efdf4af04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8080878f78d400b2c84e1d4efdf4af04">&#9670;&#160;</a></span>plt_off</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::plt_off</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00235">235</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

</div>
</div>
<a id="a6a46ce4ee2f2878d9122e12b8106e0ae" name="a6a46ce4ee2f2878d9122e12b8106e0ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a46ce4ee2f2878d9122e12b8106e0ae">&#9670;&#160;</a></span>sec_arm_attr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>* PackLinuxElf32::sec_arm_attr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00247">247</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, and <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>.</p>

</div>
</div>
<a id="a8006727271622c8955b9d2cd87282a28" name="a8006727271622c8955b9d2cd87282a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8006727271622c8955b9d2cd87282a28">&#9670;&#160;</a></span>sec_dynstr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> const* PackLinuxElf32::sec_dynstr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00246">246</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, and <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>.</p>

</div>
</div>
<a id="ac06c59607bfc28297c4739e3df424ca7" name="ac06c59607bfc28297c4739e3df424ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac06c59607bfc28297c4739e3df424ca7">&#9670;&#160;</a></span>sec_dynsym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a> const* PackLinuxElf32::sec_dynsym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00245">245</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a9cec931e83f51aaba944196c3476154c">un_asl_dynsym()</a>.</p>

</div>
</div>
<a id="a014f24da8144d063099bf9c9fc45f442" name="a014f24da8144d063099bf9c9fc45f442"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a014f24da8144d063099bf9c9fc45f442">&#9670;&#160;</a></span>sec_strndx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>* PackLinuxElf32::sec_strndx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00244">244</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, and <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>.</p>

</div>
</div>
<a id="a37a0e7b21ef6ab9036a71fe7101eb9fc" name="a37a0e7b21ef6ab9036a71fe7101eb9fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37a0e7b21ef6ab9036a71fe7101eb9fc">&#9670;&#160;</a></span>shdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>* PackLinuxElf32::shdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00225">225</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#ac4f9df5fb4c6ace9d197f29e1594a552">canPack()</a>, <a class="el" href="classPackLinuxElf32.html#a313f7710d0510a233bbda02e91d359a5">elf_find_section_name()</a>, <a class="el" href="classPackLinuxElf32.html#a86f5c0bb23dea2f02777b2bd551f3756">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf32.html#a4b9fc35299e310d90855abb422cd660a">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, <a class="el" href="classPackLinuxElf32.html#aaea43508f7513692cf3da5e91677c52c">pack3()</a>, <a class="el" href="classPackLinuxElf32.html#aa2acf155f6a76482cd3cbd17cef800e6">PackLinuxElf32help1()</a>, and <a class="el" href="classPackLinuxElf32.html#a6a054376b40ab2dc536ce43302d2c989">un_shlib_1()</a>.</p>

</div>
</div>
<a id="a4cf5438532351b0b6482b174e87ec9fb" name="a4cf5438532351b0b6482b174e87ec9fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cf5438532351b0b6482b174e87ec9fb">&#9670;&#160;</a></span>shdro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#ae858cb90aa9483b3ccee39f61446f130">Elf32_Shdr</a>* PackLinuxElf32::shdro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00226">226</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a12904e259a31849e8633faf26b5e07fe">asl_pack2_Shdrs()</a>, and <a class="el" href="classPackLinuxElf32.html#a001986a5884a191f0426037687d2f475">asl_slide_Shdrs()</a>.</p>

</div>
</div>
<a id="a8c03f5577e3a79a7900f4159318998b8" name="a8c03f5577e3a79a7900f4159318998b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c03f5577e3a79a7900f4159318998b8">&#9670;&#160;</a></span>shdrout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cprElfShdr3 PackLinuxElf32::shdrout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00285">285</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a5bafd32333cb29e162b3a21d3cd4c625">pack1()</a>, and <a class="el" href="classPackLinuxElf32.html#ad190f7b83d9aaccf78119ebb0f00eb41">pack4()</a>.</p>

</div>
</div>
<a id="af1b4b28858fe215fd7bcd305f3a58c1b" name="af1b4b28858fe215fd7bcd305f3a58c1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1b4b28858fe215fd7bcd305f3a58c1b">&#9670;&#160;</a></span>sz_dynseg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::sz_dynseg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00233">233</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#aba7026f4211ff852ffc5fc17ba0ec2b9">check_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf32.html#ab12506f897a258211fa947e556cb2615">elf_find_dynptr()</a>.</p>

</div>
</div>
<a id="a188a0aa12a6b1d42437cd1bb391424c1" name="a188a0aa12a6b1d42437cd1bb391424c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a188a0aa12a6b1d42437cd1bb391424c1">&#9670;&#160;</a></span>sz_phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf32::sz_phdrx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00230">230</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf32.html#a362f74f1bc69654c06e59aa1805f009a">canPackOSABI()</a>, <a class="el" href="classPackLinuxElf32.html#aa3a1446667e5e41721ae1ed8d40e3a82">generateElfHdr()</a>, and <a class="el" href="classPackLinuxElf32.html#a475c24cd3f9652ad82ea69cdf377aca5">pack2()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a></li>
<li>src/<a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classPackLinuxElf32.html">PackLinuxElf32</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
