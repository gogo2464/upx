<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: PackLinuxElf64 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classPackLinuxElf64.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="classPackLinuxElf64-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PackLinuxElf64 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PackLinuxElf64:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64__inherit__graph.png" border="0" usemap="#aPackLinuxElf64_inherit__map" alt="Inheritance graph"/></div>
<map name="aPackLinuxElf64_inherit__map" id="aPackLinuxElf64_inherit__map">
<area shape="rect" title=" " alt="" coords="187,299,307,324"/>
<area shape="rect" href="classPackLinuxElf64Be.html" title=" " alt="" coords="99,372,236,397"/>
<area shape="rect" href="classPackLinuxElf64Le.html" title=" " alt="" coords="265,372,400,397"/>
<area shape="rect" href="classPackLinuxElf.html" title=" " alt="" coords="195,225,299,251"/>
<area shape="rect" href="classPackUnix.html" title="Abstract class for all Unix&#45;type packers." alt="" coords="206,152,289,177"/>
<area shape="rect" href="classPacker.html" title="Packer: default implementation base class for all current packers." alt="" coords="215,79,279,104"/>
<area shape="rect" href="classPackerBase.html" title="PackerBase: abstract minimal base class for all packers." alt="" coords="199,5,295,31"/>
<area shape="rect" href="classPackLinuxElf64ppc.html" title=" " alt="" coords="5,445,148,471"/>
<area shape="rect" href="classPackLinuxElf64amd.html" title="linux/elf64amd" alt="" coords="173,445,322,471"/>
<area shape="rect" href="classPackLinuxElf64arm.html" title=" " alt="" coords="346,445,493,471"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html" title="linux/elf64ppcle" alt="" coords="517,445,671,471"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for PackLinuxElf64:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64__coll__graph.png" border="0" usemap="#aPackLinuxElf64_coll__map" alt="Collaboration graph"/></div>
<map name="aPackLinuxElf64_coll__map" id="aPackLinuxElf64_coll__map">
<area shape="rect" title=" " alt="" coords="1636,346,1756,371"/>
<area shape="rect" href="classPackLinuxElf.html" title=" " alt="" coords="1447,321,1551,346"/>
<area shape="rect" href="classPackUnix.html" title="Abstract class for all Unix&#45;type packers." alt="" coords="1315,201,1397,226"/>
<area shape="rect" href="classPacker.html" title="Packer: default implementation base class for all current packers." alt="" coords="1103,159,1167,185"/>
<area shape="rect" href="classPackerBase.html" title="PackerBase: abstract minimal base class for all packers." alt="" coords="923,133,1019,158"/>
<area shape="rect" href="classInputFile.html" title=" " alt="" coords="705,95,784,121"/>
<area shape="rect" href="classFileBase.html" title=" " alt="" coords="367,95,445,121"/>
<area shape="rect" href="structPackHeader.html" title="PackHeader also see stub/src/include/header.S." alt="" coords="695,145,794,170"/>
<area shape="rect" href="structupx__compress__result__t.html" title=" " alt="" coords="320,145,492,170"/>
<area shape="rect" href="structupx__compress__result__t_1_1Debug.html" title=" " alt="" coords="17,5,177,45"/>
<area shape="rect" href="structbzip2__compress__result__t.html" title="compression &#45; result_t" alt="" coords="5,70,188,95"/>
<area shape="rect" href="structlzma__compress__result__t.html" title=" " alt="" coords="7,119,187,145"/>
<area shape="rect" href="structucl__compress__result__t.html" title=" " alt="" coords="13,169,180,194"/>
<area shape="rect" href="structzlib__compress__result__t.html" title=" " alt="" coords="11,218,182,243"/>
<area shape="rect" href="structzstd__compress__result__t.html" title=" " alt="" coords="9,267,184,293"/>
<area shape="rect" href="classMemBuffer.html" title="MemBuffer." alt="" coords="923,226,1018,251"/>
<area shape="rect" href="classMemBufferBase.html" title=" " alt="" coords="652,215,837,241"/>
<area shape="rect" href="structMemBuffer_1_1Stats.html" title=" " alt="" coords="677,265,812,290"/>
<area shape="rect" href="structl__info.html" title=" " alt="" coords="1105,110,1164,135"/>
<area shape="rect" href="structElf64__Phdr.html" title=" " alt="" coords="1453,370,1544,395"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afc05d6aa59c55c25d1faf101a5c557b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afc05d6aa59c55c25d1faf101a5c557b7">PackLinuxElf64</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:afc05d6aa59c55c25d1faf101a5c557b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af736dee54f1eb95750dfb45531efb66c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af736dee54f1eb95750dfb45531efb66c">~PackLinuxElf64</a> ()</td></tr>
<tr class="separator:af736dee54f1eb95750dfb45531efb66c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:ac95c781c95ed54d3f82d6957d13563ef inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac95c781c95ed54d3f82d6957d13563ef">PackLinuxElf</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:ac95c781c95ed54d3f82d6957d13563ef inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbfa44abec2d5cbfb7fad953ebd852a inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5cbfa44abec2d5cbfb7fad953ebd852a">~PackLinuxElf</a> ()</td></tr>
<tr class="separator:a5cbfa44abec2d5cbfb7fad953ebd852a inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7b16256150aeee5316b817b469b93f inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a2b7b16256150aeee5316b817b469b93f">getVersion</a> () const override</td></tr>
<tr class="separator:a2b7b16256150aeee5316b817b469b93f inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3924832e55889e051ae9ad0ab43c5c9 inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac3924832e55889e051ae9ad0ab43c5c9">canUnpackVersion</a> (int version) const override</td></tr>
<tr class="separator:ac3924832e55889e051ae9ad0ab43c5c9 inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">canUnpack</a> () override</td></tr>
<tr class="memdesc:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a2918e27dbfa2989e2bebbc9d55278502 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2918e27dbfa2989e2bebbc9d55278502">~PackUnix</a> ()</td></tr>
<tr class="separator:a2918e27dbfa2989e2bebbc9d55278502 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a4ffa6385cc3e65f0e0edf03f1a689 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a56a4ffa6385cc3e65f0e0edf03f1a689">getVersion</a> () const override</td></tr>
<tr class="separator:a56a4ffa6385cc3e65f0e0edf03f1a689 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bbbfbba5b4b2b33de9d7801bd58b2cb inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">getFilters</a> () const override</td></tr>
<tr class="separator:a6bbbfbba5b4b2b33de9d7801bd58b2cb inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362bc5d4016b05a3e36f20f364950602 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602">getStrategy</a> (<a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a362bc5d4016b05a3e36f20f364950602 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421acb038daef916fef027bd5e2a7427 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a421acb038daef916fef027bd5e2a7427">pack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="separator:a421acb038daef916fef027bd5e2a7427 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a62fec1407c3b1d45bd049df4b9f5e6f7">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#a62fec1407c3b1d45bd049df4b9f5e6f7" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935b7961d8278ae7b19c53d6ef3fe3cf inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">canPack</a> () override</td></tr>
<tr class="separator:a935b7961d8278ae7b19c53d6ef3fe3cf inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120">canUnpack</a> () override</td></tr>
<tr class="memdesc:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1d471152b26686e619f2e8b6744366 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4f1d471152b26686e619f2e8b6744366">find_overlay_offset</a> (<a class="el" href="classMemBuffer.html">MemBuffer</a> const &amp;<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>)</td></tr>
<tr class="separator:a4f1d471152b26686e619f2e8b6744366 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a53a278648f1e7dd8409c81134ca110bc inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a53a278648f1e7dd8409c81134ca110bc">~Packer</a> () noexcept</td></tr>
<tr class="separator:a53a278648f1e7dd8409c81134ca110bc inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e855c1df3707b0e054eac328a520c5 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a65e855c1df3707b0e054eac328a520c5">assertPacker</a> () const override</td></tr>
<tr class="separator:a65e855c1df3707b0e054eac328a520c5 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a06289b68601b59ba96d2d0bacec15aa6">initPackHeader</a> () final override</td></tr>
<tr class="memdesc:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">packheader util  <br /></td></tr>
<tr class="separator:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb7d756fd4914ecba61720460873904 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afcb7d756fd4914ecba61720460873904">updatePackHeader</a> () final override</td></tr>
<tr class="separator:afcb7d756fd4914ecba61720460873904 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0f04afb915721f1dc846115241895eb6">doPack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) final override</td></tr>
<tr class="memdesc:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">public entries called from class <a class="el" href="classPackMaster.html" title="dispatch to a concrete subclass of class PackerBase; see work.cpp">PackMaster</a>  <br /></td></tr>
<tr class="separator:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bfdeba49a1c92bcc0d7a5bb3e10345 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad4bfdeba49a1c92bcc0d7a5bb3e10345">doUnpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) final override</td></tr>
<tr class="separator:ad4bfdeba49a1c92bcc0d7a5bb3e10345 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cfe7201a1e90ac2df2e21778b09bf9c inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4cfe7201a1e90ac2df2e21778b09bf9c">doTest</a> () final override</td></tr>
<tr class="separator:a4cfe7201a1e90ac2df2e21778b09bf9c inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303bc70d7e7247ee535e9750a26c714a inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a303bc70d7e7247ee535e9750a26c714a">doList</a> () final override</td></tr>
<tr class="separator:a303bc70d7e7247ee535e9750a26c714a inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ac0c24f13d1ba6fa3e450539ea2933 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a01ac0c24f13d1ba6fa3e450539ea2933">doFileInfo</a> () final override</td></tr>
<tr class="separator:a01ac0c24f13d1ba6fa3e450539ea2933 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d96e4d4cbfe8e5f01711f47098ccc9 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a73d96e4d4cbfe8e5f01711f47098ccc9">canUnpackVersion</a> (int version) const</td></tr>
<tr class="separator:a73d96e4d4cbfe8e5f01711f47098ccc9 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c73202b82e8ce8970cca8881d9a82e inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a31c73202b82e8ce8970cca8881d9a82e">canUnpackFormat</a> (int format) const</td></tr>
<tr class="separator:a31c73202b82e8ce8970cca8881d9a82e inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:aad37a4b709f2215c2dd790268e3e596f inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aad37a4b709f2215c2dd790268e3e596f">~PackerBase</a> () noexcept</td></tr>
<tr class="separator:aad37a4b709f2215c2dd790268e3e596f inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9d6b0ba4f236e640f8610b6688a6db inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#abe9d6b0ba4f236e640f8610b6688a6db">getVersion</a> () const =0</td></tr>
<tr class="separator:abe9d6b0ba4f236e640f8610b6688a6db inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6132cc9ef747b35947837d463aeac60 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60">getFormat</a> () const =0</td></tr>
<tr class="separator:aa6132cc9ef747b35947837d463aeac60 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf646b36342d8706c83e7c26fe47108e inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#adf646b36342d8706c83e7c26fe47108e">getName</a> () const =0</td></tr>
<tr class="separator:adf646b36342d8706c83e7c26fe47108e inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3699d96b9dc2a2531fa15d2cd348c110 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a3699d96b9dc2a2531fa15d2cd348c110">getFullName</a> (const <a class="el" href="structOptions.html">Options</a> *) const =0</td></tr>
<tr class="separator:a3699d96b9dc2a2531fa15d2cd348c110 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237baf1e217ee3aae78235baba4ad05c inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a237baf1e217ee3aae78235baba4ad05c">getCompressionMethods</a> (int method, int level) const =0</td></tr>
<tr class="separator:a237baf1e217ee3aae78235baba4ad05c inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0204dbe7106f6ac24aa712ad1ab3a5b8 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0204dbe7106f6ac24aa712ad1ab3a5b8">getFilters</a> () const =0</td></tr>
<tr class="separator:a0204dbe7106f6ac24aa712ad1ab3a5b8 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fc9b13105ad33ec6cca04b4abb507b inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a53fc9b13105ad33ec6cca04b4abb507b">canPack</a> ()=0</td></tr>
<tr class="separator:a53fc9b13105ad33ec6cca04b4abb507b inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa758490b3cc414478d262f753257d634 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa758490b3cc414478d262f753257d634">canUnpack</a> ()=0</td></tr>
<tr class="separator:aa758490b3cc414478d262f753257d634 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a83499a5451f8ab84d24fcc77f9b19 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa0a83499a5451f8ab84d24fcc77f9b19">assertPacker</a> () const =0</td></tr>
<tr class="separator:aa0a83499a5451f8ab84d24fcc77f9b19 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b4191ca6e4ca14fd425215afe129c1 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a41b4191ca6e4ca14fd425215afe129c1">initPackHeader</a> ()=0</td></tr>
<tr class="separator:a41b4191ca6e4ca14fd425215afe129c1 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1168410761f4965c7069d69628ebf203 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a1168410761f4965c7069d69628ebf203">updatePackHeader</a> ()=0</td></tr>
<tr class="separator:a1168410761f4965c7069d69628ebf203 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade8c0ee5d2501df14980c744b2fa47f4 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#ade8c0ee5d2501df14980c744b2fa47f4">doPack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:ade8c0ee5d2501df14980c744b2fa47f4 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c4c814d3afebb81309699ea0d8d8c6 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a28c4c814d3afebb81309699ea0d8d8c6">doUnpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:a28c4c814d3afebb81309699ea0d8d8c6 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e5d42ed9b00879eb0811d9492cb6a9 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a90e5d42ed9b00879eb0811d9492cb6a9">doTest</a> ()=0</td></tr>
<tr class="separator:a90e5d42ed9b00879eb0811d9492cb6a9 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb2533c208ee20b3951b1c4a8641084 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a4bb2533c208ee20b3951b1c4a8641084">doList</a> ()=0</td></tr>
<tr class="separator:a4bb2533c208ee20b3951b1c4a8641084 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d9d32792e01d4ecb6d1068939be150 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a30d9d32792e01d4ecb6d1068939be150">doFileInfo</a> ()=0</td></tr>
<tr class="separator:a30d9d32792e01d4ecb6d1068939be150 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8c2bb372c567334edd586f78224bc956"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a8c2bb372c567334edd586f78224bc956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26dade234148980bd9f8a06ee31bf3c"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr</a> (<a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> const *ehdr) const</td></tr>
<tr class="separator:ab26dade234148980bd9f8a06ee31bf3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f8b3a6d6203c2a09d5058a18423fee2"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack</a> () override</td></tr>
<tr class="separator:a3f8b3a6d6203c2a09d5058a18423fee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71bc2f0e1a1ec856b3f9a08b63add0ae"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack</a> () override</td></tr>
<tr class="memdesc:a71bc2f0e1a1ec856b3f9a08b63add0ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:a71bc2f0e1a1ec856b3f9a08b63add0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31c4b9fe8bb49ee9fa220b0c1d149bd"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">canPack_Shdr</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *pload_x0)</td></tr>
<tr class="separator:aa31c4b9fe8bb49ee9fa220b0c1d149bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39227a27d84b3a9beeef257f95b00215"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:a39227a27d84b3a9beeef257f95b00215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eefcbb2a42d861b12d2c309d93771b8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, unsigned pre_xct_top)</td></tr>
<tr class="separator:a6eefcbb2a42d861b12d2c309d93771b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c3d3d66cd14ea19fc44d0f90274092"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:ae4c3d3d66cd14ea19fc44d0f90274092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72eb546964b4b777ec38c3da1972eeb8"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, <a class="el" href="classFilter.html">Filter</a> &amp;ft, unsigned pre_xct_top)</td></tr>
<tr class="separator:a72eb546964b4b777ec38c3da1972eeb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34abb7fc5a62a52800339d603f78f562"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:a34abb7fc5a62a52800339d603f78f562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc239684c1874f0a29ee97eca4e8d4d6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:afc239684c1874f0a29ee97eca4e8d4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc61917c51c71bfcb0f9af20ba7714d6"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, <a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *ehdro)</td></tr>
<tr class="separator:acc61917c51c71bfcb0f9af20ba7714d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b789474661dc2f8e40182aae29ee479"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a4b789474661dc2f8e40182aae29ee479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a4b789474661dc2f8e40182aae29ee479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19e5a4000bc5cc063dee2a31db657e9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym</a> (unsigned orig_file_size, <a class="el" href="classOutputFile.html">OutputFile</a> *)</td></tr>
<tr class="separator:ab19e5a4000bc5cc063dee2a31db657e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c315a3286632db9c874ca7a65bb69d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *const fo, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;o_elfhdrs, unsigned &amp;c_adler, unsigned &amp;u_adler, unsigned const orig_file_size)</td></tr>
<tr class="separator:ad2c315a3286632db9c874ca7a65bb69d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c843122a8d3e44da9fe458643c2589"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT</a> (unsigned old_dtinit, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdro, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *dynhdr, <a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:a03c843122a8d3e44da9fe458643c2589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b7d0324926f0404e61dc997833544f7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64</a> (<a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_rela, <a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rela0, unsigned relasz, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> const old_dtinit, <a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:a3b7d0324926f0404e61dc997833544f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18903ac12b1370cdf82daef90aa27717"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, void const *proto, unsigned const brka) override</td></tr>
<tr class="separator:a18903ac12b1370cdf82daef90aa27717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab000c2eb42eb50ba4dd570fb0e20e4f2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *) override</td></tr>
<tr class="separator:ab000c2eb42eb50ba4dd570fb0e20e4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf98749f15000ddd7c39f330ec145341"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341">buildLinuxLoader</a> (<a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const proto, unsigned const szproto, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const fold, unsigned const szfold, <a class="el" href="classFilter.html">Filter</a> const *ft)</td></tr>
<tr class="separator:acf98749f15000ddd7c39f330ec145341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac405aa11c3c356e93dc38f2365701466"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk</a> (const <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr, int <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) const</td></tr>
<tr class="separator:ac405aa11c3c356e93dc38f2365701466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e7655b7e6bff51e5d2d9f8e203a4e3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ae5e7655b7e6bff51e5d2d9f8e203a4e3">patchLoader</a> () override</td></tr>
<tr class="separator:ae5e7655b7e6bff51e5d2d9f8e203a4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf1b9c1ce448039ac4eaec55de40c3e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afdf1b9c1ce448039ac4eaec55de40c3e">updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="separator:afdf1b9c1ce448039ac4eaec55de40c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c77e1df704fbb16e2d048937bdb0663"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *const <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, unsigned const k, unsigned const <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>)</td></tr>
<tr class="separator:a6c77e1df704fbb16e2d048937bdb0663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b086d6062198ab02e25fcc4cd5a2c3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1</a> (<a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> const *rela, int sz)</td></tr>
<tr class="separator:af4b086d6062198ab02e25fcc4cd5a2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d0e91095e3b2cdfbc913e7bc25abf8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup</a> (char const *) const</td></tr>
<tr class="separator:a02d0e91095e3b2cdfbc913e7bc25abf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047a7534432a2a090049ba2eee67bfb9"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a> (<a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>) const</td></tr>
<tr class="separator:a047a7534432a2a090049ba2eee67bfb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7458e15967252113c7b45332b973287"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a> (<a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> addr, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdr, unsigned phnum)</td></tr>
<tr class="separator:ac7458e15967252113c7b45332b973287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af746b688a3b13d3bf0895095ae5c3212"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">elf_find_ptype</a> (unsigned type, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdr0, unsigned phnum)</td></tr>
<tr class="separator:af746b688a3b13d3bf0895095ae5c3212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a154b135064ce4e1a6e58ba23d9e50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name</a> (char const *) const</td></tr>
<tr class="separator:a19a154b135064ce4e1a6e58ba23d9e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af80d289e1d9fe56882aa494f2afc0e9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a> (unsigned) const</td></tr>
<tr class="separator:af80d289e1d9fe56882aa494f2afc0e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a39ae989d67ccb9239bcff7750a6e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a> (unsigned) const</td></tr>
<tr class="separator:ab6a39ae989d67ccb9239bcff7750a6e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c99e9dc4cb9e94309dfb49b13ff09d"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a> (unsigned dt_type, unsigned sh_type)</td></tr>
<tr class="separator:ab5c99e9dc4cb9e94309dfb49b13ff09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc068ab20eb6f313fc0abbda76c62a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets</a> (<a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *const dynp0)</td></tr>
<tr class="separator:acbc068ab20eb6f313fc0abbda76c62a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e4e0a8150ba291145c388c9c00705ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdr) const</td></tr>
<tr class="separator:a5e4e0a8150ba291145c388c9c00705ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae528cb01cbf686b624e2fffe159ad5b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *)</td></tr>
<tr class="separator:ae528cb01cbf686b624e2fffe159ad5b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d86b1c186506105d0a1143fd364c014"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *)</td></tr>
<tr class="separator:a5d86b1c186506105d0a1143fd364c014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34544f047b9808c7416a3a3666a7d6bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a> (<a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_filesz)</td></tr>
<tr class="separator:a34544f047b9808c7416a3a3666a7d6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1befccbbdde5d8977b9d2e5883507d4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a> (unsigned) const</td></tr>
<tr class="separator:ad1befccbbdde5d8977b9d2e5883507d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb0d975feeb7b1b02f9e4a22ab227ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic</a> (unsigned) const</td></tr>
<tr class="separator:a5fb0d975feeb7b1b02f9e4a22ab227ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4204f3ad0b4eff8655e10f62ac640a22"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a> (unsigned) const override</td></tr>
<tr class="separator:a4204f3ad0b4eff8655e10f62ac640a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4cfbd2d81ab91d393764f41c48ad44"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">find_dt_ndx</a> (<a class="el" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> rva)</td></tr>
<tr class="separator:a4b4cfbd2d81ab91d393764f41c48ad44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b85151ad06f0b457773686f047903f4"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS</a> (<a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *sym, unsigned long delta)</td></tr>
<tr class="separator:a6b85151ad06f0b457773686f047903f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd6eb82fa691109eb7fa267d6c8570f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *)</td></tr>
<tr class="separator:abd6eb82fa691109eb7fa267d6c8570f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd825cbaf5a768993a7f0b90a24c7a4c"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a> (unsigned st_name, unsigned symnum) const</td></tr>
<tr class="separator:acd825cbaf5a768993a7f0b90a24c7a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0587b38413f853b20625a28bf2a369e8"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name</a> (unsigned symnum, unsigned relnum) const</td></tr>
<tr class="separator:a0587b38413f853b20625a28bf2a369e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426e7f90fc3af416c18a3deb0571e4b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a426e7f90fc3af416c18a3deb0571e4b1">packed_struct</a> (cprElfHdr1)</td></tr>
<tr class="separator:a426e7f90fc3af416c18a3deb0571e4b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e05ec4a8acf7cac11023b7a57aad85"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a95e05ec4a8acf7cac11023b7a57aad85">packed_struct</a> (cprElfHdr2)</td></tr>
<tr class="separator:a95e05ec4a8acf7cac11023b7a57aad85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c753db61a98f514bc1b083069692374"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5c753db61a98f514bc1b083069692374">packed_struct</a> (cprElfHdr3)</td></tr>
<tr class="separator:a5c753db61a98f514bc1b083069692374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36103546d5ed97790537a6f7c6f0e02b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a36103546d5ed97790537a6f7c6f0e02b">packed_struct</a> (cprElfHdr4)</td></tr>
<tr class="separator:a36103546d5ed97790537a6f7c6f0e02b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3f937f49c167ed74510c02a5afe10a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aec3f937f49c167ed74510c02a5afe10a">packed_struct</a> (cprElfShdr3)</td></tr>
<tr class="separator:aec3f937f49c167ed74510c02a5afe10a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a622b799334a48cb6634e790f2566248a inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">getCompressionMethods</a> (int method, int level) const override</td></tr>
<tr class="separator:a622b799334a48cb6634e790f2566248a inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01b0f8403997790f28a72329e7b28f6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af01b0f8403997790f28a72329e7b28f6">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:af01b0f8403997790f28a72329e7b28f6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619d0ed2f97d37150ed5b1437c67b6f1 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a619d0ed2f97d37150ed5b1437c67b6f1">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:a619d0ed2f97d37150ed5b1437c67b6f1 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3409fd940ae9b30dc51e68f69e0160f6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:a3409fd940ae9b30dc51e68f69e0160f6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafaf58332d98b1981f8d78c3eeb729c6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aafaf58332d98b1981f8d78c3eeb729c6">pack2_shlib_overlay_init</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:aafaf58332d98b1981f8d78c3eeb729c6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5384daf1baa189915edd8bbb8821ee88 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88">pack2_shlib_overlay_compress</a> (<a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;<a class="el" href="classPacker.html#a8f51aecfca1c5d86cc11a7d2ab574d5e">obuf</a>, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;<a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, unsigned u_len)</td></tr>
<tr class="separator:a5384daf1baa189915edd8bbb8821ee88 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80a270e823ea95b0900a5abbf786dac9 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9">pack2_shlib_overlay_write</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;<a class="el" href="classPacker.html#a8f51aecfca1c5d86cc11a7d2ab574d5e">obuf</a>, unsigned hdr_u_len, unsigned hdr_c_len)</td></tr>
<tr class="separator:a80a270e823ea95b0900a5abbf786dac9 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378dd6608963beeae5bb6393ef4b23d5 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a378dd6608963beeae5bb6393ef4b23d5">generateElfHdr</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, void const *proto, unsigned const brka)=0</td></tr>
<tr class="separator:a378dd6608963beeae5bb6393ef4b23d5 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addaacfe47a36eb9d70929a58ba311e29 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *)</td></tr>
<tr class="separator:addaacfe47a36eb9d70929a58ba311e29 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0c06e7772712b8f5cb8a7101a2e052 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">addStubEntrySections</a> (<a class="el" href="classFilter.html">Filter</a> const *, unsigned m_decompr)</td></tr>
<tr class="separator:afe0c06e7772712b8f5cb8a7101a2e052 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7cb95fd27c29245be62f4e388fc3f09 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac7cb95fd27c29245be62f4e388fc3f09">elf_unsigned_dynamic</a> (unsigned) const =0</td></tr>
<tr class="separator:ac7cb95fd27c29245be62f4e388fc3f09 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a326420727ef64feb46ddcd2f12b96a96 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a326420727ef64feb46ddcd2f12b96a96">PackUnix</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a326420727ef64feb46ddcd2f12b96a96 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67466cfa57e26dc50991e0bf9a610a05 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a67466cfa57e26dc50991e0bf9a610a05">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a67466cfa57e26dc50991e0bf9a610a05 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a90e16aac8e8c0e11180da8082bfd0f inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2a90e16aac8e8c0e11180da8082bfd0f">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a2a90e16aac8e8c0e11180da8082bfd0f inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573f3c8c4c540f51c2a7b168535d4741 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a573f3c8c4c540f51c2a7b168535d4741">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a573f3c8c4c540f51c2a7b168535d4741 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d92de9aedc1747be87ef5968952838c inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">pack4</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a7d92de9aedc1747be87ef5968952838c inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b328c80b7172751702a447aed1afb2 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ac4b328c80b7172751702a447aed1afb2">patchLoader</a> ()=0</td></tr>
<tr class="separator:ac4b328c80b7172751702a447aed1afb2 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20942814df6e718e04462ac03aebe08 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#af20942814df6e718e04462ac03aebe08">patchLoaderChecksum</a> ()</td></tr>
<tr class="separator:af20942814df6e718e04462ac03aebe08 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cee24303a1b5e7676c8d98acada2be0 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2cee24303a1b5e7676c8d98acada2be0">updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *)=0</td></tr>
<tr class="separator:a2cee24303a1b5e7676c8d98acada2be0 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced1a9bb3fee3c231bfc90051224a6dd inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aced1a9bb3fee3c231bfc90051224a6dd">writePackHeader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:aced1a9bb3fee3c231bfc90051224a6dd inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aeddca239c9109efe577257d5ac798ba7">checkCompressionRatio</a> (unsigned, unsigned) const override</td></tr>
<tr class="memdesc:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#a421acb038daef916fef027bd5e2a7427">pack()</a>.  <br /></td></tr>
<tr class="separator:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f398fa4a3b34fd79f441e3069f78b1 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a> (const <a class="el" href="structPackUnix_1_1Extent.html">Extent</a> &amp;x, <a class="el" href="classFilter.html">Filter</a> *, <a class="el" href="classOutputFile.html">OutputFile</a> *, unsigned hdr_len=0, unsigned b_extra=0, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:ad3f398fa4a3b34fd79f441e3069f78b1 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16d64e1b95f1dcf5f128665b83660f6 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a> (unsigned wanted, <a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned &amp;c_adler, unsigned &amp;u_adler, bool first_PF_X, int is_rewrite=false)</td></tr>
<tr class="separator:ab16d64e1b95f1dcf5f128665b83660f6 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd8340ae0c422e428d1a0874791c47b inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4bd8340ae0c422e428d1a0874791c47b">packed_struct</a> (<a class="el" href="structb__info.html">b_info</a>)</td></tr>
<tr class="separator:a4bd8340ae0c422e428d1a0874791c47b inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40aab492369d544f29a717b571d7f004 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a40aab492369d544f29a717b571d7f004">packed_struct</a> (<a class="el" href="structl__info.html">l_info</a>)</td></tr>
<tr class="separator:a40aab492369d544f29a717b571d7f004 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22613c8b5d9a79ac5cdeae1d6664537d inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a22613c8b5d9a79ac5cdeae1d6664537d">packed_struct</a> (<a class="el" href="structp__info.html">p_info</a>)</td></tr>
<tr class="separator:a22613c8b5d9a79ac5cdeae1d6664537d inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a133376f040e1a9677374b6b799a0b630 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a133376f040e1a9677374b6b799a0b630">Packer</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a133376f040e1a9677374b6b799a0b630 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd46726f44d4d6ecbb38ca0b682abff inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0dd46726f44d4d6ecbb38ca0b682abff">testUnpackVersion</a> (int version) const <a class="el" href="conf_8h.html#aac314c25ecc359ec37c364e623d312c1">may_throw</a></td></tr>
<tr class="separator:a0dd46726f44d4d6ecbb38ca0b682abff inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb5aa92c52d38f3c7f4cc75d111debd inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abcb5aa92c52d38f3c7f4cc75d111debd">testUnpackFormat</a> (int format) const <a class="el" href="conf_8h.html#aac314c25ecc359ec37c364e623d312c1">may_throw</a></td></tr>
<tr class="separator:abcb5aa92c52d38f3c7f4cc75d111debd inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4856b75dcd93c17a197b3cc0f6f631b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa4856b75dcd93c17a197b3cc0f6f631b">pack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:aa4856b75dcd93c17a197b3cc0f6f631b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29c743954e67295ef1793155a96c7d3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa29c743954e67295ef1793155a96c7d3">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:aa29c743954e67295ef1793155a96c7d3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4224ba769e4e9f5839f4e8a320a60e09">test</a> ()</td></tr>
<tr class="memdesc:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">default actions  <br /></td></tr>
<tr class="separator:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2a1baf71486055fcf2010eff9ddad3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aec2a1baf71486055fcf2010eff9ddad3">list</a> ()</td></tr>
<tr class="separator:aec2a1baf71486055fcf2010eff9ddad3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758c9c8f833608e7744538587c72653d inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a758c9c8f833608e7744538587c72653d">fileInfo</a> ()</td></tr>
<tr class="separator:a758c9c8f833608e7744538587c72653d inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e">compress</a> (<a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) i_ptr, unsigned i_len, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) o_ptr, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf=nullptr)</td></tr>
<tr class="memdesc:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">compress - wrap call to low-level <a class="el" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress()</a>  <br /></td></tr>
<tr class="separator:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">decompress</a> (<a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) in, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) out, bool verify_checksum=true, <a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="memdesc:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">decompress  <br /></td></tr>
<tr class="separator:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9864c9f06e96c60330ae5df35f285d9 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab9864c9f06e96c60330ae5df35f285d9">checkDefaultCompressionRatio</a> (unsigned u_len, unsigned c_len) const</td></tr>
<tr class="separator:ab9864c9f06e96c60330ae5df35f285d9 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2456e468bbb9b026d301c3e668f28d05 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a2456e468bbb9b026d301c3e668f28d05">checkCompressionRatio</a> (unsigned u_len, unsigned c_len) const</td></tr>
<tr class="separator:a2456e468bbb9b026d301c3e668f28d05 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1b90e1cf536d0dd0bcd90799d6195f inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#acc1b90e1cf536d0dd0bcd90799d6195f">checkFinalCompressionRatio</a> (const <a class="el" href="classOutputFile.html">OutputFile</a> *fo) const</td></tr>
<tr class="separator:acc1b90e1cf536d0dd0bcd90799d6195f inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ae5b698e68d64585e5be87a256f675 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a> (<a class="el" href="classFilter.html">Filter</a> *ft, const unsigned overlap_range, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf, int filter_strategy=0, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:ad0ae5b698e68d64585e5be87a256f675 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeabf0f70b5c414b04a5d7a895c50351b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aeabf0f70b5c414b04a5d7a895c50351b">compressWithFilters</a> (<a class="el" href="classFilter.html">Filter</a> *ft, const unsigned overlap_range, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf, int filter_strategy, unsigned filter_buf_off, unsigned compress_ibuf_off, unsigned compress_obuf_off, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *const hdr_ptr, unsigned hdr_len, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:aeabf0f70b5c414b04a5d7a895c50351b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c29dbab3c13461ccccdf08ba3b6cde2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a6c29dbab3c13461ccccdf08ba3b6cde2">compressWithFilters</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *i_ptr, unsigned i_len, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *o_ptr, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *f_ptr, unsigned f_len, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *const hdr_ptr, unsigned hdr_len, <a class="el" href="classFilter.html">Filter</a> *parm_ft, unsigned overlap_range, <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> const *cconf, int filter_strategy, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:a6c29dbab3c13461ccccdf08ba3b6cde2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78">testOverlappingDecompression</a> (const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *tbuf, unsigned overlap_overhead) const</td></tr>
<tr class="memdesc:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">overlapping decompression  <br /></td></tr>
<tr class="separator:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af11da16aeb96ac7ccd05f31472793ca7">findOverlapOverhead</a> (const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *tbuf, unsigned range=0, unsigned upper_limit=~0u) const</td></tr>
<tr class="memdesc:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find overhead for in-place decompression in a heuristic way (using a binary search).  <br /></td></tr>
<tr class="separator:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98836d189865b8496d759334c6257608 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a98836d189865b8496d759334c6257608">verifyOverlappingDecompression</a> (<a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="separator:a98836d189865b8496d759334c6257608 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b1f4ce72c7ddc53b424653ffde5ff8 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a34b1f4ce72c7ddc53b424653ffde5ff8">verifyOverlappingDecompression</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *o_ptr, unsigned o_size, <a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="separator:a34b1f4ce72c7ddc53b424653ffde5ff8 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f9499f529513c9d26fc647968dfe7e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad1f9499f529513c9d26fc647968dfe7e">patchPackHeader</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen) final</td></tr>
<tr class="separator:ad1f9499f529513c9d26fc647968dfe7e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeee17a50e4f350eebc14b1704ec9a39 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afeee17a50e4f350eebc14b1704ec9a39">getPackHeader</a> (const void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, bool allow_incompressible=false) final</td></tr>
<tr class="separator:afeee17a50e4f350eebc14b1704ec9a39 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42fa62442193d76789d049cbc3635bd2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a42fa62442193d76789d049cbc3635bd2">readPackHeader</a> (int len, bool allow_incompressible=false) final</td></tr>
<tr class="separator:a42fa62442193d76789d049cbc3635bd2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b9cb85a2382ebc043228597992283b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a14b9cb85a2382ebc043228597992283b">checkAlreadyPacked</a> (const void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen) final</td></tr>
<tr class="separator:a14b9cb85a2382ebc043228597992283b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0b2c2bbf482db53bf6a40811348d45 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a1e0b2c2bbf482db53bf6a40811348d45">buildLoader</a> (const <a class="el" href="classFilter.html">Filter</a> *ft)=0</td></tr>
<tr class="separator:a1e0b2c2bbf482db53bf6a40811348d45 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fe94299cf76c70de7ed953aa774330 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a86b1e444574bf0cf210927b9494cdc95">Linker</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa7fe94299cf76c70de7ed953aa774330">newLinker</a> () const =0</td></tr>
<tr class="separator:aa7fe94299cf76c70de7ed953aa774330 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9f88864fd7faa59c8130bd59a811a3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a> ()</td></tr>
<tr class="separator:a2c9f88864fd7faa59c8130bd59a811a3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e094d3b47373817a66457952f26dc70 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">getLoader</a> () const</td></tr>
<tr class="separator:a6e094d3b47373817a66457952f26dc70 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade07bbe55dcfe9cc68a6c785e9b0c33c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ade07bbe55dcfe9cc68a6c785e9b0c33c">getLoaderSize</a> () const</td></tr>
<tr class="separator:ade07bbe55dcfe9cc68a6c785e9b0c33c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af6a45574697d68421e70baef1c8d8c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a> (const void *pdata, int plen, int small=-1, int pextra=0)</td></tr>
<tr class="separator:a4af6a45574697d68421e70baef1c8d8c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a516182985490860d361a8266fa418235 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a516182985490860d361a8266fa418235 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37fb57f49864a5d22b43a13f4fc52923 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a37fb57f49864a5d22b43a13f4fc52923">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a37fb57f49864a5d22b43a13f4fc52923 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762161bd9480b458295cb0393633e224 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a762161bd9480b458295cb0393633e224">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a762161bd9480b458295cb0393633e224 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc42fc3224a7d9c6f4c9bc304392bab2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abc42fc3224a7d9c6f4c9bc304392bab2">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:abc42fc3224a7d9c6f4c9bc304392bab2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d8132ddf586284fc04b4798aac0597 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a69d8132ddf586284fc04b4798aac0597">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a69d8132ddf586284fc04b4798aac0597 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9320791ae051214ea71d7dade2c7c8e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab9320791ae051214ea71d7dade2c7c8e">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:ab9320791ae051214ea71d7dade2c7c8e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcf659cf5575651c05425f9943f3cf7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#adfcf659cf5575651c05425f9943f3cf7">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:adfcf659cf5575651c05425f9943f3cf7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20bd3abaf7f257ad69660ce6624585c6 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a20bd3abaf7f257ad69660ce6624585c6">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a20bd3abaf7f257ad69660ce6624585c6 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a813dc5ab0d1fb4bebb24261a297e5a87 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a813dc5ab0d1fb4bebb24261a297e5a87">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a813dc5ab0d1fb4bebb24261a297e5a87 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2163953fd8aa0c3af6085c03425931c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa2163953fd8aa0c3af6085c03425931c">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:aa2163953fd8aa0c3af6085c03425931c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf81a88111b09b6bd3353864484510b7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aaf81a88111b09b6bd3353864484510b7">addLoaderVA</a> (const char *s,...)</td></tr>
<tr class="separator:aaf81a88111b09b6bd3353864484510b7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c72885ba3799acf227862f721ddd5ab inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">hasLoaderSection</a> (const char *name) const</td></tr>
<tr class="separator:a0c72885ba3799acf227862f721ddd5ab inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebb62f4bf76fae3dcf2c64aac6bbf5ce inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aebb62f4bf76fae3dcf2c64aac6bbf5ce">getLoaderSection</a> (const char *name, int *slen=nullptr) const</td></tr>
<tr class="separator:aebb62f4bf76fae3dcf2c64aac6bbf5ce inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5239dbc85d3edd59b558deb94ed8e40d inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a5239dbc85d3edd59b558deb94ed8e40d">getLoaderSectionStart</a> (const char *name, int *slen=nullptr) const</td></tr>
<tr class="separator:a5239dbc85d3edd59b558deb94ed8e40d inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968ed89b0a113c54e982a497fdb8a97b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a968ed89b0a113c54e982a497fdb8a97b">getDefaultCompressionMethods_8</a> (int method, int level, int small=-1) const</td></tr>
<tr class="separator:a968ed89b0a113c54e982a497fdb8a97b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91d266e1612ca6108035e22fe8b1203 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac91d266e1612ca6108035e22fe8b1203">getDefaultCompressionMethods_le32</a> (int method, int level, int small=-1) const</td></tr>
<tr class="separator:ac91d266e1612ca6108035e22fe8b1203 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">prepareMethods</a> (int *methods, int ph_method, const int *all_methods) const</td></tr>
<tr class="memdesc:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">void <a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters()</a>: Try compression with several methods and filters, choose the best / or first working one.  <br /></td></tr>
<tr class="separator:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173933a7adb7d38dcc12ee8043457aa4 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a173933a7adb7d38dcc12ee8043457aa4">getDecompressorSections</a> () const</td></tr>
<tr class="separator:a173933a7adb7d38dcc12ee8043457aa4 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28302b0171618cd0b4949ab6c026dc31 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a28302b0171618cd0b4949ab6c026dc31">getDecompressorWrkmemSize</a> () const</td></tr>
<tr class="separator:a28302b0171618cd0b4949ab6c026dc31 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2cf462e56fc1876b93f047d8b222ce3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac2cf462e56fc1876b93f047d8b222ce3">defineDecompressorSymbols</a> ()</td></tr>
<tr class="separator:ac2cf462e56fc1876b93f047d8b222ce3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a02f8ef879cf94330288554bc525e8fd3">isValidFilter</a> (int filter_id) const</td></tr>
<tr class="memdesc:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">filter util; see class <a class="el" href="classFilterImpl.html" title="We don&#39;t want a full OO interface here because of certain implementation speed reasons.">FilterImpl</a>  <br /></td></tr>
<tr class="separator:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0525cfe60bfaae0ef0cf3efde338cd57 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0525cfe60bfaae0ef0cf3efde338cd57">optimizeFilter</a> (<a class="el" href="classFilter.html">Filter</a> *, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *, unsigned) const</td></tr>
<tr class="separator:a0525cfe60bfaae0ef0cf3efde338cd57 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a451951590472595cfd04a238624d1 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a07a451951590472595cfd04a238624d1">addFilter32</a> (int filter_id)</td></tr>
<tr class="separator:a07a451951590472595cfd04a238624d1 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec73793b1e58249dff949fad71520901 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aec73793b1e58249dff949fad71520901">defineFilterSymbols</a> (const <a class="el" href="classFilter.html">Filter</a> *ft)</td></tr>
<tr class="separator:aec73793b1e58249dff949fad71520901 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b47a6575142d8a8fafd88256c8a26e8 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0b47a6575142d8a8fafd88256c8a26e8">checkOverlay</a> (unsigned overlay)</td></tr>
<tr class="separator:a0b47a6575142d8a8fafd88256c8a26e8 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781dc4327dd4bcab50a94bfc85f52802 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a781dc4327dd4bcab50a94bfc85f52802">copyOverlay</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned overlay, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, bool do_seek=true)</td></tr>
<tr class="separator:a781dc4327dd4bcab50a94bfc85f52802 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3c0c359a5fa3597aeef5dcb6783b53 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a1e3c0c359a5fa3597aeef5dcb6783b53">getRandomId</a> () const</td></tr>
<tr class="separator:a1e3c0c359a5fa3597aeef5dcb6783b53 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90882bb1ff87aee14e72be4d953064d9 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a90882bb1ff87aee14e72be4d953064d9">patch_be16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:a90882bb1ff87aee14e72be4d953064d9 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d3293543c5f6b6ab634203eb6f7e6d7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a8d3293543c5f6b6ab634203eb6f7e6d7">patch_be16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a8d3293543c5f6b6ab634203eb6f7e6d7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba76e5b8b8d7504893344a9a166c7364 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aba76e5b8b8d7504893344a9a166c7364">patch_be32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:aba76e5b8b8d7504893344a9a166c7364 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4245c8c4fc839068b12989ee67b5f351 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4245c8c4fc839068b12989ee67b5f351">patch_be32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a4245c8c4fc839068b12989ee67b5f351 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcb9d7db4f85cd7a88ba890da7965c6 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#affcb9d7db4f85cd7a88ba890da7965c6">patch_le16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:affcb9d7db4f85cd7a88ba890da7965c6 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9336ee74f309cd9a47b91c426dc260a inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac9336ee74f309cd9a47b91c426dc260a">patch_le16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:ac9336ee74f309cd9a47b91c426dc260a inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f9280a6a5ddf2cbb669bd9a4aabf92 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac8f9280a6a5ddf2cbb669bd9a4aabf92">patch_le32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:ac8f9280a6a5ddf2cbb669bd9a4aabf92 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721bade28a259d93e7a7e0f93509f6e5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a721bade28a259d93e7a7e0f93509f6e5">patch_le32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a721bade28a259d93e7a7e0f93509f6e5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af51db683baf7d75a65f48429b77db475">checkPatch</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, int boff, int <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>)</td></tr>
<tr class="memdesc:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">patch util for loader  <br /></td></tr>
<tr class="separator:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01e10cd32d88f80d316455b55bcb1a5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a> (const void *p) const noexcept</td></tr>
<tr class="separator:ad01e10cd32d88f80d316455b55bcb1a5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a54fc63360923941cec0aa6060ae01 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a> (const void *p) const noexcept</td></tr>
<tr class="separator:a47a54fc63360923941cec0aa6060ae01 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba0bcb1d796daaeea9d308d8e407505e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a> (const void *p) const</td></tr>
<tr class="separator:aba0bcb1d796daaeea9d308d8e407505e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae85a3d8295d26480a18f0abea6912451 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a> (const void *p) const noexcept</td></tr>
<tr class="separator:ae85a3d8295d26480a18f0abea6912451 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860499fa0849a7c7a7c4d43ee084f76e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a> (void *p, unsigned v) noexcept</td></tr>
<tr class="separator:a860499fa0849a7c7a7c4d43ee084f76e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cad2c8624ee68213d01eb606be0382 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a> (void *p, unsigned v) noexcept</td></tr>
<tr class="separator:af9cad2c8624ee68213d01eb606be0382 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ee35ba69e590153658a06d471c4184 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a> (void *p, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> v) noexcept</td></tr>
<tr class="separator:a36ee35ba69e590153658a06d471c4184 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe77995491ee79eda48b8ca480687bb5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abe77995491ee79eda48b8ca480687bb5">OwningPointer</a> (<a class="el" href="classUiPacker.html">UiPacker</a>) uip</td></tr>
<tr class="separator:abe77995491ee79eda48b8ca480687bb5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82badd32867f847f506da476cce326f3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a82badd32867f847f506da476cce326f3">OwningPointer</a> (<a class="el" href="conf_8h.html#a86b1e444574bf0cf210927b9494cdc95">Linker</a>) linker</td></tr>
<tr class="separator:a82badd32867f847f506da476cce326f3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:af7608c13cbf253eea98ad6eb7cee8b61 inherit pro_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#af7608c13cbf253eea98ad6eb7cee8b61">PackerBase</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:af7608c13cbf253eea98ad6eb7cee8b61 inherit pro_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a3af121bec7063696881a30fd96d8c96b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a3af121bec7063696881a30fd96d8c96b">compileTimeAssertions</a> ()</td></tr>
<tr class="separator:a3af121bec7063696881a30fd96d8c96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a9cdb0429d3e2faba00ef2d67b2c628c0 inherit pro_static_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">elf_hash</a> (char const *)</td></tr>
<tr class="separator:a9cdb0429d3e2faba00ef2d67b2c628c0 inherit pro_static_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a504fe912dd96ebfcd443b89dd425317f inherit pro_static_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">gnu_hash</a> (char const *)</td></tr>
<tr class="separator:a504fe912dd96ebfcd443b89dd425317f inherit pro_static_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af727b6b460db28607ea976e650dbb16f">handleStub</a> (<a class="el" href="classInputFile.html">InputFile</a> *<a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>, <a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>)</td></tr>
<tr class="memdesc:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">file i/o utils  <br /></td></tr>
<tr class="separator:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a55f33ae9a3b893a0811404d4aa85592e">optimizeReloc</a> (unsigned relocnum, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) relocs, <a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) out, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) image, unsigned image_size, int bits, bool bswap, int *big)</td></tr>
<tr class="memdesc:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">sort and delta-compress relocations with optional bswap within image returns number of <b>bytes</b> written to 'out'  <br /></td></tr>
<tr class="separator:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad50f653ca4844165671764219a33eb74">unoptimizeReloc</a> (<a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) &amp;in, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;out, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) image, unsigned image_size, int bits, bool bswap)</td></tr>
<tr class="memdesc:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">delta-decompress relocations advances 'in' allocates 'out' and returns number of <b>relocs</b> written to 'out'  <br /></td></tr>
<tr class="separator:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ad10baff449a3519d7386cf0519374a15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a></td></tr>
<tr class="separator:ad10baff449a3519d7386cf0519374a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa11131540dea71d341de36cf39325c17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a></td></tr>
<tr class="separator:aa11131540dea71d341de36cf39325c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43aff2a214341cb27a7f07ec997e443d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a></td></tr>
<tr class="separator:a43aff2a214341cb27a7f07ec997e443d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923425254661af8d150e99087569da9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a></td></tr>
<tr class="separator:a923425254661af8d150e99087569da9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4fe837eb5fd3cff1d6b76758ab9a58c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a> [<a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a>]</td></tr>
<tr class="separator:ac4fe837eb5fd3cff1d6b76758ab9a58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07514aa5c9db6acc6b2bdad24113943"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a></td></tr>
<tr class="separator:ad07514aa5c9db6acc6b2bdad24113943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689b9c7fa3bd70c22d9703fbcc288819"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a></td></tr>
<tr class="separator:a689b9c7fa3bd70c22d9703fbcc288819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d71085c7179ef591535acdc5347e2dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a></td></tr>
<tr class="separator:a0d71085c7179ef591535acdc5347e2dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e16265acea35917d1e57a65fb5ffc70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a></td></tr>
<tr class="separator:a0e16265acea35917d1e57a65fb5ffc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9da32af4a0e9814653edd2d72c3e2dda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a></td></tr>
<tr class="separator:a9da32af4a0e9814653edd2d72c3e2dda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a847fd85f9cecd8abe44afd346f2ae168"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a></td></tr>
<tr class="separator:a847fd85f9cecd8abe44afd346f2ae168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf726e188c8c471755ee3f00cf7c4226"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a></td></tr>
<tr class="separator:acf726e188c8c471755ee3f00cf7c4226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f97eabbbe04201c83cd03c9103ce88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a></td></tr>
<tr class="separator:a53f97eabbbe04201c83cd03c9103ce88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d14a83cf8a4300cf26946d4c16f8421"><td class="memItemLeft" align="right" valign="top">unsigned int const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a></td></tr>
<tr class="separator:a9d14a83cf8a4300cf26946d4c16f8421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a367c1ee6e43cb116f980f9046a0fce"><td class="memItemLeft" align="right" valign="top">unsigned int const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a></td></tr>
<tr class="separator:a1a367c1ee6e43cb116f980f9046a0fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af841cae6e65e727111a3e5bc134135c0"><td class="memItemLeft" align="right" valign="top">unsigned int const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a></td></tr>
<tr class="separator:af841cae6e65e727111a3e5bc134135c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad626f92218bc4ac19501c91a513ae75c"><td class="memItemLeft" align="right" valign="top">unsigned int const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a></td></tr>
<tr class="separator:ad626f92218bc4ac19501c91a513ae75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f613581a3950b9df0a33e1dee728e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a></td></tr>
<tr class="separator:ad4f613581a3950b9df0a33e1dee728e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb6babf0e9aac66eec1cdfe3c0fb6247"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a></td></tr>
<tr class="separator:afb6babf0e9aac66eec1cdfe3c0fb6247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af723e5e6c9919f309a40134658df5a4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a></td></tr>
<tr class="separator:af723e5e6c9919f309a40134658df5a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6524ff7018c3899073535eb33f4920"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a></td></tr>
<tr class="separator:a6d6524ff7018c3899073535eb33f4920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8c011204377d30ff0f1283c7eca923"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a></td></tr>
<tr class="separator:a4e8c011204377d30ff0f1283c7eca923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d5fb25525360d037499ea920927602"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a></td></tr>
<tr class="separator:a98d5fb25525360d037499ea920927602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9448025599860ae8d5773f15c09d73a4"><td class="memItemLeft" align="right" valign="top">cprElfHdr4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a></td></tr>
<tr class="separator:a9448025599860ae8d5773f15c09d73a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae6931a0bd5d2fca80befbd24a574c3e"><td class="memItemLeft" align="right" valign="top">cprElfShdr3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a></td></tr>
<tr class="separator:aae6931a0bd5d2fca80befbd24a574c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:ae803acdbc60d287ce17afb401b844f43 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ae803acdbc60d287ce17afb401b844f43">old_data_off</a></td></tr>
<tr class="separator:ae803acdbc60d287ce17afb401b844f43 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362fdf6e7ad11e117be7166b119d80fa inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a362fdf6e7ad11e117be7166b119d80fa">old_data_len</a></td></tr>
<tr class="separator:a362fdf6e7ad11e117be7166b119d80fa inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf175264167b93a8ce865a34937584e6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a></td></tr>
<tr class="separator:aaf175264167b93a8ce865a34937584e6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0f5122457c7d42172531d3cb116f00 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a></td></tr>
<tr class="separator:a3b0f5122457c7d42172531d3cb116f00 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca43f8d44f554de5f8129732f291f2d inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a></td></tr>
<tr class="separator:aaca43f8d44f554de5f8129732f291f2d inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc48dc344bb8340e9691a43d45f8458 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></td></tr>
<tr class="separator:afcc48dc344bb8340e9691a43d45f8458 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e3d4f8dd219c66f8a2d78e20ca5df4 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a></td></tr>
<tr class="separator:ad4e3d4f8dd219c66f8a2d78e20ca5df4 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e8bd1f64f0d8583676289f7329eb31 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a></td></tr>
<tr class="separator:a29e8bd1f64f0d8583676289f7329eb31 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55541b4f9e0f8f1fe16cb785b093ab1c inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a></td></tr>
<tr class="separator:a55541b4f9e0f8f1fe16cb785b093ab1c inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834063e926d1118a24f23a8106edcd4e inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a></td></tr>
<tr class="separator:a834063e926d1118a24f23a8106edcd4e inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe0a4831f0aafe74de573ca657ea430 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a></td></tr>
<tr class="separator:acbe0a4831f0aafe74de573ca657ea430 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc33d310cb391da2166a1dd3857ee4d inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a></td></tr>
<tr class="separator:a4cc33d310cb391da2166a1dd3857ee4d inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c581148f2345d127c21f0ba5a33a656 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a></td></tr>
<tr class="separator:a4c581148f2345d127c21f0ba5a33a656 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ec71c63b3b76a8847d2a5989c2f3fbb inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a></td></tr>
<tr class="separator:a6ec71c63b3b76a8847d2a5989c2f3fbb inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ca408b94c072437e9e96a3b4e3ab1f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a></td></tr>
<tr class="separator:ab3ca408b94c072437e9e96a3b4e3ab1f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac334df9f0f0666906d1b49d1d45be792 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a></td></tr>
<tr class="separator:ac334df9f0f0666906d1b49d1d45be792 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ee39bcba2a438ad1728c8332356ce2 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a></td></tr>
<tr class="separator:a99ee39bcba2a438ad1728c8332356ce2 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae86e3eeb56091063ef73bbcab2c1262a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">sz_pack2a</a></td></tr>
<tr class="separator:ae86e3eeb56091063ef73bbcab2c1262a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd64335916d77771c6dd2f5b71e9a77 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a></td></tr>
<tr class="separator:a8cd64335916d77771c6dd2f5b71e9a77 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80989e5fdaa51b0650d6f5d66eaf3766 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a></td></tr>
<tr class="separator:a80989e5fdaa51b0650d6f5d66eaf3766 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6c41a7dc3caa60ac369d2776ee5a12 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">is_pie</a></td></tr>
<tr class="separator:a9f6c41a7dc3caa60ac369d2776ee5a12 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b16212a7cce313d106777dc6c198af inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a></td></tr>
<tr class="separator:af8b16212a7cce313d106777dc6c198af inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8dc91b5f08ffdd31586e4d0c8ef2cb inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></td></tr>
<tr class="separator:a3a8dc91b5f08ffdd31586e4d0c8ef2cb inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac769941a308e20fdce0e86d1ec3b2f3 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a></td></tr>
<tr class="separator:aac769941a308e20fdce0e86d1ec3b2f3 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371519bdb05124340b9d78e067bee1e0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a></td></tr>
<tr class="separator:a371519bdb05124340b9d78e067bee1e0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be817665d0219026ebd50acdd3700af inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a></td></tr>
<tr class="separator:a8be817665d0219026ebd50acdd3700af inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa692858672c20488c367295681b28422 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a></td></tr>
<tr class="separator:aa692858672c20488c367295681b28422 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa8506d335cb1116f720aff4611a337 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a></td></tr>
<tr class="separator:a3fa8506d335cb1116f720aff4611a337 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539c946c8c36fa509670ec9948ccb1fc inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a></td></tr>
<tr class="separator:a539c946c8c36fa509670ec9948ccb1fc inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb9134e6f6d635119bbce8ee9fc2cc0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a></td></tr>
<tr class="separator:a3bb9134e6f6d635119bbce8ee9fc2cc0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8e26f797ec69a6c183c8b15fcd4f53 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a></td></tr>
<tr class="separator:a8c8e26f797ec69a6c183c8b15fcd4f53 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f1dfda6aea57348d0720fa78b782d0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a></td></tr>
<tr class="separator:aa2f1dfda6aea57348d0720fa78b782d0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0ac0fb5a7d76ec145e96317d6501d7 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aae0ac0fb5a7d76ec145e96317d6501d7">plt_off</a></td></tr>
<tr class="separator:aae0ac0fb5a7d76ec145e96317d6501d7 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a59994ceb7e3d20444f07a08cd1cfe inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a></td></tr>
<tr class="separator:a59a59994ceb7e3d20444f07a08cd1cfe inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888f94bd6a90f535ea5567e3f8b39ccc inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a></td></tr>
<tr class="separator:a888f94bd6a90f535ea5567e3f8b39ccc inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4920cc3ff82dcbc60f2a87fdd276d025 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a></td></tr>
<tr class="separator:a4920cc3ff82dcbc60f2a87fdd276d025 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc257b84970a37def2e57221bf91c48 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a01856cf6f1215fb3b66cb3547550f99a">upx_uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></td></tr>
<tr class="separator:accc257b84970a37def2e57221bf91c48 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c2c447099336ae2bc5cc1539c36610 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">ei_class</a></td></tr>
<tr class="separator:af6c2c447099336ae2bc5cc1539c36610 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dabe40d6f7f71e6b9bce64b9cc3290f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">ei_data</a></td></tr>
<tr class="separator:a5dabe40d6f7f71e6b9bce64b9cc3290f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad930777406ea601d200de0ab59de88d6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a></td></tr>
<tr class="separator:ad930777406ea601d200de0ab59de88d6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691359a24fbf2963d4ac5f625dd0299c inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a></td></tr>
<tr class="separator:a691359a24fbf2963d4ac5f625dd0299c inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946ebc79f94eff58bd559c7b5bb60057 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">osabi_note</a></td></tr>
<tr class="separator:a946ebc79f94eff58bd559c7b5bb60057 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5789e03712ad5c821ed718be76cb006a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></td></tr>
<tr class="separator:a5789e03712ad5c821ed718be76cb006a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93d9de72bcb60bbea6757e0d44e5e296 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a> [<a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>]</td></tr>
<tr class="separator:a93d9de72bcb60bbea6757e0d44e5e296 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c2a145b6739ad4cd1035af406a821a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a></td></tr>
<tr class="separator:a76c2a145b6739ad4cd1035af406a821a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193d50a7694d9bbdd607514c4fe691ab inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a></td></tr>
<tr class="separator:a193d50a7694d9bbdd607514c4fe691ab inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0f4c33a259ca5c14cdc2384285e274f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a></td></tr>
<tr class="separator:ab0f4c33a259ca5c14cdc2384285e274f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4036b37656b78e0053108ad8f9a17ef8 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a></td></tr>
<tr class="separator:a4036b37656b78e0053108ad8f9a17ef8 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2664a0d3b21d1e9fc0871a9acefff6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3e2664a0d3b21d1e9fc0871a9acefff6">note_body</a></td></tr>
<tr class="separator:a3e2664a0d3b21d1e9fc0871a9acefff6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d39fd80fb77e53dd4d79b5042a2941 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a63d39fd80fb77e53dd4d79b5042a2941">note_size</a></td></tr>
<tr class="separator:a63d39fd80fb77e53dd4d79b5042a2941 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a02a5314fbdff34469cfa4b59ddde10 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a></td></tr>
<tr class="separator:a1a02a5314fbdff34469cfa4b59ddde10 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a614b94da58152b4585040e30a72a0de3 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a></td></tr>
<tr class="separator:a614b94da58152b4585040e30a72a0de3 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3e459ee90ee28853a76401b8145123 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a></td></tr>
<tr class="separator:aeb3e459ee90ee28853a76401b8145123 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449871a4fd2081e1399999ef05741f92 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a></td></tr>
<tr class="separator:a449871a4fd2081e1399999ef05741f92 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3408c180ca78a03f0c06da6c8c25dc34 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a></td></tr>
<tr class="separator:a3408c180ca78a03f0c06da6c8c25dc34 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6db1e979cfd371114262e2887980ee inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">progid</a></td></tr>
<tr class="separator:a4e6db1e979cfd371114262e2887980ee inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e227135d766557eb3e012e610d72a0 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a></td></tr>
<tr class="separator:aa3e227135d766557eb3e012e610d72a0 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce6e18bbda8d182b25bc7188740b55b inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a0ce6e18bbda8d182b25bc7188740b55b">loader</a></td></tr>
<tr class="separator:a0ce6e18bbda8d182b25bc7188740b55b inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914345298d86f797a6c960ca80afdeb7 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a></td></tr>
<tr class="separator:a914345298d86f797a6c960ca80afdeb7 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a7532bf1dac1d3df6a453729750505 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ac7a7532bf1dac1d3df6a453729750505">pt_dynamic</a></td></tr>
<tr class="separator:ac7a7532bf1dac1d3df6a453729750505 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe548f0eb818215a9924b273022ad71f inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#afe548f0eb818215a9924b273022ad71f">sz_dynamic</a></td></tr>
<tr class="separator:afe548f0eb818215a9924b273022ad71f inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055b87f94fa37391fb1c356b215ec027 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a055b87f94fa37391fb1c356b215ec027">b_len</a></td></tr>
<tr class="separator:a055b87f94fa37391fb1c356b215ec027 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33d54bc7392e242453b126d23c3ecbd inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a></td></tr>
<tr class="separator:aa33d54bc7392e242453b126d23c3ecbd inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a8d9222b7627fa48786c128340b0c0 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a></td></tr>
<tr class="separator:a05a8d9222b7627fa48786c128340b0c0 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab714a14f4ff2f120107dfc08b2a3a5 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a></td></tr>
<tr class="separator:a8ab714a14f4ff2f120107dfc08b2a3a5 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a994baf32174356ff73af67ad5d15ba inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structl__info.html">l_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a></td></tr>
<tr class="separator:a8a994baf32174356ff73af67ad5d15ba inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPacker')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a18d294254872108f1373a26ccabbd821 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">const N_BELE_RTP::AbstractPolicy *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a> = nullptr</td></tr>
<tr class="separator:a18d294254872108f1373a26ccabbd821 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d498ce73ff0a988560ff88f603e50ae inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a7d498ce73ff0a988560ff88f603e50ae">ph_format</a> = -1</td></tr>
<tr class="separator:a7d498ce73ff0a988560ff88f603e50ae inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096e8f1e0d39dd91a106bfb89451a25e inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a096e8f1e0d39dd91a106bfb89451a25e">ph_version</a> = -1</td></tr>
<tr class="separator:a096e8f1e0d39dd91a106bfb89451a25e inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d40264330fe966e66718440b450ec8 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a></td></tr>
<tr class="separator:a95d40264330fe966e66718440b450ec8 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f51aecfca1c5d86cc11a7d2ab574d5e inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a8f51aecfca1c5d86cc11a7d2ab574d5e">obuf</a></td></tr>
<tr class="separator:a8f51aecfca1c5d86cc11a7d2ab574d5e inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afda0c36e70bfaeeecc0494abfb924ae7 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afda0c36e70bfaeeecc0494abfb924ae7">ibufgood</a> = 0</td></tr>
<tr class="separator:afda0c36e70bfaeeecc0494abfb924ae7 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:a0306ca7a6b44bd2b88bda7eefa46d49b inherit pro_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classInputFile.html">InputFile</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a></td></tr>
<tr class="separator:a0306ca7a6b44bd2b88bda7eefa46d49b inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memItemLeft" >union {</td></tr>
<tr class="memitem:ae9574c21b6d500a7a2d0e20bcbc6f512 inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a58b8dd6274f8ad1eca2637b12665167f">upx_int64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a></td></tr>
<tr class="separator:ae9574c21b6d500a7a2d0e20bcbc6f512 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa805ae048630f146d2abf38797fea52d inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a></td></tr>
<tr class="separator:aa805ae048630f146d2abf38797fea52d inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a3f0252ee140d3a44d4a1d47ea1a9da inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a58b8dd6274f8ad1eca2637b12665167f">upx_int64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a76d1e66f0b3c637fdb874858bcda14e8">file_size_i64</a></td></tr>
<tr class="separator:a9a3f0252ee140d3a44d4a1d47ea1a9da inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae30790328b3b3bb901099d1dd6aaab inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a0fcea265b45d10fd12879bc2031bf7ab">file_size_u64</a></td></tr>
<tr class="separator:a1ae30790328b3b3bb901099d1dd6aaab inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memItemLeft" >union {</td></tr>
<tr class="memitem:ad2f05b968c3b089b974b6ee0d58f5f3d inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#ab4a628cc601ebd17416219a120bedc22">upx_int32_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a5149b8b54da86de4aece59e39d73e676">file_size_i32</a></td></tr>
<tr class="separator:ad2f05b968c3b089b974b6ee0d58f5f3d inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9da74dad6d9e37f7a927a94587ae04f inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a></td></tr>
<tr class="separator:ac9da74dad6d9e37f7a927a94587ae04f inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f3c918e5ce5b4de630d11c703cec05 inherit pro_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPackHeader.html">PackHeader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a></td></tr>
<tr class="separator:a01f3c918e5ce5b4de630d11c703cec05 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a898ffb3ab797ebed36d6f8e8e69848f0"><td class="memItemLeft" align="right" valign="top">static unsigned const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a> = 5</td></tr>
<tr class="separator:a898ffb3ab797ebed36d6f8e8e69848f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_attribs_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_static_attribs_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Static Protected Attributes inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a14a0202c4a2a508fef4009ae120b44b8 inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned int const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> = (1u&lt;&lt;12)</td></tr>
<tr class="separator:a14a0202c4a2a508fef4009ae120b44b8 inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7515af27403f7b035c02bc0f92dee48c inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a> = 34</td></tr>
<tr class="separator:a7515af27403f7b035c02bc0f92dee48c inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793632661a0af5efd197304078be1ed0 inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static const unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">o_shstrtab</a> []</td></tr>
<tr class="separator:a793632661a0af5efd197304078be1ed0 inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-types" name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a13b054a58cbbd3183bef75f38036faac"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">super</a></td></tr>
<tr class="separator:a13b054a58cbbd3183bef75f38036faac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a5d4431054206626f898a559c0bb183c4 inherit pub_types_classPackUnix"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classPacker.html">Packer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a5d4431054206626f898a559c0bb183c4">super</a></td></tr>
<tr class="separator:a5d4431054206626f898a559c0bb183c4 inherit pub_types_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4a969f788c3bad61abe0eec73fca0f0c">isValidCompressionMethod</a> (int method)</td></tr>
<tr class="memdesc:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">compression method util  <br /></td></tr>
<tr class="separator:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:a0c49d00b430fd8a28f49499748875943 inherit pub_static_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top">static constexpr unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0c49d00b430fd8a28f49499748875943">MAX_METHODS</a> = 8</td></tr>
<tr class="separator:a0c49d00b430fd8a28f49499748875943 inherit pub_static_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8691a09f947ec86dd6437b357c277851 inherit pub_static_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top">static constexpr unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a8691a09f947ec86dd6437b357c277851">MAX_FILTERS</a> = 16</td></tr>
<tr class="separator:a8691a09f947ec86dd6437b357c277851 inherit pub_static_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_types_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a1f6547d32f13116f4f888f8f359cdbef inherit pro_types_classPackUnix"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a> = 2048
 }</td></tr>
<tr class="separator:a1f6547d32f13116f4f888f8f359cdbef inherit pro_types_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00315">315</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a13b054a58cbbd3183bef75f38036faac" name="a13b054a58cbbd3183bef75f38036faac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13b054a58cbbd3183bef75f38036faac">&#9670;&#160;</a></span>super</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a> <a class="el" href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">PackLinuxElf64::super</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00317">317</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afc05d6aa59c55c25d1faf101a5c557b7" name="afc05d6aa59c55c25d1faf101a5c557b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc05d6aa59c55c25d1faf101a5c557b7">&#9670;&#160;</a></span>PackLinuxElf64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::PackLinuxElf64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInputFile.html">InputFile</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00990">990</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  991</span>    : <a class="code hl_typedef" href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">super</a>(f), <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  992</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>(0), <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>(0),</div>
<div class="line"><span class="lineno">  993</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>(~0ull&lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>),</div>
<div class="line"><span class="lineno">  994</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  995</span>                     <a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  996</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  997</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  998</span>    , <a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  999</span>{</div>
<div class="line"><span class="lineno"> 1000</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>));</div>
<div class="line"><span class="lineno"> 1001</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a> = 0;</div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">if</span> (f) {</div>
<div class="line"><span class="lineno"> 1003</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1004</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>));</div>
<div class="line"><span class="lineno"> 1005</span>    }</div>
<div class="line"><span class="lineno"> 1006</span>}</div>
<div class="ttc" id="absd_8h_html_a0d112bae8fd35be772185b6ec6bcbe64"><div class="ttname"><a href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a></div><div class="ttdeci">#define SEEK_SET</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00101">bsd.h:101</a></div></div>
<div class="ttc" id="aclassInputFile_html_a6fad8c9902f939edfcb0e48ee8379232"><div class="ttname"><a href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx</a></div><div class="ttdeci">int readx(SPAN_P(void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00201">file.cpp:201</a></div></div>
<div class="ttc" id="aclassInputFile_html_aa76b4db751f0d4ad6c47e93fa676d4a9"><div class="ttname"><a href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek</a></div><div class="ttdeci">virtual upx_off_t seek(upx_off_t off, int whence) override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00208">file.cpp:208</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a13b054a58cbbd3183bef75f38036faac"><div class="ttname"><a href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">PackLinuxElf64::super</a></div><div class="ttdeci">PackLinuxElf super</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00317">p_lx_elf.h:317</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a1a367c1ee6e43cb116f980f9046a0fce"><div class="ttname"><a href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">PackLinuxElf64::hashend</a></div><div class="ttdeci">unsigned int const * hashend</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00413">p_lx_elf.h:413</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a43aff2a214341cb27a7f07ec997e443d"><div class="ttname"><a href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">PackLinuxElf64::shdri</a></div><div class="ttdeci">Elf64_Shdr * shdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00400">p_lx_elf.h:400</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a4e8c011204377d30ff0f1283c7eca923"><div class="ttname"><a href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">PackLinuxElf64::sec_dynstr</a></div><div class="ttdeci">Elf64_Shdr const  * sec_dynstr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00420">p_lx_elf.h:420</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a53f97eabbbe04201c83cd03c9103ce88"><div class="ttname"><a href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">PackLinuxElf64::dynseg</a></div><div class="ttdeci">Elf64_Dyn * dynseg</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00412">p_lx_elf.h:412</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a689b9c7fa3bd70c22d9703fbcc288819"><div class="ttname"><a href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">PackLinuxElf64::sz_phdrx</a></div><div class="ttdeci">unsigned sz_phdrx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00405">p_lx_elf.h:405</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6d6524ff7018c3899073535eb33f4920"><div class="ttname"><a href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">PackLinuxElf64::sec_dynsym</a></div><div class="ttdeci">Elf64_Shdr * sec_dynsym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00419">p_lx_elf.h:419</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a847fd85f9cecd8abe44afd346f2ae168"><div class="ttname"><a href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">PackLinuxElf64::n_jmp_slot</a></div><div class="ttdeci">unsigned n_jmp_slot</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00409">p_lx_elf.h:409</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a98d5fb25525360d037499ea920927602"><div class="ttname"><a href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">PackLinuxElf64::sec_arm_attr</a></div><div class="ttdeci">Elf64_Shdr * sec_arm_attr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00421">p_lx_elf.h:421</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a9d14a83cf8a4300cf26946d4c16f8421"><div class="ttname"><a href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">PackLinuxElf64::hashtab</a></div><div class="ttdeci">unsigned int const  * hashtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00413">p_lx_elf.h:413</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_aa11131540dea71d341de36cf39325c17"><div class="ttname"><a href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">PackLinuxElf64::phdri</a></div><div class="ttdeci">Elf64_Phdr * phdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00399">p_lx_elf.h:399</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_acf726e188c8c471755ee3f00cf7c4226"><div class="ttname"><a href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">PackLinuxElf64::page_mask</a></div><div class="ttdeci">upx_uint64_t page_mask</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00410">p_lx_elf.h:410</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad07514aa5c9db6acc6b2bdad24113943"><div class="ttname"><a href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">PackLinuxElf64::n_phdrx</a></div><div class="ttdeci">unsigned n_phdrx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00404">p_lx_elf.h:404</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad10baff449a3519d7386cf0519374a15"><div class="ttname"><a href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">PackLinuxElf64::ehdri</a></div><div class="ttdeci">Elf64_Ehdr ehdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00398">p_lx_elf.h:398</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad4f613581a3950b9df0a33e1dee728e9"><div class="ttname"><a href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">PackLinuxElf64::dynsym</a></div><div class="ttdeci">Elf64_Sym * dynsym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00415">p_lx_elf.h:415</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad626f92218bc4ac19501c91a513ae75c"><div class="ttname"><a href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">PackLinuxElf64::gashend</a></div><div class="ttdeci">unsigned int const * gashend</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00414">p_lx_elf.h:414</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af723e5e6c9919f309a40134658df5a4d"><div class="ttname"><a href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">PackLinuxElf64::sec_strndx</a></div><div class="ttdeci">Elf64_Shdr * sec_strndx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00418">p_lx_elf.h:418</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af841cae6e65e727111a3e5bc134135c0"><div class="ttname"><a href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">PackLinuxElf64::gashtab</a></div><div class="ttdeci">unsigned int const  * gashtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00414">p_lx_elf.h:414</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_afb6babf0e9aac66eec1cdfe3c0fb6247"><div class="ttname"><a href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">PackLinuxElf64::jni_onload_sym</a></div><div class="ttdeci">Elf64_Sym const  * jni_onload_sym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00416">p_lx_elf.h:416</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8cd64335916d77771c6dd2f5b71e9a77"><div class="ttname"><a href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">PackLinuxElf::lg2_page</a></div><div class="ttdeci">unsigned lg2_page</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00101">p_lx_elf.h:101</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a4ffffab0dc6ead4a09af1dba0b85f71c"><div class="ttname"><a href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a></div><div class="ttdeci">void * memset(const C&lt; T &gt; &amp;a, int v, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00139">xspan_fwd.h:139</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, and <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph" id="aclassPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,199,162"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="270,80,346,105"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="247,129,369,155"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="249,180,367,205"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="435,80,549,105"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="417,129,567,155"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="619,131,750,156"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="837,87,927,112"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="640,29,729,55"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="616,180,753,205"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1009,59,1128,84"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="803,22,961,62"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="434,231,550,256"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="656,279,713,304"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="617,229,753,255"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="615,328,755,353"/>
</map>
</div>

</div>
</div>
<a id="af736dee54f1eb95750dfb45531efb66c" name="af736dee54f1eb95750dfb45531efb66c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af736dee54f1eb95750dfb45531efb66c">&#9670;&#160;</a></span>~PackLinuxElf64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::~PackLinuxElf64 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01008">1008</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1009</span>{</div>
<div class="line"><span class="lineno"> 1010</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abd6eb82fa691109eb7fa267d6c8570f6" name="abd6eb82fa691109eb7fa267d6c8570f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd6eb82fa691109eb7fa267d6c8570f6">&#9670;&#160;</a></span>add_phdrx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::add_phdrx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01012">1012</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1013</span>{</div>
<div class="line"><span class="lineno"> 1014</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>) {</div>
<div class="line"><span class="lineno"> 1015</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many Phdr %u&quot;</span>, (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 1016</span>    }</div>
<div class="line"><span class="lineno"> 1017</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>[<a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>++] = phdr;</div>
<div class="line"><span class="lineno"> 1018</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a898ffb3ab797ebed36d6f8e8e69848f0"><div class="ttname"><a href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">PackLinuxElf64::END_PHDRX</a></div><div class="ttdeci">static unsigned const END_PHDRX</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00402">p_lx_elf.h:402</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ac4fe837eb5fd3cff1d6b76758ab9a58c"><div class="ttname"><a href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">PackLinuxElf64::phdrx</a></div><div class="ttdeci">Elf64_Phdr const  * phdrx[END_PHDRX]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00403">p_lx_elf.h:403</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a388ab1f73d9ba5222a35cbdd67b396ff"><div class="ttname"><a href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a></div><div class="ttdeci">void throwCantPack(const char *msg)</div><div class="ttdoc">compression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00075">except.cpp:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a>, <a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph" id="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="205,13,324,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph" id="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a6b85151ad06f0b457773686f047903f4" name="a6b85151ad06f0b457773686f047903f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b85151ad06f0b457773686f047903f4">&#9670;&#160;</a></span>adjABS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::adjABS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04155">4155</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4156</span>{</div>
<div class="line"><span class="lineno"> 4157</span>    <span class="keywordtype">unsigned</span> st_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sym-&gt;st_name);</div>
<div class="line"><span class="lineno"> 4158</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; <a class="code hl_variable" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>[j][0]; ++j) {</div>
<div class="line"><span class="lineno"> 4159</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>[j], <a class="code hl_function" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a>(st_name, (<span class="keywordtype">unsigned</span>)-1))) {</div>
<div class="line"><span class="lineno"> 4160</span>            sym-&gt;st_value += delta;</div>
<div class="line"><span class="lineno"> 4161</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 4162</span>        }</div>
<div class="line"><span class="lineno"> 4163</span>    }</div>
<div class="line"><span class="lineno"> 4164</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 4165</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_acd825cbaf5a768993a7f0b90a24c7a4c"><div class="ttname"><a href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">PackLinuxElf64::get_str_name</a></div><div class="ttdeci">char const * get_str_name(unsigned st_name, unsigned symnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02548">p_lx_elf.cpp:2548</a></div></div>
<div class="ttc" id="aclassPacker_html_a47a54fc63360923941cec0aa6060ae01"><div class="ttname"><a href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32</a></div><div class="ttdeci">unsigned get_te32(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00262">packer.h:262</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aa76502ba73704544aa4c5bf2afca9195"><div class="ttname"><a href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a></div><div class="ttdeci">static char const abs_symbol_names[][14]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l04130">p_lx_elf.cpp:4130</a></div></div>
<div class="ttc" id="asnprintf_8h_html_a674a04e474d5db68cb6272b9d46940cf"><div class="ttname"><a href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a></div><div class="ttdeci">forceinline int strcmp(const uchar *s1, const char *s2) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00077">snprintf.h:77</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>, <a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, and <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph" id="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph">
<area shape="rect" title=" " alt="" coords="5,70,180,95"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="228,5,377,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="238,70,367,95"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="269,143,336,169"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="425,13,544,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph" id="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph">
<area shape="rect" title=" " alt="" coords="637,45,812,70"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="443,5,589,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="444,69,588,109"/>
<area shape="rect" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8" title=" " alt="" coords="228,5,395,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="9,13,176,38"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="239,69,383,109"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,77,180,102"/>
</map>
</div>

</div>
</div>
<a id="a6eefcbb2a42d861b12d2c309d93771b8" name="a6eefcbb2a42d861b12d2c309d93771b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eefcbb2a42d861b12d2c309d93771b8">&#9670;&#160;</a></span>asl_pack2_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::asl_pack2_Shdrs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>pre_xct_top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04450">4450</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4451</span>{</div>
<div class="line"><span class="lineno"> 4452</span>    <span class="keywordflow">if</span> (!fo) {</div>
<div class="line"><span class="lineno"> 4453</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 4454</span>    }</div>
<div class="line"><span class="lineno"> 4455</span>    <span class="comment">// In order to pacify the runtime linker on Android &quot;O&quot; (&quot;Oreo&quot;),</span></div>
<div class="line"><span class="lineno"> 4456</span>    <span class="comment">// we will splice-in a 4KiB page that contains an &quot;extra&quot; copy</span></div>
<div class="line"><span class="lineno"> 4457</span>    <span class="comment">// of the Shdr, any PT_NOTE above xct_off, and shstrtab.</span></div>
<div class="line"><span class="lineno"> 4458</span>    <span class="comment">// File order: Ehdr, Phdr[], section contents below xct_off,</span></div>
<div class="line"><span class="lineno"> 4459</span>    <span class="comment">//    Shdr_copy[], PT_NOTEs.hi, shstrtab.</span></div>
<div class="line"><span class="lineno"> 4460</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>  += <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 4461</span>    <span class="comment">//xct_off += asl_delta;  // not until ::pack3()</span></div>
<div class="line"><span class="lineno"> 4462</span> </div>
<div class="line"><span class="lineno"> 4463</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = pre_xct_top;</div>
<div class="line"><span class="lineno"> 4464</span> </div>
<div class="line"><span class="lineno"> 4465</span>    <span class="comment">// Relocate PT_DYNAMIC (in PT_LOAD with PF_W)</span></div>
<div class="line"><span class="lineno"> 4466</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dyn = <span class="keyword">const_cast&lt;</span><a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>);</div>
<div class="line"><span class="lineno"> 4467</span>    <span class="keywordflow">for</span> (; dyn-&gt;d_tag; ++dyn) {</div>
<div class="line"><span class="lineno"> 4468</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d_tag = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 4469</span>        <span class="keywordflow">if</span> (Elf64_Dyn::DT_FINI       == d_tag</div>
<div class="line"><span class="lineno"> 4470</span>        ||  Elf64_Dyn::DT_FINI_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4471</span>        ||  Elf64_Dyn::DT_INIT_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4472</span>        ||  Elf64_Dyn::DT_PREINIT_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4473</span>        ||  Elf64_Dyn::DT_PLTGOT      == d_tag) {</div>
<div class="line"><span class="lineno"> 4474</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d_val = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_val);</div>
<div class="line"><span class="lineno"> 4475</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dyn-&gt;d_val, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + d_val);</div>
<div class="line"><span class="lineno"> 4476</span>        }</div>
<div class="line"><span class="lineno"> 4477</span>    }</div>
<div class="line"><span class="lineno"> 4478</span>    <span class="comment">// Updated dynseg (.dynamic, in PT_DYNAMIC (PT_LOAD{PF_W})) has not been written.</span></div>
<div class="line"><span class="lineno"> 4479</span>    <span class="comment">// dynseg is in file_image[] but not in low_mem[].</span></div>
<div class="line"><span class="lineno"> 4480</span> </div>
<div class="line"><span class="lineno"> 4481</span>    <span class="comment">// Relocate dynsym (DT_SYMTAB) which is below xct_va</span></div>
<div class="line"><span class="lineno"> 4482</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> off_dynsym = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4483</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> sz_dynsym  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4484</span>    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sz_dynsym</div>
<div class="line"><span class="lineno"> 4485</span>    ||  (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; off_dynsym</div>
<div class="line"><span class="lineno"> 4486</span>    || ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - off_dynsym) &lt; sz_dynsym) {</div>
<div class="line"><span class="lineno"> 4487</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_SYMTAB&quot;</span>);</div>
<div class="line"><span class="lineno"> 4488</span>    }</div>
<div class="line"><span class="lineno"> 4489</span>    <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *dyntym = (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4490</span>        <span class="stringliteral">&quot;bad dynsym&quot;</span>, off_dynsym, sz_dynsym);</div>
<div class="line"><span class="lineno"> 4491</span>    <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *sym = dyntym;</div>
<div class="line"><span class="lineno"> 4492</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = sz_dynsym / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>); --j&gt;=0; ++sym) {</div>
<div class="line"><span class="lineno"> 4493</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> symval = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sym-&gt;st_value);</div>
<div class="line"><span class="lineno"> 4494</span>        <span class="keywordtype">unsigned</span> symsec = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;sym-&gt;st_shndx);</div>
<div class="line"><span class="lineno"> 4495</span>        <span class="keywordflow">if</span> (Elf64_Sym::SHN_UNDEF != symsec</div>
<div class="line"><span class="lineno"> 4496</span>        &amp;&amp;  Elf64_Sym::SHN_ABS   != symsec</div>
<div class="line"><span class="lineno"> 4497</span>        &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 4498</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sym-&gt;st_value, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + symval);</div>
<div class="line"><span class="lineno"> 4499</span>        }</div>
<div class="line"><span class="lineno"> 4500</span>        <span class="keywordflow">if</span> (Elf64_Sym::SHN_ABS == symsec &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 4501</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS</a>(sym, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 4502</span>        }</div>
<div class="line"><span class="lineno"> 4503</span>    }</div>
<div class="line"><span class="lineno"> 4504</span> </div>
<div class="line"><span class="lineno"> 4505</span>    <span class="comment">// Relocate Phdr virtual addresses, but not physical offsets and sizes</span></div>
<div class="line"><span class="lineno"> 4506</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf_notes[512]; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(buf_notes, 0, <span class="keyword">sizeof</span>(buf_notes));</div>
<div class="line"><span class="lineno"> 4507</span>    <span class="keywordtype">unsigned</span> len_notes = 0;</div>
<div class="line"><span class="lineno"> 4508</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4509</span>        <span class="stringliteral">&quot;bad e_phoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 4510</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 4511</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4512</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= offset) { <span class="comment">// above the extra page</span></div>
<div class="line"><span class="lineno"> 4513</span>            {</div>
<div class="line"><span class="lineno"> 4514</span>                <span class="comment">//set_te64(&amp;phdr-&gt;p_offset, asl_delta + offset);  // physical</span></div>
<div class="line"><span class="lineno"> 4515</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> addr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a>);</div>
<div class="line"><span class="lineno"> 4516</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4517</span>                             addr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 4518</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4519</span>            }</div>
<div class="line"><span class="lineno"> 4520</span>        }</div>
<div class="line"><span class="lineno"> 4521</span>        <span class="comment">// .p_filesz,.p_memsz are updated in ::pack3</span></div>
<div class="line"><span class="lineno"> 4522</span>    }</div>
<div class="line"><span class="lineno"> 4523</span> </div>
<div class="line"><span class="lineno"> 4524</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *<span class="keyword">const</span> ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0];</div>
<div class="line"><span class="lineno"> 4525</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> e_entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>);</div>
<div class="line"><span class="lineno"> 4526</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; e_entry) {</div>
<div class="line"><span class="lineno"> 4527</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + e_entry);</div>
<div class="line"><span class="lineno"> 4528</span>    }</div>
<div class="line"><span class="lineno"> 4529</span>    <span class="comment">// Relocate Shdr; and Rela, Rel (below xct_off)</span></div>
<div class="line"><span class="lineno"> 4530</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> pal_xct_top = <a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(pre_xct_top);</div>
<div class="line"><span class="lineno"> 4531</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>, <a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(pal_xct_top));  <span class="comment">// Shdr alignment</span></div>
<div class="line"><span class="lineno"> 4532</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[pal_xct_top], <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4533</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[pal_xct_top];</div>
<div class="line"><span class="lineno"> 4534</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>;</div>
<div class="line"><span class="lineno"> 4535</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sz_shstrtab  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4536</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++j, ++shdr) {</div>
<div class="line"><span class="lineno"> 4537</span>        <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 4538</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4539</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4540</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_entsize = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_entsize);</div>
<div class="line"><span class="lineno"> 4541</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_size</div>
<div class="line"><span class="lineno"> 4542</span>        ||  (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_offset</div>
<div class="line"><span class="lineno"> 4543</span>        || (Elf64_Shdr::SHT_NOBITS != sh_type</div>
<div class="line"><span class="lineno"> 4544</span>           &amp;&amp; ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - sh_offset) &lt; sh_size) ) {</div>
<div class="line"><span class="lineno"> 4545</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad SHT_STRNDX&quot;</span>);</div>
<div class="line"><span class="lineno"> 4546</span>        }</div>
<div class="line"><span class="lineno"> 4547</span> </div>
<div class="line"><span class="lineno"> 4548</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 4549</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> addr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 4550</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_addr, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4551</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 4552</span>        }</div>
<div class="line"><span class="lineno"> 4553</span>        <span class="keywordflow">switch</span> (sh_type) {</div>
<div class="line"><span class="lineno"> 4554</span>        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4555</span>        <span class="keywordflow">case</span> Elf64_Shdr::SHT_RELA: {</div>
<div class="line"><span class="lineno"> 4556</span>            <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>) != sh_entsize) {</div>
<div class="line"><span class="lineno"> 4557</span>                <span class="keywordtype">char</span> msg[50];</div>
<div class="line"><span class="lineno"> 4558</span>                <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad Rela.sh_entsize %lu&quot;</span>, (<span class="keywordtype">long</span>)sh_entsize);</div>
<div class="line"><span class="lineno"> 4559</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4560</span>            }</div>
<div class="line"><span class="lineno"> 4561</span>            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = ~0ull;</div>
<div class="line"><span class="lineno"> 4562</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *<span class="keyword">const</span> relb = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4563</span>                 <span class="stringliteral">&quot;bad Rela offset&quot;</span>, sh_offset, sh_size);</div>
<div class="line"><span class="lineno"> 4564</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rela = relb;</div>
<div class="line"><span class="lineno"> 4565</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sh_size / sh_entsize; --k &gt;= 0; ++rela) {</div>
<div class="line"><span class="lineno"> 4566</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_addend = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 4567</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 4568</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_info);</div>
<div class="line"><span class="lineno"> 4569</span>                <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 4570</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 4571</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4572</span>                }</div>
<div class="line"><span class="lineno"> 4573</span>                <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) <span class="keywordflow">switch</span> (r_type) {</div>
<div class="line"><span class="lineno"> 4574</span>                    <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 4575</span>                        <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4576</span>                            <span class="stringliteral">&quot;unexpected relocation %#x [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 4577</span>                            r_type, -1 + (<span class="keywordtype">unsigned</span>)(sh_size / sh_entsize) - k);</div>
<div class="line"><span class="lineno"> 4578</span>                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4579</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4580</span>                    <span class="keywordflow">case</span> R_AARCH64_ABS64: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4581</span>                    <span class="keywordflow">case</span> R_AARCH64_GLOB_DAT: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4582</span>                    <span class="keywordflow">case</span> R_AARCH64_RELATIVE: {</div>
<div class="line"><span class="lineno"> 4583</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_addend) {</div>
<div class="line"><span class="lineno"> 4584</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_addend, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_addend);</div>
<div class="line"><span class="lineno"> 4585</span>                        }</div>
<div class="line"><span class="lineno"> 4586</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4587</span>                    <span class="keywordflow">case</span> R_AARCH64_JUMP_SLOT: {</div>
<div class="line"><span class="lineno"> 4588</span>                        <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 4589</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; r_offset) {</div>
<div class="line"><span class="lineno"> 4590</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = r_offset;</div>
<div class="line"><span class="lineno"> 4591</span>                        }</div>
<div class="line"><span class="lineno"> 4592</span>                        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(r_offset);</div>
<div class="line"><span class="lineno"> 4593</span>                        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4594</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4595</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4596</span>                        }</div>
<div class="line"><span class="lineno"> 4597</span>                        ++<a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 4598</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4599</span>                }</div>
<div class="line"><span class="lineno"> 4600</span>            }</div>
<div class="line"><span class="lineno"> 4601</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4602</span>        <span class="keywordflow">case</span> Elf64_Shdr::SHT_REL: {</div>
<div class="line"><span class="lineno"> 4603</span>            <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a>) != sh_entsize) {</div>
<div class="line"><span class="lineno"> 4604</span>                <span class="keywordtype">char</span> msg[50];</div>
<div class="line"><span class="lineno"> 4605</span>                <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad Rel.sh_entsize %lu&quot;</span>, (<span class="keywordtype">long</span>)sh_entsize);</div>
<div class="line"><span class="lineno"> 4606</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4607</span>            }</div>
<div class="line"><span class="lineno"> 4608</span>            <a class="code hl_typedef" href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a> *rel = (<a class="code hl_typedef" href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4609</span>                    <span class="stringliteral">&quot;bad Rel sh_offset&quot;</span>, sh_offset, sh_size);</div>
<div class="line"><span class="lineno"> 4610</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sh_size / sh_entsize; --k &gt;= 0; ++rel) {</div>
<div class="line"><span class="lineno"> 4611</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rel-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 4612</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 4613</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rel-&gt;r_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4614</span>                }</div>
<div class="line"><span class="lineno"> 4615</span>                <span class="comment">// r_offset must be in 2nd PT_LOAD; .p_vaddr was already relocated</span></div>
<div class="line"><span class="lineno"> 4616</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4617</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4618</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rel-&gt;r_info);</div>
<div class="line"><span class="lineno"> 4619</span>                <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 4620</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w</div>
<div class="line"><span class="lineno"> 4621</span>                &amp;&amp;  Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno"> 4622</span>                &amp;&amp;  (  R_AARCH64_RELATIVE  == r_type</div>
<div class="line"><span class="lineno"> 4623</span>                    || R_AARCH64_JUMP_SLOT == r_type)) {</div>
<div class="line"><span class="lineno"> 4624</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4625</span>                }</div>
<div class="line"><span class="lineno"> 4626</span>            }</div>
<div class="line"><span class="lineno"> 4627</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4628</span>        <span class="keywordflow">case</span> Elf64_Shdr::SHT_NOTE: {</div>
<div class="line"><span class="lineno"> 4629</span>            <span class="keywordflow">if</span> (!(Elf64_Shdr::SHF_ALLOC &amp; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags))) {</div>
<div class="line"><span class="lineno"> 4630</span>                <span class="comment">// example: version number of &#39;gold&#39; linker (static binder)</span></div>
<div class="line"><span class="lineno"> 4631</span>                <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(buf_notes) &lt; (sh_size + len_notes)) {</div>
<div class="line"><span class="lineno"> 4632</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;SHT_NOTEs too big&quot;</span>);</div>
<div class="line"><span class="lineno"> 4633</span>                }</div>
<div class="line"><span class="lineno"> 4634</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>[j].sh_offset,</div>
<div class="line"><span class="lineno"> 4635</span>                    len_notes + (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>)) + <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 4636</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;buf_notes[len_notes], &amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[sh_offset], sh_size);</div>
<div class="line"><span class="lineno"> 4637</span>                len_notes += sh_size;</div>
<div class="line"><span class="lineno"> 4638</span>            }</div>
<div class="line"><span class="lineno"> 4639</span>            <span class="keywordflow">else</span> { <span class="comment">// SHF_ALLOC: in PT_LOAD; but move sh_addr and sh_offset</span></div>
<div class="line"><span class="lineno"> 4640</span>                <span class="comment">// Not sure why we need this conditional.</span></div>
<div class="line"><span class="lineno"> 4641</span>                <span class="comment">// Anyway, some Android have multiple SHT_NOTE sections.</span></div>
<div class="line"><span class="lineno"> 4642</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 4643</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> pos = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>);</div>
<div class="line"><span class="lineno"> 4644</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_addr,   pos);</div>
<div class="line"><span class="lineno"> 4645</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, pos);</div>
<div class="line"><span class="lineno"> 4646</span>                }</div>
<div class="line"><span class="lineno"> 4647</span>            }</div>
<div class="line"><span class="lineno"> 4648</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4649</span>        } <span class="comment">// end switch (sh_type)</span></div>
<div class="line"><span class="lineno"> 4650</span>    }</div>
<div class="line"><span class="lineno"> 4651</span>    <span class="comment">// shstrndx will move</span></div>
<div class="line"><span class="lineno"> 4652</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>[<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a>)].sh_offset,</div>
<div class="line"><span class="lineno"> 4653</span>        len_notes + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) + pal_xct_top);</div>
<div class="line"><span class="lineno"> 4654</span> </div>
<div class="line"><span class="lineno"> 4655</span>    <span class="comment">// (&quot;Re-&quot;)write all changes below pal_xct_top</span></div>
<div class="line"><span class="lineno"> 4656</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4657</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, pal_xct_top);</div>
<div class="line"><span class="lineno"> 4658</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = pal_xct_top;</div>
<div class="line"><span class="lineno"> 4659</span> </div>
<div class="line"><span class="lineno"> 4660</span>    <span class="comment">// New copy of Shdr</span></div>
<div class="line"><span class="lineno"> 4661</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> blank; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;blank, 0, <span class="keyword">sizeof</span>(blank));</div>
<div class="line"><span class="lineno"> 4662</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;blank.sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// hint for &quot;upx -d&quot;</span></div>
<div class="line"><span class="lineno"> 4663</span>    <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);  <span class="comment">// Shdr alignment</span></div>
<div class="line"><span class="lineno"> 4664</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;blank, <span class="keyword">sizeof</span>(blank));</div>
<div class="line"><span class="lineno"> 4665</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>[1], (-1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4666</span> </div>
<div class="line"><span class="lineno"> 4667</span>    <span class="keywordflow">if</span> (len_notes) {</div>
<div class="line"><span class="lineno"> 4668</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(buf_notes, len_notes);</div>
<div class="line"><span class="lineno"> 4669</span>    }</div>
<div class="line"><span class="lineno"> 4670</span> </div>
<div class="line"><span class="lineno"> 4671</span>    <span class="comment">// New copy of Shdr[.e_shstrndx].[ sh_offset, +.sh_size )</span></div>
<div class="line"><span class="lineno"> 4672</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>,  sz_shstrtab);</div>
<div class="line"><span class="lineno"> 4673</span> </div>
<div class="line"><span class="lineno"> 4674</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 4675</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 4676</span>    <span class="comment">//xct_off += asl_delta;  // wait until ::pack3</span></div>
<div class="line"><span class="lineno"> 4677</span>    <span class="keywordtype">unsigned</span> d = <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + pal_xct_top - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 4678</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(d, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 4679</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += d;</div>
<div class="line"><span class="lineno"> 4680</span>}</div>
<div class="ttc" id="absd_8h_html_a4c8d0b76b470ba65a43ca46a88320f39"><div class="ttname"><a href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a></div><div class="ttdeci">#define SEEK_CUR</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00102">bsd.h:102</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a4909e2f9df016dda4d2a9e4d1991e7be"><div class="ttname"><a href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref</a></div><div class="ttdeci">forceinline pointer subref(const char *errfmt, size_t skip, size_t take) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00219">membuffer.h:219</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a8b1b934391e5d959387552e48a5fb4b4"><div class="ttname"><a href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek</a></div><div class="ttdeci">virtual upx_off_t seek(upx_off_t off, int whence) override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00320">file.cpp:320</a></div></div>
<div class="ttc" id="aclassOutputFile_html_aa8beb793956b90404c940c5821936718"><div class="ttname"><a href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write</a></div><div class="ttdeci">void write(SPAN_0(const void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00274">file.cpp:274</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a047a7534432a2a090049ba2eee67bfb9"><div class="ttname"><a href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">PackLinuxElf64::elf_get_offset_from_address</a></div><div class="ttdeci">virtual upx_uint64_t elf_get_offset_from_address(upx_uint64_t) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08264">p_lx_elf.cpp:8264</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a0d71085c7179ef591535acdc5347e2dd"><div class="ttname"><a href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">PackLinuxElf64::e_phoff</a></div><div class="ttdeci">upx_uint64_t e_phoff</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00406">p_lx_elf.h:406</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6b85151ad06f0b457773686f047903f4"><div class="ttname"><a href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">PackLinuxElf64::adjABS</a></div><div class="ttdeci">virtual int adjABS(Elf64_Sym *sym, unsigned long delta)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l04155">p_lx_elf.cpp:4155</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a923425254661af8d150e99087569da9f"><div class="ttname"><a href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">PackLinuxElf64::shdro</a></div><div class="ttdeci">Elf64_Shdr * shdro</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00401">p_lx_elf.h:401</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a14a0202c4a2a508fef4009ae120b44b8"><div class="ttname"><a href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a></div><div class="ttdeci">static unsigned int const asl_delta</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00083">p_lx_elf.h:83</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a193d50a7694d9bbdd607514c4fe691ab"><div class="ttname"><a href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a></div><div class="ttdeci">char const  * shstrtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00130">p_lx_elf.h:130</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a29e8bd1f64f0d8583676289f7329eb31"><div class="ttname"><a href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a></div><div class="ttdeci">MemBuffer lowmem</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00089">p_lx_elf.h:89</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3a8dc91b5f08ffdd31586e4d0c8ef2cb"><div class="ttname"><a href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a></div><div class="ttdeci">unsigned xct_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00105">p_lx_elf.h:105</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3b0f5122457c7d42172531d3cb116f00"><div class="ttname"><a href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a></div><div class="ttdeci">unsigned e_phnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00085">p_lx_elf.h:85</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3fa8506d335cb1116f720aff4611a337"><div class="ttname"><a href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a></div><div class="ttdeci">upx_uint64_t xct_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00110">p_lx_elf.h:110</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aa2f1dfda6aea57348d0720fa78b782d0"><div class="ttname"><a href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a></div><div class="ttdeci">upx_uint64_t plt_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00114">p_lx_elf.h:114</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aaca43f8d44f554de5f8129732f291f2d"><div class="ttname"><a href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a></div><div class="ttdeci">unsigned e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00086">p_lx_elf.h:86</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ac334df9f0f0666906d1b49d1d45be792"><div class="ttname"><a href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a></div><div class="ttdeci">unsigned sz_elf_hdrs</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00098">p_lx_elf.h:98</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_accc257b84970a37def2e57221bf91c48"><div class="ttname"><a href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a></div><div class="ttdeci">upx_uint16_t e_machine</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00119">p_lx_elf.h:119</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ad4e3d4f8dd219c66f8a2d78e20ca5df4"><div class="ttname"><a href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a></div><div class="ttdeci">MemBuffer file_image</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00088">p_lx_elf.h:88</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a614b94da58152b4585040e30a72a0de3"><div class="ttname"><a href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a></div><div class="ttdeci">unsigned total_in</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00091">p_unix.h:91</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aeb3e459ee90ee28853a76401b8145123"><div class="ttname"><a href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a></div><div class="ttdeci">unsigned total_out</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00091">p_unix.h:91</a></div></div>
<div class="ttc" id="aclassPackerBase_html_ace3319e7b055b7328edc18f48dba58db"><div class="ttname"><a href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a></div><div class="ttdeci">const upx_int64_t file_size</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00087">packer.h:87</a></div></div>
<div class="ttc" id="aclassPacker_html_a36ee35ba69e590153658a06d471c4184"><div class="ttname"><a href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64</a></div><div class="ttdeci">void set_te64(void *p, upx_uint64_t v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00267">packer.h:267</a></div></div>
<div class="ttc" id="aclassPacker_html_ad01e10cd32d88f80d316455b55bcb1a5"><div class="ttname"><a href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16</a></div><div class="ttdeci">unsigned get_te16(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00261">packer.h:261</a></div></div>
<div class="ttc" id="aclassPacker_html_ae85a3d8295d26480a18f0abea6912451"><div class="ttname"><a href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64</a></div><div class="ttdeci">upx_uint64_t get_te64(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00264">packer.h:264</a></div></div>
<div class="ttc" id="aconf_8h_html_a89d95f84118e61993a0a97429e8b8274"><div class="ttname"><a href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a></div><div class="ttdeci">acc_uint64_t upx_uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00167">conf.h:167</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a21e9cd6b9bcb032db9a6cda007013662"><div class="ttname"><a href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a></div><div class="ttdeci">ElfClass_Host64::Sym Elf64_Sym</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00380">p_elf.h:380</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a7cc1da9f1c15c68a7204d1846d6533ed"><div class="ttname"><a href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a></div><div class="ttdeci">ElfClass_Host64::Shdr Elf64_Shdr</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00376">p_elf.h:376</a></div></div>
<div class="ttc" id="ap__elf_8h_html_aa76cda786f88d3847afd663e85ff85bc"><div class="ttname"><a href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a></div><div class="ttdeci">ElfClass_Host64::Dyn Elf64_Dyn</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00377">p_elf.h:377</a></div></div>
<div class="ttc" id="ap__elf_8h_html_aabcf5f0de441c6290f5828bc243265b3"><div class="ttname"><a href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a></div><div class="ttdeci">ElfClass_Host64::Rel Elf64_Rel</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00378">p_elf.h:378</a></div></div>
<div class="ttc" id="ap__elf_8h_html_abbe4299005772efa79a79dc90ccbfc0e"><div class="ttname"><a href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a></div><div class="ttdeci">ElfClass_Host64::Rela Elf64_Rela</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00379">p_elf.h:379</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a5487e5169059653e4841e5aa6fe72859"><div class="ttname"><a href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a></div><div class="ttdeci">static unsigned up8(unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00082">p_lx_elf.cpp:82</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae67031a5cdb8843f862b05500cb6984f"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a></div><div class="ttdeci">static off_t fpad8(OutputFile *fo, unsigned pos)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00114">p_lx_elf.cpp:114</a></div></div>
<div class="ttc" id="asnprintf_8h_html_aa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00061">snprintf.h:61</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html"><div class="ttname"><a href="structElf64__Ehdr.html">Elf64_Ehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00205">bsd.h:206</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a63fca3f9b273e5fd4d190d9cb7fba9b0"><div class="ttname"><a href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a></div><div class="ttdeci">Elf64_Off e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00213">bsd.h:213</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a943c7d038a3cc3c1115e84b4cd19966d"><div class="ttname"><a href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a></div><div class="ttdeci">Elf64_Addr e_entry</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00211">bsd.h:211</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_ae8289d7705794be744876f6246242b9b"><div class="ttname"><a href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a></div><div class="ttdeci">Elf64_Half e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00220">bsd.h:220</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html"><div class="ttname"><a href="structElf64__Phdr.html">Elf64_Phdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00235">bsd.h:236</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_a5c69879e1229b175020ff011af46fcb9"><div class="ttname"><a href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a></div><div class="ttdeci">Elf64_Addr p_vaddr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00240">bsd.h:240</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_a83f4adb032fc307f5af79bdee5ef692d"><div class="ttname"><a href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a></div><div class="ttdeci">Elf64_Addr p_paddr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00241">bsd.h:241</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_aa2d51fb4517ded0c74903f8d0c9abea7"><div class="ttname"><a href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a></div><div class="ttdeci">Elf64_Off p_offset</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00239">bsd.h:239</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a9cf3296ee41855b4ced7b3bdfcaf8e5d"><div class="ttname"><a href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a></div><div class="ttdeci">void * memcpy(C&lt; T &gt; a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00095">xspan_fwd.h:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8()</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph" id="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,409,152,449"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="443,36,617,61"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1274,315,1393,340"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="674,135,803,160"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="200,135,391,175"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="465,85,595,111"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="266,739,325,764"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="465,739,595,764"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="231,441,360,467"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="256,515,335,540"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="257,588,333,613"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="466,391,594,416"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="231,689,359,715"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="224,289,367,315"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="272,788,319,813"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="856,73,1005,113"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="705,29,772,55"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="439,135,621,160"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="1061,971,1204,996"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1479,819,1617,844"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="671,819,806,844"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1689,667,1820,692"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="886,717,975,743"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1088,391,1177,416"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="694,717,783,743"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1270,869,1397,895"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="866,819,995,844"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1455,868,1641,893"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1727,868,1783,893"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1070,819,1195,844"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1260,717,1407,743"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1521,717,1575,743"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1478,616,1618,641"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1053,551,1212,591"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="863,441,999,467"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="681,516,797,541"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="902,491,959,516"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="441,289,619,315"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="669,239,808,264"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="857,137,1004,163"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1109,87,1157,112"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1288,87,1379,112"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="1485,87,1611,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph" id="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph">
<area shape="rect" title=" " alt="" coords="435,5,581,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8" title=" " alt="" coords="220,5,387,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="acf98749f15000ddd7c39f330ec145341" name="acf98749f15000ddd7c39f330ec145341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf98749f15000ddd7c39f330ec145341">&#9670;&#160;</a></span>buildLinuxLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::buildLinuxLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>szproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const&#160;</td>
          <td class="paramname"><em>fold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>szfold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01634">1634</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1641</span>{</div>
<div class="line"><span class="lineno"> 1642</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_cprLoader;</div>
<div class="line"><span class="lineno"> 1643</span>    <span class="keywordtype">unsigned</span> sz_cpr = 0;</div>
<div class="line"><span class="lineno"> 1644</span>    <span class="keywordtype">unsigned</span> sz_unc = 0;</div>
<div class="line"><span class="lineno"> 1645</span>    <span class="keywordtype">unsigned</span> method = 0;</div>
<div class="line"><span class="lineno"> 1646</span>    <a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> <span class="keyword">const</span> *uncLoader = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1647</span> </div>
<div class="line"><span class="lineno"> 1648</span>  <span class="keywordflow">if</span> (0 &lt; szfold) {</div>
<div class="line"><span class="lineno"> 1649</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 1650</span>      &amp;&amp; (  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64</div>
<div class="line"><span class="lineno"> 1651</span>         || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_AARCH64)</div>
<div class="line"><span class="lineno"> 1652</span>    ) {</div>
<div class="line"><span class="lineno"> 1653</span>        <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(fold, szfold);</div>
<div class="line"><span class="lineno"> 1654</span><span class="comment">// Typical layout of &#39;sections&#39; in compressed stub code for shared library:</span></div>
<div class="line"><span class="lineno"> 1655</span><span class="comment">//   SO_HEAD</span></div>
<div class="line"><span class="lineno"> 1656</span><span class="comment">//   ptr_NEXT</span></div>
<div class="line"><span class="lineno"> 1657</span><span class="comment">//   EXP_HEAD  NRV getbit(), copy</span></div>
<div class="line"><span class="lineno"> 1658</span><span class="comment">//   NRV2B etc: daisy chain of de-compressor for each method used</span></div>
<div class="line"><span class="lineno"> 1659</span><span class="comment">//   EXP_TAIL  FIXME: unfilter</span></div>
<div class="line"><span class="lineno"> 1660</span><span class="comment">//   SO_TAIL</span></div>
<div class="line"><span class="lineno"> 1661</span><span class="comment">//   SO_MAIN  C-language supervision based on PT_LOADs</span></div>
<div class="line"><span class="lineno"> 1662</span>        <span class="keywordtype">char</span> sec[120]; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(sec, 0, <span class="keyword">sizeof</span>(sec));  <span class="comment">// debug convenience</span></div>
<div class="line"><span class="lineno"> 1663</span>        <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><span class="lineno"> 1664</span>        <span class="keywordtype">unsigned</span> m_decompr = <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> | (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>));</div>
<div class="line"><span class="lineno"> 1665</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(sec, <span class="keyword">sizeof</span>(sec), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;SO_HEAD,ptr_NEXT,EXP_HEAD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1666</span> </div>
<div class="line"><span class="lineno"> 1667</span>        <span class="comment">// Start of dasiy-chain fall-through.</span></div>
<div class="line"><span class="lineno"> 1668</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1669</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2B&quot;</span>);</div>
<div class="line"><span class="lineno"> 1670</span>        }</div>
<div class="line"><span class="lineno"> 1671</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1672</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2D&quot;</span>);</div>
<div class="line"><span class="lineno"> 1673</span>        }</div>
<div class="line"><span class="lineno"> 1674</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1675</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2E&quot;</span>);</div>
<div class="line"><span class="lineno"> 1676</span>        }</div>
<div class="line"><span class="lineno"> 1677</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1678</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>,</div>
<div class="line"><span class="lineno"> 1679</span>                <span class="stringliteral">&quot;LZMA_DAISY,LZMA_ELF00,LZMA_DEC20,LZMA_DEC30&quot;</span>);</div>
<div class="line"><span class="lineno"> 1680</span>        }</div>
<div class="line"><span class="lineno"> 1681</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;EXP_TAIL&quot;</span>);</div>
<div class="line"><span class="lineno"> 1682</span>        <span class="comment">// End of daisy-chain fall-through.</span></div>
<div class="line"><span class="lineno"> 1683</span> </div>
<div class="line"><span class="lineno"> 1684</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;HUMF_L,UMF_LINUX&quot;</span>);</div>
<div class="line"><span class="lineno"> 1685</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">hasLoaderSection</a>(<span class="stringliteral">&quot;STRCON&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 1686</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;STRCON&quot;</span>);</div>
<div class="line"><span class="lineno"> 1687</span>        }</div>
<div class="line"><span class="lineno"> 1688</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;SO_TAIL,SO_MAIN&quot;</span>);</div>
<div class="line"><span class="lineno"> 1689</span>        (void)len;  <span class="comment">// Pacify the anal-retentive static analyzer which hates a good idiom.</span></div>
<div class="line"><span class="lineno"> 1690</span>        <a class="code hl_function" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a>(<span class="stringliteral">&quot;\n%s\n&quot;</span>, sec);</div>
<div class="line"><span class="lineno"> 1691</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(sec, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1692</span>        <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1693</span>        {</div>
<div class="line"><span class="lineno"> 1694</span>            <span class="keywordtype">int</span> sz_unc_int;</div>
<div class="line"><span class="lineno"> 1695</span>            uncLoader = linker-&gt;getLoader(&amp;sz_unc_int);</div>
<div class="line"><span class="lineno"> 1696</span>            sz_unc = sz_unc_int;</div>
<div class="line"><span class="lineno"> 1697</span>        }</div>
<div class="line"><span class="lineno"> 1698</span>        method = <a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>;  <span class="comment">// requires unaligned fetch</span></div>
<div class="line"><span class="lineno"> 1699</span>    }</div>
<div class="line"><span class="lineno"> 1700</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_NONE</div>
<div class="line"><span class="lineno"> 1701</span>         ||  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64</div>
<div class="line"><span class="lineno"> 1702</span>         ||  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_AARCH64</div>
<div class="line"><span class="lineno"> 1703</span>         ||  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_PPC64</div>
<div class="line"><span class="lineno"> 1704</span>         ) { <span class="comment">// main program with ELF2 de-compressor (folded portion)</span></div>
<div class="line"><span class="lineno"> 1705</span>        <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(fold, szfold);</div>
<div class="line"><span class="lineno"> 1706</span>        <span class="keywordtype">char</span> sec[120]; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(sec, 0, <span class="keyword">sizeof</span>(sec));  <span class="comment">// debug convenience</span></div>
<div class="line"><span class="lineno"> 1707</span>        <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><span class="lineno"> 1708</span>        <span class="keywordtype">unsigned</span> m_decompr = <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> | (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>));</div>
<div class="line"><span class="lineno"> 1709</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(sec, <span class="keyword">sizeof</span>(sec), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;.text,EXP_HEAD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1710</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1711</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2B&quot;</span>);</div>
<div class="line"><span class="lineno"> 1712</span>        }</div>
<div class="line"><span class="lineno"> 1713</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1714</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2D&quot;</span>);</div>
<div class="line"><span class="lineno"> 1715</span>        }</div>
<div class="line"><span class="lineno"> 1716</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1717</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2E&quot;</span>);</div>
<div class="line"><span class="lineno"> 1718</span>        }</div>
<div class="line"><span class="lineno"> 1719</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1720</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>,</div>
<div class="line"><span class="lineno"> 1721</span>                <span class="stringliteral">&quot;LZMA_DAISY,LZMA_ELF00,LZMA_DEC20,LZMA_DEC30&quot;</span>);</div>
<div class="line"><span class="lineno"> 1722</span>        }</div>
<div class="line"><span class="lineno"> 1723</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;EXP_TAIL&quot;</span>);</div>
<div class="line"><span class="lineno"> 1724</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">hasLoaderSection</a>(<span class="stringliteral">&quot;SYSCALLS&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 1725</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;SYSCALLS&quot;</span>);</div>
<div class="line"><span class="lineno"> 1726</span>        }</div>
<div class="line"><span class="lineno"> 1727</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">hasLoaderSection</a>(<span class="stringliteral">&quot;STRCON&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 1728</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;STRCON&quot;</span>);</div>
<div class="line"><span class="lineno"> 1729</span>        }</div>
<div class="line"><span class="lineno"> 1730</span>        (void)len;</div>
<div class="line"><span class="lineno"> 1731</span>        <a class="code hl_function" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a>(<span class="stringliteral">&quot;\n%s\n&quot;</span>, sec);</div>
<div class="line"><span class="lineno"> 1732</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(sec, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1733</span>        <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1734</span>        {</div>
<div class="line"><span class="lineno"> 1735</span>            <span class="keywordtype">int</span> sz_unc_int;</div>
<div class="line"><span class="lineno"> 1736</span>            uncLoader = linker-&gt;getLoader(&amp;sz_unc_int);</div>
<div class="line"><span class="lineno"> 1737</span>            sz_unc = sz_unc_int;</div>
<div class="line"><span class="lineno"> 1738</span>        }</div>
<div class="line"><span class="lineno"> 1739</span>        method = <a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>;  <span class="comment">// requires unaligned fetch</span></div>
<div class="line"><span class="lineno"> 1740</span>    }</div>
<div class="line"><span class="lineno"> 1741</span>    <span class="keywordflow">else</span> { <span class="comment">// not shlib: main program with ELF1 de-compressor</span></div>
<div class="line"><span class="lineno"> 1742</span>        cprElfHdr1 <span class="keyword">const</span> *hf = (cprElfHdr1 <span class="keyword">const</span> *)fold;</div>
<div class="line"><span class="lineno"> 1743</span>        <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_type);</div>
<div class="line"><span class="lineno"> 1744</span>        <span class="keywordflow">if</span> (ET_REL == <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno"> 1745</span>            <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(fold, szfold);</div>
<div class="line"><span class="lineno"> 1746</span>            <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(<span class="stringliteral">&quot;.text&quot;</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1747</span>            <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1748</span>            <span class="keywordtype">int</span> sz_unc_int(0);</div>
<div class="line"><span class="lineno"> 1749</span>            uncLoader = linker-&gt;getLoader(&amp;sz_unc_int);</div>
<div class="line"><span class="lineno"> 1750</span>            sz_unc = sz_unc_int;</div>
<div class="line"><span class="lineno"> 1751</span>        }</div>
<div class="line"><span class="lineno"> 1752</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="bsd_8h.html#a942478985eb016311380dee473cc8c3e">ET_EXEC</a> == <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno"> 1753</span>            hf = (cprElfHdr1 <span class="keyword">const</span> *)fold;</div>
<div class="line"><span class="lineno"> 1754</span>            <span class="keywordtype">unsigned</span> fold_hdrlen = <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(hf-&gt;ehdr) +</div>
<div class="line"><span class="lineno"> 1755</span>                <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_phentsize) * <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_phnum);</div>
<div class="line"><span class="lineno"> 1756</span>            <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64) {</div>
<div class="line"><span class="lineno"> 1757</span>                fold_hdrlen = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;hf-&gt;ehdr.e_entry);</div>
<div class="line"><span class="lineno"> 1758</span>            }</div>
<div class="line"><span class="lineno"> 1759</span>            uncLoader = &amp;fold[fold_hdrlen];</div>
<div class="line"><span class="lineno"> 1760</span>            sz_unc = ((szfold &lt; fold_hdrlen) ? 0 : (szfold - fold_hdrlen));</div>
<div class="line"><span class="lineno"> 1761</span>        }</div>
<div class="line"><span class="lineno"> 1762</span>        method = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>;</div>
<div class="line"><span class="lineno"> 1763</span>    }</div>
<div class="line"><span class="lineno"> 1764</span> </div>
<div class="line"><span class="lineno"> 1765</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structb__info.html">b_info</a> h; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h, 0, <span class="keyword">sizeof</span>(h));</div>
<div class="line"><span class="lineno"> 1766</span>    h.b_method = method;</div>
<div class="line"><span class="lineno"> 1767</span>    <span class="comment">// _Ehdr and _Phdr are NOT filtered, so Leave h.b_ftid and h.b_cto8 as zero.</span></div>
<div class="line"><span class="lineno"> 1768</span> </div>
<div class="line"><span class="lineno"> 1769</span>    mb_cprLoader.<a class="code hl_function" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">allocForCompression</a>(<span class="keyword">sizeof</span>(h) + sz_unc);</div>
<div class="line"><span class="lineno"> 1770</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> cprLoader = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)mb_cprLoader;  <span class="comment">// less typing</span></div>
<div class="line"><span class="lineno"> 1771</span> </div>
<div class="line"><span class="lineno"> 1772</span>    h.sz_unc = sz_unc;</div>
<div class="line"><span class="lineno"> 1773</span>    h.sz_cpr = mb_cprLoader.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>();  <span class="comment">// max that upx_compress may use</span></div>
<div class="line"><span class="lineno"> 1774</span>    {</div>
<div class="line"><span class="lineno"> 1775</span>        <span class="keywordtype">int</span> r = <a class="code hl_function" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress</a>(uncLoader, sz_unc, <span class="keyword">sizeof</span>(h) + cprLoader, &amp;sz_cpr,</div>
<div class="line"><span class="lineno"> 1776</span>            <span class="keyword">nullptr</span>, <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(method), 10, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span> );</div>
<div class="line"><span class="lineno"> 1777</span>        h.sz_cpr = sz_cpr;  <span class="comment">// actual length used</span></div>
<div class="line"><span class="lineno"> 1778</span>        <span class="keywordflow">if</span> (r != <a class="code hl_define" href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a> || h.sz_cpr &gt;= h.sz_unc)</div>
<div class="line"><span class="lineno"> 1779</span>            <a class="code hl_function" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a>(<span class="stringliteral">&quot;loader compression failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1780</span>    }</div>
<div class="line"><span class="lineno"> 1781</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h.sz_cpr, h.sz_cpr);</div>
<div class="line"><span class="lineno"> 1782</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h.sz_unc, h.sz_unc);</div>
<div class="line"><span class="lineno"> 1783</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(cprLoader, &amp;h, <span class="keyword">sizeof</span>(h)); <span class="comment">// cprLoader will become FOLDEXEC</span></div>
<div class="line"><span class="lineno"> 1784</span>  }  <span class="comment">// end (0 &lt; szfold)</span></div>
<div class="line"><span class="lineno"> 1785</span> </div>
<div class="line"><span class="lineno"> 1786</span>    <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(proto, szproto, -1, sz_cpr);</div>
<div class="line"><span class="lineno"> 1787</span>    <a class="code hl_function" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a>(<span class="stringliteral">&quot;FOLDEXEC unc=%#x  cpr=%#x\n&quot;</span>, sz_unc, sz_cpr);</div>
<div class="line"><span class="lineno"> 1788</span>    linker-&gt;addSection(<span class="stringliteral">&quot;FOLDEXEC&quot;</span>, mb_cprLoader, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structb__info.html">b_info</a>) + sz_cpr, 0);</div>
<div class="line"><span class="lineno"> 1789</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 1790</span>       &amp;&amp; (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_NONE</div>
<div class="line"><span class="lineno"> 1791</span>          || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64</div>
<div class="line"><span class="lineno"> 1792</span>          || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_AARCH64</div>
<div class="line"><span class="lineno"> 1793</span>          || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_PPC64</div>
<div class="line"><span class="lineno"> 1794</span>          )</div>
<div class="line"><span class="lineno"> 1795</span>    ) {</div>
<div class="line"><span class="lineno"> 1796</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(<span class="stringliteral">&quot;ELFMAINX,ELFMAINZ,FOLDEXEC,IDENTSTR&quot;</span>);</div>
<div class="line"><span class="lineno"> 1797</span>    } <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 1798</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf32_Ehdr::EM_NONE</div>
<div class="line"><span class="lineno"> 1799</span>         ||  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64</div>
<div class="line"><span class="lineno"> 1800</span>         ||  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_AARCH64</div>
<div class="line"><span class="lineno"> 1801</span>         ||  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_PPC64</div>
<div class="line"><span class="lineno"> 1802</span>        ) { <span class="comment">// main program with ELF2 de-compressor</span></div>
<div class="line"><span class="lineno"> 1803</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(<span class="stringliteral">&quot;ELFMAINX,ELFMAINZ,FOLDEXEC,IDENTSTR&quot;</span>);</div>
<div class="line"><span class="lineno"> 1804</span>        <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_PPC64</div>
<div class="line"><span class="lineno"> 1805</span>        &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_ident[Elf64_Ehdr::EI_DATA]==Elf64_Ehdr::ELFDATA2MSB) {</div>
<div class="line"><span class="lineno"> 1806</span>            <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(<span class="stringliteral">&quot;ELFMAINZe&quot;</span>);</div>
<div class="line"><span class="lineno"> 1807</span>        }</div>
<div class="line"><span class="lineno"> 1808</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// main program</span></div>
<div class="line"><span class="lineno"> 1809</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno"> 1810</span>        }</div>
<div class="line"><span class="lineno"> 1811</span>    }</div>
<div class="line"><span class="lineno"> 1812</span>    <span class="keywordflow">else</span> { <span class="comment">// main program with ELF1 de-compressor</span></div>
<div class="line"><span class="lineno"> 1813</span>        <a class="code hl_function" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">addStubEntrySections</a>(ft, <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> | (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>)) );</div>
<div class="line"><span class="lineno"> 1814</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// main program</span></div>
<div class="line"><span class="lineno"> 1815</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno"> 1816</span>        }</div>
<div class="line"><span class="lineno"> 1817</span>    }</div>
<div class="line"><span class="lineno"> 1818</span>    <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1819</span>}</div>
<div class="ttc" id="absd_8h_html_a942478985eb016311380dee473cc8c3e"><div class="ttname"><a href="bsd_8h.html#a942478985eb016311380dee473cc8c3e">ET_EXEC</a></div><div class="ttdeci">#define ET_EXEC</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00273">bsd.h:273</a></div></div>
<div class="ttc" id="aclassMemBuffer_html"><div class="ttname"><a href="classMemBuffer.html">MemBuffer</a></div><div class="ttdoc">MemBuffer.</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00187">membuffer.h:187</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a15705698799e612d2ed4b439837c649a"><div class="ttname"><a href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize</a></div><div class="ttdeci">unsigned getSize() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00208">membuffer.h:208</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_aa7fca1d24644887e92e728c1d3f3785f"><div class="ttname"><a href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression</a></div><div class="ttdeci">void allocForCompression(unsigned uncompressed_size, unsigned extra=0) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8cpp_source.html#l00125">membuffer.cpp:125</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a9448025599860ae8d5773f15c09d73a4"><div class="ttname"><a href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">PackLinuxElf64::elfout</a></div><div class="ttdeci">cprElfHdr4 elfout</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00447">p_lx_elf.h:447</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab000c2eb42eb50ba4dd570fb0e20e4f2"><div class="ttname"><a href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">PackLinuxElf64::defineSymbols</a></div><div class="ttdeci">virtual void defineSymbols(Filter const *) override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00955">p_lx_elf.cpp:955</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aaf175264167b93a8ce865a34937584e6"><div class="ttname"><a href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a></div><div class="ttdeci">unsigned e_type</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00084">p_lx_elf.h:84</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_afe0c06e7772712b8f5cb8a7101a2e052"><div class="ttname"><a href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">PackLinuxElf::addStubEntrySections</a></div><div class="ttdeci">virtual void addStubEntrySections(Filter const *, unsigned m_decompr)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00904">p_lx_elf.cpp:904</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aa33d54bc7392e242453b126d23c3ecbd"><div class="ttname"><a href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">PackUnix::methods_used</a></div><div class="ttdeci">unsigned methods_used</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00104">p_unix.h:104</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a01f3c918e5ce5b4de630d11c703cec05"><div class="ttname"><a href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a></div><div class="ttdeci">PackHeader ph</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00096">packer.h:96</a></div></div>
<div class="ttc" id="aclassPacker_html_a0c72885ba3799acf227862f721ddd5ab"><div class="ttname"><a href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">Packer::hasLoaderSection</a></div><div class="ttdeci">virtual bool hasLoaderSection(const char *name) const</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00815">packer.cpp:815</a></div></div>
<div class="ttc" id="aclassPacker_html_a2c9f88864fd7faa59c8130bd59a811a3"><div class="ttname"><a href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">Packer::relocateLoader</a></div><div class="ttdeci">virtual void relocateLoader()</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00841">packer.cpp:841</a></div></div>
<div class="ttc" id="aclassPacker_html_a4af6a45574697d68421e70baef1c8d8c"><div class="ttname"><a href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">Packer::initLoader</a></div><div class="ttdeci">virtual void initLoader(const void *pdata, int plen, int small=-1, int pextra=0)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00760">packer.cpp:760</a></div></div>
<div class="ttc" id="aclassPacker_html_a516182985490860d361a8266fa418235"><div class="ttname"><a href="classPacker.html#a516182985490860d361a8266fa418235">Packer::addLoader</a></div><div class="ttdeci">void addLoader(C)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00773">packer.cpp:773</a></div></div>
<div class="ttc" id="aclassPacker_html_af9cad2c8624ee68213d01eb606be0382"><div class="ttname"><a href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32</a></div><div class="ttdeci">void set_te32(void *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00266">packer.h:266</a></div></div>
<div class="ttc" id="acompress_8cpp_html_a503ce434d639fefff3eee167b8bc5b64"><div class="ttname"><a href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress</a></div><div class="ttdeci">int upx_compress(const upx_bytep src, unsigned src_len, upx_bytep dst, unsigned *dst_len, upx_callback_t *cb, int method, int level, const upx_compress_config_t *cconf, upx_compress_result_t *cresult)</div><div class="ttdef"><b>Definition:</b> <a href="compress_8cpp_source.html#l00064">compress.cpp:64</a></div></div>
<div class="ttc" id="aconf_8h_html_a019151729ec9d9cd6f87106a18fdfb50"><div class="ttname"><a href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a></div><div class="ttdeci">#define M_LZMA</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00599">conf.h:599</a></div></div>
<div class="ttc" id="aconf_8h_html_a1bbfdab7b8396bae1dcb8f14f235d862"><div class="ttname"><a href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a></div><div class="ttdeci">#define M_NRV2E_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00594">conf.h:594</a></div></div>
<div class="ttc" id="aconf_8h_html_a28d10b43a6177d2d5f9b2e76d728d241"><div class="ttname"><a href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a></div><div class="ttdeci">#define upx_byte</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00185">conf.h:185</a></div></div>
<div class="ttc" id="aconf_8h_html_a3143e9be3cc076994dd57e0c1a2ed4d8"><div class="ttname"><a href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a></div><div class="ttdeci">#define M_NRV2E_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00595">conf.h:595</a></div></div>
<div class="ttc" id="aconf_8h_html_a514895bc5cc851af35523494bbdedc36"><div class="ttname"><a href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a></div><div class="ttdeci">#define M_NRV2B_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00588">conf.h:588</a></div></div>
<div class="ttc" id="aconf_8h_html_a5d201f974fac93da9a7fe4821477ca70"><div class="ttname"><a href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a></div><div class="ttdeci">#define M_NRV2B_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00587">conf.h:587</a></div></div>
<div class="ttc" id="aconf_8h_html_a5fc25c01aa02e925d76494b476074a7d"><div class="ttname"><a href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a></div><div class="ttdeci">#define usizeof(expr)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00484">conf.h:484</a></div></div>
<div class="ttc" id="aconf_8h_html_a6633961dc2e4df53ee07eacffeb154d3"><div class="ttname"><a href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a></div><div class="ttdeci">#define UPX_E_OK</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00513">conf.h:513</a></div></div>
<div class="ttc" id="aconf_8h_html_a71fca72da6661281c6b285f5507da415"><div class="ttname"><a href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a></div><div class="ttdeci">#define M_NRV2D_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00590">conf.h:590</a></div></div>
<div class="ttc" id="aconf_8h_html_a7b1664a2d7051a8e85beaa77e98aa157"><div class="ttname"><a href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a></div><div class="ttdeci">#define M_NRV2B_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00589">conf.h:589</a></div></div>
<div class="ttc" id="aconf_8h_html_a8cfb2c5a5eeaaad5aead9d35339242c8"><div class="ttname"><a href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a></div><div class="ttdeci">#define M_NRV2E_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00593">conf.h:593</a></div></div>
<div class="ttc" id="aconf_8h_html_a9c028313c33deb35227a3e5af1b1513d"><div class="ttname"><a href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a></div><div class="ttdeci">#define M_NRV2D_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00592">conf.h:592</a></div></div>
<div class="ttc" id="aconf_8h_html_aa54a53fd4499f1e86cac93fb7f7b802a"><div class="ttname"><a href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a></div><div class="ttdeci">#define M_NRV2D_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00591">conf.h:591</a></div></div>
<div class="ttc" id="aconf_8h_html_af79eab1f480f5a57b6bfbff38256b0d2"><div class="ttname"><a href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a></div><div class="ttdeci">void NO_printf(const char *,...) noexcept attribute_format(1</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00375">conf.h:375</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a57b532c382fd20e682bf0393b6d63050"><div class="ttname"><a href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a></div><div class="ttdeci">void throwInternalError(const char *msg)</div><div class="ttdoc">other</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00128">except.cpp:128</a></div></div>
<div class="ttc" id="apackhead_8cpp_html_a772d316c45ac4858f5cffa5f842fff49"><div class="ttname"><a href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a></div><div class="ttdeci">int ph_forced_method(int method) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00300">packhead.cpp:300</a></div></div>
<div class="ttc" id="astructPackHeader_html_af1d11217d186dee6524ad3ab35768b0a"><div class="ttname"><a href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a></div><div class="ttdeci">int method</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00052">packhead.h:52</a></div></div>
<div class="ttc" id="astructb__info_html"><div class="ttname"><a href="structb__info.html">b_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00322">bsd.h:322</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a516182985490860d361a8266fa418235">Packer::addLoader()</a>, <a class="el" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">PackLinuxElf::addStubEntrySections()</a>, <a class="el" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression()</a>, <a class="el" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a>, <a class="el" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols()</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="bsd_8h.html#a942478985eb016311380dee473cc8c3e">ET_EXEC</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">Packer::hasLoaderSection()</a>, <a class="el" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">Packer::initLoader()</a>, <a class="el" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>, <a class="el" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>, <a class="el" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>, <a class="el" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>, <a class="el" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>, <a class="el" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>, <a class="el" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>, <a class="el" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>, <a class="el" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>, <a class="el" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a>, <a class="el" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">PackUnix::methods_used</a>, <a class="el" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method()</a>, <a class="el" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">Packer::relocateLoader()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a>, <a class="el" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError()</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, <a class="el" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress()</a>, <a class="el" href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a>, <a class="el" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64amd.html#a4e925c41e1f85114a34b4fec6a0bfc18">PackLinuxElf64amd::buildLoader()</a>, <a class="el" href="classPackLinuxElf64arm.html#a433b6323d27480148574ea89b6ee3634">PackLinuxElf64arm::buildLoader()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#adeb403f68ec4aeb636a5ecf2ce9039f1">PackLinuxElf64ppcle::buildLoader()</a>, and <a class="el" href="classPackLinuxElf64ppc.html#ad2998d239264bc145084afbd56fec5b7">PackLinuxElf64ppc::buildLoader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph" id="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph">
<area shape="rect" title=" " alt="" coords="5,417,200,457"/>
<area shape="rect" href="classPacker.html#a516182985490860d361a8266fa418235" title=" " alt="" coords="569,24,709,49"/>
<area shape="rect" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052" title=" " alt="" coords="261,109,459,149"/>
<area shape="rect" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab" title=" " alt="" coords="546,88,733,113"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="568,156,711,181"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="520,276,759,301"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1179,212,1255,237"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1175,511,1259,536"/>
<area shape="rect" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2" title=" " alt="" coords="248,325,472,351"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="295,424,425,449"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="295,473,425,499"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="285,523,435,548"/>
<area shape="rect" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c" title=" " alt="" coords="291,375,429,400"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="1177,675,1256,700"/>
<area shape="rect" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3" title=" " alt="" coords="275,1047,445,1072"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1147,976,1287,1001"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="296,911,424,936"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="581,620,697,645"/>
<area shape="rect" href="classPacker.html#aaf81a88111b09b6bd3353864484510b7" title=" " alt="" coords="855,24,1013,49"/>
<area shape="rect" href="packhead_8cpp.html#a99fd3f5cbc734f9863205a1e892ea48c" title="ph method util" alt="" coords="853,156,1015,181"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="867,311,1001,336"/>
<area shape="rect" href="classMemBuffer.html#a3dcd6ad1b690292fd215302825ceaf5b" title=" " alt="" coords="807,360,1061,385"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1172,360,1261,385"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1176,580,1257,605"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1109,261,1324,287"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1139,311,1294,336"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1372,460,1491,485"/>
<area shape="rect" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7" title=" " alt="" coords="1171,409,1262,435"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="536,325,743,351"/>
<area shape="rect" href="packer_8cpp.html#afa767aba089a4d3b97fe3a1f391004d0" title="loader util (interface to linker)" alt="" coords="593,473,686,499"/>
<area shape="rect" href="classPacker.html#aa7fe94299cf76c70de7ed953aa774330" title=" " alt="" coords="570,375,709,400"/>
<area shape="rect" href="namespaceupx.html#a0c83095d93809bd5537d12d7217b1b64" title=" " alt="" coords="568,424,711,449"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="910,927,958,952"/>
<area shape="rect" href="util_8cpp.html#a9d6effb3a2dacaed842c2e588220b3d5" title=" " alt="" coords="879,560,989,585"/>
<area shape="rect" href="conf_8h.html#a24c77e0d6845ec1a80a990def321c620" title=" " alt="" coords="863,409,1005,435"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1171,927,1262,952"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="1177,1228,1256,1253"/>
<area shape="rect" href="classPacker.html#a6e094d3b47373817a66457952f26dc70" title=" " alt="" coords="571,961,708,987"/>
<area shape="rect" href="classPacker.html#a5239dbc85d3edd59b558deb94ed8e40d" title=" " alt="" coords="547,1011,732,1051"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="818,1127,1050,1152"/>
<area shape="rect" href="structPackHeader.html#a3c61166ce01a954f2c2ec5c9a563f478" title="see stub/src/include/header.S" alt="" coords="537,1076,742,1101"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1390,1228,1473,1253"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="870,976,998,1001"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1147,1076,1286,1101"/>
<area shape="rect" href="packhead_8cpp.html#a316db91362bd31b5ff8c167f8456ead5" title="extremely simple checksum for the header itself (since version 10)" alt="" coords="835,1228,1033,1253"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="889,1077,979,1103"/>
<area shape="rect" href="bele_8h.html#abc3e7ac42e0d364d55e526be7243cc7f" title=" " alt="" coords="893,725,975,751"/>
<area shape="rect" href="structupx__compress__result__t.html#a92ddd8771e00cf86eedb13cda3e3c52c" title=" " alt="" coords="854,610,1014,650"/>
<area shape="rect" href="compress__lzma_8cpp.html#a16968f66ecd1f6e7a199462fc20b5b9c" title=" " alt="" coords="857,511,1011,536"/>
<area shape="rect" href="compress__ucl_8cpp.html#aee4e34700d3f36ec3ae2aee005649204" title=" " alt="" coords="863,775,1005,800"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph" id="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph">
<area shape="rect" title=" " alt="" coords="211,101,405,141"/>
<area shape="rect" href="classPackLinuxElf64amd.html#a4e925c41e1f85114a34b4fec6a0bfc18" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#a433b6323d27480148574ea89b6ee3634" title=" " alt="" coords="7,69,161,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#adeb403f68ec4aeb636a5ecf2ce9039f1" title=" " alt="" coords="7,133,161,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#ad2998d239264bc145084afbd56fec5b7" title=" " alt="" coords="9,197,159,237"/>
</map>
</div>

</div>
</div>
<a id="af4b086d6062198ab02e25fcc4cd5a2c3" name="af4b086d6062198ab02e25fcc4cd5a2c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b086d6062198ab02e25fcc4cd5a2c3">&#9670;&#160;</a></span>calls_crt1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PackLinuxElf64::calls_crt1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> const *&#160;</td>
          <td class="paramname"><em>rela</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02567">2567</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2568</span>{</div>
<div class="line"><span class="lineno"> 2569</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> || !<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> || !rela) {</div>
<div class="line"><span class="lineno"> 2570</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2571</span>    }</div>
<div class="line"><span class="lineno"> 2572</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> relnum= 0; 0 &lt; sz; (sz -= <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>)), ++rela, ++relnum) {</div>
<div class="line"><span class="lineno"> 2573</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symnum = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_info) &gt;&gt; 32;</div>
<div class="line"><span class="lineno"> 2574</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> symnam = <a class="code hl_function" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name</a>(symnum, relnum);</div>
<div class="line"><span class="lineno"> 2575</span>        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__libc_start_main&quot;</span>)  <span class="comment">// glibc</span></div>
<div class="line"><span class="lineno"> 2576</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__libc_init&quot;</span>)  <span class="comment">// Android</span></div>
<div class="line"><span class="lineno"> 2577</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__uClibc_main&quot;</span>)</div>
<div class="line"><span class="lineno"> 2578</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__uClibc_start_main&quot;</span>))</div>
<div class="line"><span class="lineno"> 2579</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2580</span>    }</div>
<div class="line"><span class="lineno"> 2581</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2582</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a0587b38413f853b20625a28bf2a369e8"><div class="ttname"><a href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">PackLinuxElf64::get_dynsym_name</a></div><div class="ttdeci">char const * get_dynsym_name(unsigned symnum, unsigned relnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02558">p_lx_elf.cpp:2558</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a6ec71c63b3b76a8847d2a5989c2f3fbb"><div class="ttname"><a href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a></div><div class="ttdeci">char const  * dynstr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00095">p_lx_elf.h:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, and <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph" id="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph">
<area shape="rect" title=" " alt="" coords="5,98,196,123"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="244,33,393,73"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="254,98,383,123"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="285,171,352,197"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="441,5,591,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="451,70,581,95"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="639,13,757,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph" id="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,425,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a3f8b3a6d6203c2a09d5058a18423fee2" name="a3f8b3a6d6203c2a09d5058a18423fee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f8b3a6d6203c2a09d5058a18423fee2">&#9670;&#160;</a></span>canPack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tribool PackLinuxElf64::canPack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03347">3347</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3348</span>{</div>
<div class="line"><span class="lineno"> 3349</span>    <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3350</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[<a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>];</div>
<div class="line"><span class="lineno"> 3351</span>        <span class="comment">//struct { Elf64_Ehdr ehdr; Elf64_Phdr phdr; } e;</span></div>
<div class="line"><span class="lineno"> 3352</span>    } u;</div>
<div class="line"><span class="lineno"> 3353</span>    <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(u) &lt;= (2*1024))</div>
<div class="line"><span class="lineno"> 3354</span> </div>
<div class="line"><span class="lineno"> 3355</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;readx(u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, sizeof(u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>));</div>
<div class="line"><span class="lineno"> 3356</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;seek(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3357</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> const *const ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *) u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>;</div>
<div class="line"><span class="lineno"> 3358</span> </div>
<div class="line"><span class="lineno"> 3359</span>    <span class="comment">// now check the ELF header</span></div>
<div class="line"><span class="lineno"> 3360</span>    if (<a class="code hl_function" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr</a>(ehdr) != 0)</div>
<div class="line"><span class="lineno"> 3361</span>        return false;</div>
<div class="line"><span class="lineno"> 3362</span> </div>
<div class="line"><span class="lineno"> 3363</span>    <span class="comment">// additional requirements for linux/elf386</span></div>
<div class="line"><span class="lineno"> 3364</span>    if (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_ehsize) != sizeof(*ehdr)) {</div>
<div class="line"><span class="lineno"> 3365</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;invalid Ehdr e_ehsize; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3366</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3367</span>    }</div>
<div class="line"><span class="lineno"> 3368</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> != <span class="keyword">sizeof</span>(*ehdr)) {<span class="comment">// Phdrs not contiguous with Ehdr</span></div>
<div class="line"><span class="lineno"> 3369</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;non-contiguous Ehdr/Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3370</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3371</span>    }</div>
<div class="line"><span class="lineno"> 3372</span> </div>
<div class="line"><span class="lineno"> 3373</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> max_LOADsz = 0, max_offset = 0;</div>
<div class="line"><span class="lineno"> 3374</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 3375</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3376</span>        <span class="keywordflow">if</span> (j &gt; ((<a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>)) / <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>))) {</div>
<div class="line"><span class="lineno"> 3377</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many ElfXX_Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3378</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3379</span>        }</div>
<div class="line"><span class="lineno"> 3380</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 3381</span>            <span class="comment">// The first PT_LOAD must cover the beginning of the file (0==p_offset).</span></div>
<div class="line"><span class="lineno"> 3382</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 3383</span>            <span class="keywordflow">if</span> (1!= <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a>) {</div>
<div class="line"><span class="lineno"> 3384</span>                <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 1;</div>
<div class="line"><span class="lineno"> 3385</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);  <span class="comment">// class data member</span></div>
<div class="line"><span class="lineno"> 3386</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> off = ~page_mask &amp; <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>;</div>
<div class="line"><span class="lineno"> 3387</span>                <span class="keywordflow">if</span> (off &amp;&amp; off == p_offset) { <span class="comment">// specific hint</span></div>
<div class="line"><span class="lineno"> 3388</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;Go-language PT_LOAD: try hemfix.c, or try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3389</span>                    <span class="comment">// Fixing it inside upx fails because packExtent() reads original file.</span></div>
<div class="line"><span class="lineno"> 3390</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3391</span>                }</div>
<div class="line"><span class="lineno"> 3392</span>                <span class="keywordflow">if</span> (0 != p_offset) { <span class="comment">// 1st PT_LOAD must cover Ehdr and Phdr</span></div>
<div class="line"><span class="lineno"> 3393</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;first PT_LOAD.p_offset != 0; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3394</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3395</span>                }</div>
<div class="line"><span class="lineno"> 3396</span>                <span class="comment">// FIXME: bad for shlib!</span></div>
<div class="line"><span class="lineno"> 3397</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a> = ~3ul &amp; (3+ <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>));</div>
<div class="line"><span class="lineno"> 3398</span>            }</div>
<div class="line"><span class="lineno"> 3399</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>);</div>
<div class="line"><span class="lineno"> 3400</span>            <span class="keywordflow">if</span> (0x200000ul &lt; align) align = 0x200000ul;  <span class="comment">// UPX_MIN type problem</span></div>
<div class="line"><span class="lineno"> 3401</span>            max_LOADsz = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, align);</div>
<div class="line"><span class="lineno"> 3402</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 3403</span>            max_LOADsz = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, filesz);</div>
<div class="line"><span class="lineno"> 3404</span>            max_offset = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_offset, filesz + p_offset);</div>
<div class="line"><span class="lineno"> 3405</span>        }</div>
<div class="line"><span class="lineno"> 3406</span>    }</div>
<div class="line"><span class="lineno"> 3407</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack</a>()) {</div>
<div class="line"><span class="lineno"> 3408</span>        <a class="code hl_function" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a>();</div>
<div class="line"><span class="lineno"> 3409</span>    }</div>
<div class="line"><span class="lineno"> 3410</span>    <span class="comment">// Heuristic for lopped trailing PackHeader (packed and &quot;hacked&quot;!)</span></div>
<div class="line"><span class="lineno"> 3411</span>    <span class="keywordflow">if</span> (3 == <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>  <span class="comment">// not shlib: PT_LOAD.C_BASE, PT_LOAD.C_TEXT, PT_GNU_STACK</span></div>
<div class="line"><span class="lineno"> 3412</span>    &amp;&amp; <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> == <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;((<a class="code hl_struct" href="structl__info.html">l_info</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>])-&gt;l_magic)) {</div>
<div class="line"><span class="lineno"> 3413</span>        <a class="code hl_function" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a>();</div>
<div class="line"><span class="lineno"> 3414</span>    }</div>
<div class="line"><span class="lineno"> 3415</span>    <span class="comment">// We want to compress position-independent executable (gcc -pie)</span></div>
<div class="line"><span class="lineno"> 3416</span>    <span class="comment">// main programs, but compressing a shared library must be avoided</span></div>
<div class="line"><span class="lineno"> 3417</span>    <span class="comment">// because the result is no longer usable.  In theory, there is no way</span></div>
<div class="line"><span class="lineno"> 3418</span>    <span class="comment">// to tell them apart: both are just ET_DYN.  Also in theory,</span></div>
<div class="line"><span class="lineno"> 3419</span>    <span class="comment">// neither the presence nor the absence of any particular symbol name</span></div>
<div class="line"><span class="lineno"> 3420</span>    <span class="comment">// can be used to tell them apart; there are counterexamples.</span></div>
<div class="line"><span class="lineno"> 3421</span>    <span class="comment">// However, we will use the following heuristic suggested by</span></div>
<div class="line"><span class="lineno"> 3422</span>    <span class="comment">// Peter S. Mazinger &lt;ps.m@gmx.net&gt; September 2005:</span></div>
<div class="line"><span class="lineno"> 3423</span>    <span class="comment">// If a ET_DYN has __libc_start_main as a global undefined symbol,</span></div>
<div class="line"><span class="lineno"> 3424</span>    <span class="comment">// then the file is a position-independent executable main program</span></div>
<div class="line"><span class="lineno"> 3425</span>    <span class="comment">// (that depends on libc.so.6) and is eligible to be compressed.</span></div>
<div class="line"><span class="lineno"> 3426</span>    <span class="comment">// Otherwise (no __libc_start_main as global undefined): skip it.</span></div>
<div class="line"><span class="lineno"> 3427</span>    <span class="comment">// Also allow  __uClibc_main  and  __uClibc_start_main .</span></div>
<div class="line"><span class="lineno"> 3428</span> </div>
<div class="line"><span class="lineno"> 3429</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_DYN==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_type)) {</div>
<div class="line"><span class="lineno"> 3430</span>        <span class="comment">// The DT_SYMTAB has no designated length.  Read the whole file.</span></div>
<div class="line"><span class="lineno"> 3431</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 3432</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3433</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 3434</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, ehdr, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 3435</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>= (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)((<span class="keywordtype">size_t</span>)<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 3436</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)((<span class="keywordtype">size_t</span>)<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 3437</span> </div>
<div class="line"><span class="lineno"> 3438</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3439</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3440</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno"> 3441</span>            <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_shstrndx);</div>
<div class="line"><span class="lineno"> 3442</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) {</div>
<div class="line"><span class="lineno"> 3443</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) {</div>
<div class="line"><span class="lineno"> 3444</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3445</span>                        <span class="stringliteral">&quot;bad e_shstrndx %#x &gt;= e_shnum %d&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 3446</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3447</span>                }</div>
<div class="line"><span class="lineno"> 3448</span>                <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>];</div>
<div class="line"><span class="lineno"> 3449</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 3450</span>                <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 3451</span>                    <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3452</span>                        <span class="stringliteral">&quot;bad .e_shstrndx-&gt;sh_offset %#lx&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)sh_offset);</div>
<div class="line"><span class="lineno"> 3453</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3454</span>                }</div>
<div class="line"><span class="lineno"> 3455</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(sh_offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 3456</span>            }</div>
<div class="line"><span class="lineno"> 3457</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 3458</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 3459</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_link = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_link);</div>
<div class="line"><span class="lineno"> 3460</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= sh_link) {</div>
<div class="line"><span class="lineno"> 3461</span>                    <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3462</span>                        <span class="stringliteral">&quot;bad SHT_DYNSYM.sh_link %#x&quot;</span>, sh_link);</div>
<div class="line"><span class="lineno"> 3463</span>                }</div>
<div class="line"><span class="lineno"> 3464</span>                <a class="code hl_variable" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[sh_link];</div>
<div class="line"><span class="lineno"> 3465</span>            }</div>
<div class="line"><span class="lineno"> 3466</span> </div>
<div class="line"><span class="lineno"> 3467</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>) {</div>
<div class="line"><span class="lineno"> 3468</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_name);</div>
<div class="line"><span class="lineno"> 3469</span>                <span class="keywordflow">if</span> (Elf64_Shdr::SHT_STRTAB != <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_type)</div>
<div class="line"><span class="lineno"> 3470</span>                || (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= (<span class="keyword">sizeof</span>(<span class="stringliteral">&quot;.shstrtab&quot;</span>)</div>
<div class="line"><span class="lineno"> 3471</span>                    + sh_name + (<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> - (<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0]))</div>
<div class="line"><span class="lineno"> 3472</span>                || (sh_name</div>
<div class="line"><span class="lineno"> 3473</span>                  &amp;&amp; 0!=<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>((<span class="keywordtype">char</span> <span class="keyword">const</span> *)<span class="stringliteral">&quot;.shstrtab&quot;</span>, &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[sh_name]))</div>
<div class="line"><span class="lineno"> 3474</span>                ) {</div>
<div class="line"><span class="lineno"> 3475</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad e_shstrtab&quot;</span>);</div>
<div class="line"><span class="lineno"> 3476</span>                }</div>
<div class="line"><span class="lineno"> 3477</span>            }</div>
<div class="line"><span class="lineno"> 3478</span>        }</div>
<div class="line"><span class="lineno"> 3479</span> </div>
<div class="line"><span class="lineno"> 3480</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *pload_x0(<span class="keyword">nullptr</span>);  <span class="comment">// first eXecutable PT_LOAD</span></div>
<div class="line"><span class="lineno"> 3481</span>        phdr= <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 3482</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ++phdr)</div>
<div class="line"><span class="lineno"> 3483</span>        <span class="keywordflow">if</span> (Elf64_Phdr::PT_DYNAMIC==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 3484</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic</a>(phdr);</div>
<div class="line"><span class="lineno"> 3485</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>= (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 3486</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>,</div>
<div class="line"><span class="lineno"> 3487</span>                <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>), <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - offset));</div>
<div class="line"><span class="lineno"> 3488</span>        }</div>
<div class="line"><span class="lineno"> 3489</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 3490</span>            <span class="keywordflow">if</span> (!pload_x0</div>
<div class="line"><span class="lineno"> 3491</span>            &amp;&amp;  Elf64_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>)</div>
<div class="line"><span class="lineno"> 3492</span>            ) {</div>
<div class="line"><span class="lineno"> 3493</span>                pload_x0 = phdr;</div>
<div class="line"><span class="lineno"> 3494</span>            }</div>
<div class="line"><span class="lineno"> 3495</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load</a>(phdr);</div>
<div class="line"><span class="lineno"> 3496</span>        }</div>
<div class="line"><span class="lineno"> 3497</span>        <span class="keywordflow">if</span> (!pload_x0) {</div>
<div class="line"><span class="lineno"> 3498</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;No PT_LOAD has (p_flags &amp; PF_X)&quot;</span>);</div>
<div class="line"><span class="lineno"> 3499</span>        }</div>
<div class="line"><span class="lineno"> 3500</span>        <span class="comment">// elf_find_dynamic() returns 0 if 0==dynseg.</span></div>
<div class="line"><span class="lineno"> 3501</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>=          (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 3502</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> <span class="comment">/*const*/</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_SYMTAB);</div>
<div class="line"><span class="lineno"> 3503</span> </div>
<div class="line"><span class="lineno"> 3504</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.force_pie</div>
<div class="line"><span class="lineno"> 3505</span>        ||       Elf64_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_FLAGS_1)</div>
<div class="line"><span class="lineno"> 3506</span>        ||  <a class="code hl_function" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1</a>((<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_RELA),</div>
<div class="line"><span class="lineno"> 3507</span>                                  (<span class="keywordtype">int</span>)<a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELASZ))</div>
<div class="line"><span class="lineno"> 3508</span>        ||  <a class="code hl_function" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1</a>((<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_JMPREL),</div>
<div class="line"><span class="lineno"> 3509</span>                                  (<span class="keywordtype">int</span>)<a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_PLTRELSZ))) {</div>
<div class="line"><span class="lineno"> 3510</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">is_pie</a> = <span class="keyword">true</span>;  <span class="comment">// UNUSED except to ignore is_shlib and xct_off</span></div>
<div class="line"><span class="lineno"> 3511</span>            <span class="keywordflow">goto</span> proceed;  <span class="comment">// calls C library init for main program</span></div>
<div class="line"><span class="lineno"> 3512</span>        }</div>
<div class="line"><span class="lineno"> 3513</span> </div>
<div class="line"><span class="lineno"> 3514</span>        <span class="comment">// Heuristic HACK for shared libraries (compare Darwin (MacOS) Dylib.)</span></div>
<div class="line"><span class="lineno"> 3515</span>        <span class="comment">// If there is an existing DT_INIT, and if everything that the dynamic</span></div>
<div class="line"><span class="lineno"> 3516</span>        <span class="comment">// linker ld-linux needs to perform relocations before calling DT_INIT</span></div>
<div class="line"><span class="lineno"> 3517</span>        <span class="comment">// resides below the first SHT_EXECINSTR Section in one PT_LOAD, then</span></div>
<div class="line"><span class="lineno"> 3518</span>        <span class="comment">// compress from the first executable Section to the end of that PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 3519</span>        <span class="comment">// We must not alter anything that ld-linux might touch before it calls</span></div>
<div class="line"><span class="lineno"> 3520</span>        <span class="comment">// the DT_INIT function.</span></div>
<div class="line"><span class="lineno"> 3521</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3522</span>        <span class="comment">// Obviously this hack requires that the linker script put pieces</span></div>
<div class="line"><span class="lineno"> 3523</span>        <span class="comment">// into good positions when building the original shared library,</span></div>
<div class="line"><span class="lineno"> 3524</span>        <span class="comment">// and also requires ld-linux to behave.</span></div>
<div class="line"><span class="lineno"> 3525</span> </div>
<div class="line"><span class="lineno"> 3526</span>        <span class="keywordflow">if</span> (<span class="comment">/*jni_onload_sym ||*/</span> <a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>)) {</div>
<div class="line"><span class="lineno"> 3527</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic</a>(Elf64_Dyn::DT_TEXTREL)) {</div>
<div class="line"><span class="lineno"> 3528</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;DT_TEXTREL found; re-compile with -fPIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 3529</span>                <span class="keywordflow">goto</span> abandon;</div>
<div class="line"><span class="lineno"> 3530</span>            }</div>
<div class="line"><span class="lineno"> 3531</span>            <span class="keywordflow">if</span> (!(Elf64_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_FLAGS_1))) {</div>
<div class="line"><span class="lineno"> 3532</span>                <span class="comment">// not explicitly PIE main program</span></div>
<div class="line"><span class="lineno"> 3533</span>                <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>  <span class="comment">// Android is common</span></div>
<div class="line"><span class="lineno"> 3534</span>                &amp;&amp;  !<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib  <span class="comment">// but not explicit</span></div>
<div class="line"><span class="lineno"> 3535</span>                &amp;&amp;    !<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a></div>
<div class="line"><span class="lineno"> 3536</span>                ) {</div>
<div class="line"><span class="lineno"> 3537</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode++;</div>
<div class="line"><span class="lineno"> 3538</span>                    <a class="code hl_function" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a>(<span class="stringliteral">&quot;note: use --android-shlib if appropriate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3539</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode--;</div>
<div class="line"><span class="lineno"> 3540</span>                }</div>
<div class="line"><span class="lineno"> 3541</span>            }</div>
<div class="line"><span class="lineno"> 3542</span>            <span class="keywordflow">if</span> (Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine)) {</div>
<div class="line"><span class="lineno"> 3543</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;This test UPX cannot pack .so for PowerPC64; coming soon.&quot;</span>);</div>
<div class="line"><span class="lineno"> 3544</span>            }</div>
<div class="line"><span class="lineno"> 3545</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = ~(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)0;</div>
<div class="line"><span class="lineno"> 3546</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno"> 3547</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = <a class="code hl_function" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">canPack_Shdr</a>(pload_x0);</div>
<div class="line"><span class="lineno"> 3548</span>            }</div>
<div class="line"><span class="lineno"> 3549</span>            <span class="keywordflow">else</span> { <span class="comment">// no Sections; use heuristics</span></div>
<div class="line"><span class="lineno"> 3550</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> strsz  = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRSZ);</div>
<div class="line"><span class="lineno"> 3551</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> strtab = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 3552</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> relsz  = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELSZ);</div>
<div class="line"><span class="lineno"> 3553</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> rel    = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_REL);</div>
<div class="line"><span class="lineno"> 3554</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> init   = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>);</div>
<div class="line"><span class="lineno"> 3555</span>                <span class="keywordflow">if</span> ((init == (relsz + rel   ) &amp;&amp; rel    == (strsz + strtab))</div>
<div class="line"><span class="lineno"> 3556</span>                ||  (init == (strsz + strtab) &amp;&amp; strtab == (relsz + rel   ))</div>
<div class="line"><span class="lineno"> 3557</span>                ) {</div>
<div class="line"><span class="lineno"> 3558</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = init;</div>
<div class="line"><span class="lineno"> 3559</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = init;</div>
<div class="line"><span class="lineno"> 3560</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(init);</div>
<div class="line"><span class="lineno"> 3561</span>                }</div>
<div class="line"><span class="lineno"> 3562</span>            }</div>
<div class="line"><span class="lineno"> 3563</span>            <span class="comment">// Rely on 0==elf_unsigned_dynamic(tag) if no such tag.</span></div>
<div class="line"><span class="lineno"> 3564</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> va_gash = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 3565</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> va_hash = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 3566</span>            <span class="keywordtype">unsigned</span> y = 0;</div>
<div class="line"><span class="lineno"> 3567</span>            <span class="keywordflow">if</span> ((y=1, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; va_gash)  ||  (y=2, (0==va_gash &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; va_hash))</div>
<div class="line"><span class="lineno"> 3568</span>            ||  (y=3, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRTAB))</div>
<div class="line"><span class="lineno"> 3569</span>            ||  (y=4, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_SYMTAB))</div>
<div class="line"><span class="lineno"> 3570</span>            ||  (y=5, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_REL))</div>
<div class="line"><span class="lineno"> 3571</span>            ||  (y=6, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELA))</div>
<div class="line"><span class="lineno"> 3572</span>            ||  (y=7, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_JMPREL))</div>
<div class="line"><span class="lineno"> 3573</span>            ||  (y=8, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERDEF))</div>
<div class="line"><span class="lineno"> 3574</span>            ||  (y=9, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERSYM))</div>
<div class="line"><span class="lineno"> 3575</span>            ||  (y=10, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERNEED)) ) {</div>
<div class="line"><span class="lineno"> 3576</span>                <span class="keyword">static</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *which[] = {</div>
<div class="line"><span class="lineno"> 3577</span>                    <span class="stringliteral">&quot;unknown&quot;</span>,</div>
<div class="line"><span class="lineno"> 3578</span>                    <span class="stringliteral">&quot;DT_GNU_HASH&quot;</span>,</div>
<div class="line"><span class="lineno"> 3579</span>                    <span class="stringliteral">&quot;DT_HASH&quot;</span>,</div>
<div class="line"><span class="lineno"> 3580</span>                    <span class="stringliteral">&quot;DT_STRTAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 3581</span>                    <span class="stringliteral">&quot;DT_SYMTAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 3582</span>                    <span class="stringliteral">&quot;DT_REL&quot;</span>,</div>
<div class="line"><span class="lineno"> 3583</span>                    <span class="stringliteral">&quot;DT_RELA&quot;</span>,</div>
<div class="line"><span class="lineno"> 3584</span>                    <span class="stringliteral">&quot;DT_JMPREL&quot;</span>,</div>
<div class="line"><span class="lineno"> 3585</span>                    <span class="stringliteral">&quot;DT_VERDEF&quot;</span>,</div>
<div class="line"><span class="lineno"> 3586</span>                    <span class="stringliteral">&quot;DT_VERSYM&quot;</span>,</div>
<div class="line"><span class="lineno"> 3587</span>                    <span class="stringliteral">&quot;DT_VERNEED&quot;</span>,</div>
<div class="line"><span class="lineno"> 3588</span>                };</div>
<div class="line"><span class="lineno"> 3589</span>                <span class="keywordtype">char</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[30]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>), <span class="stringliteral">&quot;%s above stub&quot;</span>, which[y]);</div>
<div class="line"><span class="lineno"> 3590</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>);</div>
<div class="line"><span class="lineno"> 3591</span>                <span class="keywordflow">goto</span> abandon;</div>
<div class="line"><span class="lineno"> 3592</span>            }</div>
<div class="line"><span class="lineno"> 3593</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>);</div>
<div class="line"><span class="lineno"> 3594</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;debug.debug_level) {</div>
<div class="line"><span class="lineno"> 3595</span>                fprintf(stderr, <span class="stringliteral">&quot;shlib canPack: xct_va=%#lx  xct_off=%#lx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3596</span>                    (<span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>, (<span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 3597</span>            }</div>
<div class="line"><span class="lineno"> 3598</span>            <span class="keywordflow">goto</span> proceed;  <span class="comment">// But proper packing depends on checking xct_va.</span></div>
<div class="line"><span class="lineno"> 3599</span>        }</div>
<div class="line"><span class="lineno"> 3600</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3601</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;need DT_INIT; try \&quot;void _init(void){}\&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3602</span>        }</div>
<div class="line"><span class="lineno"> 3603</span>abandon:</div>
<div class="line"><span class="lineno"> 3604</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3605</span>proceed: ;</div>
<div class="line"><span class="lineno"> 3606</span>    }</div>
<div class="line"><span class="lineno"> 3607</span>    <span class="comment">// XXX Theoretically the following test should be first,</span></div>
<div class="line"><span class="lineno"> 3608</span>    <span class="comment">// but PackUnix::canPack() wants 0!=exetype ?</span></div>
<div class="line"><span class="lineno"> 3609</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">super::canPack</a>())</div>
<div class="line"><span class="lineno"> 3610</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3611</span>    assert(<a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> == 1);</div>
<div class="line"><span class="lineno"> 3612</span>    <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 0;</div>
<div class="line"><span class="lineno"> 3613</span> </div>
<div class="line"><span class="lineno"> 3614</span>    <span class="comment">// set options</span></div>
<div class="line"><span class="lineno"> 3615</span>    <span class="comment">// this-&gt;blocksize: avoid over-allocating.</span></div>
<div class="line"><span class="lineno"> 3616</span>    <span class="comment">// (file_size - max_offset): debug info, non-globl symbols, etc.</span></div>
<div class="line"><span class="lineno"> 3617</span>    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.blocksize = <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - max_offset);</div>
<div class="line"><span class="lineno"> 3618</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3619</span>}</div>
<div class="ttc" id="abele_8h_html_a975f8af4219a9c95cf3395cbd46fc472"><div class="ttname"><a href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_le32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00327">bele.h:327</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a0e16265acea35917d1e57a65fb5ffc70"><div class="ttname"><a href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">PackLinuxElf64::e_shoff</a></div><div class="ttdeci">upx_uint64_t e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00407">p_lx_elf.h:407</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a34544f047b9808c7416a3a3666a7d6bb"><div class="ttname"><a href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">PackLinuxElf64::invert_pt_dynamic</a></div><div class="ttdeci">void invert_pt_dynamic(Elf64_Dyn const *, upx_uint64_t dt_filesz)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08421">p_lx_elf.cpp:8421</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a4204f3ad0b4eff8655e10f62ac640a22"><div class="ttname"><a href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">PackLinuxElf64::elf_unsigned_dynamic</a></div><div class="ttdeci">virtual upx_uint64_t elf_unsigned_dynamic(unsigned) const override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08244">p_lx_elf.cpp:8244</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a5d86b1c186506105d0a1143fd364c014"><div class="ttname"><a href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">PackLinuxElf64::check_pt_dynamic</a></div><div class="ttdeci">upx_uint64_t check_pt_dynamic(Elf64_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08316">p_lx_elf.cpp:8316</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a5e4e0a8150ba291145c388c9c00705ec"><div class="ttname"><a href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">PackLinuxElf64::is_LOAD</a></div><div class="ttdeci">int is_LOAD(Elf64_Phdr const *phdr) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00270">p_lx_elf.cpp:270</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a5fb0d975feeb7b1b02f9e4a22ab227ed"><div class="ttname"><a href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">PackLinuxElf64::elf_has_dynamic</a></div><div class="ttdeci">Elf64_Dyn const * elf_has_dynamic(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08305">p_lx_elf.cpp:8305</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a71bc2f0e1a1ec856b3f9a08b63add0ae"><div class="ttname"><a href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">PackLinuxElf64::canUnpack</a></div><div class="ttdeci">virtual tribool canUnpack() override</div><div class="ttdoc">Generic Unix canUnpack().</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03330">p_lx_elf.cpp:3330</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_aa31c4b9fe8bb49ee9fa220b0c1d149bd"><div class="ttname"><a href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">PackLinuxElf64::canPack_Shdr</a></div><div class="ttdeci">virtual upx_uint64_t canPack_Shdr(Elf64_Phdr const *pload_x0)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02877">p_lx_elf.cpp:2877</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab26dade234148980bd9f8a06ee31bf3c"><div class="ttname"><a href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">PackLinuxElf64::checkEhdr</a></div><div class="ttdeci">virtual int checkEhdr(Elf64_Ehdr const *ehdr) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00195">p_lx_elf.cpp:195</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad1befccbbdde5d8977b9d2e5883507d4"><div class="ttname"><a href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">PackLinuxElf64::elf_find_dynamic</a></div><div class="ttdeci">void * elf_find_dynamic(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08231">p_lx_elf.cpp:8231</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ae528cb01cbf686b624e2fffe159ad5b6"><div class="ttname"><a href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">PackLinuxElf64::check_pt_load</a></div><div class="ttdeci">upx_uint64_t check_pt_load(Elf64_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08285">p_lx_elf.cpp:8285</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af4b086d6062198ab02e25fcc4cd5a2c3"><div class="ttname"><a href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">PackLinuxElf64::calls_crt1</a></div><div class="ttdeci">bool calls_crt1(Elf64_Rela const *rela, int sz)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02567">p_lx_elf.cpp:2567</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af80d289e1d9fe56882aa494f2afc0e9b"><div class="ttname"><a href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">PackLinuxElf64::elf_find_section_type</a></div><div class="ttdeci">Elf64_Shdr * elf_find_section_type(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02531">p_lx_elf.cpp:2531</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3bb9134e6f6d635119bbce8ee9fc2cc0"><div class="ttname"><a href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a></div><div class="ttdeci">upx_uint64_t user_init_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00112">p_lx_elf.h:112</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a5789e03712ad5c821ed718be76cb006a"><div class="ttname"><a href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a></div><div class="ttdeci">unsigned upx_dt_init</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00125">p_lx_elf.h:125</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a59a59994ceb7e3d20444f07a08cd1cfe"><div class="ttname"><a href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a></div><div class="ttdeci">unsigned user_init_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00115">p_lx_elf.h:115</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a9f6c41a7dc3caa60ac369d2776ee5a12"><div class="ttname"><a href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">PackLinuxElf::is_pie</a></div><div class="ttdeci">bool is_pie</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00103">p_lx_elf.h:103</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aa692858672c20488c367295681b28422"><div class="ttname"><a href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a></div><div class="ttdeci">upx_uint64_t load_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00109">p_lx_elf.h:109</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aac769941a308e20fdce0e86d1ec3b2f3"><div class="ttname"><a href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a></div><div class="ttdeci">unsigned hatch_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00106">p_lx_elf.h:106</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_afcc48dc344bb8340e9691a43d45f8458"><div class="ttname"><a href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a></div><div class="ttdeci">unsigned e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00087">p_lx_elf.h:87</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a3408c180ca78a03f0c06da6c8c25dc34"><div class="ttname"><a href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a></div><div class="ttdeci">unsigned blocksize</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00094">p_unix.h:94</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a449871a4fd2081e1399999ef05741f92"><div class="ttname"><a href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a></div><div class="ttdeci">int exetype</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00093">p_unix.h:93</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a8ab714a14f4ff2f120107dfc08b2a3a5"><div class="ttname"><a href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a></div><div class="ttdeci">unsigned saved_opt_android_shlib</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00106">p_unix.h:106</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a935b7961d8278ae7b19c53d6ef3fe3cf"><div class="ttname"><a href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix::canPack</a></div><div class="ttdeci">virtual tribool canPack() override</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00070">p_unix.cpp:70</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a0306ca7a6b44bd2b88bda7eefa46d49b"><div class="ttname"><a href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a></div><div class="ttdeci">InputFile *const fi</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00084">packer.h:84</a></div></div>
<div class="ttc" id="aconf_8h_html_a2ce9aaa3ef74889b5352e4a6025db5bc"><div class="ttname"><a href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a></div><div class="ttdeci">#define UPX_MAGIC_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00509">conf.h:509</a></div></div>
<div class="ttc" id="aconf_8h_html_a92f0ba69c0f889de4efac3dea2b0cc8a"><div class="ttname"><a href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT(e)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00237">conf.h:237</a></div></div>
<div class="ttc" id="aconf_8h_html_aafadbc56bd61f1a892099d70ff71b6e4"><div class="ttname"><a href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a></div><div class="ttdeci">#define UPX_MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00488">conf.h:488</a></div></div>
<div class="ttc" id="aconf_8h_html_af1fdeecf9ad80f9618354edc154be54a"><div class="ttname"><a href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a></div><div class="ttdeci">void void void void void info(const char *format,...) attribute_format(1</div></div>
<div class="ttc" id="aexcept_8cpp_html_a263a7fe48ef7383a4fd0b9daf6c317fa"><div class="ttname"><a href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a></div><div class="ttdeci">void throwAlreadyPacked(const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00097">except.cpp:97</a></div></div>
<div class="ttc" id="anamespaceupx_html_a79bf3f180bc97aea86be54634b455c77"><div class="ttname"><a href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">upx::umin</a></div><div class="ttdeci">forceinline constexpr T umin(const T &amp;a, const T &amp;b) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cxxlib_8h_source.html#l00250">cxxlib.h:250</a></div></div>
<div class="ttc" id="aoptions_8cpp_html_a887b9edd7a68b4cde1de1f0d7ac1d6eb"><div class="ttname"><a href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a></div><div class="ttdeci">#define opt</div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a34f9d3637288371175e78109dfbabef4"><div class="ttname"><a href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a></div><div class="ttdeci">static void alloc_file_image(MemBuffer &amp;mb, off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00138">p_lx_elf.cpp:138</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a5c15cec3b8e2056be6bf0b188bae4f82"><div class="ttname"><a href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a></div><div class="ttdeci">static constexpr unsigned MAX_ELF_HDR_64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00063">p_lx_elf.cpp:63</a></div></div>
<div class="ttc" id="ap__lx__elf_8h_html_a68e5abb5d6e413b99c6e37512b057090"><div class="ttname"><a href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a></div><div class="ttdeci">upx_uint32_t u32_t</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00037">p_lx_elf.h:37</a></div></div>
<div class="ttc" id="ap__lx__elf_8h_html_add593f4cfdc5ddcbd94ea2638b7a96e7"><div class="ttname"><a href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a></div><div class="ttdeci">upx_uint64_t u64_t</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00038">p_lx_elf.h:38</a></div></div>
<div class="ttc" id="ap__unix_8cpp_html_aa29b866765bdc5bdf87b7eb666d66093"><div class="ttname"><a href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a></div><div class="ttdeci">#define buf</div></div>
<div class="ttc" id="astructElf64__Phdr_html_a55fae01175fc4e3f1c23e52b14459235"><div class="ttname"><a href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a></div><div class="ttdeci">Elf64_Xword p_memsz</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00243">bsd.h:243</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_aa89a4b1835998c8866e821d777a2f879"><div class="ttname"><a href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a></div><div class="ttdeci">Elf64_Xword p_align</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00244">bsd.h:244</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_ab96e7784733c2192a76d5a42897cb38b"><div class="ttname"><a href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a></div><div class="ttdeci">Elf64_Word p_flags</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00238">bsd.h:238</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_aee6ec430eaaf8b8faf82ae6397282cb3"><div class="ttname"><a href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a></div><div class="ttdeci">Elf64_Word p_type</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00237">bsd.h:237</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_af50e5756da2acda5ccb02ebaa3367092"><div class="ttname"><a href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a></div><div class="ttdeci">Elf64_Xword p_filesz</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00242">bsd.h:242</a></div></div>
<div class="ttc" id="astructl__info_html"><div class="ttname"><a href="structl__info.html">l_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00331">bsd.h:332</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image()</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1()</a>, <a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix::canPack()</a>, <a class="el" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">canPack_Shdr()</a>, <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load()</a>, <a class="el" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr()</a>, <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a>, <a class="el" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">PackLinuxElf::is_pie</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked()</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a>, <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph" id="aclassPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph">
<area shape="rect" title=" " alt="" coords="5,1759,187,1785"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="764,605,892,630"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1707,505,1825,530"/>
<area shape="rect" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3" title=" " alt="" coords="239,2234,430,2259"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1701,2022,1831,2047"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1701,1378,1831,1403"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="547,2341,613,2366"/>
<area shape="rect" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf" title=" " alt="" coords="509,278,651,303"/>
<area shape="rect" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa" title=" " alt="" coords="987,101,1141,126"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="767,278,889,303"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="769,353,887,378"/>
<area shape="rect" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd" title=" " alt="" coords="1436,101,1653,126"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="235,1658,435,1683"/>
<area shape="rect" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c" title=" " alt="" coords="483,1835,677,1861"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="999,1810,1129,1835"/>
<area shape="rect" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014" title=" " alt="" coords="1461,935,1628,975"/>
<area shape="rect" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6" title=" " alt="" coords="1209,823,1376,863"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="991,1276,1137,1316"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="1197,1543,1388,1583"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="1453,1837,1636,1862"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="1220,1828,1365,1868"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="745,1367,911,1407"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="1217,1364,1368,1404"/>
<area shape="rect" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed" title=" " alt="" coords="1472,2093,1617,2133"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="295,2442,374,2467"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="311,2491,358,2517"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="295,2565,374,2590"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="1226,673,1359,698"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="989,706,1139,731"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="1208,1111,1377,1137"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="979,554,1149,579"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1040,505,1088,530"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1500,454,1589,479"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1507,673,1583,698"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="1218,2291,1367,2331"/>
<area shape="rect" href="classPacker.html#a14b9cb85a2382ebc043228597992283b" title=" " alt="" coords="725,151,931,177"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="1007,251,1121,277"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="989,202,1139,227"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1224,302,1361,327"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="1006,353,1122,378"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="1702,126,1830,151"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="1702,77,1830,102"/>
<area shape="rect" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack()." alt="" coords="489,1633,671,1658"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="483,1003,677,1043"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="759,403,897,429"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="786,1658,870,1683"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="1472,1313,1617,1353"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="991,1441,1137,1481"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="987,1212,1141,1252"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="539,2442,621,2467"/>
</map>
</div>

</div>
</div>
<a id="aa31c4b9fe8bb49ee9fa220b0c1d149bd" name="aa31c4b9fe8bb49ee9fa220b0c1d149bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31c4b9fe8bb49ee9fa220b0c1d149bd">&#9670;&#160;</a></span>canPack_Shdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::canPack_Shdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>pload_x0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02877">2877</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2878</span>{</div>
<div class="line"><span class="lineno"> 2879</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *shdr_xva = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2880</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 2881</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; --j&gt;=0; ++shdr) {</div>
<div class="line"><span class="lineno"> 2882</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 2883</span>    <span class="keywordflow">if</span> (Elf64_Shdr::SHF_EXECINSTR &amp; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags)) {</div>
<div class="line"><span class="lineno"> 2884</span>        shdr_xva = shdr;</div>
<div class="line"><span class="lineno"> 2885</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>, <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr));</div>
<div class="line"><span class="lineno"> 2886</span>    }</div>
<div class="line"><span class="lineno"> 2887</span>    <span class="comment">// Hook the first slot of DT_PREINIT_ARRAY or DT_INIT_ARRAY.</span></div>
<div class="line"><span class="lineno"> 2888</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> &amp;&amp; (</div>
<div class="line"><span class="lineno"> 2889</span>           (     Elf64_Dyn::DT_PREINIT_ARRAY==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></div>
<div class="line"><span class="lineno"> 2890</span>           &amp;&amp;  Elf64_Shdr::SHT_PREINIT_ARRAY==sh_type)</div>
<div class="line"><span class="lineno"> 2891</span>        || (     Elf64_Dyn::DT_INIT_ARRAY   ==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></div>
<div class="line"><span class="lineno"> 2892</span>           &amp;&amp;  Elf64_Shdr::SHT_INIT_ARRAY   ==sh_type) )) {</div>
<div class="line"><span class="lineno"> 2893</span>        <span class="keywordtype">unsigned</span> user_init_ava = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 2894</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 2895</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>) {</div>
<div class="line"><span class="lineno"> 2896</span>            <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2897</span>                <span class="stringliteral">&quot;bad Elf64_Shdr[%d].sh_offset %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2898</span>                -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> - j, <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>);</div>
<div class="line"><span class="lineno"> 2899</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2900</span>        }</div>
<div class="line"><span class="lineno"> 2901</span>        <span class="comment">// Check that &amp;file_image[user_init_off] has</span></div>
<div class="line"><span class="lineno"> 2902</span>        <span class="comment">// *_RELATIVE or *_ABS* relocation, and fetch user_init_va.</span></div>
<div class="line"><span class="lineno"> 2903</span>        <span class="comment">// If Elf_Rela then the actual value is in Rela.r_addend.</span></div>
<div class="line"><span class="lineno"> 2904</span>        <span class="keywordtype">int</span> z_rel = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_RELA];</div>
<div class="line"><span class="lineno"> 2905</span>        <span class="keywordtype">int</span> z_rsz = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_RELASZ];</div>
<div class="line"><span class="lineno"> 2906</span>        <span class="keywordflow">if</span> (z_rel &amp;&amp; z_rsz) {</div>
<div class="line"><span class="lineno"> 2907</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> rel_off = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>[-1+ z_rel].d_val);</div>
<div class="line"><span class="lineno"> 2908</span>            <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= rel_off) {</div>
<div class="line"><span class="lineno"> 2909</span>                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2910</span>                     <span class="stringliteral">&quot;bad Elf64_Dynamic[DT_RELA] %#llx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2911</span>                     rel_off);</div>
<div class="line"><span class="lineno"> 2912</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2913</span>            }</div>
<div class="line"><span class="lineno"> 2914</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rp = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[rel_off];</div>
<div class="line"><span class="lineno"> 2915</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> relsz   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>[-1+ z_rsz].d_val);</div>
<div class="line"><span class="lineno"> 2916</span>            <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= relsz) {</div>
<div class="line"><span class="lineno"> 2917</span>                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2918</span>                     <span class="stringliteral">&quot;bad Elf64_Dynamic[DT_RELASZ] %#llx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2919</span>                     relsz);</div>
<div class="line"><span class="lineno"> 2920</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2921</span>            }</div>
<div class="line"><span class="lineno"> 2922</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *last = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)(relsz + (<span class="keywordtype">char</span> *)rp);</div>
<div class="line"><span class="lineno"> 2923</span>            <span class="keywordflow">for</span> (; rp &lt; last; ++rp) {</div>
<div class="line"><span class="lineno"> 2924</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_va = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 2925</span>                <span class="keywordflow">if</span> (r_va == user_init_ava) { <span class="comment">// found the Elf64_Rela</span></div>
<div class="line"><span class="lineno"> 2926</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> = rp;</div>
<div class="line"><span class="lineno"> 2927</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_info);</div>
<div class="line"><span class="lineno"> 2928</span>                    <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 2929</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0].st_name, r_va);  <span class="comment">// for decompressor</span></div>
<div class="line"><span class="lineno"> 2930</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0].st_value, r_info);</div>
<div class="line"><span class="lineno"> 2931</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0].st_size, <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_addend));</div>
<div class="line"><span class="lineno"> 2932</span>                    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 2933</span>                        <span class="keywordflow">if</span> (R_AARCH64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 2934</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 2935</span>                        }</div>
<div class="line"><span class="lineno"> 2936</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_AARCH64_ABS64 == r_type) {</div>
<div class="line"><span class="lineno"> 2937</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[ELF64_R_SYM(r_info)].st_value);</div>
<div class="line"><span class="lineno"> 2938</span>                        }</div>
<div class="line"><span class="lineno"> 2939</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2940</span>                            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2941</span>                                <span class="stringliteral">&quot;bad relocation %#llx DT_INIT_ARRAY[0]&quot;</span>,</div>
<div class="line"><span class="lineno"> 2942</span>                                r_info);</div>
<div class="line"><span class="lineno"> 2943</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2944</span>                        }</div>
<div class="line"><span class="lineno"> 2945</span>                    }</div>
<div class="line"><span class="lineno"> 2946</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf64_Ehdr::EM_X86_64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 2947</span>                        <span class="keywordflow">if</span> (R_X86_64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 2948</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 2949</span>                        }</div>
<div class="line"><span class="lineno"> 2950</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_X86_64_64 == r_type) {</div>
<div class="line"><span class="lineno"> 2951</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[ELF64_R_SYM(r_info)].st_value);</div>
<div class="line"><span class="lineno"> 2952</span>                        }</div>
<div class="line"><span class="lineno"> 2953</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2954</span>                            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2955</span>                                <span class="stringliteral">&quot;bad relocation %#llx DT_INIT_ARRAY[0]&quot;</span>,</div>
<div class="line"><span class="lineno"> 2956</span>                                r_info);</div>
<div class="line"><span class="lineno"> 2957</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2958</span>                        }</div>
<div class="line"><span class="lineno"> 2959</span>                    }</div>
<div class="line"><span class="lineno"> 2960</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2961</span>                }</div>
<div class="line"><span class="lineno"> 2962</span>            }</div>
<div class="line"><span class="lineno"> 2963</span>        }</div>
<div class="line"><span class="lineno"> 2964</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;pload_x0-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 2965</span>        <span class="keywordflow">if</span> (!((<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> - <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>) &lt; p_filesz)) {</div>
<div class="line"><span class="lineno"> 2966</span>            <span class="comment">// Not in executable portion of first executable PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 2967</span>            <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> &amp;&amp; <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib) {</div>
<div class="line"><span class="lineno"> 2968</span>                <span class="comment">// Android allows (0 ==&gt; skip) ?</span></div>
<div class="line"><span class="lineno"> 2969</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = 0;  <span class="comment">// force steal of &#39;extra&#39; DT_NULL</span></div>
<div class="line"><span class="lineno"> 2970</span>                <span class="comment">// XXX: FIXME: depends on SHT_DYNAMIC coming later</span></div>
<div class="line"><span class="lineno"> 2971</span>            }</div>
<div class="line"><span class="lineno"> 2972</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2973</span>                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2974</span>                    <span class="stringliteral">&quot;bad init address %#x in Elf64_Shdr[%d].%#x\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 2975</span>                    (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a>, -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> - j, <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>);</div>
<div class="line"><span class="lineno"> 2976</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2977</span>            }</div>
<div class="line"><span class="lineno"> 2978</span>        }</div>
<div class="line"><span class="lineno"> 2979</span>    }</div>
<div class="line"><span class="lineno"> 2980</span>    <span class="comment">// By default /usr/bin/ld leaves 4 extra DT_NULL to support pre-linking.</span></div>
<div class="line"><span class="lineno"> 2981</span>    <span class="comment">// Take one as a last resort.</span></div>
<div class="line"><span class="lineno"> 2982</span>    <span class="keywordflow">if</span> ((Elf64_Dyn::DT_INIT==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> || !<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>)</div>
<div class="line"><span class="lineno"> 2983</span>    &amp;&amp;  Elf64_Shdr::SHT_DYNAMIC == sh_type) {</div>
<div class="line"><span class="lineno"> 2984</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 2985</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 2986</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_size</div>
<div class="line"><span class="lineno"> 2987</span>        ||  (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_offset</div>
<div class="line"><span class="lineno"> 2988</span>        || ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - sh_offset) &lt; sh_size) {</div>
<div class="line"><span class="lineno"> 2989</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad SHT_DYNAMIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 2990</span>        }</div>
<div class="line"><span class="lineno"> 2991</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> <a class="code hl_variable" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a> = sh_size / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>);</div>
<div class="line"><span class="lineno"> 2992</span>        <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dynp = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[sh_offset];</div>
<div class="line"><span class="lineno"> 2993</span>        <span class="keywordflow">for</span> (; Elf64_Dyn::DT_NULL != dynp-&gt;d_tag; ++dynp) {</div>
<div class="line"><span class="lineno"> 2994</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> == <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag)) {</div>
<div class="line"><span class="lineno"> 2995</span>                <span class="keywordflow">break</span>;  <span class="comment">// re-found DT_INIT</span></div>
<div class="line"><span class="lineno"> 2996</span>            }</div>
<div class="line"><span class="lineno"> 2997</span>        }</div>
<div class="line"><span class="lineno"> 2998</span>        <span class="keywordflow">if</span> ((1+ dynp) &lt; (<a class="code hl_variable" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a>+ <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>)) { <span class="comment">// not the terminator, so take it</span></div>
<div class="line"><span class="lineno"> 2999</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val);  <span class="comment">// 0 if (0==upx_dt_init)</span></div>
<div class="line"><span class="lineno"> 3000</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dynp-&gt;d_tag, <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_INIT);</div>
<div class="line"><span class="lineno"> 3001</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;dynp-&gt;d_val - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0];</div>
<div class="line"><span class="lineno"> 3002</span>        }</div>
<div class="line"><span class="lineno"> 3003</span>    }</div>
<div class="line"><span class="lineno"> 3004</span>  }</div>
<div class="line"><span class="lineno"> 3005</span>    <span class="comment">// If shdr_xva-&gt;sh_size is too small, then probably it won&#39;t compress.</span></div>
<div class="line"><span class="lineno"> 3006</span>    <span class="comment">// So look for a Shdr that has PROGBITS and not SHF_WRITE, which is</span></div>
<div class="line"><span class="lineno"> 3007</span>    <span class="comment">// much larger, and use that for the compressibility decision.</span></div>
<div class="line"><span class="lineno"> 3008</span>    <span class="keywordflow">if</span> (shdr_xva-&gt;sh_size &lt; 0x1000) {</div>
<div class="line"><span class="lineno"> 3009</span>        shdr = shdr_xva;</div>
<div class="line"><span class="lineno"> 3010</span>        <span class="keywordflow">while</span> (SHT_PROGBITS == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr[-1].sh_type))  --shdr;  <span class="comment">// backup</span></div>
<div class="line"><span class="lineno"> 3011</span>        <span class="keywordflow">for</span> (; SHT_PROGBITS == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type)</div>
<div class="line"><span class="lineno"> 3012</span>               &amp;&amp; !(SHF_WRITE &amp; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags)); ++shdr) {</div>
<div class="line"><span class="lineno"> 3013</span>            <span class="keywordflow">if</span> (0x4000 &lt;= <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_size)) {</div>
<div class="line"><span class="lineno"> 3014</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr);  <span class="comment">// hopefully more compressible</span></div>
<div class="line"><span class="lineno"> 3015</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3016</span>            }</div>
<div class="line"><span class="lineno"> 3017</span>        }</div>
<div class="line"><span class="lineno"> 3018</span>    }</div>
<div class="line"><span class="lineno"> 3019</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>;</div>
<div class="line"><span class="lineno"> 3020</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a8c8e26f797ec69a6c183c8b15fcd4f53"><div class="ttname"><a href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a></div><div class="ttdeci">void * user_init_rp</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00113">p_lx_elf.h:113</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a93d9de72bcb60bbea6757e0d44e5e296"><div class="ttname"><a href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a></div><div class="ttdeci">unsigned dt_table[DT_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00127">p_lx_elf.h:127</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_af532e634462c5e42c213735f6869b383"><div class="ttname"><a href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a></div><div class="ttdeci">const C&lt; U &gt; size_t n</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00080">xspan_fwd.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a>, <a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_cgraph" id="aclassPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,223,129"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="271,5,400,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="271,55,400,80"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="271,104,399,129"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="271,153,399,179"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="276,203,395,228"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_icgraph" id="aclassPackLinuxElf64_aa31c4b9fe8bb49ee9fa220b0c1d149bd_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,452,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a71bc2f0e1a1ec856b3f9a08b63add0ae" name="a71bc2f0e1a1ec856b3f9a08b63add0ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71bc2f0e1a1ec856b3f9a08b63add0ae">&#9670;&#160;</a></span>canUnpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tribool PackLinuxElf64::canUnpack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic Unix <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack().">canUnpack()</a>. </p>

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03330">3330</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3331</span>{</div>
<div class="line"><span class="lineno"> 3332</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>)) {</div>
<div class="line"><span class="lineno"> 3333</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3334</span>    }</div>
<div class="line"><span class="lineno"> 3335</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>) &lt; 2) {</div>
<div class="line"><span class="lineno"> 3336</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;e_phnum must be &gt;= 2&quot;</span>);</div>
<div class="line"><span class="lineno"> 3337</span>    }</div>
<div class="line"><span class="lineno"> 3338</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_DYN==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>)) {</div>
<div class="line"><span class="lineno"> 3339</span>        <a class="code hl_function" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);</div>
<div class="line"><span class="lineno"> 3340</span>    }</div>
<div class="line"><span class="lineno"> 3341</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">super::canUnpack</a>()) {</div>
<div class="line"><span class="lineno"> 3342</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3343</span>    }</div>
<div class="line"><span class="lineno"> 3344</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3345</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a8c2bb372c567334edd586f78224bc956"><div class="ttname"><a href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64::PackLinuxElf64help1</a></div><div class="ttdeci">virtual void PackLinuxElf64help1(InputFile *f)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01022">p_lx_elf.cpp:1022</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a2749869eea115d88727ccd4f60b0c474"><div class="ttname"><a href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf::canUnpack</a></div><div class="ttdeci">virtual tribool canUnpack() override</div><div class="ttdoc">Generic Unix canUnpack().</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00049">p_lx_elf.h:49</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_aeec259360ad810df576d7012b3f054f3"><div class="ttname"><a href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a></div><div class="ttdeci">void throwCantUnpack(const char *msg)</div><div class="ttdoc">decompression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00109">except.cpp:109</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a031210e6571dad798c4ed66b85631d58"><div class="ttname"><a href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a></div><div class="ttdeci">Elf64_Half e_type</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00208">bsd.h:208</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_af13bac5685d725c2ba9930c1176f3082"><div class="ttname"><a href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a></div><div class="ttdeci">Elf64_Half e_phnum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00217">bsd.h:217</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf::canUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr()</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph" id="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph">
<area shape="rect" title="Generic Unix canUnpack()." alt="" coords="5,323,205,348"/>
<area shape="rect" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack()." alt="" coords="259,171,441,196"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1274,196,1413,222"/>
<area shape="rect" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c" title=" " alt="" coords="495,323,689,348"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="758,576,887,602"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="253,1190,447,1230"/>
<area shape="rect" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120" title="Generic Unix canUnpack()." alt="" coords="511,171,673,196"/>
<area shape="rect" href="classPackUnix.html#a4f1d471152b26686e619f2e8b6744366" title=" " alt="" coords="737,136,908,176"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="761,454,884,479"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="764,390,881,415"/>
<area shape="rect" href="classFileBase.html#a7ae5a36714da37350db8bf0c9e6618b3" title=" " alt="" coords="757,86,888,111"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1499,652,1628,678"/>
<area shape="rect" href="classPacker.html#afeee17a50e4f350eebc14b1704ec9a39" title=" " alt="" coords="987,70,1157,95"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="956,171,1188,196"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1504,1184,1623,1210"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="1015,523,1129,548"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="997,474,1147,499"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1299,1159,1388,1184"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1275,424,1412,450"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="1014,424,1130,450"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1499,1566,1628,1591"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="781,527,865,552"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="1005,2031,1139,2056"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="528,2056,656,2082"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="747,1980,898,2006"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="987,2131,1157,2156"/>
<area shape="rect" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014" title=" " alt="" coords="1260,1310,1427,1350"/>
<area shape="rect" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6" title=" " alt="" coords="1260,1425,1427,1465"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="750,1692,895,1732"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="1252,963,1435,988"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="999,1165,1145,1205"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="750,882,895,922"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="509,1533,675,1573"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1305,2039,1381,2064"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1301,2088,1385,2114"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1303,2138,1384,2163"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1236,2187,1451,2212"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1266,1966,1421,1991"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="737,2082,908,2107"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="799,2131,847,2156"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="1271,1692,1416,1732"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="977,1584,1167,1624"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="989,840,1155,866"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="997,674,1147,714"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="1269,782,1418,822"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="985,890,1159,915"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="1039,963,1105,988"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="750,1476,895,1516"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="997,1648,1147,1688"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="746,1764,899,1804"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph" id="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph">
<area shape="rect" title="Generic Unix canUnpack()." alt="" coords="235,5,435,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a5d86b1c186506105d0a1143fd364c014" name="a5d86b1c186506105d0a1143fd364c014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d86b1c186506105d0a1143fd364c014">&#9670;&#160;</a></span>check_pt_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::check_pt_dynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08316">8316</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8317</span>{</div>
<div class="line"><span class="lineno"> 8318</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> t = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_offset), s = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>) + t;</div>
<div class="line"><span class="lineno"> 8319</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr);</div>
<div class="line"><span class="lineno"> 8320</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_filesz), memsz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_memsz);</div>
<div class="line"><span class="lineno"> 8321</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno"> 8322</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; t || s &lt; t</div>
<div class="line"><span class="lineno"> 8323</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; filesz</div>
<div class="line"><span class="lineno"> 8324</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; (filesz + t)</div>
<div class="line"><span class="lineno"> 8325</span>    ||  t &lt; (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>*<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>))</div>
<div class="line"><span class="lineno"> 8326</span>    ||  (7 &amp; t) || (0xf &amp; (filesz | memsz))  <span class="comment">// .balign 8; 16==sizeof(Elf64_Dyn)</span></div>
<div class="line"><span class="lineno"> 8327</span>    ||  (-1+ align) &amp; (t ^ vaddr)</div>
<div class="line"><span class="lineno"> 8328</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= memsz</div>
<div class="line"><span class="lineno"> 8329</span>    ||  filesz &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>)</div>
<div class="line"><span class="lineno"> 8330</span>    ||  memsz  &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>)</div>
<div class="line"><span class="lineno"> 8331</span>    ||  filesz &lt; memsz) {</div>
<div class="line"><span class="lineno"> 8332</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad PT_DYNAMIC phdr[%u]&quot;</span>,</div>
<div class="line"><span class="lineno"> 8333</span>            (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 8334</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 8335</span>    }</div>
<div class="line"><span class="lineno"> 8336</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a> = memsz;</div>
<div class="line"><span class="lineno"> 8337</span>    <span class="keywordflow">return</span> t;</div>
<div class="line"><span class="lineno"> 8338</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a9da32af4a0e9814653edd2d72c3e2dda"><div class="ttname"><a href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">PackLinuxElf64::sz_dynseg</a></div><div class="ttdeci">upx_uint64_t sz_dynseg</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00408">p_lx_elf.h:408</a></div></div>
<div class="ttc" id="aclassPackerBase_html_ac91973d9b4ba31e291970a8a058f6b07"><div class="ttname"><a href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a></div><div class="ttdeci">const upx_uint64_t file_size_u</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00088">packer.h:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph" id="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,172,63"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="220,5,349,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="225,55,344,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph" id="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph">
<area shape="rect" title=" " alt="" coords="735,27,901,67"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
</map>
</div>

</div>
</div>
<a id="ae528cb01cbf686b624e2fffe159ad5b6" name="ae528cb01cbf686b624e2fffe159ad5b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae528cb01cbf686b624e2fffe159ad5b6">&#9670;&#160;</a></span>check_pt_load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> PackLinuxElf64::check_pt_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08285">8285</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8286</span>{</div>
<div class="line"><span class="lineno"> 8287</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 8288</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_offset), offend = filesz + offset;</div>
<div class="line"><span class="lineno"> 8289</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> vaddr  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr);</div>
<div class="line"><span class="lineno"> 8290</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> paddr  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_paddr);</div>
<div class="line"><span class="lineno"> 8291</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> align  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno"> 8292</span> </div>
<div class="line"><span class="lineno"> 8293</span>    <span class="keywordflow">if</span> ((-1+ align) &amp; (paddr ^ vaddr)</div>
<div class="line"><span class="lineno"> 8294</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)offset</div>
<div class="line"><span class="lineno"> 8295</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;  (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)offend</div>
<div class="line"><span class="lineno"> 8296</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;  (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)filesz) {</div>
<div class="line"><span class="lineno"> 8297</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad PT_LOAD phdr[%u]&quot;</span>,</div>
<div class="line"><span class="lineno"> 8298</span>            (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 8299</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 8300</span>    }</div>
<div class="line"><span class="lineno"> 8301</span>    <span class="keywordflow">return</span> offset;</div>
<div class="line"><span class="lineno"> 8302</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph" id="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,172,63"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="220,5,349,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="225,55,344,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph" id="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph">
<area shape="rect" title=" " alt="" coords="735,27,901,67"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
</map>
</div>

</div>
</div>
<a id="ab26dade234148980bd9f8a06ee31bf3c" name="ab26dade234148980bd9f8a06ee31bf3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab26dade234148980bd9f8a06ee31bf3c">&#9670;&#160;</a></span>checkEhdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::checkEhdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> const *&#160;</td>
          <td class="paramname"><em>ehdr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00195">195</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  196</span>{</div>
<div class="line"><span class="lineno">  197</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a> = ehdr-&gt;e_ident;</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> osabi0 = <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf32_Ehdr::EI_OSABI];</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (0==osabi0) {</div>
<div class="line"><span class="lineno">  200</span>        osabi0 = <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.osabi0;</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <span class="stringliteral">&quot;\x7f\x45\x4c\x46&quot;</span>, 4)  <span class="comment">// &quot;\177ELF&quot;</span></div>
<div class="line"><span class="lineno">  204</span>    ||  <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf64_Ehdr::EI_CLASS]!=<a class="code hl_variable" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">ei_class</a></div>
<div class="line"><span class="lineno">  205</span>    ||  <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf64_Ehdr::EI_DATA] !=<a class="code hl_variable" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">ei_data</a></div>
<div class="line"><span class="lineno">  206</span>    ||                     osabi0!=<a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a></div>
<div class="line"><span class="lineno">  207</span>    ) {</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  209</span>    }</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>+8, <span class="stringliteral">&quot;FreeBSD&quot;</span>, 7))                   <span class="comment">// branded</span></div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordtype">int</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_type);</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">if</span> (type != Elf64_Ehdr::ET_EXEC &amp;&amp; type != Elf64_Ehdr::ET_DYN)</div>
<div class="line"><span class="lineno">  215</span>        <span class="keywordflow">return</span> 2;</div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine) != (<span class="keywordtype">unsigned</span>) <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>)</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><span class="lineno">  218</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ehdr-&gt;e_version) != Elf64_Ehdr::EV_CURRENT)</div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">return</span> 4;</div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> &lt; 1)</div>
<div class="line"><span class="lineno">  221</span>        <span class="keywordflow">return</span> 5;</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_phentsize) != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>))</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">return</span> 6;</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">if</span> (type == Elf64_Ehdr::ET_EXEC) {</div>
<div class="line"><span class="lineno">  226</span>        <span class="comment">// check for Linux kernels</span></div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;ehdr-&gt;e_entry);</div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">if</span> (entry == 0xC0100000)    <span class="comment">// uncompressed vmlinux</span></div>
<div class="line"><span class="lineno">  229</span>            <span class="keywordflow">return</span> 1000;</div>
<div class="line"><span class="lineno">  230</span>        <span class="keywordflow">if</span> (entry == 0x00001000)    <span class="comment">// compressed vmlinux</span></div>
<div class="line"><span class="lineno">  231</span>            <span class="keywordflow">return</span> 1001;</div>
<div class="line"><span class="lineno">  232</span>        <span class="keywordflow">if</span> (entry == 0x00100000)    <span class="comment">// compressed bvmlinux</span></div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">return</span> 1002;</div>
<div class="line"><span class="lineno">  234</span>    }</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="comment">// FIXME: add more checks for kernels</span></div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    <span class="comment">// FIXME: add special checks for other ELF i386 formats, like</span></div>
<div class="line"><span class="lineno">  239</span>    <span class="comment">//        NetBSD, OpenBSD, Solaris, ....</span></div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    <span class="comment">// success</span></div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  243</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a5dabe40d6f7f71e6b9bce64b9cc3290f"><div class="ttname"><a href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">PackLinuxElf::ei_data</a></div><div class="ttdeci">unsigned char ei_data</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00121">p_lx_elf.h:121</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ad930777406ea601d200de0ab59de88d6"><div class="ttname"><a href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a></div><div class="ttdeci">unsigned char ei_osabi</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00122">p_lx_elf.h:122</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_af6c2c447099336ae2bc5cc1539c36610"><div class="ttname"><a href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">PackLinuxElf::ei_class</a></div><div class="ttdeci">unsigned char ei_class</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00120">p_lx_elf.h:120</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a1a9f236758b0df388ddf70ed0e05e350"><div class="ttname"><a href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a></div><div class="ttdeci">int memcmp(const C&lt; T &gt; &amp;a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00073">xspan_fwd.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">PackLinuxElf::ei_class</a>, <a class="el" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">PackLinuxElf::ei_data</a>, <a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, and <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph" id="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,200,105"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="248,5,377,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="248,55,377,80"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="248,104,377,129"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="271,177,355,203"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph" id="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph">
<area shape="rect" title=" " alt="" coords="483,5,677,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="235,31,435,56"/>
</map>
</div>

</div>
</div>
<a id="a3af121bec7063696881a30fd96d8c96b" name="a3af121bec7063696881a30fd96d8c96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3af121bec7063696881a30fd96d8c96b">&#9670;&#160;</a></span>compileTimeAssertions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PackLinuxElf64::compileTimeAssertions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00455">455</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  455</span>                                        {</div>
<div class="line"><span class="lineno">  456</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(cprElfHdr1) == 64 + 1*56 + 12)</div>
<div class="line"><span class="lineno">  457</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr2) == 64 + 2*56 + 12)</div>
<div class="line"><span class="lineno">  458</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr3) == 64 + 3*56 + 12)</div>
<div class="line"><span class="lineno">  459</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr4) == 64 + 4*56 + 12)</div>
<div class="line"><span class="lineno">  460</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr1)</div>
<div class="line"><span class="lineno">  461</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr2)</div>
<div class="line"><span class="lineno">  462</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr3)</div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr4)</div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="ttc" id="aconf_8h_html_a20a79123be4e1110319dc90522f4b563"><div class="ttname"><a href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT_ALIGNED1(a)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00432">conf.h:432</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, and <a class="el" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>.</p>

</div>
</div>
<a id="ab000c2eb42eb50ba4dd570fb0e20e4f2" name="ab000c2eb42eb50ba4dd570fb0e20e4f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab000c2eb42eb50ba4dd570fb0e20e4f2">&#9670;&#160;</a></span>defineSymbols()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::defineSymbols </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf64amd.html#af36770a77fe0872431300e7da76429d9">PackLinuxElf64amd</a>, and <a class="el" href="classPackLinuxElf64arm.html#a10aaeb12a6288a69bff959f0cd7da183">PackLinuxElf64arm</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00955">955</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  956</span>{</div>
<div class="line"><span class="lineno">  957</span>    <a class="code hl_function" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno">  958</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_addaacfe47a36eb9d70929a58ba311e29"><div class="ttname"><a href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols</a></div><div class="ttdeci">virtual void defineSymbols(Filter const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00943">p_lx_elf.cpp:943</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341">buildLinuxLoader()</a>, <a class="el" href="classPackLinuxElf64amd.html#af36770a77fe0872431300e7da76429d9">PackLinuxElf64amd::defineSymbols()</a>, and <a class="el" href="classPackLinuxElf64arm.html#a10aaeb12a6288a69bff959f0cd7da183">PackLinuxElf64arm::defineSymbols()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph" id="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,229,31"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="277,5,484,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph" id="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph">
<area shape="rect" title=" " alt="" coords="453,173,677,198"/>
<area shape="rect" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341" title=" " alt="" coords="211,101,405,141"/>
<area shape="rect" href="classPackLinuxElf64amd.html#af36770a77fe0872431300e7da76429d9" title=" " alt="" coords="229,165,387,205"/>
<area shape="rect" href="classPackLinuxElf64arm.html#a10aaeb12a6288a69bff959f0cd7da183" title=" " alt="" coords="231,229,385,269"/>
<area shape="rect" href="classPackLinuxElf64amd.html#a4e925c41e1f85114a34b4fec6a0bfc18" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#a433b6323d27480148574ea89b6ee3634" title=" " alt="" coords="7,69,161,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#adeb403f68ec4aeb636a5ecf2ce9039f1" title=" " alt="" coords="7,133,161,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#ad2998d239264bc145084afbd56fec5b7" title=" " alt="" coords="9,197,159,237"/>
</map>
</div>

</div>
</div>
<a id="ad1befccbbdde5d8977b9d2e5883507d4" name="ad1befccbbdde5d8977b9d2e5883507d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1befccbbdde5d8977b9d2e5883507d4">&#9670;&#160;</a></span>elf_find_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * PackLinuxElf64::elf_find_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08231">8231</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8232</span>{</div>
<div class="line"><span class="lineno"> 8233</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(key);</div>
<div class="line"><span class="lineno"> 8234</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 8235</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> t= <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val));</div>
<div class="line"><span class="lineno"> 8236</span>        <span class="keywordflow">if</span> (t &amp;&amp; t &lt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a>) {</div>
<div class="line"><span class="lineno"> 8237</span>            <span class="keywordflow">return</span> t + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>;</div>
<div class="line"><span class="lineno"> 8238</span>        }</div>
<div class="line"><span class="lineno"> 8239</span>    }</div>
<div class="line"><span class="lineno"> 8240</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8241</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab6a39ae989d67ccb9239bcff7750a6e5"><div class="ttname"><a href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">PackLinuxElf64::elf_find_dynptr</a></div><div class="ttdeci">Elf64_Dyn * elf_find_dynptr(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08200">p_lx_elf.cpp:8200</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, and <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph" id="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,151,103"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="221,5,367,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="464,70,593,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="199,120,389,160"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="437,123,620,149"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="469,173,588,198"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="668,123,797,149"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph" id="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph">
<area shape="rect" title=" " alt="" coords="949,198,1095,238"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,27,187,52"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,198,901,238"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,141,687,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,256,662,296"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,316,890,356"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,27,440,52"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,77,445,117"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,141,444,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,295,427,320"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,320,662,360"/>
</map>
</div>

</div>
</div>
<a id="ab6a39ae989d67ccb9239bcff7750a6e5" name="ab6a39ae989d67ccb9239bcff7750a6e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6a39ae989d67ccb9239bcff7750a6e5">&#9670;&#160;</a></span>elf_find_dynptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> * PackLinuxElf64::elf_find_dynptr </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08200">8200</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8201</span>{</div>
<div class="line"><span class="lineno"> 8202</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dynp= <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>;</div>
<div class="line"><span class="lineno"> 8203</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 8204</span>        <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *<span class="keyword">const</span> last = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(<a class="code hl_variable" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a> + (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>);</div>
<div class="line"><span class="lineno"> 8205</span>        <span class="keywordflow">for</span> (; dynp &lt; last; ++dynp) {</div>
<div class="line"><span class="lineno"> 8206</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag)==key) {</div>
<div class="line"><span class="lineno"> 8207</span>                <span class="keywordflow">return</span> dynp;</div>
<div class="line"><span class="lineno"> 8208</span>            }</div>
<div class="line"><span class="lineno"> 8209</span>            <span class="keywordflow">if</span> (Elf64_Dyn::DT_NULL == dynp-&gt;d_tag) {</div>
<div class="line"><span class="lineno"> 8210</span>                <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8211</span>            }</div>
<div class="line"><span class="lineno"> 8212</span>        }</div>
<div class="line"><span class="lineno"> 8213</span>    }</div>
<div class="line"><span class="lineno"> 8214</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8215</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, and <a class="el" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph" id="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph" id="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph">
<area shape="rect" title=" " alt="" coords="1375,403,1520,443"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="966,231,1111,271"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,339,662,379"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="1176,518,1327,558"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="955,741,1122,767"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,295,187,320"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,397,901,437"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,119,687,159"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,231,890,271"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,5,440,31"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,119,445,159"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,55,444,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,347,427,372"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,254,662,294"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="966,461,1111,501"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="949,626,1128,666"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="962,346,1115,386"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="735,633,901,659"/>
</map>
</div>

</div>
</div>
<a id="ac7458e15967252113c7b45332b973287" name="ac7458e15967252113c7b45332b973287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7458e15967252113c7b45332b973287">&#9670;&#160;</a></span>elf_find_Phdr_for_va()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const  * PackLinuxElf64::elf_find_Phdr_for_va </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00468">468</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>{</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno">  471</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)</div>
<div class="line"><span class="lineno">  473</span>        &amp;&amp; <a class="code hl_function" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a>(align) &amp;&amp; !((-1+ align) &amp;</div>
<div class="line"><span class="lineno">  474</span>            (<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr) ^ <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_offset)))</div>
<div class="line"><span class="lineno">  475</span>        &amp;&amp;  (addr - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr)) &lt; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_filesz)) {</div>
<div class="line"><span class="lineno">  476</span>            <span class="keywordflow">return</span> phdr;</div>
<div class="line"><span class="lineno">  477</span>        }</div>
<div class="line"><span class="lineno">  478</span>    }</div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  480</span>}</div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a0a26281ee961fe926e04c93f395d76cf"><div class="ttname"><a href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a></div><div class="ttdeci">static unsigned is_pow2(u64_t x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00447">p_lx_elf.cpp:447</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2()</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, and <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph" id="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,151,87"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="225,5,355,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="199,55,381,80"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="253,104,327,129"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="429,55,559,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph" id="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph">
<area shape="rect" title=" " alt="" coords="1164,92,1309,132"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="960,63,1105,103"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,5,662,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="949,127,1116,153"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="956,177,1109,217"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,63,901,103"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,127,187,153"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,149,687,189"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,185,440,210"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,235,445,275"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,120,444,160"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,13,427,38"/>
</map>
</div>

</div>
</div>
<a id="af746b688a3b13d3bf0895095ae5c3212" name="af746b688a3b13d3bf0895095ae5c3212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af746b688a3b13d3bf0895095ae5c3212">&#9670;&#160;</a></span>elf_find_ptype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const  * PackLinuxElf64::elf_find_ptype </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02456">2456</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2457</span>{</div>
<div class="line"><span class="lineno"> 2458</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 2459</span>        <span class="keywordflow">if</span> (type == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type)) {</div>
<div class="line"><span class="lineno"> 2460</span>            <span class="keywordflow">return</span> phdr;</div>
<div class="line"><span class="lineno"> 2461</span>        }</div>
<div class="line"><span class="lineno"> 2462</span>    }</div>
<div class="line"><span class="lineno"> 2463</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2464</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph" id="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph" id="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,373,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a19a154b135064ce4e1a6e58ba23d9e50" name="a19a154b135064ce4e1a6e58ba23d9e50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a154b135064ce4e1a6e58ba23d9e50">&#9670;&#160;</a></span>elf_find_section_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const  * PackLinuxElf64::elf_find_section_name </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02490">2490</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2493</span>{</div>
<div class="line"><span class="lineno"> 2494</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 2495</span>    <span class="keywordflow">if</span> (!shdr) {</div>
<div class="line"><span class="lineno"> 2496</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2497</span>    }</div>
<div class="line"><span class="lineno"> 2498</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>;</div>
<div class="line"><span class="lineno"> 2499</span>    <span class="keywordflow">for</span> (; 0 &lt;=--j; ++shdr) {</div>
<div class="line"><span class="lineno"> 2500</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_name);</div>
<div class="line"><span class="lineno"> 2501</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= sh_name) {  <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 2502</span>            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2503</span>                <span class="stringliteral">&quot;bad Elf64_Shdr[%d].sh_name %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2504</span>                -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> -j, sh_name);</div>
<div class="line"><span class="lineno"> 2505</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2506</span>        }</div>
<div class="line"><span class="lineno"> 2507</span>        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[sh_name])) {</div>
<div class="line"><span class="lineno"> 2508</span>            <span class="keywordflow">return</span> shdr;</div>
<div class="line"><span class="lineno"> 2509</span>        }</div>
<div class="line"><span class="lineno"> 2510</span>    }</div>
<div class="line"><span class="lineno"> 2511</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2512</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph" id="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,156,111"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="204,5,333,31"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="235,79,302,104"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="209,128,328,153"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph" id="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,371,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="af80d289e1d9fe56882aa494f2afc0e9b" name="af80d289e1d9fe56882aa494f2afc0e9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af80d289e1d9fe56882aa494f2afc0e9b">&#9670;&#160;</a></span>elf_find_section_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> * PackLinuxElf64::elf_find_section_type </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02531">2531</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2534</span>{</div>
<div class="line"><span class="lineno"> 2535</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 2536</span>    <span class="keywordflow">if</span> (!shdr) {</div>
<div class="line"><span class="lineno"> 2537</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2538</span>    }</div>
<div class="line"><span class="lineno"> 2539</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>;</div>
<div class="line"><span class="lineno"> 2540</span>    <span class="keywordflow">for</span> (; 0 &lt;=--j; ++shdr) {</div>
<div class="line"><span class="lineno"> 2541</span>        <span class="keywordflow">if</span> (type==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type)) {</div>
<div class="line"><span class="lineno"> 2542</span>            <span class="keywordflow">return</span> shdr;</div>
<div class="line"><span class="lineno"> 2543</span>        }</div>
<div class="line"><span class="lineno"> 2544</span>    }</div>
<div class="line"><span class="lineno"> 2545</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2546</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph" id="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph" id="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph">
<area shape="rect" title=" " alt="" coords="1164,141,1309,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,159,187,184"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="960,141,1105,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,209,687,249"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="949,256,1116,282"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="961,65,1105,105"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,141,901,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,94,662,134"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,338,440,363"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,209,445,249"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,273,444,313"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,72,427,98"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="746,44,890,84"/>
</map>
</div>

</div>
</div>
<a id="ab5c99e9dc4cb9e94309dfb49b13ff09d" name="ab5c99e9dc4cb9e94309dfb49b13ff09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c99e9dc4cb9e94309dfb49b13ff09d">&#9670;&#160;</a></span>elf_find_table_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::elf_find_table_size </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dt_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>sh_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08393">8393</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8394</span>{</div>
<div class="line"><span class="lineno"> 8395</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *sec = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(sh_type);</div>
<div class="line"><span class="lineno"> 8396</span>    <span class="keywordflow">if</span> (sec) { <span class="comment">// Cheat the easy way: use _Shdr.  (No _Shdr anyway for de-compression)</span></div>
<div class="line"><span class="lineno"> 8397</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sec-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 8398</span>    }</div>
<div class="line"><span class="lineno"> 8399</span>    <span class="comment">// Honest hard work: use _Phdr</span></div>
<div class="line"><span class="lineno"> 8400</span>    <span class="keywordtype">unsigned</span> x_rva;</div>
<div class="line"><span class="lineno"> 8401</span>    <span class="keywordflow">if</span> (dt_type &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) {</div>
<div class="line"><span class="lineno"> 8402</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> x_ndx = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[dt_type];</div>
<div class="line"><span class="lineno"> 8403</span>        <span class="keywordflow">if</span> (!x_ndx) { <span class="comment">// no such entry</span></div>
<div class="line"><span class="lineno"> 8404</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 8405</span>        }</div>
<div class="line"><span class="lineno"> 8406</span>        x_rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>[-1+ x_ndx].d_val);</div>
<div class="line"><span class="lineno"> 8407</span>    }</div>
<div class="line"><span class="lineno"> 8408</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8409</span>        x_rva = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(dt_type);</div>
<div class="line"><span class="lineno"> 8410</span>    }</div>
<div class="line"><span class="lineno"> 8411</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> x_phdr = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(x_rva, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 8412</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>           d_off =             x_rva - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;x_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 8413</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>           y_ndx = <a class="code hl_function" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">find_dt_ndx</a>(d_off + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;x_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>));</div>
<div class="line"><span class="lineno"> 8414</span>    <span class="keywordflow">if</span> (~0u != y_ndx) {</div>
<div class="line"><span class="lineno"> 8415</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[1+ y_ndx] - <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[y_ndx];</div>
<div class="line"><span class="lineno"> 8416</span>    }</div>
<div class="line"><span class="lineno"> 8417</span>    <span class="keywordflow">return</span> ~0u;</div>
<div class="line"><span class="lineno"> 8418</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a4b4cfbd2d81ab91d393764f41c48ad44"><div class="ttname"><a href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">PackLinuxElf64::find_dt_ndx</a></div><div class="ttdeci">unsigned find_dt_ndx(u64_t rva)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08381">p_lx_elf.cpp:8381</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ac7458e15967252113c7b45332b973287"><div class="ttname"><a href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">PackLinuxElf64::elf_find_Phdr_for_va</a></div><div class="ttdeci">virtual Elf64_Phdr const * elf_find_Phdr_for_va(upx_uint64_t addr, Elf64_Phdr const *phdr, unsigned phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00468">p_lx_elf.cpp:468</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a7515af27403f7b035c02bc0f92dee48c"><div class="ttname"><a href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a></div><div class="ttdeci">static unsigned const DT_NUM</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00126">p_lx_elf.h:126</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_acbe0a4831f0aafe74de573ca657ea430"><div class="ttname"><a href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a></div><div class="ttdeci">unsigned * dt_offsets</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00092">p_lx_elf.h:92</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">find_dt_ndx()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, and <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph" id="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph">
<area shape="rect" title=" " alt="" coords="5,177,151,217"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="202,99,347,139"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="629,210,759,235"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="202,5,347,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="199,235,350,275"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="199,343,351,383"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="399,34,581,59"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="453,83,527,109"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="629,9,759,34"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="417,285,563,325"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="415,399,565,425"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="405,350,575,375"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph" id="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph">
<area shape="rect" title=" " alt="" coords="949,81,1095,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="a047a7534432a2a090049ba2eee67bfb9" name="a047a7534432a2a090049ba2eee67bfb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047a7534432a2a090049ba2eee67bfb9">&#9670;&#160;</a></span>elf_get_offset_from_address()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::elf_get_offset_from_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08264">8264</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8265</span>{</div>
<div class="line"><span class="lineno"> 8266</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 8267</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>;</div>
<div class="line"><span class="lineno"> 8268</span>    <span class="keywordflow">for</span> (; --j&gt;=0; ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 8269</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> t = addr - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 8270</span>        <span class="keywordflow">if</span> (t &lt; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>)) {</div>
<div class="line"><span class="lineno"> 8271</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 8272</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= p_offset) { <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 8273</span>                <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 8274</span>                    <span class="stringliteral">&quot;bad Elf64_Phdr[%d].p_offset %#lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 8275</span>                    -1+ <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - j, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)p_offset);</div>
<div class="line"><span class="lineno"> 8276</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 8277</span>            }</div>
<div class="line"><span class="lineno"> 8278</span>            <span class="keywordflow">return</span> t + p_offset;</div>
<div class="line"><span class="lineno"> 8279</span>        }</div>
<div class="line"><span class="lineno"> 8280</span>    }</div>
<div class="line"><span class="lineno"> 8281</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 8282</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph" id="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,196,87"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="271,5,400,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="244,55,427,80"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="276,104,395,129"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="475,55,604,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph" id="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph">
<area shape="rect" title=" " alt="" coords="1144,174,1335,214"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="949,46,1096,86"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,221,187,247"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="950,202,1095,242"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,106,901,146"/>
<area shape="rect" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8" title=" " alt="" coords="735,21,901,61"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="507,5,673,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,143,687,183"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,207,662,247"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,271,890,311"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,107,440,132"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,221,445,261"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,157,444,197"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,285,427,311"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,271,662,311"/>
</map>
</div>

</div>
</div>
<a id="a5fb0d975feeb7b1b02f9e4a22ab227ed" name="a5fb0d975feeb7b1b02f9e4a22ab227ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb0d975feeb7b1b02f9e4a22ab227ed">&#9670;&#160;</a></span>elf_has_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const  * PackLinuxElf64::elf_has_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08305">8305</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8306</span>{</div>
<div class="line"><span class="lineno"> 8307</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>;</div>
<div class="line"><span class="lineno"> 8308</span>    <span class="keywordflow">if</span> (dynp)</div>
<div class="line"><span class="lineno"> 8309</span>    <span class="keywordflow">for</span> (; Elf64_Dyn::DT_NULL!=dynp-&gt;d_tag; ++dynp) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag)==key) {</div>
<div class="line"><span class="lineno"> 8310</span>        <span class="keywordflow">return</span> dynp;</div>
<div class="line"><span class="lineno"> 8311</span>    }</div>
<div class="line"><span class="lineno"> 8312</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8313</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, and <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph" id="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph" id="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,380,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,13,187,38"/>
</map>
</div>

</div>
</div>
<a id="a02d0e91095e3b2cdfbc913e7bc25abf8" name="a02d0e91095e3b2cdfbc913e7bc25abf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d0e91095e3b2cdfbc913e7bc25abf8">&#9670;&#160;</a></span>elf_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const  * PackLinuxElf64::elf_lookup </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08722">8722</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8723</span>{</div>
<div class="line"><span class="lineno"> 8724</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>) {</div>
<div class="line"><span class="lineno"> 8725</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> nbucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8726</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[2];</div>
<div class="line"><span class="lineno"> 8727</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> chains = &amp;buckets[nbucket];</div>
<div class="line"><span class="lineno"> 8728</span>        <span class="keywordflow">if</span> (nbucket) { <span class="comment">// -rust-musl can have &quot;empty&quot; hashtab</span></div>
<div class="line"><span class="lineno"> 8729</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> m = <a class="code hl_function" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">elf_hash</a>(name) % nbucket;</div>
<div class="line"><span class="lineno"> 8730</span>            <span class="keywordtype">unsigned</span> nvisit = 0;</div>
<div class="line"><span class="lineno"> 8731</span>            <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>;</div>
<div class="line"><span class="lineno"> 8732</span>            <span class="keywordflow">for</span> (<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>= <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[m]); <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>; ) {</div>
<div class="line"><span class="lineno"> 8733</span>                <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> p= <a class="code hl_function" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name</a>(<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>, (<span class="keywordtype">unsigned</span>)-1);</div>
<div class="line"><span class="lineno"> 8734</span>                <span class="keywordflow">if</span> (p &amp;&amp; 0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, p)) {</div>
<div class="line"><span class="lineno"> 8735</span>                    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>];</div>
<div class="line"><span class="lineno"> 8736</span>                }</div>
<div class="line"><span class="lineno"> 8737</span>                <span class="keywordflow">if</span> (nbucket &lt;= ++nvisit) {</div>
<div class="line"><span class="lineno"> 8738</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;circular DT_HASH chain %d\n&quot;</span>, <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>);</div>
<div class="line"><span class="lineno"> 8739</span>                }</div>
<div class="line"><span class="lineno"> 8740</span>                <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;chains[<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>]);</div>
<div class="line"><span class="lineno"> 8741</span>                <span class="keywordflow">if</span> (nbucket &lt;= <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>) { <span class="comment">// bad hashtab</span></div>
<div class="line"><span class="lineno"> 8742</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8743</span>                }</div>
<div class="line"><span class="lineno"> 8744</span>            }</div>
<div class="line"><span class="lineno"> 8745</span>        }</div>
<div class="line"><span class="lineno"> 8746</span>    }</div>
<div class="line"><span class="lineno"> 8747</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>) {</div>
<div class="line"><span class="lineno"> 8748</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8749</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symbias  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[1]);</div>
<div class="line"><span class="lineno"> 8750</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bitmask = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[2]);</div>
<div class="line"><span class="lineno"> 8751</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> gnu_shift = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[3]);</div>
<div class="line"><span class="lineno"> 8752</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *<span class="keyword">const</span> bitmask = (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[4];</div>
<div class="line"><span class="lineno"> 8753</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> buckets = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)&amp;bitmask[n_bitmask];</div>
<div class="line"><span class="lineno"> 8754</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> hasharr = &amp;buckets[n_bucket];</div>
<div class="line"><span class="lineno"> 8755</span> </div>
<div class="line"><span class="lineno"> 8756</span>        <span class="keywordflow">if</span> (31 &lt; gnu_shift) {</div>
<div class="line"><span class="lineno"> 8757</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_shift %#x&quot;</span>, gnu_shift);</div>
<div class="line"><span class="lineno"> 8758</span>        }</div>
<div class="line"><span class="lineno"> 8759</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) &lt;= (<span class="keywordtype">void</span> <span class="keyword">const</span> *)hasharr) {</div>
<div class="line"><span class="lineno"> 8760</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bucket %#x\n&quot;</span>, n_bucket);</div>
<div class="line"><span class="lineno"> 8761</span>        }</div>
<div class="line"><span class="lineno"> 8762</span>        <span class="keywordflow">if</span> (!n_bitmask</div>
<div class="line"><span class="lineno"> 8763</span>        || (<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)bitmask - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 8764</span>                &lt;= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*n_bitmask ) {</div>
<div class="line"><span class="lineno"> 8765</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bitmask %#x\n&quot;</span>, n_bitmask);</div>
<div class="line"><span class="lineno"> 8766</span>        }</div>
<div class="line"><span class="lineno"> 8767</span>        <span class="keywordflow">if</span> (n_bucket) { <span class="comment">// -rust-musl can have &quot;empty&quot; gashtab</span></div>
<div class="line"><span class="lineno"> 8768</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> h = <a class="code hl_function" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">gnu_hash</a>(name);</div>
<div class="line"><span class="lineno"> 8769</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hbit1 = 077&amp; h;</div>
<div class="line"><span class="lineno"> 8770</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hbit2 = 077&amp; (h&gt;&gt;gnu_shift);</div>
<div class="line"><span class="lineno"> 8771</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;bitmask[(n_bitmask -1) &amp; (h&gt;&gt;6)]);</div>
<div class="line"><span class="lineno"> 8772</span>            <span class="keywordflow">if</span> (1&amp; (w&gt;&gt;hbit1) &amp; (w&gt;&gt;hbit2)) {</div>
<div class="line"><span class="lineno"> 8773</span>                <span class="keywordtype">unsigned</span> hhead = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[h % n_bucket]);</div>
<div class="line"><span class="lineno"> 8774</span>                <span class="keywordflow">if</span> (hhead) {</div>
<div class="line"><span class="lineno"> 8775</span>                    <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> <span class="keyword">const</span> *dsp = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[hhead];</div>
<div class="line"><span class="lineno"> 8776</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *hp = &amp;hasharr[hhead - symbias];</div>
<div class="line"><span class="lineno"> 8777</span>                    <span class="keywordtype">unsigned</span> k;</div>
<div class="line"><span class="lineno"> 8778</span>                    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 8779</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a> &lt;= hp) {</div>
<div class="line"><span class="lineno"> 8780</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_hash[%#tx]  head=%u&quot;</span>,</div>
<div class="line"><span class="lineno"> 8781</span>                                hp - hasharr, hhead);</div>
<div class="line"><span class="lineno"> 8782</span>                        }</div>
<div class="line"><span class="lineno"> 8783</span>                        k = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(hp);</div>
<div class="line"><span class="lineno"> 8784</span>                        <span class="keywordflow">if</span> (0==((h ^ k)&gt;&gt;1)) {</div>
<div class="line"><span class="lineno"> 8785</span>                            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> st_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dsp-&gt;st_name);</div>
<div class="line"><span class="lineno"> 8786</span>                            <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> p = <a class="code hl_function" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a>(st_name, (<span class="keywordtype">unsigned</span>)-1);</div>
<div class="line"><span class="lineno"> 8787</span>                            <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, p)) {</div>
<div class="line"><span class="lineno"> 8788</span>                                <span class="keywordflow">return</span> dsp;</div>
<div class="line"><span class="lineno"> 8789</span>                            }</div>
<div class="line"><span class="lineno"> 8790</span>                        }</div>
<div class="line"><span class="lineno"> 8791</span>                    } <span class="keywordflow">while</span> (++dsp, ++hp, 0==(1u&amp; k));</div>
<div class="line"><span class="lineno"> 8792</span>                }</div>
<div class="line"><span class="lineno"> 8793</span>            }</div>
<div class="line"><span class="lineno"> 8794</span>        }</div>
<div class="line"><span class="lineno"> 8795</span>    }</div>
<div class="line"><span class="lineno"> 8796</span>    <span class="comment">// 2021-12-25  FIXME: Some Rust programs use</span></div>
<div class="line"><span class="lineno"> 8797</span>    <span class="comment">//    (1==n_bucket &amp;&amp; 0==buckets[0] &amp;&amp; 1==n_bitmask &amp;&amp; 0==bitmask[0])</span></div>
<div class="line"><span class="lineno"> 8798</span>    <span class="comment">// to minimize space in DT_GNU_HASH. This causes the fancy lookup to fail.</span></div>
<div class="line"><span class="lineno"> 8799</span>    <span class="comment">// Is a fallback to linear search assumed?</span></div>
<div class="line"><span class="lineno"> 8800</span>    <span class="comment">// 2022-03-12  Some Rust programs have 0==n_bucket.</span></div>
<div class="line"><span class="lineno"> 8801</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8802</span> </div>
<div class="line"><span class="lineno"> 8803</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a504fe912dd96ebfcd443b89dd425317f"><div class="ttname"><a href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">PackLinuxElf::gnu_hash</a></div><div class="ttdeci">static unsigned gnu_hash(char const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08610">p_lx_elf.cpp:8610</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a9cdb0429d3e2faba00ef2d67b2c628c0"><div class="ttname"><a href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">PackLinuxElf::elf_hash</a></div><div class="ttdeci">static unsigned elf_hash(char const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08621">p_lx_elf.cpp:8621</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a9bd631b0b513dae0e31c1042265af539"><div class="ttname"><a href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov si</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00258">lzma_m.h:258</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">PackLinuxElf::elf_hash()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a>, <a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>, <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>, <a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">PackLinuxElf::gnu_hash()</a>, <a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>, <a class="el" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph" id="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph">
<area shape="rect" title=" " alt="" coords="5,189,151,229"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="202,5,369,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="211,106,360,146"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="420,106,569,146"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="617,168,736,193"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="430,171,559,196"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="221,272,350,297"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="199,321,372,347"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="252,395,319,420"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph" id="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph">
<area shape="rect" title=" " alt="" coords="735,55,880,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,5,440,31"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,55,445,95"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,119,444,159"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a4204f3ad0b4eff8655e10f62ac640a22" name="a4204f3ad0b4eff8655e10f62ac640a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4204f3ad0b4eff8655e10f62ac640a22">&#9670;&#160;</a></span>elf_unsigned_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::elf_unsigned_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#ac7cb95fd27c29245be62f4e388fc3f09">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08244">8244</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8245</span>{</div>
<div class="line"><span class="lineno"> 8246</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(key);</div>
<div class="line"><span class="lineno"> 8247</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 8248</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val);</div>
<div class="line"><span class="lineno"> 8249</span>    }</div>
<div class="line"><span class="lineno"> 8250</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 8251</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, and <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph" id="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,156,75"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="204,5,349,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="397,42,527,67"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph" id="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph">
<area shape="rect" title=" " alt="" coords="1176,251,1327,291"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,43,187,69"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="966,221,1111,261"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,187,901,227"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,272,662,312"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,307,427,333"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="949,437,1128,477"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="955,387,1122,413"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="962,157,1115,197"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,125,687,165"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,43,440,69"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,93,445,133"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,157,444,197"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="735,445,901,470"/>
</map>
</div>

</div>
</div>
<a id="a4b4cfbd2d81ab91d393764f41c48ad44" name="a4b4cfbd2d81ab91d393764f41c48ad44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4cfbd2d81ab91d393764f41c48ad44">&#9670;&#160;</a></span>find_dt_ndx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::find_dt_ndx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>&#160;</td>
          <td class="paramname"><em>rva</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08381">8381</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8382</span>{</div>
<div class="line"><span class="lineno"> 8383</span>    <span class="keywordtype">unsigned</span> *<span class="keyword">const</span> dto = (<span class="keywordtype">unsigned</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 8384</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> dto_size = <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() / <span class="keyword">sizeof</span>(*dto);</div>
<div class="line"><span class="lineno"> 8385</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; dto_size &amp;&amp; dto[j]; ++j) { <span class="comment">// linear search of short table</span></div>
<div class="line"><span class="lineno"> 8386</span>        <span class="keywordflow">if</span> (rva == dto[j]) {</div>
<div class="line"><span class="lineno"> 8387</span>            <span class="keywordflow">return</span> j;</div>
<div class="line"><span class="lineno"> 8388</span>        }</div>
<div class="line"><span class="lineno"> 8389</span>    }</div>
<div class="line"><span class="lineno"> 8390</span>    <span class="keywordflow">return</span> ~0u;</div>
<div class="line"><span class="lineno"> 8391</span>}</div>
<div class="ttc" id="aclassMemBuffer_html_a50cf45756c991e8d65a6b90b8e6a5be2"><div class="ttname"><a href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr</a></div><div class="ttdeci">void * getVoidPtr() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00205">membuffer.h:205</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a834063e926d1118a24f23a8106edcd4e"><div class="ttname"><a href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a></div><div class="ttdeci">MemBuffer mb_dt_offsets</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00091">p_lx_elf.h:91</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, and <a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph" id="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,157,63"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="215,5,365,31"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="205,55,375,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph" id="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph">
<area shape="rect" title=" " alt="" coords="1143,81,1295,121"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="949,81,1095,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="a6c77e1df704fbb16e2d048937bdb0663" name="a6c77e1df704fbb16e2d048937bdb0663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c77e1df704fbb16e2d048937bdb0663">&#9670;&#160;</a></span>find_LOAD_gap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::find_LOAD_gap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *const&#160;</td>
          <td class="paramname"><em>phdri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05608">5608</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5613</span>{</div>
<div class="line"><span class="lineno"> 5614</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;phdr[k])) {</div>
<div class="line"><span class="lineno"> 5615</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 5616</span>    }</div>
<div class="line"><span class="lineno"> 5617</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hi = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[k].p_offset) +</div>
<div class="line"><span class="lineno"> 5618</span>                        <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5619</span>    <span class="keywordtype">unsigned</span> lo = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">u_file_size</a>;</div>
<div class="line"><span class="lineno"> 5620</span>    <span class="keywordflow">if</span> (lo &lt; hi)</div>
<div class="line"><span class="lineno"> 5621</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad input: PT_LOAD beyond end-of-file&quot;</span>);</div>
<div class="line"><span class="lineno"> 5622</span>    <span class="keywordtype">unsigned</span> j = k;</div>
<div class="line"><span class="lineno"> 5623</span>    <span class="keywordflow">for</span> (;;) { <span class="comment">// circular search, optimize for adjacent ascending</span></div>
<div class="line"><span class="lineno"> 5624</span>        ++j;</div>
<div class="line"><span class="lineno"> 5625</span>        <span class="keywordflow">if</span> (nph==j) {</div>
<div class="line"><span class="lineno"> 5626</span>            j = 0;</div>
<div class="line"><span class="lineno"> 5627</span>        }</div>
<div class="line"><span class="lineno"> 5628</span>        <span class="keywordflow">if</span> (k==j) {</div>
<div class="line"><span class="lineno"> 5629</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5630</span>        }</div>
<div class="line"><span class="lineno"> 5631</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;phdr[j])) {</div>
<div class="line"><span class="lineno"> 5632</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> t = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_offset);</div>
<div class="line"><span class="lineno"> 5633</span>            <span class="keywordflow">if</span> ((t - hi) &lt; (lo - hi)) {</div>
<div class="line"><span class="lineno"> 5634</span>                lo = t;</div>
<div class="line"><span class="lineno"> 5635</span>                <span class="keywordflow">if</span> (hi==lo) {</div>
<div class="line"><span class="lineno"> 5636</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5637</span>                }</div>
<div class="line"><span class="lineno"> 5638</span>            }</div>
<div class="line"><span class="lineno"> 5639</span>        }</div>
<div class="line"><span class="lineno"> 5640</span>    }</div>
<div class="line"><span class="lineno"> 5641</span>    <span class="keywordflow">return</span> lo - hi;</div>
<div class="line"><span class="lineno"> 5642</span>}</div>
<div class="ttc" id="astructPackHeader_html_ae3a40ba7325ebc8b86301bc9e7c5d3d6"><div class="ttname"><a href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a></div><div class="ttdeci">unsigned u_file_size</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00058">packhead.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph" id="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,157,87"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="232,5,361,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="205,55,388,80"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="237,104,356,129"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="436,55,565,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph" id="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph">
<area shape="rect" title=" " alt="" coords="228,47,380,87"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="9,5,176,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="9,55,176,80"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,104,180,129"/>
</map>
</div>

</div>
</div>
<a id="acc61917c51c71bfcb0f9af20ba7714d6" name="acc61917c51c71bfcb0f9af20ba7714d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc61917c51c71bfcb0f9af20ba7714d6">&#9670;&#160;</a></span>forward_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::forward_Shdrs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>ehdro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06244">6244</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6245</span>{</div>
<div class="line"><span class="lineno"> 6246</span>    <span class="keywordflow">if</span> (!fo) {</div>
<div class="line"><span class="lineno"> 6247</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 6248</span>    }</div>
<div class="line"><span class="lineno"> 6249</span>    <span class="keywordtype">unsigned</span> penalty = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 6250</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a>) { <span class="comment">// Forward select _Shdr</span></div>
<div class="line"><span class="lineno"> 6251</span>        <span class="comment">// Keep _Shdr for rtld data (below xct_off).</span></div>
<div class="line"><span class="lineno"> 6252</span>        <span class="comment">// Discard _Shdr for compressed regions, except &quot;.text&quot; for gdb.</span></div>
<div class="line"><span class="lineno"> 6253</span>        <span class="comment">// Keep _Shdr for SHF_WRITE.</span></div>
<div class="line"><span class="lineno"> 6254</span>        <span class="comment">// Discard _Shdr with (0==sh_addr), except _Shdr[0]</span></div>
<div class="line"><span class="lineno"> 6255</span>        <span class="comment">// Keep ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 6256</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> want_types_mask =</div>
<div class="line"><span class="lineno"> 6257</span>              1u&lt;&lt;SHT_SYMTAB</div>
<div class="line"><span class="lineno"> 6258</span>            | 1u&lt;&lt;SHT_RELA</div>
<div class="line"><span class="lineno"> 6259</span>            | 1u&lt;&lt;SHT_PROGBITS  <span class="comment">// see comment above</span></div>
<div class="line"><span class="lineno"> 6260</span>            | 1u&lt;&lt;SHT_HASH</div>
<div class="line"><span class="lineno"> 6261</span>            | 1u&lt;&lt;SHT_DYNAMIC</div>
<div class="line"><span class="lineno"> 6262</span>            | 1u&lt;&lt;SHT_NOTE</div>
<div class="line"><span class="lineno"> 6263</span>            | 1u&lt;&lt;SHT_REL</div>
<div class="line"><span class="lineno"> 6264</span>            | 1u&lt;&lt;SHT_RELR</div>
<div class="line"><span class="lineno"> 6265</span>            | 1u&lt;&lt;SHT_DYNSYM</div>
<div class="line"><span class="lineno"> 6266</span>            | 1u&lt;&lt;SHT_STRTAB  <span class="comment">// .shstrtab and .dynstr</span></div>
<div class="line"><span class="lineno"> 6267</span>            | 1u&lt;&lt;SHT_INIT_ARRAY</div>
<div class="line"><span class="lineno"> 6268</span>            | 1u&lt;&lt;SHT_FINI_ARRAY</div>
<div class="line"><span class="lineno"> 6269</span>            | 1u&lt;&lt;SHT_PREINIT_ARRAY</div>
<div class="line"><span class="lineno"> 6270</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_versym)</div>
<div class="line"><span class="lineno"> 6271</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_verneed)</div>
<div class="line"><span class="lineno"> 6272</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_verdef)</div>
<div class="line"><span class="lineno"> 6273</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 6274</span> </div>
<div class="line"><span class="lineno"> 6275</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> xct_off_hi = 0;</div>
<div class="line"><span class="lineno"> 6276</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, *ptr_end = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>];</div>
<div class="line"><span class="lineno"> 6277</span>        <span class="keywordflow">for</span> (; <a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> &lt; ptr_end; ++<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>) {</div>
<div class="line"><span class="lineno"> 6278</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>)) {</div>
<div class="line"><span class="lineno"> 6279</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> hi = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_filesz)</div>
<div class="line"><span class="lineno"> 6280</span>                    + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 6281</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; hi) {</div>
<div class="line"><span class="lineno"> 6282</span>                    xct_off_hi = hi;</div>
<div class="line"><span class="lineno"> 6283</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6284</span>                }</div>
<div class="line"><span class="lineno"> 6285</span>            }</div>
<div class="line"><span class="lineno"> 6286</span>        }</div>
<div class="line"><span class="lineno"> 6287</span> </div>
<div class="line"><span class="lineno"> 6288</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_ask_for(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(eho-&gt;e_shnum));</div>
<div class="line"><span class="lineno"> 6289</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(mb_ask_for, 0, mb_ask_for.getSize());</div>
<div class="line"><span class="lineno"> 6290</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *<span class="keyword">const</span> ask_for = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)mb_ask_for.getVoidPtr();</div>
<div class="line"><span class="lineno"> 6291</span> </div>
<div class="line"><span class="lineno"> 6292</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_shdro(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>));</div>
<div class="line"><span class="lineno"> 6293</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *sh_out0 = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)mb_shdro.getVoidPtr();</div>
<div class="line"><span class="lineno"> 6294</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *sh_out = sh_out0;</div>
<div class="line"><span class="lineno"> 6295</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *sh_in = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 6296</span> </div>
<div class="line"><span class="lineno"> 6297</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(sh_out, 0, <span class="keyword">sizeof</span>(*sh_out));  <span class="comment">// blank sh_out[0]</span></div>
<div class="line"><span class="lineno"> 6298</span>        ++sh_in; ++sh_out; <span class="keywordtype">unsigned</span> n_sh_out = 1;</div>
<div class="line"><span class="lineno"> 6299</span> </div>
<div class="line"><span class="lineno"> 6300</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 1; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++j, ++sh_in) {</div>
<div class="line"><span class="lineno"> 6301</span>            <span class="keywordtype">char</span> <span class="keyword">const</span> *sh_name = &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_name)];</div>
<div class="line"><span class="lineno"> 6302</span>            (void)sh_name;  <span class="comment">// debugging</span></div>
<div class="line"><span class="lineno"> 6303</span>            <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 6304</span>            <span class="keywordtype">unsigned</span> sh_info = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_info);</div>
<div class="line"><span class="lineno"> 6305</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_flags   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_flags);</div>
<div class="line"><span class="lineno"> 6306</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_addr    = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 6307</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_offset  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 6308</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_size    = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 6309</span>            <span class="keywordflow">if</span> (ask_for[j]) { <span class="comment">// Some previous _Shdr requested  me</span></div>
<div class="line"><span class="lineno"> 6310</span>                <span class="comment">// Tell them my new index</span></div>
<div class="line"><span class="lineno"> 6311</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out0[ask_for[j]].sh_info, n_sh_out);  <span class="comment">// sh_info vs st_shndx</span></div>
<div class="line"><span class="lineno"> 6312</span>            }</div>
<div class="line"><span class="lineno"> 6313</span>            <span class="keywordflow">if</span> (sh_info &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) { <span class="comment">// wild sh_info abounds!</span></div>
<div class="line"><span class="lineno"> 6314</span>                ask_for[sh_info] = j;  <span class="comment">// Enter my request, if any</span></div>
<div class="line"><span class="lineno"> 6315</span>            }</div>
<div class="line"><span class="lineno"> 6316</span>            <span class="keywordflow">if</span> (   (sh_offset &amp;&amp; sh_offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>)</div>
<div class="line"><span class="lineno"> 6317</span>                || (Elf64_Shdr::SHF_WRITE &amp; sh_flags)</div>
<div class="line"><span class="lineno"> 6318</span>                || (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>)</div>
<div class="line"><span class="lineno"> 6319</span>                || (<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> == sh_in)</div>
<div class="line"><span class="lineno"> 6320</span>                || (want_types_mask &amp; (1&lt;&lt;(0x1f &amp; sh_type)))</div>
<div class="line"><span class="lineno"> 6321</span>            ) {</div>
<div class="line"><span class="lineno"> 6322</span>                *sh_out = *sh_in;</div>
<div class="line"><span class="lineno"> 6323</span>                <span class="keywordflow">if</span> (sh_offset &gt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// may slide down: earlier compression</span></div>
<div class="line"><span class="lineno"> 6324</span>                    <span class="keywordflow">if</span> (sh_offset &gt;= xct_off_hi) { <span class="comment">// easy: so_slide down</span></div>
<div class="line"><span class="lineno"> 6325</span>                        <span class="keywordflow">if</span> (sh_out-&gt;sh_addr) <span class="comment">// change only if non-zero</span></div>
<div class="line"><span class="lineno"> 6326</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr,   <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_addr);</div>
<div class="line"><span class="lineno"> 6327</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 6328</span>                    }</div>
<div class="line"><span class="lineno"> 6329</span>                    <span class="keywordflow">else</span> { <span class="comment">// somewhere in compressed; try proportional (aligned)</span></div>
<div class="line"><span class="lineno"> 6330</span>                        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> slice = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + (~0xFu &amp; (unsigned)(</div>
<div class="line"><span class="lineno"> 6331</span>                             (sh_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) *</div>
<div class="line"><span class="lineno"> 6332</span>                            ((sh_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) / (<span class="keywordtype">float</span>)(xct_off_hi - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>))));</div>
<div class="line"><span class="lineno"> 6333</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr,   slice);</div>
<div class="line"><span class="lineno"> 6334</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, slice);</div>
<div class="line"><span class="lineno"> 6335</span>                    }</div>
<div class="line"><span class="lineno"> 6336</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> max_sz = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_out-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 6337</span>                    <span class="keywordflow">if</span> (sh_size &gt; max_sz) { <span class="comment">// avoid complaint &quot;extends beyond EOF&quot;</span></div>
<div class="line"><span class="lineno"> 6338</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_size, max_sz);</div>
<div class="line"><span class="lineno"> 6339</span>                    }</div>
<div class="line"><span class="lineno"> 6340</span>                }</div>
<div class="line"><span class="lineno"> 6341</span>                <span class="keywordflow">if</span> (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) { <span class="comment">// changes Elf64_Ehdr itself</span></div>
<div class="line"><span class="lineno"> 6342</span>                    <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shstrndx, sh_out -</div>
<div class="line"><span class="lineno"> 6343</span>                        (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)mb_shdro.getVoidPtr());</div>
<div class="line"><span class="lineno"> 6344</span>                }</div>
<div class="line"><span class="lineno"> 6345</span>                <span class="keywordflow">if</span> (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></div>
<div class="line"><span class="lineno"> 6346</span>                ||  <a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> == sh_in</div>
<div class="line"><span class="lineno"> 6347</span>                ||  (SHT_NOTE == sh_type &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_offset)</div>
<div class="line"><span class="lineno"> 6348</span>                ) { <span class="comment">// append a copy</span></div>
<div class="line"><span class="lineno"> 6349</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6350</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>((<a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>)sh_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6351</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>,  sh_size);</div>
<div class="line"><span class="lineno"> 6352</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sh_size);</div>
<div class="line"><span class="lineno"> 6353</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> +=    sh_size;</div>
<div class="line"><span class="lineno"> 6354</span>                } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6355</span>                <span class="keywordflow">if</span> (SHT_PROGBITS == sh_type) {</div>
<div class="line"><span class="lineno"> 6356</span>                    <span class="keywordflow">if</span> (sh_offset &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 6357</span>                    &amp;&amp;  0 == <a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.text&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_name)) ) {</div>
<div class="line"><span class="lineno"> 6358</span>                        <span class="comment">// .text was compressed (but perhaps omitting some leading</span></div>
<div class="line"><span class="lineno"> 6359</span>                        <span class="comment">// portion, if less than 4 PT_LOAD)</span></div>
<div class="line"><span class="lineno"> 6360</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_size, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_size);</div>
<div class="line"><span class="lineno"> 6361</span>                    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6362</span>                    <span class="keywordflow">if</span> (0 == sh_in-&gt;sh_addr) { <span class="comment">// .gnu_debuglink etc</span></div>
<div class="line"><span class="lineno"> 6363</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 6364</span>                    }</div>
<div class="line"><span class="lineno"> 6365</span>                }</div>
<div class="line"><span class="lineno"> 6366</span>                <span class="comment">// Exploration for updating Shdrs from Dynamic, to pacify Android.</span></div>
<div class="line"><span class="lineno"> 6367</span>                <span class="comment">// Motivated by --force-pie with an input shared library;</span></div>
<div class="line"><span class="lineno"> 6368</span>                <span class="comment">// see https://github.com/upx/upx/issues/694</span></div>
<div class="line"><span class="lineno"> 6369</span>                <span class="comment">// But then realized that the pointed-to regions typically were</span></div>
<div class="line"><span class="lineno"> 6370</span>                <span class="comment">// just above Elfhdrs (overlay_offset), so the data would be</span></div>
<div class="line"><span class="lineno"> 6371</span>                <span class="comment">// incorrect because occupied by compressed PT_LOADS.</span></div>
<div class="line"><span class="lineno"> 6372</span>                <span class="comment">// But don&#39;t lose the code, so comment-out via &quot;if (0)&quot;.</span></div>
<div class="line"><span class="lineno"> 6373</span>                <span class="keywordflow">if</span> (0) <span class="keywordflow">switch</span>(sh_type) { <span class="comment">// start {Shdr, Dynamic} pairs</span></div>
<div class="line"><span class="lineno"> 6374</span>                <span class="keywordflow">case</span> SHT_DYNSYM: {</div>
<div class="line"><span class="lineno"> 6375</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_SYMTAB));</div>
<div class="line"><span class="lineno"> 6376</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6377</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6378</span>                <span class="keywordflow">case</span> SHT_STRTAB: {</div>
<div class="line"><span class="lineno"> 6379</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> != j) {</div>
<div class="line"><span class="lineno"> 6380</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRTAB));</div>
<div class="line"><span class="lineno"> 6381</span>                        sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6382</span>                    }</div>
<div class="line"><span class="lineno"> 6383</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6384</span>                <span class="keywordflow">case</span> SHT_GNU_versym: {</div>
<div class="line"><span class="lineno"> 6385</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERSYM));</div>
<div class="line"><span class="lineno"> 6386</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6387</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6388</span>                <span class="keywordflow">case</span> SHT_GNU_verneed: {</div>
<div class="line"><span class="lineno"> 6389</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERNEED));</div>
<div class="line"><span class="lineno"> 6390</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6391</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6392</span>                <span class="keywordflow">case</span> SHT_GNU_HASH: {</div>
<div class="line"><span class="lineno"> 6393</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_GNU_HASH));</div>
<div class="line"><span class="lineno"> 6394</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6395</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6396</span>                <span class="keywordflow">case</span> SHT_HASH: {</div>
<div class="line"><span class="lineno"> 6397</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_HASH));</div>
<div class="line"><span class="lineno"> 6398</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6399</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6400</span>                <span class="keywordflow">case</span> SHT_RELA: {</div>
<div class="line"><span class="lineno"> 6401</span>                    <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rela.dyn&quot;</span>, sh_name)) {</div>
<div class="line"><span class="lineno"> 6402</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELA));</div>
<div class="line"><span class="lineno"> 6403</span>                        sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6404</span>                    }</div>
<div class="line"><span class="lineno"> 6405</span>                    <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rela.plt&quot;</span>, sh_name)) {</div>
<div class="line"><span class="lineno"> 6406</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_JMPREL));</div>
<div class="line"><span class="lineno"> 6407</span>                        sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 6408</span>                    }</div>
<div class="line"><span class="lineno"> 6409</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6410</span>                } <span class="comment">// end {Shdr, Dynamic} pairs</span></div>
<div class="line"><span class="lineno"> 6411</span>                ++sh_out; ++n_sh_out;</div>
<div class="line"><span class="lineno"> 6412</span>            }</div>
<div class="line"><span class="lineno"> 6413</span>        }</div>
<div class="line"><span class="lineno"> 6414</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6415</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6416</span>        <span class="keywordtype">unsigned</span> len = (<span class="keywordtype">char</span> *)sh_out - (<span class="keywordtype">char</span> *)mb_shdro.getVoidPtr();</div>
<div class="line"><span class="lineno"> 6417</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shnum, len / <span class="keyword">sizeof</span>(*sh_out));</div>
<div class="line"><span class="lineno"> 6418</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 6419</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(mb_shdro, len);</div>
<div class="line"><span class="lineno"> 6420</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 6421</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6422</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(*eho));</div>
<div class="line"><span class="lineno"> 6423</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 6424</span>    }</div>
<div class="line"><span class="lineno"> 6425</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>) {</div>
<div class="line"><span class="lineno"> 6426</span>        <span class="comment">// Forward just ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 6427</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> shdr_aa[3];</div>
<div class="line"><span class="lineno"> 6428</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> attr_len = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 6429</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> str_aa[] = <span class="stringliteral">&quot;\x00&quot;</span> <span class="stringliteral">&quot;.shstrtab\x00&quot;</span> <span class="stringliteral">&quot;.ARM.attributes\x00&quot;</span>;</div>
<div class="line"><span class="lineno"> 6430</span> </div>
<div class="line"><span class="lineno"> 6431</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(shdr_aa, 0, <span class="keyword">sizeof</span> shdr_aa);</div>
<div class="line"><span class="lineno"> 6432</span>            <span class="comment">// shstrtab</span></div>
<div class="line"><span class="lineno"> 6433</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_name, 1);</div>
<div class="line"><span class="lineno"> 6434</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_type, Elf64_Shdr::SHT_STRTAB);</div>
<div class="line"><span class="lineno"> 6435</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[1].sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6436</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[1].sh_size, <span class="keyword">sizeof</span>(str_aa));</div>
<div class="line"><span class="lineno"> 6437</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[1].sh_addralign, 1);</div>
<div class="line"><span class="lineno"> 6438</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(str_aa, <span class="keyword">sizeof</span>(str_aa)); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(str_aa);</div>
<div class="line"><span class="lineno"> 6439</span> </div>
<div class="line"><span class="lineno"> 6440</span>            <span class="comment">// ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 6441</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_name, 11);</div>
<div class="line"><span class="lineno"> 6442</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_type, Elf64_Shdr::SHT_ARM_ATTRIBUTES);</div>
<div class="line"><span class="lineno"> 6443</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[2].sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6444</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[2].sh_size, attr_len);</div>
<div class="line"><span class="lineno"> 6445</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[2].sh_addralign, 1);</div>
<div class="line"><span class="lineno"> 6446</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>-&gt;sh_offset)], attr_len);</div>
<div class="line"><span class="lineno"> 6447</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += attr_len);</div>
<div class="line"><span class="lineno"> 6448</span> </div>
<div class="line"><span class="lineno"> 6449</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shnum, 3);</div>
<div class="line"><span class="lineno"> 6450</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 6451</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6452</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shstrndx, 1);</div>
<div class="line"><span class="lineno"> 6453</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(shdr_aa, <span class="keyword">sizeof</span>(shdr_aa));</div>
<div class="line"><span class="lineno"> 6454</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(shdr_aa);</div>
<div class="line"><span class="lineno"> 6455</span> </div>
<div class="line"><span class="lineno"> 6456</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6457</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(*eho));</div>
<div class="line"><span class="lineno"> 6458</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 6459</span>    }</div>
<div class="line"><span class="lineno"> 6460</span>    penalty = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - penalty;</div>
<div class="line"><span class="lineno"> 6461</span>    <a class="code hl_function" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a>(<span class="stringliteral">&quot;Android penalty = %d bytes&quot;</span>, penalty);</div>
<div class="line"><span class="lineno"> 6462</span>    <span class="keywordflow">return</span> penalty;</div>
<div class="line"><span class="lineno"> 6463</span>}</div>
<div class="ttc" id="aclassInputFile_html_ae6797787eefa57fdc7191461a47109f6"><div class="ttname"><a href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read</a></div><div class="ttdeci">int read(SPAN_P(void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00190">file.cpp:190</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a6dcc27c7627119f073cf47775984fcad"><div class="ttname"><a href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite</a></div><div class="ttdeci">void rewrite(SPAN_P(const void) buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00314">file.cpp:314</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8be817665d0219026ebd50acdd3700af"><div class="ttname"><a href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a></div><div class="ttdeci">upx_off_t so_slide</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00108">p_lx_elf.h:108</a></div></div>
<div class="ttc" id="aclassPacker_html_a860499fa0849a7c7a7c4d43ee084f76e"><div class="ttname"><a href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16</a></div><div class="ttdeci">void set_te16(void *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00265">packer.h:265</a></div></div>
<div class="ttc" id="aclassPacker_html_a95d40264330fe966e66718440b450ec8"><div class="ttname"><a href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a></div><div class="ttdeci">MemBuffer ibuf</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00329">packer.h:329</a></div></div>
<div class="ttc" id="aconf_8h_html_a7e40dc9a8b2c00d7675df0cd2bd7c91e"><div class="ttname"><a href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a></div><div class="ttdeci">long long upx_off_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00199">conf.h:199</a></div></div>
<div class="ttc" id="alinux_8h_html_ad2a2e6c114780c3071efd24f16c7f7d8"><div class="ttname"><a href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a></div><div class="ttdeci">#define SEEK_END</div><div class="ttdef"><b>Definition:</b> <a href="linux_8h_source.html#l00111">linux.h:111</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a7b01bc9a5d719e0ece76d9b8dd822dde"><div class="ttname"><a href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov cx endm macro M_shld_diax_8_bxcx mov di mov bl mov ah mov al xor al mov bx endm macro M_shld_8_bp h l mov word ptr[bp+h] mov word ptr[bp+l] M_shld_8 mov word ptr[bp+h]</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00292">lzma_m.h:292</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">Elf64_Ehdr::e_shentsize</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph" id="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph">
<area shape="rect" title=" " alt="" coords="5,684,184,724"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="248,94,399,134"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="659,44,788,70"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="294,362,353,387"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="470,367,601,392"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="471,750,600,775"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="248,766,399,791"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="239,815,408,840"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="300,864,347,890"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="232,716,415,742"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="285,938,361,963"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="666,514,781,539"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="252,463,395,488"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="477,700,594,726"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="471,651,599,676"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="259,987,387,1012"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="259,1036,387,1062"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="259,1086,387,1111"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="290,1159,357,1184"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="463,37,608,77"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="1031,152,1173,178"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1449,355,1586,380"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="656,254,791,279"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1659,683,1789,708"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="862,379,951,404"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1057,470,1147,495"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="679,355,768,380"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1239,203,1366,228"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="842,254,971,279"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1424,230,1611,255"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1696,230,1752,255"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1039,254,1165,279"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1229,304,1376,330"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1490,304,1545,330"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1447,492,1587,518"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1023,393,1181,433"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1243,432,1362,458"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="665,784,781,810"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="878,835,935,860"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="839,683,975,708"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph" id="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,399,45"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a18903ac12b1370cdf82daef90aa27717" name="a18903ac12b1370cdf82daef90aa27717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18903ac12b1370cdf82daef90aa27717">&#9670;&#160;</a></span>generateElfHdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::generateElfHdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>brka</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a378dd6608963beeae5bb6393ef4b23d5">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03992">3992</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3997</span>{</div>
<div class="line"><span class="lineno"> 3998</span>    cprElfHdr2 *<span class="keyword">const</span> h2 = (cprElfHdr2 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>;</div>
<div class="line"><span class="lineno"> 3999</span>    cprElfHdr3 *<span class="keyword">const</span> h3 = (cprElfHdr3 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>;</div>
<div class="line"><span class="lineno"> 4000</span>    h3-&gt;ehdr =         ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;ehdr;</div>
<div class="line"><span class="lineno"> 4001</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_REL == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h3-&gt;ehdr.e_type)) {</div>
<div class="line"><span class="lineno"> 4002</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h3-&gt;ehdr.e_phoff, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 4003</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h3-&gt;ehdr.e_ehsize,<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 4004</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h3-&gt;ehdr.e_phentsize, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 4005</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h3-&gt;ehdr.e_phnum, 2);</div>
<div class="line"><span class="lineno"> 4006</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>], 0, <span class="keyword">sizeof</span>(h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>]));</div>
<div class="line"><span class="lineno"> 4007</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>], 0, <span class="keyword">sizeof</span>(h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>]));</div>
<div class="line"><span class="lineno"> 4008</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h3-&gt;phdr[2     ], 0, <span class="keyword">sizeof</span>(h3-&gt;phdr[2     ]));</div>
<div class="line"><span class="lineno"> 4009</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, 0);</div>
<div class="line"><span class="lineno"> 4010</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags, Elf64_Phdr::PF_X| Elf64_Phdr::PF_R);</div>
<div class="line"><span class="lineno"> 4011</span>    }</div>
<div class="line"><span class="lineno"> 4012</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4013</span>        h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>] = ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;phdr[1];  <span class="comment">// .data; .p_align</span></div>
<div class="line"><span class="lineno"> 4014</span>        h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>] = ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;phdr[0];  <span class="comment">// .text</span></div>
<div class="line"><span class="lineno"> 4015</span>    }</div>
<div class="line"><span class="lineno"> 4016</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h3-&gt;linfo, 0, <span class="keyword">sizeof</span>(h3-&gt;linfo));</div>
<div class="line"><span class="lineno"> 4017</span> </div>
<div class="line"><span class="lineno"> 4018</span>    h3-&gt;ehdr.e_type = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>;  <span class="comment">// ET_EXEC vs ET_DYN (gcc -pie -fPIC)</span></div>
<div class="line"><span class="lineno"> 4019</span>    h3-&gt;ehdr.e_ident[Elf64_Ehdr::EI_OSABI] = <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>;</div>
<div class="line"><span class="lineno"> 4020</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ELFOSABI_LINUX == <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>  <span class="comment">// proper</span></div>
<div class="line"><span class="lineno"> 4021</span>    &amp;&amp;  Elf64_Ehdr::ELFOSABI_NONE  == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_OSABI]  <span class="comment">// sloppy</span></div>
<div class="line"><span class="lineno"> 4022</span>    ) { <span class="comment">// propagate sloppiness so that decompression does not complain</span></div>
<div class="line"><span class="lineno"> 4023</span>        h3-&gt;ehdr.e_ident[Elf64_Ehdr::EI_OSABI] = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_OSABI];</div>
<div class="line"><span class="lineno"> 4024</span>    }</div>
<div class="line"><span class="lineno"> 4025</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>)) {</div>
<div class="line"><span class="lineno"> 4026</span>        h3-&gt;ehdr.e_flags = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a>;  <span class="comment">// &quot;0x1, abiv1&quot; vs &quot;0x2, abiv2&quot;</span></div>
<div class="line"><span class="lineno"> 4027</span>    }</div>
<div class="line"><span class="lineno"> 4028</span> </div>
<div class="line"><span class="lineno"> 4029</span>    assert(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;h2-&gt;ehdr.e_phoff)     == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 4030</span>    assert(<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_ehsize)    == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 4031</span>    assert(<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_phentsize) == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 4032</span> </div>
<div class="line"><span class="lineno"> 4033</span>    h2-&gt;ehdr.e_shoff = 0;</div>
<div class="line"><span class="lineno"> 4034</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a>) {</div>
<div class="line"><span class="lineno"> 4035</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h2-&gt;ehdr.e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4036</span>        h2-&gt;ehdr.e_shnum = <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a>;</div>
<div class="line"><span class="lineno"> 4037</span>        h2-&gt;ehdr.e_shstrndx = <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a> - 1;</div>
<div class="line"><span class="lineno"> 4038</span>    }</div>
<div class="line"><span class="lineno"> 4039</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4040</span>        <span class="comment">// https://bugzilla.redhat.com/show_bug.cgi?id=2131609</span></div>
<div class="line"><span class="lineno"> 4041</span>        <span class="comment">// 0==.e_shnum is a special case for libbfd</span></div>
<div class="line"><span class="lineno"> 4042</span>        <span class="comment">// that requires 0==.e_shentsize in order to force &quot;no Shdrs&quot;</span></div>
<div class="line"><span class="lineno"> 4043</span>        h2-&gt;ehdr.e_shentsize = 0;</div>
<div class="line"><span class="lineno"> 4044</span>        h2-&gt;ehdr.e_shnum = 0;</div>
<div class="line"><span class="lineno"> 4045</span>        h2-&gt;ehdr.e_shstrndx = 0;</div>
<div class="line"><span class="lineno"> 4046</span>    }</div>
<div class="line"><span class="lineno"> 4047</span> </div>
<div class="line"><span class="lineno"> 4048</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> phnum_i = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_phnum);</div>
<div class="line"><span class="lineno"> 4049</span>    <span class="keywordtype">unsigned</span>       phnum_o = 2 + <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>;  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 4050</span>    <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h2-&gt;ehdr.e_phnum, phnum_o);</div>
<div class="line"><span class="lineno"> 4051</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a> =  <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>)*phnum_o + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structp__info.html">p_info</a>);</div>
<div class="line"><span class="lineno"> 4052</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <span class="keyword">sizeof</span>(*h2));  <span class="comment">// + identsize;</span></div>
<div class="line"><span class="lineno"> 4053</span>              h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz;</div>
<div class="line"><span class="lineno"> 4054</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_type, <a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>);  <span class="comment">// be sure</span></div>
<div class="line"><span class="lineno"> 4055</span> </div>
<div class="line"><span class="lineno"> 4056</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; phnum_i; ++j) {</div>
<div class="line"><span class="lineno"> 4057</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;h3-&gt;phdr[j])) {</div>
<div class="line"><span class="lineno"> 4058</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>( &amp;h3-&gt;phdr[j].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 4059</span>        }</div>
<div class="line"><span class="lineno"> 4060</span>    }</div>
<div class="line"><span class="lineno"> 4061</span> </div>
<div class="line"><span class="lineno"> 4062</span>    <span class="comment">// Info for OS kernel to set the brk()</span></div>
<div class="line"><span class="lineno"> 4063</span>    <span class="keywordflow">if</span> (brka) {</div>
<div class="line"><span class="lineno"> 4064</span>        <span class="comment">// linux-2.6.14 binfmt_elf.c: SIGKILL if (0==.p_memsz) on a page boundary</span></div>
<div class="line"><span class="lineno"> 4065</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> lo_va_user(~(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)0);  <span class="comment">// infinity</span></div>
<div class="line"><span class="lineno"> 4066</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ) {</div>
<div class="line"><span class="lineno"> 4067</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[j])) {</div>
<div class="line"><span class="lineno"> 4068</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[j].p_vaddr);</div>
<div class="line"><span class="lineno"> 4069</span>                lo_va_user = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(lo_va_user, vaddr);</div>
<div class="line"><span class="lineno"> 4070</span>            }</div>
<div class="line"><span class="lineno"> 4071</span>        }</div>
<div class="line"><span class="lineno"> 4072</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(                 &amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr, lo_va_user);</div>
<div class="line"><span class="lineno"> 4073</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_paddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 4074</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 4075</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_paddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 4076</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_type, <a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>);  <span class="comment">// be sure</span></div>
<div class="line"><span class="lineno"> 4077</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_offset = 0;</div>
<div class="line"><span class="lineno"> 4078</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz = 0;</div>
<div class="line"><span class="lineno"> 4079</span>        <span class="comment">// .p_memsz = brka;  temporary until sz_pack2</span></div>
<div class="line"><span class="lineno"> 4080</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_memsz, brka - lo_va_user);</div>
<div class="line"><span class="lineno"> 4081</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, Elf64_Phdr::PF_R | Elf64_Phdr::PF_W);</div>
<div class="line"><span class="lineno"> 4082</span>    }</div>
<div class="line"><span class="lineno"> 4083</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 4084</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 4085</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags, ~Elf64_Phdr::PF_W &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags));</div>
<div class="line"><span class="lineno"> 4086</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(h2, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + 2* <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 4087</span> </div>
<div class="line"><span class="lineno"> 4088</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> zero_pad = 0;</div>
<div class="line"><span class="lineno"> 4089</span>    <span class="keywordtype">unsigned</span> uva0 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 4090</span>    <span class="keywordtype">unsigned</span> off_o = 0;</div>
<div class="line"><span class="lineno"> 4091</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> phase = 0; phase &lt; 2; ++phase) { <span class="comment">// 0: Phdrs;  1: bodies</span></div>
<div class="line"><span class="lineno"> 4092</span>        off_o = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>);</div>
<div class="line"><span class="lineno"> 4093</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>; ++j) {</div>
<div class="line"><span class="lineno"> 4094</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phtmp = *<a class="code hl_variable" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>[j];</div>
<div class="line"><span class="lineno"> 4095</span>            phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a> = phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a> = 0;</div>
<div class="line"><span class="lineno"> 4096</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> off_i = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4097</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>);</div>
<div class="line"><span class="lineno"> 4098</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 4099</span>            <span class="keywordtype">unsigned</span> pad = 0;</div>
<div class="line"><span class="lineno"> 4100</span>            <span class="keywordflow">if</span> (filesz &amp;&amp; align &amp;&amp; <a class="code hl_function" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a>(align)) {</div>
<div class="line"><span class="lineno"> 4101</span>                <span class="keywordtype">unsigned</span> alm1 = -1 + <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(8u, (<span class="keywordtype">unsigned</span>)align);</div>
<div class="line"><span class="lineno"> 4102</span>                pad = alm1 &amp; (0u - off_o);</div>
<div class="line"><span class="lineno"> 4103</span>                off_o += pad;</div>
<div class="line"><span class="lineno"> 4104</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>, off_o + uva0); phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a> = phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>;</div>
<div class="line"><span class="lineno"> 4105</span>            }</div>
<div class="line"><span class="lineno"> 4106</span>            <span class="keywordflow">if</span> (0==phase) {</div>
<div class="line"><span class="lineno"> 4107</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>, (filesz ? off_o : 0));</div>
<div class="line"><span class="lineno"> 4108</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;phtmp, <span class="keyword">sizeof</span>(phtmp));  <span class="comment">// Phdr</span></div>
<div class="line"><span class="lineno"> 4109</span>            }</div>
<div class="line"><span class="lineno"> 4110</span>            <span class="keywordflow">if</span> (1==phase) {</div>
<div class="line"><span class="lineno"> 4111</span>                <span class="keywordflow">if</span> (pad) fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;zero_pad, pad);</div>
<div class="line"><span class="lineno"> 4112</span>                <span class="keywordflow">if</span> (filesz) fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[off_i], filesz);  <span class="comment">// body</span></div>
<div class="line"><span class="lineno"> 4113</span>            }</div>
<div class="line"><span class="lineno"> 4114</span>            off_o += filesz;</div>
<div class="line"><span class="lineno"> 4115</span>        }</div>
<div class="line"><span class="lineno"> 4116</span>    }</div>
<div class="line"><span class="lineno"> 4117</span>    off_o = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, off_o);</div>
<div class="line"><span class="lineno"> 4118</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a> = off_o - (<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 4119</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz, off_o);</div>
<div class="line"><span class="lineno"> 4120</span> </div>
<div class="line"><span class="lineno"> 4121</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) + <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>;</div>
<div class="line"><span class="lineno"> 4122</span>    <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>);</div>
<div class="line"><span class="lineno"> 4123</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a>        = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structp__info.html">p_info</a>);</div>
<div class="line"><span class="lineno"> 4124</span> </div>
<div class="line"><span class="lineno"> 4125</span>    <a class="code hl_struct" href="structl__info.html">l_info</a> linfo2; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;linfo2, 0, <span class="keyword">sizeof</span>(linfo2));</div>
<div class="line"><span class="lineno"> 4126</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;linfo2, <span class="keyword">sizeof</span>(linfo2));</div>
<div class="line"><span class="lineno"> 4127</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a1a02a5314fbdff34469cfa4b59ddde10"><div class="ttname"><a href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a></div><div class="ttdeci">int o_elf_shnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00135">p_lx_elf.h:135</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a371519bdb05124340b9d78e067bee1e0"><div class="ttname"><a href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">PackLinuxElf::o_binfo</a></div><div class="ttdeci">unsigned o_binfo</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00107">p_lx_elf.h:107</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a80989e5fdaa51b0650d6f5d66eaf3766"><div class="ttname"><a href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a></div><div class="ttdeci">unsigned page_size</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00102">p_lx_elf.h:102</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aa3e227135d766557eb3e012e610d72a0"><div class="ttname"><a href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a></div><div class="ttdeci">unsigned overlay_offset</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00096">p_unix.h:96</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a84d7768fd6c6ece599d297090900cf92"><div class="ttname"><a href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a></div><div class="ttdeci">#define PT_LOAD</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00053">p_lx_elf.cpp:53</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a961610ff2ac229f29f7d03d3a2ccc084"><div class="ttname"><a href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a></div><div class="ttdeci">static off_t fpad4(OutputFile *fo, unsigned pos)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00098">p_lx_elf.cpp:98</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b"><div class="ttname"><a href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a></div><div class="ttdeci">@ C_BASE</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00508">p_lx_elf.cpp:507</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5"><div class="ttname"><a href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a></div><div class="ttdeci">@ C_TEXT</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00509">p_lx_elf.cpp:508</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a6c07667c1adfd724637d66535c3ffed0"><div class="ttname"><a href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a></div><div class="ttdeci">unsigned char e_ident[EI_NIDENT]</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00207">bsd.h:207</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_adecc8b3641e23794f39c78f15ab8c809"><div class="ttname"><a href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a></div><div class="ttdeci">Elf64_Half e_machine</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00209">bsd.h:209</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_ae6ea9e821472d35e7d2c446fa79bdc3a"><div class="ttname"><a href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a></div><div class="ttdeci">Elf64_Word e_flags</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00214">bsd.h:214</a></div></div>
<div class="ttc" id="astructp__info_html"><div class="ttname"><a href="structp__info.html">p_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00340">bsd.h:341</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>, <a class="el" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">PackLinuxElf::o_binfo</a>, <a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>, <a class="el" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>, and <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd::pack1()</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm::pack1()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle::pack1()</a>, and <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc::pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph" id="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph">
<area shape="rect" title=" " alt="" coords="5,377,192,417"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="302,132,361,157"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="471,183,601,208"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="267,233,396,259"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="471,309,601,335"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="267,384,396,409"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="240,335,423,360"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="294,433,369,459"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="293,507,369,532"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="267,556,395,581"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="267,605,395,631"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="267,655,395,680"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="832,5,975,31"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1449,109,1586,135"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="649,208,784,233"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1659,132,1789,157"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="859,283,948,308"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1057,337,1147,363"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="672,107,761,132"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1239,257,1366,283"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="839,157,968,183"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1424,257,1611,283"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1696,257,1752,283"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1039,157,1165,183"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1229,208,1376,233"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1490,159,1545,184"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1447,208,1587,233"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1023,273,1181,313"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1243,321,1362,347"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph" id="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph">
<area shape="rect" title=" " alt="" coords="211,101,397,141"/>
<area shape="rect" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8" title=" " alt="" coords="7,69,161,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53" title=" " alt="" coords="7,133,161,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb" title=" " alt="" coords="9,197,159,237"/>
</map>
</div>

</div>
</div>
<a id="a0587b38413f853b20625a28bf2a369e8" name="a0587b38413f853b20625a28bf2a369e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0587b38413f853b20625a28bf2a369e8">&#9670;&#160;</a></span>get_dynsym_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char const  * PackLinuxElf64::get_dynsym_name </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>symnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02558">2558</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2559</span>{</div>
<div class="line"><span class="lineno"> 2560</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a> &lt;= symnum) {</div>
<div class="line"><span class="lineno"> 2561</span>        (void)relnum;</div>
<div class="line"><span class="lineno"> 2562</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2563</span>    }</div>
<div class="line"><span class="lineno"> 2564</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[symnum].st_name), symnum);</div>
<div class="line"><span class="lineno"> 2565</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a4cc33d310cb391da2166a1dd3857ee4d"><div class="ttname"><a href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a></div><div class="ttdeci">unsigned symnum_max</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00093">p_lx_elf.h:93</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1()</a>, and <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph" id="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,155,75"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="203,5,352,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="213,70,342,95"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="400,13,519,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph" id="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph">
<area shape="rect" title=" " alt="" coords="928,39,1077,79"/>
<area shape="rect" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3" title=" " alt="" coords="495,5,685,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="735,67,880,107"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,17,187,43"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,67,687,107"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,43,440,68"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,93,445,133"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,157,444,197"/>
</map>
</div>

</div>
</div>
<a id="acd825cbaf5a768993a7f0b90a24c7a4c" name="acd825cbaf5a768993a7f0b90a24c7a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd825cbaf5a768993a7f0b90a24c7a4c">&#9670;&#160;</a></span>get_str_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char const  * PackLinuxElf64::get_str_name </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>st_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>symnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02548">2548</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2549</span>{</div>
<div class="line"><span class="lineno"> 2550</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> &lt;= st_name) {</div>
<div class="line"><span class="lineno"> 2551</span>        <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2552</span>            <span class="stringliteral">&quot;bad .st_name %#x in DT_SYMTAB[%d]&quot;</span>, st_name, symnum);</div>
<div class="line"><span class="lineno"> 2553</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2554</span>    }</div>
<div class="line"><span class="lineno"> 2555</span>    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>[st_name];</div>
<div class="line"><span class="lineno"> 2556</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a4c581148f2345d127c21f0ba5a33a656"><div class="ttname"><a href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a></div><div class="ttdeci">unsigned strtab_max</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00094">p_lx_elf.h:94</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS()</a>, <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, and <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph" id="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="203,13,321,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph" id="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph">
<area shape="rect" title=" " alt="" coords="1152,144,1301,184"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="929,77,1104,102"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="735,168,881,208"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="942,201,1091,241"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="735,5,881,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="736,69,880,109"/>
<area shape="rect" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8" title=" " alt="" coords="507,5,673,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="257,13,423,38"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,69,662,109"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,69,427,94"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,168,687,208"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,118,440,143"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,168,445,208"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,232,444,272"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,207,187,233"/>
<area shape="rect" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3" title=" " alt="" coords="495,265,685,290"/>
</map>
</div>

</div>
</div>
<a id="ac405aa11c3c356e93dc38f2365701466" name="ac405aa11c3c356e93dc38f2365701466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac405aa11c3c356e93dc38f2365701466">&#9670;&#160;</a></span>getbrk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf64::getbrk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03653">3653</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3654</span>{</div>
<div class="line"><span class="lineno"> 3655</span>    <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> brka = 0;</div>
<div class="line"><span class="lineno"> 3656</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nph; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3657</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 3658</span>            <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>);</div>
<div class="line"><span class="lineno"> 3659</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> &gt; brka)</div>
<div class="line"><span class="lineno"> 3660</span>                brka = <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 3661</span>        }</div>
<div class="line"><span class="lineno"> 3662</span>    }</div>
<div class="line"><span class="lineno"> 3663</span>    <span class="keywordflow">return</span> brka;</div>
<div class="line"><span class="lineno"> 3664</span>}</div>
<div class="ttc" id="absd_8h_html_af83497edef361523a95b06deda0b4c2d"><div class="ttname"><a href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a></div><div class="ttdeci">long off_t</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00073">bsd.h:73</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_af71ddeb3e6a1edbdfadd8f044c60fa66"><div class="ttname"><a href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a></div><div class="ttdeci">const C&lt; U &gt; &amp; b</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00080">xspan_fwd.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, and <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd::pack1()</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm::pack1()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle::pack1()</a>, <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc::pack1()</a>, and <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph" id="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,176,56"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="251,5,380,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="224,55,407,80"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="455,55,584,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph" id="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph">
<area shape="rect" title=" " alt="" coords="220,141,391,166"/>
<area shape="rect" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533" title=" " alt="" coords="10,5,167,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8" title=" " alt="" coords="11,69,166,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53" title=" " alt="" coords="11,133,166,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb" title=" " alt="" coords="13,197,164,237"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="5,262,172,287"/>
</map>
</div>

</div>
</div>
<a id="a34544f047b9808c7416a3a3666a7d6bb" name="a34544f047b9808c7416a3a3666a7d6bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34544f047b9808c7416a3a3666a7d6bb">&#9670;&#160;</a></span>invert_pt_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::invert_pt_dynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *&#160;</td>
          <td class="paramname"><em>dynp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>dt_filesz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08421">8421</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8422</span>{</div>
<div class="line"><span class="lineno"> 8423</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_NULL]) {</div>
<div class="line"><span class="lineno"> 8424</span>        <span class="keywordflow">return</span>;  <span class="comment">// not 1st time; do not change upx_dt_init</span></div>
<div class="line"><span class="lineno"> 8425</span>    }</div>
<div class="line"><span class="lineno"> 8426</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *<span class="keyword">const</span> dynp0 = dynp;</div>
<div class="line"><span class="lineno"> 8427</span>    <span class="keywordtype">unsigned</span> ndx = 0;</div>
<div class="line"><span class="lineno"> 8428</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> limit = headway / <span class="keyword">sizeof</span>(*dynp);</div>
<div class="line"><span class="lineno"> 8429</span>    <span class="keywordflow">if</span> (dynp)</div>
<div class="line"><span class="lineno"> 8430</span>    <span class="keywordflow">for</span> (; ; ++ndx, ++dynp) {</div>
<div class="line"><span class="lineno"> 8431</span>        <span class="keywordflow">if</span> (limit &lt;= ndx) {</div>
<div class="line"><span class="lineno"> 8432</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;DT_NULL not found&quot;</span>);</div>
<div class="line"><span class="lineno"> 8433</span>        }</div>
<div class="line"><span class="lineno"> 8434</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> d_tag = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 8435</span>        <span class="keywordflow">if</span> (d_tag&gt;&gt;32) { <span class="comment">// outrageous</span></div>
<div class="line"><span class="lineno"> 8436</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad Elf64_Dyn[%d].d_tag %#lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 8437</span>                ndx, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)d_tag);</div>
<div class="line"><span class="lineno"> 8438</span>        }</div>
<div class="line"><span class="lineno"> 8439</span>        <span class="keywordflow">if</span> (d_tag &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) {</div>
<div class="line"><span class="lineno"> 8440</span>            <span class="keywordflow">if</span> (Elf64_Dyn::DT_NEEDED != d_tag</div>
<div class="line"><span class="lineno"> 8441</span>            &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag]</div>
<div class="line"><span class="lineno"> 8442</span>            &amp;&amp;    <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val)</div>
<div class="line"><span class="lineno"> 8443</span>               != <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag]].d_val)) {</div>
<div class="line"><span class="lineno"> 8444</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;duplicate DT_%#x: [%#x] [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 8445</span>                    (<span class="keywordtype">unsigned</span>)d_tag, -1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag], ndx);</div>
<div class="line"><span class="lineno"> 8446</span>            }</div>
<div class="line"><span class="lineno"> 8447</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag] = 1+ ndx;</div>
<div class="line"><span class="lineno"> 8448</span>        }</div>
<div class="line"><span class="lineno"> 8449</span>        <span class="keywordflow">if</span> (Elf64_Dyn::DT_NULL == d_tag) {</div>
<div class="line"><span class="lineno"> 8450</span>            <span class="keywordflow">break</span>;  <span class="comment">// check here so that dt_table[DT_NULL] is set</span></div>
<div class="line"><span class="lineno"> 8451</span>        }</div>
<div class="line"><span class="lineno"> 8452</span>    }</div>
<div class="line"><span class="lineno"> 8453</span>    <a class="code hl_function" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets</a>(dynp0);</div>
<div class="line"><span class="lineno"> 8454</span> </div>
<div class="line"><span class="lineno"> 8455</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = 0;</div>
<div class="line"><span class="lineno"> 8456</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_INIT])          <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_INIT;</div>
<div class="line"><span class="lineno"> 8457</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_PREINIT_ARRAY]) <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_PREINIT_ARRAY;</div>
<div class="line"><span class="lineno"> 8458</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_INIT_ARRAY])    <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_INIT_ARRAY;</div>
<div class="line"><span class="lineno"> 8459</span> </div>
<div class="line"><span class="lineno"> 8460</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> z_str = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_STRSZ];</div>
<div class="line"><span class="lineno"> 8461</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> = !z_str ? 0 : <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ z_str].d_val);</div>
<div class="line"><span class="lineno"> 8462</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> z_tab = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_STRTAB];</div>
<div class="line"><span class="lineno"> 8463</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> tmp1 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ z_tab].d_val);</div>
<div class="line"><span class="lineno"> 8464</span>    <span class="keywordflow">if</span> (tmp1 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) {</div>
<div class="line"><span class="lineno"> 8465</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_STRTAB %#x&quot;</span>, tmp1);</div>
<div class="line"><span class="lineno"> 8466</span>    }</div>
<div class="line"><span class="lineno"> 8467</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> strtab_beg = !z_tab ? 0 : <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(tmp1);</div>
<div class="line"><span class="lineno"> 8468</span> </div>
<div class="line"><span class="lineno"> 8469</span>    <span class="keywordflow">if</span> (!z_str || !z_tab</div>
<div class="line"><span class="lineno"> 8470</span>    || (this-&gt;<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - strtab_beg) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a>  <span class="comment">// strtab overlaps EOF</span></div>
<div class="line"><span class="lineno"> 8471</span>        <span class="comment">// last string in table must have terminating NUL</span></div>
<div class="line"><span class="lineno"> 8472</span>    ||  <span class="charliteral">&#39;\0&#39;</span> != ((<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>())[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> + strtab_beg]</div>
<div class="line"><span class="lineno"> 8473</span>    ) {</div>
<div class="line"><span class="lineno"> 8474</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_STRSZ %#x&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a>);</div>
<div class="line"><span class="lineno"> 8475</span>    }</div>
<div class="line"><span class="lineno"> 8476</span> </div>
<div class="line"><span class="lineno"> 8477</span>    <span class="comment">// Find end of DT_SYMTAB</span></div>
<div class="line"><span class="lineno"> 8478</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> tmp2 = <a class="code hl_function" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a>(Elf64_Dyn::DT_SYMTAB,</div>
<div class="line"><span class="lineno"> 8479</span>        Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 8480</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a> = (~0u == tmp2) ? 0 : tmp1 / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>);</div>
<div class="line"><span class="lineno"> 8481</span> </div>
<div class="line"><span class="lineno"> 8482</span>    <span class="keywordtype">unsigned</span> v_sym = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_SYMTAB];</div>
<div class="line"><span class="lineno"> 8483</span>    <span class="keywordflow">if</span> (v_sym) {</div>
<div class="line"><span class="lineno"> 8484</span>        v_sym = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ v_sym].d_val));</div>
<div class="line"><span class="lineno"> 8485</span>    }</div>
<div class="line"><span class="lineno"> 8486</span> </div>
<div class="line"><span class="lineno"> 8487</span>    <span class="keywordtype">unsigned</span> v_hsh = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_HASH];</div>
<div class="line"><span class="lineno"> 8488</span>    <span class="keywordflow">if</span> (v_hsh) {</div>
<div class="line"><span class="lineno"> 8489</span>        v_hsh = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ v_hsh].d_val));</div>
<div class="line"><span class="lineno"> 8490</span>    }</div>
<div class="line"><span class="lineno"> 8491</span>    <span class="keywordflow">if</span> (v_hsh &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) {</div>
<div class="line"><span class="lineno"> 8492</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 8493</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>) {</div>
<div class="line"><span class="lineno"> 8494</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH %#x&quot;</span>, v_hsh);</div>
<div class="line"><span class="lineno"> 8495</span>        }</div>
<div class="line"><span class="lineno"> 8496</span>        <span class="comment">// Find end of DT_HASH</span></div>
<div class="line"><span class="lineno"> 8497</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)(<a class="code hl_function" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a>(</div>
<div class="line"><span class="lineno"> 8498</span>            Elf64_Dyn::DT_HASH, Elf64_Shdr::SHT_HASH) + (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>);</div>
<div class="line"><span class="lineno"> 8499</span> </div>
<div class="line"><span class="lineno"> 8500</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> nbucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8501</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[2];</div>
<div class="line"><span class="lineno"> 8502</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> chains = &amp;buckets[nbucket]; (void)chains;</div>
<div class="line"><span class="lineno"> 8503</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)buckets - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 8504</span>                &lt;= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*nbucket ) {</div>
<div class="line"><span class="lineno"> 8505</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad nbucket %#x\n&quot;</span>, nbucket);</div>
<div class="line"><span class="lineno"> 8506</span>        }</div>
<div class="line"><span class="lineno"> 8507</span> </div>
<div class="line"><span class="lineno"> 8508</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a> - buckets) &lt; nbucket</div>
<div class="line"><span class="lineno"> 8509</span>        || !v_sym || <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= v_sym</div>
<div class="line"><span class="lineno"> 8510</span>        || ((v_hsh &lt; v_sym) &amp;&amp; (v_sym - v_hsh) &lt; <span class="keyword">sizeof</span>(*buckets)*(2+ nbucket))</div>
<div class="line"><span class="lineno"> 8511</span>        ) {</div>
<div class="line"><span class="lineno"> 8512</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH nbucket=%#x  len=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 8513</span>                nbucket, (v_sym - v_hsh));</div>
<div class="line"><span class="lineno"> 8514</span>        }</div>
<div class="line"><span class="lineno"> 8515</span>        <span class="keywordtype">unsigned</span> chmax = 0;</div>
<div class="line"><span class="lineno"> 8516</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j= 0; j &lt; nbucket; ++j) {</div>
<div class="line"><span class="lineno"> 8517</span>            <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno"> 8518</span>            <span class="keywordflow">if</span> (chmax &lt; x) {</div>
<div class="line"><span class="lineno"> 8519</span>                chmax = x;</div>
<div class="line"><span class="lineno"> 8520</span>            }</div>
<div class="line"><span class="lineno"> 8521</span>        }</div>
<div class="line"><span class="lineno"> 8522</span>        <span class="keywordflow">if</span> ((v_hsh &lt; v_sym) &amp;&amp; (v_sym - v_hsh) &lt;</div>
<div class="line"><span class="lineno"> 8523</span>                (<span class="keyword">sizeof</span>(*buckets)*(2+ nbucket) + <span class="keyword">sizeof</span>(*chains)*(1+ chmax))) {</div>
<div class="line"><span class="lineno"> 8524</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH nbucket=%#x  len=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 8525</span>                nbucket, (v_sym - v_hsh));</div>
<div class="line"><span class="lineno"> 8526</span>        }</div>
<div class="line"><span class="lineno"> 8527</span>    }</div>
<div class="line"><span class="lineno"> 8528</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> v_gsh = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 8529</span>    <span class="keywordflow">if</span> (v_gsh &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) {</div>
<div class="line"><span class="lineno"> 8530</span>        <span class="comment">// Not similar to DT_HASH because DT_GNU_HASH is not small (0x6ffffef5).</span></div>
<div class="line"><span class="lineno"> 8531</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 8532</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>) {</div>
<div class="line"><span class="lineno"> 8533</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH %#x&quot;</span>, v_gsh);</div>
<div class="line"><span class="lineno"> 8534</span>        }</div>
<div class="line"><span class="lineno"> 8535</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)(<a class="code hl_function" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a>(</div>
<div class="line"><span class="lineno"> 8536</span>            Elf64_Dyn::DT_GNU_HASH, Elf64_Shdr::SHT_GNU_HASH) + (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>);</div>
<div class="line"><span class="lineno"> 8537</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8538</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symbias  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[1]);</div>
<div class="line"><span class="lineno"> 8539</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bitmask = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[2]);</div>
<div class="line"><span class="lineno"> 8540</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> gnu_shift = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[3]);</div>
<div class="line"><span class="lineno"> 8541</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *<span class="keyword">const</span> bitmask = (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[4];</div>
<div class="line"><span class="lineno"> 8542</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> buckets = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)&amp;bitmask[n_bitmask];</div>
<div class="line"><span class="lineno"> 8543</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> hasharr = &amp;buckets[n_bucket]; (void)hasharr;</div>
<div class="line"><span class="lineno"> 8544</span>        <span class="keywordflow">if</span> (!n_bucket || (1u&lt;&lt;31) &lt;= n_bucket  <span class="comment">/* fie on fuzzers */</span></div>
<div class="line"><span class="lineno"> 8545</span>        || (unsigned)(<a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a> - buckets) &lt; n_bucket</div>
<div class="line"><span class="lineno"> 8546</span>        || (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) &lt;= (<span class="keywordtype">void</span> <span class="keyword">const</span> *)hasharr) {</div>
<div class="line"><span class="lineno"> 8547</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bucket %#x\n&quot;</span>, n_bucket);</div>
<div class="line"><span class="lineno"> 8548</span>        }</div>
<div class="line"><span class="lineno"> 8549</span>        <span class="comment">// It would be better to detect zeroes shifted into low 6 bits of:</span></div>
<div class="line"><span class="lineno"> 8550</span>        <span class="comment">//    (077 &amp; (hash_32 &gt;&gt; gnu_shift))</span></div>
<div class="line"><span class="lineno"> 8551</span>        <span class="comment">// but compilers can be stupid.</span></div>
<div class="line"><span class="lineno"> 8552</span>        <span class="keywordflow">if</span> (31 &lt; gnu_shift) {</div>
<div class="line"><span class="lineno"> 8553</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_shift %#x&quot;</span>, gnu_shift);</div>
<div class="line"><span class="lineno"> 8554</span>        }</div>
<div class="line"><span class="lineno"> 8555</span>        <span class="comment">// unsigned const *const gashend = &amp;hasharr[n_bucket];</span></div>
<div class="line"><span class="lineno"> 8556</span>        <span class="comment">// minimum, except:</span></div>
<div class="line"><span class="lineno"> 8557</span>        <span class="comment">// Rust and Android trim unused zeroes from high end of hasharr[]</span></div>
<div class="line"><span class="lineno"> 8558</span>        <span class="keywordtype">unsigned</span> bmax = 0;</div>
<div class="line"><span class="lineno"> 8559</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j= 0; j &lt; n_bucket; ++j) {</div>
<div class="line"><span class="lineno"> 8560</span>            <span class="keywordtype">unsigned</span> bj = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno"> 8561</span>            <span class="keywordflow">if</span> (bj) {</div>
<div class="line"><span class="lineno"> 8562</span>                <span class="keywordflow">if</span> (bj &lt; symbias) {</div>
<div class="line"><span class="lineno"> 8563</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH bucket[%d] &lt; symbias{%#x}\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 8564</span>                            bj, symbias);</div>
<div class="line"><span class="lineno"> 8565</span>                }</div>
<div class="line"><span class="lineno"> 8566</span>                <span class="keywordflow">if</span> (bmax &lt; bj) {</div>
<div class="line"><span class="lineno"> 8567</span>                    bmax = bj;</div>
<div class="line"><span class="lineno"> 8568</span>                }</div>
<div class="line"><span class="lineno"> 8569</span>            }</div>
<div class="line"><span class="lineno"> 8570</span>        }</div>
<div class="line"><span class="lineno"> 8571</span>        <span class="keywordflow">if</span> (1==n_bucket  &amp;&amp; 0==buckets[0]</div>
<div class="line"><span class="lineno"> 8572</span>        &amp;&amp;  1==n_bitmask &amp;&amp; 0==bitmask[0]) {</div>
<div class="line"><span class="lineno"> 8573</span>            <span class="comment">// 2021-09-11 Rust on RaspberryPi apparently uses this to minimize space.</span></div>
<div class="line"><span class="lineno"> 8574</span>            <span class="comment">// But then the DT_GNU_HASH symbol lookup algorithm always fails?</span></div>
<div class="line"><span class="lineno"> 8575</span>            <span class="comment">// https://github.com/upx/upx/issues/525</span></div>
<div class="line"><span class="lineno"> 8576</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8577</span>        <span class="keywordflow">if</span> (bmax) {</div>
<div class="line"><span class="lineno"> 8578</span>            <span class="keywordflow">if</span> ((1+ bmax) &lt; symbias) {</div>
<div class="line"><span class="lineno"> 8579</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH (1+ max_bucket)=%#x &lt; symbias=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 8580</span>                    1+ bmax, symbias);</div>
<div class="line"><span class="lineno"> 8581</span>            }</div>
<div class="line"><span class="lineno"> 8582</span>            bmax -= symbias;</div>
<div class="line"><span class="lineno"> 8583</span>        }</div>
<div class="line"><span class="lineno"> 8584</span> </div>
<div class="line"><span class="lineno"> 8585</span>        <span class="keywordtype">unsigned</span> r = 0;</div>
<div class="line"><span class="lineno"> 8586</span>        <span class="keywordflow">if</span> (!n_bucket || !n_bitmask || !v_sym</div>
<div class="line"><span class="lineno"> 8587</span>        || (r=1, ((-1+ n_bitmask) &amp; n_bitmask))  <span class="comment">// not a power of 2</span></div>
<div class="line"><span class="lineno"> 8588</span>        || (r=2, (8*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>) &lt;= gnu_shift))  <span class="comment">// shifted result always == 0</span></div>
<div class="line"><span class="lineno"> 8589</span>        || (r=3, (n_bucket&gt;&gt;30))  <span class="comment">// fie on fuzzers</span></div>
<div class="line"><span class="lineno"> 8590</span>        || (r=4, (n_bitmask&gt;&gt;30))</div>
<div class="line"><span class="lineno"> 8591</span>        || (r=5, ((<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))</div>
<div class="line"><span class="lineno"> 8592</span>                &lt;= ((<span class="keyword">sizeof</span>(*bitmask)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))*n_bitmask + 2*n_bucket)))  <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 8593</span>        || (r=6, ((v_gsh &lt; v_sym) &amp;&amp; (v_sym - v_gsh) &lt; (<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*4  <span class="comment">// headers</span></div>
<div class="line"><span class="lineno"> 8594</span>                + <span class="keyword">sizeof</span>(*bitmask)*n_bitmask  <span class="comment">// bitmask</span></div>
<div class="line"><span class="lineno"> 8595</span>                + <span class="keyword">sizeof</span>(*buckets)*n_bucket  <span class="comment">// buckets</span></div>
<div class="line"><span class="lineno"> 8596</span>                + <span class="keyword">sizeof</span>(*hasharr)*(!bmax ? 0 : (1+ bmax))  <span class="comment">// hasharr</span></div>
<div class="line"><span class="lineno"> 8597</span>            )) )</div>
<div class="line"><span class="lineno"> 8598</span>        ) {</div>
<div class="line"><span class="lineno"> 8599</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH n_bucket=%#x  n_bitmask=%#x  len=%#lx  r=%d&quot;</span>,</div>
<div class="line"><span class="lineno"> 8600</span>                n_bucket, n_bitmask, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)(v_sym - v_gsh), r);</div>
<div class="line"><span class="lineno"> 8601</span>        }</div>
<div class="line"><span class="lineno"> 8602</span>    }</div>
<div class="line"><span class="lineno"> 8603</span>    <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a>);  <span class="comment">// who omitted this?</span></div>
<div class="line"><span class="lineno"> 8604</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></div>
<div class="line"><span class="lineno"> 8605</span>    &amp;&amp;  !(0==<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; 0==<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) ) {</div>
<div class="line"><span class="lineno"> 8606</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad .e_shstrndx %d &gt;= .e_shnum %d&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 8607</span>    }</div>
<div class="line"><span class="lineno"> 8608</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab5c99e9dc4cb9e94309dfb49b13ff09d"><div class="ttname"><a href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">PackLinuxElf64::elf_find_table_size</a></div><div class="ttdeci">unsigned elf_find_table_size(unsigned dt_type, unsigned sh_type)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08393">p_lx_elf.cpp:8393</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_acbc068ab20eb6f313fc0abbda76c62a4"><div class="ttname"><a href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">PackLinuxElf64::sort_DT64_offsets</a></div><div class="ttdeci">void sort_DT64_offsets(Elf64_Dyn const *const dynp0)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08341">p_lx_elf.cpp:8341</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a>, <a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a>, <a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, <a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a>, <a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph" id="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,578,172,618"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="224,194,369,234"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="945,252,1075,277"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="421,231,612,271"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="945,606,1075,632"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="951,910,1069,936"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="224,460,369,500"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="441,295,592,335"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="683,758,852,784"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="232,836,361,861"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="220,771,373,811"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="695,136,840,176"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="676,404,859,429"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="444,427,589,467"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="444,491,589,531"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="441,606,593,646"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="730,505,805,530"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="692,657,843,682"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="450,1109,583,1134"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="449,998,584,1024"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="455,873,579,898"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="723,961,812,986"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="972,1150,1048,1176"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="725,1060,809,1085"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="727,1264,808,1289"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="660,1109,875,1134"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1145,1137,1300,1162"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="935,1260,1085,1300"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="1147,1215,1298,1255"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="1147,1279,1298,1319"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="708,1010,827,1036"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="923,1049,1097,1074"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1181,1025,1264,1050"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1153,1074,1293,1100"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1348,1018,1499,1058"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1547,986,1697,1026"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1547,1050,1697,1090"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph" id="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph">
<area shape="rect" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="a5e4e0a8150ba291145c388c9c00705ec" name="a5e4e0a8150ba291145c388c9c00705ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e4e0a8150ba291145c388c9c00705ec">&#9670;&#160;</a></span>is_LOAD()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::is_LOAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00270">270</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  271</span>{</div>
<div class="line"><span class="lineno">  272</span>    <span class="comment">// (1+ PT_LOPROC) can confuse!</span></div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type);</div>
<div class="line"><span class="lineno">  274</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, and <a class="el" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_cgraph" id="aclassPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,188,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="236,5,365,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_icgraph" id="aclassPackLinuxElf64_a5e4e0a8150ba291145c388c9c00705ec_icgraph">
<area shape="rect" title=" " alt="" coords="1403,654,1585,679"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,145,187,170"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="1187,437,1332,477"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,208,687,248"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,444,662,484"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,502,427,527"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="1164,201,1355,241"/>
<area shape="rect" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8" title=" " alt="" coords="735,603,901,643"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="507,667,673,693"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="1183,647,1335,687"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="1170,981,1349,1021"/>
<area shape="rect" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717" title=" " alt="" coords="1166,917,1353,957"/>
<area shape="rect" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466" title=" " alt="" coords="1174,865,1345,890"/>
<area shape="rect" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215" title=" " alt="" coords="1176,1046,1343,1071"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="960,323,1105,363"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="949,654,1116,679"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="956,387,1109,427"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,360,901,400"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,259,440,285"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,309,445,349"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,195,444,235"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="959,259,1106,299"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="960,144,1105,184"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,245,890,285"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,284,662,324"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="949,1113,1116,1138"/>
<area shape="rect" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533" title=" " alt="" coords="954,856,1111,896"/>
<area shape="rect" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8" title=" " alt="" coords="955,920,1110,960"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53" title=" " alt="" coords="955,984,1110,1024"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb" title=" " alt="" coords="957,1048,1108,1088"/>
</map>
</div>

</div>
</div>
<a id="a39227a27d84b3a9beeef257f95b00215" name="a39227a27d84b3a9beeef257f95b00215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39227a27d84b3a9beeef257f95b00215">&#9670;&#160;</a></span>pack1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::pack1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#af01b0f8403997790f28a72329e7b28f6">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle</a>, and <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05018">5018</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5019</span>{</div>
<div class="line"><span class="lineno"> 5020</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5021</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>));</div>
<div class="line"><span class="lineno"> 5022</span>    assert(<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));  <span class="comment">// checked by canPack()</span></div>
<div class="line"><span class="lineno"> 5023</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">e_phentsize</a>);</div>
<div class="line"><span class="lineno"> 5024</span> </div>
<div class="line"><span class="lineno"> 5025</span><span class="comment">// We compress separate pieces (usually each PT_LOAD, plus the gaps in the file</span></div>
<div class="line"><span class="lineno"> 5026</span><span class="comment">// that are not covered by any PT_LOAD), but currently at run time there can be</span></div>
<div class="line"><span class="lineno"> 5027</span><span class="comment">// only one decompressor method.</span></div>
<div class="line"><span class="lineno"> 5028</span><span class="comment">// Therefore we must plan ahead because Packer::compressWithFilters tries</span></div>
<div class="line"><span class="lineno"> 5029</span><span class="comment">// to find the smallest result among the available methods, for one piece only.</span></div>
<div class="line"><span class="lineno"> 5030</span><span class="comment">// In the future we may allow more than one decompression method at run time.</span></div>
<div class="line"><span class="lineno"> 5031</span><span class="comment">// For now we must choose only one, and force PackUnix::packExtent</span></div>
<div class="line"><span class="lineno"> 5032</span><span class="comment">// (==&gt; compressWithFilters) to use it.</span></div>
<div class="line"><span class="lineno"> 5033</span>    <span class="keywordtype">int</span> nfilters = 0;</div>
<div class="line"><span class="lineno"> 5034</span>    {</div>
<div class="line"><span class="lineno"> 5035</span>        <span class="keywordtype">int</span> <span class="keyword">const</span> *fp = <a class="code hl_function" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">getFilters</a>();</div>
<div class="line"><span class="lineno"> 5036</span>        <span class="keywordflow">while</span> (<a class="code hl_define" href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a> != *fp++) {</div>
<div class="line"><span class="lineno"> 5037</span>            ++nfilters;</div>
<div class="line"><span class="lineno"> 5038</span>        }</div>
<div class="line"><span class="lineno"> 5039</span>    }</div>
<div class="line"><span class="lineno"> 5040</span>    {</div>
<div class="line"><span class="lineno"> 5041</span>        <span class="keywordtype">int</span> npieces = 1;  <span class="comment">// tail after highest PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5042</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 5043</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 5044</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 5045</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span>  flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>);</div>
<div class="line"><span class="lineno"> 5046</span>                <span class="keywordtype">unsigned</span>       offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 5047</span>                <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 5048</span>                  <span class="comment">// new-style shlib: PT_LOAD[0] has symbol table</span></div>
<div class="line"><span class="lineno"> 5049</span>                  <span class="comment">// which must not be compressed, but also lacks PF_X</span></div>
<div class="line"><span class="lineno"> 5050</span>                ||    (Elf64_Phdr::PF_X &amp; flags)</div>
<div class="line"><span class="lineno"> 5051</span>                  <span class="comment">// Read-only, non-first PT_LOAD is _assumed_ to be compressible</span></div>
<div class="line"><span class="lineno"> 5052</span>                ||  (!(Elf64_Phdr::PF_W &amp; flags) &amp;&amp; 0!=offset))</div>
<div class="line"><span class="lineno"> 5053</span>                {</div>
<div class="line"><span class="lineno"> 5054</span>                    ++npieces;  <span class="comment">// will attempt compression of this PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5055</span>                }</div>
<div class="line"><span class="lineno"> 5056</span>            }</div>
<div class="line"><span class="lineno"> 5057</span>        }</div>
<div class="line"><span class="lineno"> 5058</span>        uip-&gt;ui_total_passes += npieces;</div>
<div class="line"><span class="lineno"> 5059</span>    }</div>
<div class="line"><span class="lineno"> 5060</span>    <span class="keywordtype">int</span> methods[256];</div>
<div class="line"><span class="lineno"> 5061</span>    <span class="keywordtype">unsigned</span> nmethods = <a class="code hl_function" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">prepareMethods</a>(methods, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>, <a class="code hl_function" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">getCompressionMethods</a>(<a class="code hl_define" href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">level</a>));</div>
<div class="line"><span class="lineno"> 5062</span>    <span class="keywordflow">if</span> (1 &lt; nmethods) { <span class="comment">// Many are available, but we must choose only one</span></div>
<div class="line"><span class="lineno"> 5063</span>        uip-&gt;ui_total_passes += 1;  <span class="comment">// the batch for output</span></div>
<div class="line"><span class="lineno"> 5064</span>        uip-&gt;ui_total_passes *= nmethods * (1+ nfilters);  <span class="comment">// finding smallest total</span></div>
<div class="line"><span class="lineno"> 5065</span>        <a class="code hl_struct" href="structPackHeader.html">PackHeader</a> orig_ph = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>;</div>
<div class="line"><span class="lineno"> 5066</span>        <a class="code hl_class" href="classFilter.html">Filter</a> orig_ft = ft;</div>
<div class="line"><span class="lineno"> 5067</span>        <span class="keywordtype">unsigned</span> max_offset = 0;</div>
<div class="line"><span class="lineno"> 5068</span>        <span class="keywordtype">unsigned</span> sz_best= ~0u;</div>
<div class="line"><span class="lineno"> 5069</span>        <span class="keywordtype">int</span> method_best = 0;</div>
<div class="line"><span class="lineno"> 5070</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; nmethods; ++k) { <span class="comment">// FIXME: parallelize; cost: working space</span></div>
<div class="line"><span class="lineno"> 5071</span>            <span class="keywordtype">unsigned</span> sz_this = 0;</div>
<div class="line"><span class="lineno"> 5072</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 5073</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 5074</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 5075</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>  flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>);</div>
<div class="line"><span class="lineno"> 5076</span>                    <span class="keywordtype">unsigned</span>       offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 5077</span>                    <span class="keywordtype">unsigned</span>       filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 5078</span>                    max_offset = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_offset, filesz + offset);</div>
<div class="line"><span class="lineno"> 5079</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 5080</span>                      <span class="comment">// new-style shlib: PT_LOAD[0] has symbol table</span></div>
<div class="line"><span class="lineno"> 5081</span>                      <span class="comment">// which must not be compressed, but also lacks PF_X</span></div>
<div class="line"><span class="lineno"> 5082</span>                    ||    (Elf64_Phdr::PF_X &amp; flags)</div>
<div class="line"><span class="lineno"> 5083</span>                      <span class="comment">// Read-only, non-first PT_LOAD is _assumed_ to be compressible</span></div>
<div class="line"><span class="lineno"> 5084</span>                    ||  (!(Elf64_Phdr::PF_W &amp; flags) &amp;&amp; 0!=offset))</div>
<div class="line"><span class="lineno"> 5085</span>                    {</div>
<div class="line"><span class="lineno"> 5086</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &amp;&amp; 0==offset) { <span class="comment">// old-style shlib</span></div>
<div class="line"><span class="lineno"> 5087</span>                            offset  = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5088</span>                            filesz -= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5089</span>                        }</div>
<div class="line"><span class="lineno"> 5090</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5091</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 5092</span>                        ft = orig_ft;</div>
<div class="line"><span class="lineno"> 5093</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 5094</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(methods[k]);</div>
<div class="line"><span class="lineno"> 5095</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = filesz;</div>
<div class="line"><span class="lineno"> 5096</span>                        <a class="code hl_function" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a>(&amp;ft, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>, <a class="code hl_define" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, 10, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5097</span>                        sz_this += <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>;</div>
<div class="line"><span class="lineno"> 5098</span>                    }</div>
<div class="line"><span class="lineno"> 5099</span>                }</div>
<div class="line"><span class="lineno"> 5100</span>            }</div>
<div class="line"><span class="lineno"> 5101</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_tail = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - max_offset;  <span class="comment">// debuginfo, etc.</span></div>
<div class="line"><span class="lineno"> 5102</span>            <span class="keywordflow">if</span> (sz_tail) {</div>
<div class="line"><span class="lineno"> 5103</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(max_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5104</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sz_tail);</div>
<div class="line"><span class="lineno"> 5105</span>                ft = orig_ft;</div>
<div class="line"><span class="lineno"> 5106</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 5107</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(methods[k]);</div>
<div class="line"><span class="lineno"> 5108</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = sz_tail;</div>
<div class="line"><span class="lineno"> 5109</span>                <a class="code hl_function" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a>(&amp;ft, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>, <a class="code hl_define" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, 10, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5110</span>                sz_this += <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>;</div>
<div class="line"><span class="lineno"> 5111</span>            }</div>
<div class="line"><span class="lineno"> 5112</span>            <span class="comment">// FIXME: loader size also depends on method</span></div>
<div class="line"><span class="lineno"> 5113</span>            <span class="keywordflow">if</span> (sz_best &gt; sz_this) {</div>
<div class="line"><span class="lineno"> 5114</span>                sz_best = sz_this;</div>
<div class="line"><span class="lineno"> 5115</span>                method_best = methods[k];</div>
<div class="line"><span class="lineno"> 5116</span>            }</div>
<div class="line"><span class="lineno"> 5117</span>        }</div>
<div class="line"><span class="lineno"> 5118</span>        ft = orig_ft;</div>
<div class="line"><span class="lineno"> 5119</span>        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 5120</span>        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(method_best);</div>
<div class="line"><span class="lineno"> 5121</span>    }</div>
<div class="line"><span class="lineno"> 5122</span> </div>
<div class="line"><span class="lineno"> 5123</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 5124</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 5125</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno"> 5126</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a4fc1f5c0094105f552b3b1604ea749d7">PT_GNU_STACK64</a> == type || <a class="code hl_define" href="p__lx__elf_8cpp.html#a9d1efbaf998aaa325cd289fb22c29f2c">PT_NOTE64</a> == type) {</div>
<div class="line"><span class="lineno"> 5127</span>            <a class="code hl_function" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx</a>(phdr);  <span class="comment">// PT_GNU_STACK64, PT_NOTE64</span></div>
<div class="line"><span class="lineno"> 5128</span>        }</div>
<div class="line"><span class="lineno"> 5129</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a> == type) {</div>
<div class="line"><span class="lineno"> 5130</span>            <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>) &gt;&gt; <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 5131</span>            <span class="keywordflow">while</span> (x&gt;&gt;=1) {</div>
<div class="line"><span class="lineno"> 5132</span>                ++<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 5133</span>            }</div>
<div class="line"><span class="lineno"> 5134</span>        }</div>
<div class="line"><span class="lineno"> 5135</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a4fc59c9f0258b54971a12f49f939d6cd">PT_GNU_RELRO64</a> == type</div>
<div class="line"><span class="lineno"> 5136</span>        &amp;&amp;  16 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>) {</div>
<div class="line"><span class="lineno"> 5137</span>            <span class="comment">// x86* allows 4K, 2M, 1G</span></div>
<div class="line"><span class="lineno"> 5138</span>            <span class="comment">// arm32 and arm64 both allow 4K, 16K, 64K; Apple Silicon uses 16K</span></div>
<div class="line"><span class="lineno"> 5139</span>            <span class="comment">// Oracle 5.4.17-2136.314.6.2.el8uek.aarch64 demands 64K</span></div>
<div class="line"><span class="lineno"> 5140</span>            <span class="comment">// PowerPC and PowerPC64 has 4K, 64K, 1M (?), 16M (?)</span></div>
<div class="line"><span class="lineno"> 5141</span>            <span class="comment">// MIPS  allows any power of 2 from 4K through 64K</span></div>
<div class="line"><span class="lineno"> 5142</span> </div>
<div class="line"><span class="lineno"> 5143</span>            <span class="comment">// If 64K &lt; .p_align then we assume that 4K is also accepted.</span></div>
<div class="line"><span class="lineno"> 5144</span>            <span class="comment">// .p_align can be like 2M, which is a huge over-estimate.</span></div>
<div class="line"><span class="lineno"> 5145</span>            <span class="comment">// RELRO ends on a page boundary: usually close to actual page_size</span></div>
<div class="line"><span class="lineno"> 5146</span>            <span class="keywordtype">unsigned</span> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 5147</span>            <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 5148</span>            <span class="keywordflow">if</span> (!(0xfff &amp; (filesz + offset))) { <span class="comment">// a 4KiB boundary</span></div>
<div class="line"><span class="lineno"> 5149</span>                <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> = 12;</div>
<div class="line"><span class="lineno"> 5150</span>                <span class="keywordflow">while</span> (!(~(~0u &lt;&lt; <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>) &amp; (filesz + offset))) {</div>
<div class="line"><span class="lineno"> 5151</span>                    ++<a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 5152</span>                }</div>
<div class="line"><span class="lineno"> 5153</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a> = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>, -1+ <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>);</div>
<div class="line"><span class="lineno"> 5154</span>            }</div>
<div class="line"><span class="lineno"> 5155</span>        }</div>
<div class="line"><span class="lineno"> 5156</span>    }</div>
<div class="line"><span class="lineno"> 5157</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a> =  1u  &lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 5158</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a> = ~0ull&lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 5159</span> </div>
<div class="line"><span class="lineno"> 5160</span>    <a class="code hl_variable" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">progid</a> = 0;  <span class="comment">// getRandomId();  not useful, so do not clutter</span></div>
<div class="line"><span class="lineno"> 5161</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a>;</div>
<div class="line"><span class="lineno"> 5162</span> </div>
<div class="line"><span class="lineno"> 5163</span>    <span class="comment">// only execute if option present</span></div>
<div class="line"><span class="lineno"> 5164</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.preserve_build_id) {</div>
<div class="line"><span class="lineno"> 5165</span>        <span class="comment">// set this so we can use elf_find_section_name</span></div>
<div class="line"><span class="lineno"> 5166</span>        <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 5167</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>) {</div>
<div class="line"><span class="lineno"> 5168</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 5169</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 5170</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 5171</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5172</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 5173</span>        }</div>
<div class="line"><span class="lineno"> 5174</span>        <span class="comment">//set the shstrtab</span></div>
<div class="line"><span class="lineno"> 5175</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a>)];</div>
<div class="line"><span class="lineno"> 5176</span> </div>
<div class="line"><span class="lineno"> 5177</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 5178</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(sh_size); <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 5179</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5180</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_offset,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5181</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>, sh_size);</div>
<div class="line"><span class="lineno"> 5182</span> </div>
<div class="line"><span class="lineno"> 5183</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *buildid = <a class="code hl_function" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name</a>(<span class="stringliteral">&quot;.note.gnu.build-id&quot;</span>);</div>
<div class="line"><span class="lineno"> 5184</span>        <span class="keywordflow">if</span> (buildid) {</div>
<div class="line"><span class="lineno"> 5185</span>            <span class="keywordtype">unsigned</span> bid_sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;buildid-&gt;sh_size);  <span class="comment">// UPX_RSIZE_MAX_MEM protects us</span></div>
<div class="line"><span class="lineno"> 5186</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(bid_sh_size);</div>
<div class="line"><span class="lineno"> 5187</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>.<a class="code hl_function" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">clear</a>();</div>
<div class="line"><span class="lineno"> 5188</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5189</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(buildid-&gt;sh_offset,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5190</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>((<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>, bid_sh_size);</div>
<div class="line"><span class="lineno"> 5191</span> </div>
<div class="line"><span class="lineno"> 5192</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a> = 3;</div>
<div class="line"><span class="lineno"> 5193</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>,0,<span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>));</div>
<div class="line"><span class="lineno"> 5194</span> </div>
<div class="line"><span class="lineno"> 5195</span>            <span class="comment">//setup the build-id</span></div>
<div class="line"><span class="lineno"> 5196</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1], buildid, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1]));</div>
<div class="line"><span class="lineno"> 5197</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1].sh_name, 1);</div>
<div class="line"><span class="lineno"> 5198</span> </div>
<div class="line"><span class="lineno"> 5199</span>            <span class="comment">//setup the shstrtab</span></div>
<div class="line"><span class="lineno"> 5200</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2], <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2]));</div>
<div class="line"><span class="lineno"> 5201</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_name, 20);</div>
<div class="line"><span class="lineno"> 5202</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_size, 29); <span class="comment">//size of our static shstrtab; UPX_RSIZE_MAX_MEM</span></div>
<div class="line"><span class="lineno"> 5203</span>        }</div>
<div class="line"><span class="lineno"> 5204</span>    }</div>
<div class="line"><span class="lineno"> 5205</span>}</div>
<div class="ttc" id="aclassFilter_html"><div class="ttname"><a href="classFilter.html">Filter</a></div><div class="ttdoc">A filter is a reversible operation that modifies a given block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00047">filter.h:47</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a440e8db9c9010226d9778185f66529f5"><div class="ttname"><a href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc</a></div><div class="ttdeci">void alloc(upx_uint64_t bytes) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8cpp_source.html#l00170">membuffer.cpp:170</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_acea3f3781a8c941186b5777f13691c8c"><div class="ttname"><a href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear</a></div><div class="ttdeci">forceinline void clear(unsigned off, unsigned len) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00212">membuffer.h:212</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a19a154b135064ce4e1a6e58ba23d9e50"><div class="ttname"><a href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">PackLinuxElf64::elf_find_section_name</a></div><div class="ttdeci">Elf64_Shdr const * elf_find_section_name(char const *) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02490">p_lx_elf.cpp:2490</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_aae6931a0bd5d2fca80befbd24a574c3e"><div class="ttname"><a href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">PackLinuxElf64::shdrout</a></div><div class="ttdeci">cprElfShdr3 shdrout</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00453">p_lx_elf.h:453</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_abd6eb82fa691109eb7fa267d6c8570f6"><div class="ttname"><a href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">PackLinuxElf64::add_phdrx</a></div><div class="ttdeci">void add_phdrx(Elf64_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01012">p_lx_elf.cpp:1012</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a4036b37656b78e0053108ad8f9a17ef8"><div class="ttname"><a href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a></div><div class="ttdeci">MemBuffer buildid_data</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00132">p_lx_elf.h:132</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a55541b4f9e0f8f1fe16cb785b093ab1c"><div class="ttname"><a href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a></div><div class="ttdeci">MemBuffer mb_shdr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00090">p_lx_elf.h:90</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a622b799334a48cb6634e790f2566248a"><div class="ttname"><a href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">PackLinuxElf::getCompressionMethods</a></div><div class="ttdeci">virtual const int * getCompressionMethods(int method, int level) const override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01132">p_lx_elf.cpp:1132</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a76c2a145b6739ad4cd1035af406a821a"><div class="ttname"><a href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">PackLinuxElf::mb_shstrtab</a></div><div class="ttdeci">MemBuffer mb_shstrtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00129">p_lx_elf.h:129</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ab3ca408b94c072437e9e96a3b4e3ab1f"><div class="ttname"><a href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a></div><div class="ttdeci">unsigned sz_phdrs</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00097">p_lx_elf.h:97</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73"><div class="ttname"><a href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a></div><div class="ttdeci">@ OVERHEAD</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00135">p_unix.h:135</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a4e6db1e979cfd371114262e2887980ee"><div class="ttname"><a href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">PackUnix::progid</a></div><div class="ttdeci">unsigned progid</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00095">p_unix.h:95</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a6bbbfbba5b4b2b33de9d7801bd58b2cb"><div class="ttname"><a href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">PackUnix::getFilters</a></div><div class="ttdeci">virtual const int * getFilters() const override</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00052">p_unix.h:52</a></div></div>
<div class="ttc" id="aclassPacker_html_a476d801b02376434abccfd4b84e057fe"><div class="ttname"><a href="classPacker.html#a476d801b02376434abccfd4b84e057fe">Packer::prepareMethods</a></div><div class="ttdeci">int prepareMethods(int *methods, int ph_method, const int *all_methods) const</div><div class="ttdoc">void Packer::compressWithFilters(): Try compression with several methods and filters,...</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00908">packer.cpp:908</a></div></div>
<div class="ttc" id="aclassPacker_html_ad0ae5b698e68d64585e5be87a256f675"><div class="ttname"><a href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters</a></div><div class="ttdeci">void compressWithFilters(Filter *ft, const unsigned overlap_range, const upx_compress_config_t *cconf, int filter_strategy=0, bool inhibit_compression_check=false)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l01213">packer.cpp:1213</a></div></div>
<div class="ttc" id="aconf_8h_html_a273ac851b4231e7ae380d36191040548"><div class="ttname"><a href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a></div><div class="ttdeci">#define M_ALL</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00604">conf.h:604</a></div></div>
<div class="ttc" id="aconf_8h_html_a28c3ab53e0d5633976245bf127fe9a40"><div class="ttname"><a href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a></div><div class="ttdeci">#define NULL_cconf</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00720">conf.h:720</a></div></div>
<div class="ttc" id="aconf_8h_html_a75519eeb326c3b15b3059db3f3098881"><div class="ttname"><a href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a></div><div class="ttdeci">#define FT_END</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00620">conf.h:620</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4fc1f5c0094105f552b3b1604ea749d7"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4fc1f5c0094105f552b3b1604ea749d7">PT_GNU_STACK64</a></div><div class="ttdeci">#define PT_GNU_STACK64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00057">p_lx_elf.cpp:57</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4fc59c9f0258b54971a12f49f939d6cd"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4fc59c9f0258b54971a12f49f939d6cd">PT_GNU_RELRO64</a></div><div class="ttdeci">#define PT_GNU_RELRO64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00059">p_lx_elf.cpp:59</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a9d1efbaf998aaa325cd289fb22c29f2c"><div class="ttname"><a href="p__lx__elf_8cpp.html#a9d1efbaf998aaa325cd289fb22c29f2c">PT_NOTE64</a></div><div class="ttdeci">#define PT_NOTE64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00055">p_lx_elf.cpp:55</a></div></div>
<div class="ttc" id="apackhead_8cpp_html_ae33d5198af6a4110c9533bb4fdccffe6"><div class="ttname"><a href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a></div><div class="ttdeci">int ph_force_method(int method) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00295">packhead.cpp:295</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a317679f1ef5e41e0717e95670c6a1d24"><div class="ttname"><a href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a></div><div class="ttdeci">Elf64_Half e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00219">bsd.h:219</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_ab5aefb7a14b9cf2eafcbaf0664852369"><div class="ttname"><a href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a></div><div class="ttdeci">Elf64_Half e_phentsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00216">bsd.h:216</a></div></div>
<div class="ttc" id="astructPackHeader_html"><div class="ttname"><a href="structPackHeader.html">PackHeader</a></div><div class="ttdoc">PackHeader also see stub/src/include/header.S.</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00037">packhead.h:37</a></div></div>
<div class="ttc" id="astructPackHeader_html_a1115672eeb2a2bb05760ce5c7fc0b5cf"><div class="ttname"><a href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a></div><div class="ttdeci">unsigned u_len</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00054">packhead.h:54</a></div></div>
<div class="ttc" id="astructPackHeader_html_a19b4cdc8a27935b591bcb85cb5ec3e9d"><div class="ttname"><a href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">PackHeader::level</a></div><div class="ttdeci">int level</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00053">packhead.h:53</a></div></div>
<div class="ttc" id="astructPackHeader_html_a448fca0da6280454a321894c7eb29e79"><div class="ttname"><a href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a></div><div class="ttdeci">unsigned c_len</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00055">packhead.h:55</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear()</a>, <a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters()</a>, <a class="el" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">PackLinuxElf::getCompressionMethods()</a>, <a class="el" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">PackUnix::getFilters()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">PackHeader::level</a>, <a class="el" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">PackLinuxElf::lg2_page</a>, <a class="el" href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">PackLinuxElf::mb_shstrtab</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a>, <a class="el" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, <a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>, <a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method()</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">Packer::prepareMethods()</a>, <a class="el" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">PackUnix::progid</a>, <a class="el" href="p__lx__elf_8cpp.html#a4fc59c9f0258b54971a12f49f939d6cd">PT_GNU_RELRO64</a>, <a class="el" href="p__lx__elf_8cpp.html#a4fc1f5c0094105f552b3b1604ea749d7">PT_GNU_STACK64</a>, <a class="el" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>, <a class="el" href="p__lx__elf_8cpp.html#a9d1efbaf998aaa325cd289fb22c29f2c">PT_NOTE64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph" id="aclassPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph">
<area shape="rect" title=" " alt="" coords="5,683,172,709"/>
<area shape="rect" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6" title=" " alt="" coords="1027,965,1179,1005"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="532,167,665,193"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="829,219,905,245"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="261,269,396,294"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="226,407,431,433"/>
<area shape="rect" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50" title=" " alt="" coords="253,319,404,359"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="534,557,663,582"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="264,558,393,583"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="264,607,393,633"/>
<area shape="rect" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a" title=" " alt="" coords="220,808,437,848"/>
<area shape="rect" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb" title=" " alt="" coords="253,709,404,734"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="244,758,413,783"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="237,509,420,534"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="289,897,368,922"/>
<area shape="rect" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6" title=" " alt="" coords="261,946,396,971"/>
<area shape="rect" href="classPacker.html#a476d801b02376434abccfd4b84e057fe" title="void Packer::compressWithFilters(): Try compression with several methods and filters,..." alt="" coords="509,507,688,533"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="267,995,390,1021"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="270,1045,387,1070"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="265,1146,393,1171"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="265,1195,393,1221"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1248,737,1367,762"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1059,794,1148,819"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="825,471,909,497"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="827,45,908,70"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="760,146,975,171"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1026,161,1181,186"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1028,37,1179,77"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="1232,5,1383,45"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="1232,69,1383,109"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="539,269,658,294"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="780,269,955,294"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1062,269,1145,294"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1033,446,1173,471"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1232,261,1383,301"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="565,445,632,470"/>
<area shape="rect" href="classPacker.html#ac91d266e1612ca6108035e22fe8b1203" title=" " alt="" coords="485,780,712,820"/>
<area shape="rect" href="classPacker.html#a4a969f788c3bad61abe0eec73fca0f0c" title="compression method util" alt="" coords="767,620,967,660"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="796,521,939,546"/>
<area shape="rect" href="util_8cpp.html#aa6941e20228b3e1dc459a36773b99633" title=" " alt="" coords="826,570,909,595"/>
<area shape="rect" href="packhead_8cpp.html#a99fd3f5cbc734f9863205a1e892ea48c" title="ph method util" alt="" coords="1023,521,1184,546"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="541,845,656,870"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="524,894,673,919"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="802,845,933,870"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="823,739,912,765"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="799,894,936,919"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1024,729,1183,769"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="541,995,657,1021"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="839,1045,896,1070"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="799,995,935,1021"/>
</map>
</div>

</div>
</div>
<a id="ae4c3d3d66cd14ea19fc44d0f90274092" name="ae4c3d3d66cd14ea19fc44d0f90274092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4c3d3d66cd14ea19fc44d0f90274092">&#9670;&#160;</a></span>pack2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::pack2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a619d0ed2f97d37150ed5b1437c67b6f1">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05758">5758</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5759</span>{</div>
<div class="line"><span class="lineno"> 5760</span>    Extent x;</div>
<div class="line"><span class="lineno"> 5761</span>    <span class="keywordtype">unsigned</span> k;</div>
<div class="line"><span class="lineno"> 5762</span>    <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = (!!<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib) &lt;&lt; 1;  <span class="comment">// bit 1; see is_shlib</span></div>
<div class="line"><span class="lineno"> 5763</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> is_shlib = (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) | <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>;</div>
<div class="line"><span class="lineno"> 5764</span>    <span class="keywordtype">unsigned</span> pre_xct_top = 0;  <span class="comment">// offset of end of PT_LOAD _before_ xct_off</span></div>
<div class="line"><span class="lineno"> 5765</span> </div>
<div class="line"><span class="lineno"> 5766</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_ARM==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>)) {</div>
<div class="line"><span class="lineno"> 5767</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_ARM_ATTRIBUTES);</div>
<div class="line"><span class="lineno"> 5768</span>    }</div>
<div class="line"><span class="lineno"> 5769</span>    <span class="comment">// count passes, set ptload vars</span></div>
<div class="line"><span class="lineno"> 5770</span>    uip-&gt;ui_total_passes = 0;</div>
<div class="line"><span class="lineno"> 5771</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno"> 5772</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k])) {</div>
<div class="line"><span class="lineno"> 5773</span>            <span class="keywordflow">if</span> (!is_shlib) {</div>
<div class="line"><span class="lineno"> 5774</span>                uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5775</span>            }</div>
<div class="line"><span class="lineno"> 5776</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5777</span>                <span class="keywordtype">unsigned</span> p_flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_flags);</div>
<div class="line"><span class="lineno"> 5778</span>                <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_offset);</div>
<div class="line"><span class="lineno"> 5779</span>                <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5780</span>                <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset) &lt; p_filesz) { <span class="comment">// PT_LOAD covers xct_off</span></div>
<div class="line"><span class="lineno"> 5781</span>                    <span class="keywordflow">if</span> (!pre_xct_top &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> != p_offset) {</div>
<div class="line"><span class="lineno"> 5782</span>                        pre_xct_top = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5783</span>                    }</div>
<div class="line"><span class="lineno"> 5784</span>                }</div>
<div class="line"><span class="lineno"> 5785</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p_offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// candidate for pre_xct_top</span></div>
<div class="line"><span class="lineno"> 5786</span>                    <span class="keywordtype">unsigned</span> top = p_filesz + p_offset;</div>
<div class="line"><span class="lineno"> 5787</span>                    <span class="keywordflow">if</span> (pre_xct_top &lt; top) {</div>
<div class="line"><span class="lineno"> 5788</span>                        pre_xct_top = top;</div>
<div class="line"><span class="lineno"> 5789</span>                    }</div>
<div class="line"><span class="lineno"> 5790</span>                }</div>
<div class="line"><span class="lineno"> 5791</span>                <span class="keywordflow">if</span> (Elf64_Phdr::PF_W &amp; p_flags) {</div>
<div class="line"><span class="lineno"> 5792</span>                    <span class="comment">// rtld might write, so cannot compress</span></div>
<div class="line"><span class="lineno"> 5793</span>                }</div>
<div class="line"><span class="lineno"> 5794</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5795</span>                    <span class="comment">// First PT_LOAD (partial) only if has instructions</span></div>
<div class="line"><span class="lineno"> 5796</span>                    <span class="keywordflow">if</span> (k || <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; p_filesz) {</div>
<div class="line"><span class="lineno"> 5797</span>                        uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5798</span>                    }</div>
<div class="line"><span class="lineno"> 5799</span>                }</div>
<div class="line"><span class="lineno"> 5800</span>            }</div>
<div class="line"><span class="lineno"> 5801</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>)) {</div>
<div class="line"><span class="lineno"> 5802</span>                uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5803</span>            }</div>
<div class="line"><span class="lineno"> 5804</span>        }</div>
<div class="line"><span class="lineno"> 5805</span>    }</div>
<div class="line"><span class="lineno"> 5806</span> </div>
<div class="line"><span class="lineno"> 5807</span>    <span class="comment">// compress extents</span></div>
<div class="line"><span class="lineno"> 5808</span>    <span class="keywordtype">unsigned</span> hdr_u_len = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a>;</div>
<div class="line"><span class="lineno"> 5809</span> </div>
<div class="line"><span class="lineno"> 5810</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> =  0;</div>
<div class="line"><span class="lineno"> 5811</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = 0;</div>
<div class="line"><span class="lineno"> 5812</span>    uip-&gt;ui_pass = 0;</div>
<div class="line"><span class="lineno"> 5813</span>    ft.<a class="code hl_variable" href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">addvalue</a> = 0;</div>
<div class="line"><span class="lineno"> 5814</span> </div>
<div class="line"><span class="lineno"> 5815</span>    <span class="keywordtype">unsigned</span> nk_f = 0; <a class="code hl_typedef" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a> xsz_f = 0;</div>
<div class="line"><span class="lineno"> 5816</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k)</div>
<div class="line"><span class="lineno"> 5817</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k])</div>
<div class="line"><span class="lineno"> 5818</span>    &amp;&amp;  Elf32_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_flags)) {</div>
<div class="line"><span class="lineno"> 5819</span>        <span class="keywordtype">unsigned</span> xsz = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5820</span>        <span class="keywordflow">if</span> (xsz_f &lt; xsz) {</div>
<div class="line"><span class="lineno"> 5821</span>            xsz_f = xsz;</div>
<div class="line"><span class="lineno"> 5822</span>            nk_f = k;</div>
<div class="line"><span class="lineno"> 5823</span>        }</div>
<div class="line"><span class="lineno"> 5824</span>    }</div>
<div class="line"><span class="lineno"> 5825</span>    <span class="keywordflow">if</span> (is_shlib) {</div>
<div class="line"><span class="lineno"> 5826</span>        <a class="code hl_function" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib</a>(fo, ft, pre_xct_top);</div>
<div class="line"><span class="lineno"> 5827</span>    }</div>
<div class="line"><span class="lineno"> 5828</span>    <span class="keywordflow">else</span> { <span class="comment">// main program</span></div>
<div class="line"><span class="lineno"> 5829</span>        <span class="keywordtype">int</span> n_ptload = 0;</div>
<div class="line"><span class="lineno"> 5830</span>        <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k)</div>
<div class="line"><span class="lineno"> 5831</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k])) {</div>
<div class="line"><span class="lineno"> 5832</span>            <span class="keywordflow">if</span> (ft.<a class="code hl_variable" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">id</a> &lt; 0x40) {</div>
<div class="line"><span class="lineno"> 5833</span>                <span class="comment">// FIXME: ??    ft.addvalue = phdri[k].p_vaddr;</span></div>
<div class="line"><span class="lineno"> 5834</span>            }</div>
<div class="line"><span class="lineno"> 5835</span>            <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_offset);</div>
<div class="line"><span class="lineno"> 5836</span>            <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5837</span>            x.offset = p_offset;</div>
<div class="line"><span class="lineno"> 5838</span>            x.size   = p_filesz;</div>
<div class="line"><span class="lineno"> 5839</span>            <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)x.size &lt; hdr_u_len) { <span class="comment">// FIXME: main program, but how?</span></div>
<div class="line"><span class="lineno"> 5840</span>                <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5841</span>            }</div>
<div class="line"><span class="lineno"> 5842</span>            <span class="keywordflow">else</span> {  <span class="comment">// main program, not shared library</span></div>
<div class="line"><span class="lineno"> 5843</span>                <span class="keywordflow">if</span> (0 == n_ptload) { <span class="comment">// 1st PT_LOAD must cover Ehdr at 0==p_offset</span></div>
<div class="line"><span class="lineno"> 5844</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> delta = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5845</span>                    <span class="keywordflow">if</span> (ft.<a class="code hl_variable" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">id</a> &lt; 0x40) {</div>
<div class="line"><span class="lineno"> 5846</span>                        <span class="comment">// FIXME: ??     ft.addvalue += asl_delta;</span></div>
<div class="line"><span class="lineno"> 5847</span>                    }</div>
<div class="line"><span class="lineno"> 5848</span>                    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)delta == x.size) { <span class="comment">// PT_LOAD[0] with ElfXX.Ehdr only</span></div>
<div class="line"><span class="lineno"> 5849</span>                        <span class="comment">// QBE backend - http://c9x.me/compile/</span></div>
<div class="line"><span class="lineno"> 5850</span>                        hdr_u_len = 0;  <span class="comment">// no fiddling necessary!</span></div>
<div class="line"><span class="lineno"> 5851</span>                        <span class="comment">// &amp;ft arg to packExtent will be zero because (k != nk_f)</span></div>
<div class="line"><span class="lineno"> 5852</span>                    }</div>
<div class="line"><span class="lineno"> 5853</span>                    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5854</span>                        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += delta - hdr_u_len;</div>
<div class="line"><span class="lineno"> 5855</span>                        x.offset += delta;</div>
<div class="line"><span class="lineno"> 5856</span>                        x.size   -= delta;</div>
<div class="line"><span class="lineno"> 5857</span>                    }</div>
<div class="line"><span class="lineno"> 5858</span>                }</div>
<div class="line"><span class="lineno"> 5859</span>                <span class="comment">// compressWithFilters() always assumes a &quot;loader&quot;, so would</span></div>
<div class="line"><span class="lineno"> 5860</span>                <span class="comment">// throw NotCompressible for small .data Extents, which PowerPC</span></div>
<div class="line"><span class="lineno"> 5861</span>                <span class="comment">// sometimes marks as PF_X anyway.  So filter only first segment.</span></div>
<div class="line"><span class="lineno"> 5862</span>                <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x,</div>
<div class="line"><span class="lineno"> 5863</span>                    (k==nk_f ? &amp;ft : <span class="keyword">nullptr</span> ), fo, hdr_u_len, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5864</span>                hdr_u_len = 0;</div>
<div class="line"><span class="lineno"> 5865</span>            }</div>
<div class="line"><span class="lineno"> 5866</span>            ++n_ptload;</div>
<div class="line"><span class="lineno"> 5867</span>        }</div>
<div class="line"><span class="lineno"> 5868</span>    }</div>
<div class="line"><span class="lineno"> 5869</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">sz_pack2a</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);  <span class="comment">// MATCH01</span></div>
<div class="line"><span class="lineno"> 5870</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5871</span> </div>
<div class="line"><span class="lineno"> 5872</span>    <span class="comment">// Accounting only; ::pack3 will do the compression and output</span></div>
<div class="line"><span class="lineno"> 5873</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno"> 5874</span>        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += <a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 5875</span>    }</div>
<div class="line"><span class="lineno"> 5876</span> </div>
<div class="line"><span class="lineno"> 5877</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> != (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>)</div>
<div class="line"><span class="lineno"> 5878</span>        <a class="code hl_function" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a>();</div>
<div class="line"><span class="lineno"> 5879</span> </div>
<div class="line"><span class="lineno"> 5880</span>    <span class="keywordflow">return</span> 0;  <span class="comment">// omit end-of-compression bhdr for now</span></div>
<div class="line"><span class="lineno"> 5881</span>}</div>
<div class="ttc" id="aclassFilter_html_a2f300af4994c93ee536e9002b315b1ea"><div class="ttname"><a href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">Filter::addvalue</a></div><div class="ttdeci">unsigned addvalue</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00071">filter.h:71</a></div></div>
<div class="ttc" id="aclassFilter_html_aac773bd22bdb2ba33014b5d58405d19f"><div class="ttname"><a href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">Filter::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00086">filter.h:86</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6c77e1df704fbb16e2d048937bdb0663"><div class="ttname"><a href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">PackLinuxElf64::find_LOAD_gap</a></div><div class="ttdeci">virtual unsigned find_LOAD_gap(Elf64_Phdr const *const phdri, unsigned const k, unsigned const e_phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05608">p_lx_elf.cpp:5608</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a72eb546964b4b777ec38c3da1972eeb8"><div class="ttname"><a href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">PackLinuxElf64::pack2_shlib</a></div><div class="ttdeci">virtual int pack2_shlib(OutputFile *fo, Filter &amp;ft, unsigned pre_xct_top)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05644">p_lx_elf.cpp:5644</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ae86e3eeb56091063ef73bbcab2c1262a"><div class="ttname"><a href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">PackLinuxElf::sz_pack2a</a></div><div class="ttdeci">unsigned sz_pack2a</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00100">p_lx_elf.h:100</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_af8b16212a7cce313d106777dc6c198af"><div class="ttname"><a href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a></div><div class="ttdeci">unsigned is_asl</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00104">p_lx_elf.h:104</a></div></div>
<div class="ttc" id="aclassPackUnix_html_ad3f398fa4a3b34fd79f441e3069f78b1"><div class="ttname"><a href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent</a></div><div class="ttdeci">virtual void packExtent(const Extent &amp;x, Filter *, OutputFile *, unsigned hdr_len=0, unsigned b_extra=0, bool inhibit_compression_check=false)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00331">p_unix.cpp:331</a></div></div>
<div class="ttc" id="aclassPacker_html_aba0bcb1d796daaeea9d308d8e407505e"><div class="ttname"><a href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">Packer::get_te64_32</a></div><div class="ttdeci">unsigned get_te64_32(const void *p) const</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00263">packer.h:263</a></div></div>
<div class="ttc" id="aconf_8h_html_a8e3030ad36a1cb27a77eb87e12a648bc"><div class="ttname"><a href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a></div><div class="ttdeci">acc_uint32_t upx_uint32_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00165">conf.h:165</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_ab8961782cfe1b9b4f96796b45672f762"><div class="ttname"><a href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a></div><div class="ttdeci">void throwEOFException(const char *msg, int e)</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00140">except.cpp:140</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a7236f968e16474ded809aa6b9f98452a"><div class="ttname"><a href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a></div><div class="ttdeci">static unsigned up4(unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00076">p_lx_elf.cpp:76</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">Filter::addvalue</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">Packer::get_te64_32()</a>, <a class="el" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">Filter::id</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib()</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">PackLinuxElf::sz_pack2a</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph" id="aclassPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph">
<area shape="rect" title=" " alt="" coords="5,323,172,349"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="231,208,376,248"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="739,198,869,223"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="227,93,379,133"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="435,147,617,173"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="497,566,555,591"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="739,310,869,335"/>
<area shape="rect" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e" title=" " alt="" coords="450,299,602,325"/>
<area shape="rect" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8" title=" " alt="" coords="220,685,387,725"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="445,1225,607,1250"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="991,1022,1140,1047"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="280,1201,327,1226"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="739,251,869,277"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1628,643,1747,669"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="994,466,1137,491"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="739,718,869,743"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1247,542,1384,567"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="998,719,1133,745"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1271,745,1360,770"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1250,819,1381,845"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1491,870,1580,895"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="1021,769,1110,794"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="999,1190,1132,1215"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="685,1225,923,1250"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="453,451,599,491"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="765,617,843,642"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="740,365,868,390"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="781,473,827,498"/>
<area shape="rect" href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88" title=" " alt="" coords="711,1713,897,1753"/>
<area shape="rect" href="classPackLinuxElf.html#aafaf58332d98b1981f8d78c3eeb729c6" title=" " alt="" coords="451,819,601,859"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="740,921,868,946"/>
<area shape="rect" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9" title=" " alt="" coords="448,883,604,923"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="1008,870,1123,895"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="745,667,863,693"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1277,1019,1353,1045"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1273,1233,1357,1258"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1275,1183,1356,1209"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1208,1282,1423,1307"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1238,1082,1393,1107"/>
<area shape="rect" href="classMemBuffer.html#a3dcd6ad1b690292fd215302825ceaf5b" title=" " alt="" coords="1188,1331,1443,1357"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1245,1690,1385,1715"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="1014,1613,1117,1638"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="1007,1663,1123,1689"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="737,1511,871,1537"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="994,1562,1137,1587"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="701,1298,907,1323"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="721,1347,887,1373"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="743,1022,865,1047"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="665,1397,943,1422"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="710,1447,898,1487"/>
</map>
</div>

</div>
</div>
<a id="a72eb546964b4b777ec38c3da1972eeb8" name="a72eb546964b4b777ec38c3da1972eeb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72eb546964b4b777ec38c3da1972eeb8">&#9670;&#160;</a></span>pack2_shlib()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::pack2_shlib </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>pre_xct_top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05644">5644</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5645</span>{</div>
<div class="line"><span class="lineno"> 5646</span>    <span class="comment">// prepare to alter Phdrs and Shdrs</span></div>
<div class="line"><span class="lineno"> 5647</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + (!<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a></div>
<div class="line"><span class="lineno"> 5648</span>        ? 0</div>
<div class="line"><span class="lineno"> 5649</span>        : <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>))));</div>
<div class="line"><span class="lineno"> 5650</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// android omits Shdr from copy now</span></div>
<div class="line"><span class="lineno"> 5651</span> </div>
<div class="line"><span class="lineno"> 5652</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> elf_buf;</div>
<div class="line"><span class="lineno"> 5653</span>    elf_buf.<a class="code hl_function" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">allocForCompression</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno"> 5654</span>    <span class="keywordtype">unsigned</span> u_len = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 5655</span>    <span class="keywordtype">unsigned</span> c_len = <a class="code hl_function" href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88">pack2_shlib_overlay_compress</a>(elf_buf, <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, u_len);</div>
<div class="line"><span class="lineno"> 5656</span> </div>
<div class="line"><span class="lineno"> 5657</span>    <span class="keywordtype">int</span> n_ptload = 0;</div>
<div class="line"><span class="lineno"> 5658</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0];</div>
<div class="line"><span class="lineno"> 5659</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++k)</div>
<div class="line"><span class="lineno"> 5660</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 5661</span>        <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 5662</span>        <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 5663</span>        <span class="keywordflow">if</span> (!n_ptload) { <span class="comment">// first PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5664</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) { <span class="comment">// Copy up to xct_off, then add 2nd copy of Shdrs</span></div>
<div class="line"><span class="lineno"> 5665</span>                <a class="code hl_function" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs</a>(fo, pre_xct_top);</div>
<div class="line"><span class="lineno"> 5666</span>            }</div>
<div class="line"><span class="lineno"> 5667</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5668</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(p_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5669</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>,  <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);  <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  += <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 5670</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 5671</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>;  <span class="comment">// leave space</span></div>
<div class="line"><span class="lineno"> 5672</span> </div>
<div class="line"><span class="lineno"> 5673</span>                <span class="comment">// Compare PackUnix::packExtent, especially &quot;if (u_len)&quot; .</span></div>
<div class="line"><span class="lineno"> 5674</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 5675</span> </div>
<div class="line"><span class="lineno"> 5676</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hi_offset = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>, (<span class="keywordtype">unsigned</span>)(p_filesz + p_offset));</div>
<div class="line"><span class="lineno"> 5677</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> &lt; hi_offset) {</div>
<div class="line"><span class="lineno"> 5678</span>                    <span class="comment">// Loader tables in first PT_LOAD, and below xct_off.</span></div>
<div class="line"><span class="lineno"> 5679</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 5680</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>,  hi_offset - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);  <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  += hi_offset - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 5681</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, hi_offset - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += hi_offset - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 5682</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *lo_phdr = k + (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5683</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;lo_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>, Elf64_Phdr::PF_X | <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;lo_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>));</div>
<div class="line"><span class="lineno"> 5684</span>                }</div>
<div class="line"><span class="lineno"> 5685</span>            }</div>
<div class="line"><span class="lineno"> 5686</span>            <a class="code hl_function" href="classPackLinuxElf.html#aafaf58332d98b1981f8d78c3eeb729c6">pack2_shlib_overlay_init</a>(fo); <span class="comment">// set overlay_offset</span></div>
<div class="line"><span class="lineno"> 5687</span>            <span class="comment">// Compressed ELF headers go first.</span></div>
<div class="line"><span class="lineno"> 5688</span>            <a class="code hl_function" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9">pack2_shlib_overlay_write</a>(fo, elf_buf, u_len, c_len);</div>
<div class="line"><span class="lineno"> 5689</span> </div>
<div class="line"><span class="lineno"> 5690</span>            <span class="comment">// The (compressible) remainder above xct_off in first PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5691</span>            <span class="keywordflow">if</span> (         p_filesz &gt;= (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset)) {</div>
<div class="line"><span class="lineno"> 5692</span>                Extent x;</div>
<div class="line"><span class="lineno"> 5693</span>                x.size = p_filesz -  (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset);</div>
<div class="line"><span class="lineno"> 5694</span>                x.offset = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5695</span>                <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5696</span>            }</div>
<div class="line"><span class="lineno"> 5697</span>        }  <span class="comment">// end first PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5698</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((p_filesz + p_offset) &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 5699</span>            <span class="comment">// Not first PT_LOAD, but below xct_offset.  Thus &quot;interloper&quot; PT_LOAD,</span></div>
<div class="line"><span class="lineno"> 5700</span>            <span class="comment">// below xct_off that was increased to a PT_LOAD large enough to compress.</span></div>
<div class="line"><span class="lineno"> 5701</span>            <span class="comment">// &quot;Manually&quot; compress it, do not use PackExtent.</span></div>
<div class="line"><span class="lineno"> 5702</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(p_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5703</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, p_filesz);  <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  += p_filesz;</div>
<div class="line"><span class="lineno"> 5704</span>            <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> buf2; buf2.<a class="code hl_function" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">allocForCompression</a>(p_filesz);</div>
<div class="line"><span class="lineno"> 5705</span>            c_len = <a class="code hl_function" href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88">pack2_shlib_overlay_compress</a>(buf2, <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, p_filesz);</div>
<div class="line"><span class="lineno"> 5706</span>            <a class="code hl_function" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9">pack2_shlib_overlay_write</a>(fo, buf2, p_filesz, c_len);</div>
<div class="line"><span class="lineno"> 5707</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *lo_phdr = k + (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5708</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;lo_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>, Elf64_Phdr::PT_NULL);</div>
<div class="line"><span class="lineno"> 5709</span>        }</div>
<div class="line"><span class="lineno"> 5710</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset) &lt; p_filesz) {</div>
<div class="line"><span class="lineno"> 5711</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset;</div>
<div class="line"><span class="lineno"> 5712</span>            <span class="comment">// Loader tables in non-first PT_LOAD.  (xct_off was increased.)</span></div>
<div class="line"><span class="lineno"> 5713</span>            <span class="comment">// Bytes below xct_off belong to rtld, so cannot be compressed.</span></div>
<div class="line"><span class="lineno"> 5714</span>            <span class="comment">// Note that asl_pack2_Shdrs() copies up to xct_off, then adds extra info.</span></div>
<div class="line"><span class="lineno"> 5715</span>            <span class="comment">// Copy up to xct_off</span></div>
<div class="line"><span class="lineno"> 5716</span>            <span class="comment">// FIXME: fo-&gt;write(&amp;file_image[x.offset], x.size);</span></div>
<div class="line"><span class="lineno"> 5717</span>            <span class="keywordflow">if</span> (len) {</div>
<div class="line"><span class="lineno"> 5718</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>,  len);  <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  += len;</div>
<div class="line"><span class="lineno"> 5719</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, len);  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 5720</span> </div>
<div class="line"><span class="lineno"> 5721</span>                <span class="comment">// Compressed ELF headers  FIXME: 1st PT_LOAD also did this!</span></div>
<div class="line"><span class="lineno"> 5722</span>                <a class="code hl_function" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9">pack2_shlib_overlay_write</a>(fo, elf_buf, u_len, c_len);  <span class="comment">// set overlay_offset</span></div>
<div class="line"><span class="lineno"> 5723</span>            }</div>
<div class="line"><span class="lineno"> 5724</span>            <span class="comment">// The rest, above xct_off.</span></div>
<div class="line"><span class="lineno"> 5725</span>            Extent x;</div>
<div class="line"><span class="lineno"> 5726</span>            x.offset = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5727</span>            x.size = p_filesz - len;</div>
<div class="line"><span class="lineno"> 5728</span>            <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5729</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *lo_phdr = k + (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5730</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;lo_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>, Elf64_Phdr::PT_NULL);</div>
<div class="line"><span class="lineno"> 5731</span>        }</div>
<div class="line"><span class="lineno"> 5732</span>        <span class="keywordflow">else</span> { <span class="comment">// definitely compressible unless writeable</span></div>
<div class="line"><span class="lineno"> 5733</span>            <span class="keywordflow">if</span> (!(Elf64_Phdr::PF_W &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>))) {</div>
<div class="line"><span class="lineno"> 5734</span>                <span class="comment">// Read-only PT_LOAD, assume not written by relocations.</span></div>
<div class="line"><span class="lineno"> 5735</span>                <span class="comment">// Also assume not the source for R_*_COPY relocation,</span></div>
<div class="line"><span class="lineno"> 5736</span>                <span class="comment">// therefore compress it.</span></div>
<div class="line"><span class="lineno"> 5737</span>                Extent x;</div>
<div class="line"><span class="lineno"> 5738</span>                x.offset = p_offset;</div>
<div class="line"><span class="lineno"> 5739</span>                x.size = p_filesz;</div>
<div class="line"><span class="lineno"> 5740</span>                <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);  <span class="comment">// choose filter and method, then do it</span></div>
<div class="line"><span class="lineno"> 5741</span>                <span class="comment">// De-compressing will re-create it, but otherwise ignore it.</span></div>
<div class="line"><span class="lineno"> 5742</span>                <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdro = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5743</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdro[k].p_type, Elf32_Phdr::PT_NULL);</div>
<div class="line"><span class="lineno"> 5744</span>            }</div>
<div class="line"><span class="lineno"> 5745</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5746</span>                <span class="comment">// Read-write PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 5747</span>                <span class="comment">// rtld might relocate, so we cannot compress.</span></div>
<div class="line"><span class="lineno"> 5748</span>                <span class="comment">// (Could compress if not relocated; complicates run-time.)</span></div>
<div class="line"><span class="lineno"> 5749</span>                <span class="comment">// Postpone writing until &quot;slide&quot;, but account for its size.</span></div>
<div class="line"><span class="lineno"> 5750</span>                <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> +=  p_filesz;</div>
<div class="line"><span class="lineno"> 5751</span>            }</div>
<div class="line"><span class="lineno"> 5752</span>        }</div>
<div class="line"><span class="lineno"> 5753</span>        ++n_ptload;</div>
<div class="line"><span class="lineno"> 5754</span>    }</div>
<div class="line"><span class="lineno"> 5755</span>    <span class="keywordflow">return</span> 0;  <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 5756</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6eefcbb2a42d861b12d2c309d93771b8"><div class="ttname"><a href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">PackLinuxElf64::asl_pack2_Shdrs</a></div><div class="ttdeci">virtual void asl_pack2_Shdrs(OutputFile *, unsigned pre_xct_top)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l04450">p_lx_elf.cpp:4450</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a5384daf1baa189915edd8bbb8821ee88"><div class="ttname"><a href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88">PackLinuxElf::pack2_shlib_overlay_compress</a></div><div class="ttdeci">virtual unsigned pack2_shlib_overlay_compress(MemBuffer &amp;obuf, MemBuffer &amp;ibuf, unsigned u_len)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05301">p_lx_elf.cpp:5301</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a80a270e823ea95b0900a5abbf786dac9"><div class="ttname"><a href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9">PackLinuxElf::pack2_shlib_overlay_write</a></div><div class="ttdeci">virtual unsigned pack2_shlib_overlay_write(OutputFile *fo, MemBuffer &amp;obuf, unsigned hdr_u_len, unsigned hdr_c_len)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05284">p_lx_elf.cpp:5284</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aafaf58332d98b1981f8d78c3eeb729c6"><div class="ttname"><a href="classPackLinuxElf.html#aafaf58332d98b1981f8d78c3eeb729c6">PackLinuxElf::pack2_shlib_overlay_init</a></div><div class="ttdeci">virtual unsigned pack2_shlib_overlay_init(OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05263">p_lx_elf.cpp:5263</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression()</a>, <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">Packer::get_te64_32()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88">PackLinuxElf::pack2_shlib_overlay_compress()</a>, <a class="el" href="classPackLinuxElf.html#aafaf58332d98b1981f8d78c3eeb729c6">PackLinuxElf::pack2_shlib_overlay_init()</a>, <a class="el" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9">PackLinuxElf::pack2_shlib_overlay_write()</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8()</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_cgraph" id="aclassPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_cgraph">
<area shape="rect" title=" " alt="" coords="5,1018,172,1058"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="781,853,914,878"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="450,904,689,929"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="228,467,375,507"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1049,84,1179,109"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="756,58,939,84"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="782,1686,913,1712"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="530,701,609,726"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="505,1322,633,1348"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="546,576,593,601"/>
<area shape="rect" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e" title=" " alt="" coords="225,1082,377,1108"/>
<area shape="rect" href="classPackLinuxElf.html#a5384daf1baa189915edd8bbb8821ee88" title=" " alt="" coords="476,1004,663,1044"/>
<area shape="rect" href="classPackLinuxElf.html#aafaf58332d98b1981f8d78c3eeb729c6" title=" " alt="" coords="226,1960,377,2000"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="505,1069,633,1094"/>
<area shape="rect" href="classPackLinuxElf.html#a80a270e823ea95b0900a5abbf786dac9" title=" " alt="" coords="223,1018,379,1058"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="220,1209,383,1234"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="790,1562,905,1588"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="511,1372,628,1397"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1289,1098,1379,1124"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1076,753,1152,778"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1072,1029,1156,1054"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1073,853,1155,878"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1007,1130,1221,1156"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1037,804,1191,829"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1427,664,1545,689"/>
<area shape="rect" href="classMemBuffer.html#a3dcd6ad1b690292fd215302825ceaf5b" title=" " alt="" coords="987,954,1241,980"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="760,108,935,133"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="474,158,665,198"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="783,220,912,245"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="540,1470,599,1496"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="505,273,634,298"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="505,425,633,450"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="498,474,641,500"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="1047,1762,1181,1788"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1289,1661,1379,1686"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1049,1509,1179,1534"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1045,1460,1183,1485"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="1046,1410,1182,1436"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="789,1461,905,1486"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1044,1208,1184,1233"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="796,1056,899,1081"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="789,954,905,980"/>
<area shape="rect" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1" title=" " alt="" coords="531,1961,608,1986"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="502,1170,637,1196"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="776,1309,919,1334"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="467,1710,672,1736"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="486,1760,653,1785"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="508,1421,631,1446"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="431,1809,708,1834"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="475,1622,663,1662"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_icgraph" id="aclassPackLinuxElf64_a72eb546964b4b777ec38c3da1972eeb8_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,387,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a34abb7fc5a62a52800339d603f78f562" name="a34abb7fc5a62a52800339d603f78f562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34abb7fc5a62a52800339d603f78f562">&#9670;&#160;</a></span>pack3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf64::pack3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00706">706</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  707</span>{</div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a>) {</div>
<div class="line"><span class="lineno">  709</span>        <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>) + (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> : <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno">  710</span>    }</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">super::pack3</a>(fo, ft);  <span class="comment">// loader follows compressed PT_LOADs</span></div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &amp;&amp; Elf64_Dyn::DT_INIT != <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>) { <span class="comment">// patch user_init_rp</span></div>
<div class="line"><span class="lineno">  714</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>((<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0], <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  715</span>        <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> rela(*(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>);</div>
<div class="line"><span class="lineno">  716</span>        <span class="comment">//u64_t r_info = get_te64(&amp;((Elf64_Rela const *)user_init_rp)-&gt;r_info);</span></div>
<div class="line"><span class="lineno">  717</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> r_type = (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_AARCH64_RELATIVE</div>
<div class="line"><span class="lineno">  718</span>                     : (Elf64_Ehdr::EM_X86_64  == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_X86_64_RELATIVE</div>
<div class="line"><span class="lineno">  719</span>                     : (Elf64_Ehdr::EM_PPC64   == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_PPC64_RELATIVE</div>
<div class="line"><span class="lineno">  720</span>                     : 0;</div>
<div class="line"><span class="lineno">  721</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela.r_info, ELF64_R_INFO(0 <span class="comment">/*ELF64_R_SYM(r_info)*/</span>, r_type));</div>
<div class="line"><span class="lineno">  722</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela.r_addend, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a>);  <span class="comment">// entry to decompressor</span></div>
<div class="line"><span class="lineno">  723</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;rela, <span class="keyword">sizeof</span>(rela));</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno">  726</span>    }</div>
<div class="line"><span class="lineno">  727</span>    <span class="comment">// NOTE: PackLinuxElf::pack3  adjusted xct_off for the extra page</span></div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="comment">// Then compressed gaps (including debuginfo.)</span></div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno">  731</span>        Extent x;</div>
<div class="line"><span class="lineno">  732</span>        x.size = <a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  733</span>        <span class="keywordflow">if</span> (x.size) {</div>
<div class="line"><span class="lineno">  734</span>            x.offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_offset) +</div>
<div class="line"><span class="lineno">  735</span>                       <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno">  736</span>            <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, <span class="keyword">nullptr</span>, fo);</div>
<div class="line"><span class="lineno">  737</span>        }</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span>    <span class="comment">// write block end marker (uncompressed size 0)</span></div>
<div class="line"><span class="lineno">  740</span>    <a class="code hl_struct" href="structb__info.html">b_info</a> hdr; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;hdr, 0, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno">  741</span>    <a class="code hl_function" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a>(&amp;hdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>, <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>);</div>
<div class="line"><span class="lineno">  742</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;hdr, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno">  743</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// not shared library</span></div>
<div class="line"><span class="lineno">  746</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_align, ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)0) - <a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>);</div>
<div class="line"><span class="lineno">  747</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_paddr = <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno">  748</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_offset = 0;</div>
<div class="line"><span class="lineno">  749</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> abrk = <a class="code hl_function" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  750</span>        <span class="comment">// vbase handles ET_EXEC.  FIXME: pre-linking?</span></div>
<div class="line"><span class="lineno">  751</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> vbase = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr);</div>
<div class="line"><span class="lineno">  752</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz, 0x1000);  <span class="comment">// Linux kernel SIGSEGV if (0==.p_filesz)</span></div>
<div class="line"><span class="lineno">  753</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_memsz, abrk - vbase);</div>
<div class="line"><span class="lineno">  754</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, Elf64_Phdr::PF_W|Elf64_Phdr::PF_R);</div>
<div class="line"><span class="lineno">  755</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  756</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz,  <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  757</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr, abrk= (<a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a> &amp; (~<a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a> + abrk)));</div>
<div class="line"><span class="lineno">  758</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_paddr = <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr;</div>
<div class="line"><span class="lineno">  759</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry, abrk + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry) - vbase);</div>
<div class="line"><span class="lineno">  760</span>    }</div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// shared library</span></div>
<div class="line"><span class="lineno">  762</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> cpr_entry = <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a>;</div>
<div class="line"><span class="lineno">  763</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>], cpr_entry);  <span class="comment">// set the hook</span></div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>) { <span class="comment">// decompressor needs hint for DT_INIT_ARRAY</span></div>
<div class="line"><span class="lineno">  766</span>            <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dynp = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)<a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(Elf64_Dyn::DT_NULL);</div>
<div class="line"><span class="lineno">  767</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dynp-&gt;d_val, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0]);</div>
<div class="line"><span class="lineno">  768</span>        }</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *<span class="keyword">const</span> phdr0 = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno">  771</span>                <span class="stringliteral">&quot;bad e_phoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno">  772</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = phdr0;</div>
<div class="line"><span class="lineno">  773</span>        <a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a> off = fo-&gt;<a class="code hl_function" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">st_size</a>();  <span class="comment">// 64 bits</span></div>
<div class="line"><span class="lineno">  774</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> = 0;</div>
<div class="line"><span class="lineno">  775</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) {</div>
<div class="line"><span class="lineno">  776</span>            <span class="comment">// p_vaddr and p_paddr do not change!</span></div>
<div class="line"><span class="lineno">  777</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> len  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno">  778</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> ioff = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[j].p_offset);  <span class="comment">// without asl_delta</span></div>
<div class="line"><span class="lineno">  779</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>       align= <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>);</div>
<div class="line"><span class="lineno">  780</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno">  781</span>            <span class="keywordflow">if</span> (Elf64_Phdr::PT_INTERP==type) {</div>
<div class="line"><span class="lineno">  782</span>                <span class="comment">// Rotate to highest position, so it can be lopped</span></div>
<div class="line"><span class="lineno">  783</span>                <span class="comment">// by decrementing e_phnum.</span></div>
<div class="line"><span class="lineno">  784</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, phdr, <span class="keyword">sizeof</span>(*phdr));  <span class="comment">// extract</span></div>
<div class="line"><span class="lineno">  785</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove</a>(phdr, 1+phdr, (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - (1+ j))*<span class="keyword">sizeof</span>(*phdr));  <span class="comment">// overlapping</span></div>
<div class="line"><span class="lineno">  786</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;phdr[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - (1+ j)], (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <span class="keyword">sizeof</span>(*phdr));  <span class="comment">// to top</span></div>
<div class="line"><span class="lineno">  787</span>                --phdr; --<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>;</div>
<div class="line"><span class="lineno">  788</span>                <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  789</span>                <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;((<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>)-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  790</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  791</span>            }</div>
<div class="line"><span class="lineno">  792</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a> == type) {</div>
<div class="line"><span class="lineno">  793</span>                <span class="keywordflow">if</span> (!ioff) { <span class="comment">// first PT_LOAD must contain everything written so far</span></div>
<div class="line"><span class="lineno">  794</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);  <span class="comment">// is this correct?</span></div>
<div class="line"><span class="lineno">  795</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>,  <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  796</span>                }</div>
<div class="line"><span class="lineno">  797</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - ioff) &lt; len) { <span class="comment">// Change length of compressed PT_LOAD.</span></div>
<div class="line"><span class="lineno">  798</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - ioff);  <span class="comment">// FIXME  (sz_pack2 + lsize - ioff) ?</span></div>
<div class="line"><span class="lineno">  799</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>,  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - ioff);</div>
<div class="line"><span class="lineno">  800</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// MIPS puts PT_DYNAMIC here</span></div>
<div class="line"><span class="lineno">  801</span>                        <span class="comment">// Allow for DT_INIT in a new [stolen] slot</span></div>
<div class="line"><span class="lineno">  802</span>                        <span class="keywordtype">unsigned</span> off2 = <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> - <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>);</div>
<div class="line"><span class="lineno">  803</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off2, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  804</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[off2], 2*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>));</div>
<div class="line"><span class="lineno">  805</span>                    }</div>
<div class="line"><span class="lineno">  806</span>                }</div>
<div class="line"><span class="lineno">  807</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; ioff) { <span class="comment">// Slide subsequent PT_LOAD.</span></div>
<div class="line"><span class="lineno">  808</span>                    <span class="keywordflow">if</span> ((1u&lt;&lt;12) &lt; align</div>
<div class="line"><span class="lineno">  809</span>                    &amp;&amp;  Elf64_Ehdr::EM_X86_64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>  <span class="comment">// FIXME: other $ARCH ?</span></div>
<div class="line"><span class="lineno">  810</span>                    ) {</div>
<div class="line"><span class="lineno">  811</span>                        align = 1u&lt;&lt;12;</div>
<div class="line"><span class="lineno">  812</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>, align);</div>
<div class="line"><span class="lineno">  813</span>                    }</div>
<div class="line"><span class="lineno">  814</span>                    off = <a class="code hl_function" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a>(fo, (-1 + align) &amp; (ioff - off));</div>
<div class="line"><span class="lineno">  815</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>) {</div>
<div class="line"><span class="lineno">  816</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> = off - ((<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0) + ioff);</div>
<div class="line"><span class="lineno">  817</span>                        <span class="comment">//asl_slide_Shdrs();</span></div>
<div class="line"><span class="lineno">  818</span>                    }</div>
<div class="line"><span class="lineno">  819</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>, off);</div>
<div class="line"><span class="lineno">  820</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  821</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[ioff], len);</div>
<div class="line"><span class="lineno">  822</span>                    off += len;</div>
<div class="line"><span class="lineno">  823</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = off;</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>                    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> - ioff) &lt; len) {</div>
<div class="line"><span class="lineno">  826</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  827</span>                        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> word = cpr_entry;</div>
<div class="line"><span class="lineno">  828</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;word, cpr_entry);</div>
<div class="line"><span class="lineno">  829</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;word, <span class="keyword">sizeof</span>(word));</div>
<div class="line"><span class="lineno">  830</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno">  831</span>                    }</div>
<div class="line"><span class="lineno">  832</span>                }</div>
<div class="line"><span class="lineno">  833</span>                <span class="keywordflow">continue</span>;  <span class="comment">// all done with this PT_LOAD</span></div>
<div class="line"><span class="lineno">  834</span>            }</div>
<div class="line"><span class="lineno">  835</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; ioff) {</div>
<div class="line"><span class="lineno">  836</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0) + ioff);</div>
<div class="line"><span class="lineno">  837</span>            }</div>
<div class="line"><span class="lineno">  838</span>        }  <span class="comment">// end each Phdr</span></div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> || <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) { <span class="comment">// must update Shdr.sh_offset for so_slide</span></div>
<div class="line"><span class="lineno">  841</span>            <span class="comment">// Update {DYNAMIC}.sh_offset by so_slide.</span></div>
<div class="line"><span class="lineno">  842</span>            <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *shdr = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(  <span class="comment">// FIXME: use shdri ?</span></div>
<div class="line"><span class="lineno">  843</span>                    <span class="stringliteral">&quot;bad e_shoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0), <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno">  844</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++shdr, ++j) {</div>
<div class="line"><span class="lineno">  845</span>                <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno">  846</span>                <span class="keywordtype">unsigned</span> sh_flags = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags);  <span class="comment">// all SHF_ are 32-bit anyway</span></div>
<div class="line"><span class="lineno">  847</span>                <span class="keywordtype">unsigned</span> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset); <span class="comment">// already asl_delta</span></div>
<div class="line"><span class="lineno">  848</span>                <span class="keywordflow">if</span> (Elf64_Shdr::SHF_ALLOC &amp; sh_flags</div>
<div class="line"><span class="lineno">  849</span>                &amp;&amp;  Elf64_Shdr::SHF_WRITE &amp; sh_flags</div>
<div class="line"><span class="lineno">  850</span>                &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_offset) {</div>
<div class="line"><span class="lineno">  851</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno">  852</span>                }</div>
<div class="line"><span class="lineno">  853</span>                <span class="keywordflow">if</span> (Elf64_Shdr::SHT_RELA == sh_type</div>
<div class="line"><span class="lineno">  854</span>                &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>  <span class="comment">// FIXME: does this apply to SHT_RELA ?</span></div>
<div class="line"><span class="lineno">  855</span>                &amp;&amp;  !<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rel.plt&quot;</span>, <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_name) + <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>)) {</div>
<div class="line"><span class="lineno">  856</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> va = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_PLTGOT) - (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0);</div>
<div class="line"><span class="lineno">  857</span>                    <span class="comment">// Now use the old Phdrs (phdri)</span></div>
<div class="line"><span class="lineno">  858</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phva;</div>
<div class="line"><span class="lineno">  859</span>                    phva = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(va, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  860</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> old_off = (va - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>))</div>
<div class="line"><span class="lineno">  861</span>                        + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>                    <span class="comment">// Now use the new Phdrs (phdr0)</span></div>
<div class="line"><span class="lineno">  864</span>                    va += (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0);</div>
<div class="line"><span class="lineno">  865</span>                    phva = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(va, phdr0, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  866</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> new_off = (va - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>))</div>
<div class="line"><span class="lineno">  867</span>                        + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>                    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>) {</div>
<div class="line"><span class="lineno">  870</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(new_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  871</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[old_off], <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a> * 8);</div>
<div class="line"><span class="lineno">  872</span>                    }</div>
<div class="line"><span class="lineno">  873</span>                }</div>
<div class="line"><span class="lineno">  874</span>                <span class="keywordflow">if</span> (j &amp;&amp; shdr-&gt;sh_addr == 0</div>
<div class="line"><span class="lineno">  875</span>                &amp;&amp;  <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;shdr-&gt;sh_offset) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// UPX_RSIZE_MAX_MEM protects us</span></div>
<div class="line"><span class="lineno">  876</span>                    <span class="comment">// Try to be nice by sliding; but still fails if compressed.</span></div>
<div class="line"><span class="lineno">  877</span>                    <span class="comment">// So don&#39;t do it unless appending plain text of shstrtab.</span></div>
<div class="line"><span class="lineno">  878</span>                    <span class="keywordtype">unsigned</span> sh_off = <a class="code hl_function" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">get_te64_32</a>(&amp;shdr-&gt;sh_offset);  <span class="comment">// UPX_RSIZE_MAX_MEM protects us</span></div>
<div class="line"><span class="lineno">  879</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_off) {</div>
<div class="line"><span class="lineno">  880</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, sh_off + <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>);</div>
<div class="line"><span class="lineno">  881</span>                    }</div>
<div class="line"><span class="lineno">  882</span>                }</div>
<div class="line"><span class="lineno">  883</span>            }</div>
<div class="line"><span class="lineno">  884</span>            <span class="comment">// Maybe: append plain text of shstrtab strings?</span></div>
<div class="line"><span class="lineno">  885</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  886</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>) {</div>
<div class="line"><span class="lineno">  887</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;((<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>())-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno">  888</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno">  889</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*shdr));</div>
<div class="line"><span class="lineno">  890</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*shdr);</div>
<div class="line"><span class="lineno">  891</span>                }</div>
<div class="line"><span class="lineno">  892</span>            }</div>
<div class="line"><span class="lineno">  893</span>        }</div>
<div class="line"><span class="lineno">  894</span>        <span class="keywordflow">else</span> { <span class="comment">// output has no Shdr</span></div>
<div class="line"><span class="lineno">  895</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">e_shnum</a> = 0;</div>
<div class="line"><span class="lineno">  896</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a> = 0;</div>
<div class="line"><span class="lineno">  897</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a> = 0;</div>
<div class="line"><span class="lineno">  898</span>        }</div>
<div class="line"><span class="lineno">  899</span>    }</div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno">  901</span>}</div>
<div class="ttc" id="abele_8h_html_ab07367b17d1a80bb3cd4eeb48b4fdde5"><div class="ttname"><a href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr void set_le32(XE32 *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00346">bele.h:346</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a05fb6e81deb6d535c8192cfbb1eb5732"><div class="ttname"><a href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">OutputFile::st_size</a></div><div class="ttdeci">virtual upx_off_t st_size() const override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00303">file.cpp:303</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ac405aa11c3c356e93dc38f2365701466"><div class="ttname"><a href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">PackLinuxElf64::getbrk</a></div><div class="ttdeci">virtual off_t getbrk(const Elf64_Phdr *phdr, int e_phnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03653">p_lx_elf.cpp:3653</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3409fd940ae9b30dc51e68f69e0160f6"><div class="ttname"><a href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf::pack3</a></div><div class="ttdeci">virtual off_t pack3(OutputFile *, Filter &amp;) override=0</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00382">p_lx_elf.cpp:382</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a99ee39bcba2a438ad1728c8332356ce2"><div class="ttname"><a href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a></div><div class="ttdeci">unsigned sz_pack2</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00099">p_lx_elf.h:99</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a8a994baf32174356ff73af67ad5d15ba"><div class="ttname"><a href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a></div><div class="ttdeci">struct l_info linfo</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00132">p_unix.h:132</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a914345298d86f797a6c960ca80afdeb7"><div class="ttname"><a href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a></div><div class="ttdeci">int lsize</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00099">p_unix.h:99</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a13631338bc966bdceaf740dfd8082dd5"><div class="ttname"><a href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a></div><div class="ttdeci">static off_t fpadN(OutputFile *fo, unsigned len)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00088">p_lx_elf.cpp:88</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html"><div class="ttname"><a href="structElf32__Ehdr.html">Elf32_Ehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00187">bsd.h:188</a></div></div>
<div class="ttc" id="astructb__info_html_a29bbf0f18e0c39a8f826067d7ed80602"><div class="ttname"><a href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a></div><div class="ttdeci">uint32_t sz_cpr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00324">bsd.h:324</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a8012d8687b040cb0d6a7ad890856cf49"><div class="ttname"><a href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove</a></div><div class="ttdeci">void * memmove(C&lt; T &gt; a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00117">xspan_fwd.h:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e">Packer::get_te64_32()</a>, <a class="el" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf::pack3()</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32()</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, <a class="el" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">OutputFile::st_size()</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph" id="aclassPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph">
<area shape="rect" title=" " alt="" coords="5,1017,172,1042"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="505,16,650,56"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="775,182,904,208"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="233,168,378,208"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="775,410,904,436"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="230,74,381,114"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="229,403,381,443"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="548,638,607,664"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="768,588,911,613"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="774,790,905,816"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5" title=" " alt="" coords="547,537,608,562"/>
<area shape="rect" href="classPacker.html#aba0bcb1d796daaeea9d308d8e407505e" title=" " alt="" coords="229,1637,381,1662"/>
<area shape="rect" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466" title=" " alt="" coords="220,334,391,360"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="221,1686,390,1712"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="538,1218,617,1244"/>
<area shape="rect" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49" title=" " alt="" coords="793,1234,886,1260"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="995,1824,1071,1849"/>
<area shape="rect" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6" title=" " alt="" coords="230,890,381,916"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="513,992,641,1017"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="513,1093,641,1118"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="224,1485,387,1510"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="234,1042,377,1068"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="513,2112,641,2137"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="267,1736,344,1761"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="241,1785,369,1810"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="272,1858,339,1884"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="234,1908,377,1933"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="486,334,669,360"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="540,182,615,208"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="518,436,637,461"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="772,537,907,562"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="513,841,642,866"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="764,1005,915,1030"/>
<area shape="rect" href="classPackUnix.html#a573f3c8c4c540f51c2a7b168535d4741" title=" " alt="" coords="513,890,642,916"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="554,740,601,765"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="773,1824,906,1849"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="458,1688,697,1713"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="510,1434,645,1460"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="768,1384,911,1409"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="963,1536,1103,1561"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="788,1534,891,1560"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="781,1485,897,1510"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="475,1761,680,1786"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="494,1810,661,1836"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="516,1860,639,1885"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="519,2010,636,2036"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="439,1909,716,1934"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="483,1319,671,1359"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="781,2112,897,2137"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="965,2137,1101,2162"/>
</map>
</div>

</div>
</div>
<a id="afc239684c1874f0a29ee97eca4e8d4d6" name="afc239684c1874f0a29ee97eca4e8d4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc239684c1874f0a29ee97eca4e8d4d6">&#9670;&#160;</a></span>pack4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::pack4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06543">6543</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6544</span>{</div>
<div class="line"><span class="lineno"> 6545</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 6546</span>        <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 6547</span>    }</div>
<div class="line"><span class="lineno"> 6548</span> </div>
<div class="line"><span class="lineno"> 6549</span>    cprElfHdr4 *eho = !<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 6550</span>            ? &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 6551</span>            : (cprElfHdr4 *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();  <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 6552</span>    <span class="keywordtype">unsigned</span> penalty = <a class="code hl_function" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs</a>(fo, &amp;eho-&gt;ehdr); (void)penalty;</div>
<div class="line"><span class="lineno"> 6553</span> </div>
<div class="line"><span class="lineno"> 6554</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.preserve_build_id) { <span class="comment">// FIXME: co-ordinate with forward_Shdrs</span></div>
<div class="line"><span class="lineno"> 6555</span>        <span class="comment">// calc e_shoff here and write shdrout, then o_shstrtab</span></div>
<div class="line"><span class="lineno"> 6556</span>        <span class="comment">//NOTE: these are pushed last to ensure nothing is stepped on</span></div>
<div class="line"><span class="lineno"> 6557</span>        <span class="comment">//for the UPX structure.</span></div>
<div class="line"><span class="lineno"> 6558</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6559</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;ehdr.e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6560</span> </div>
<div class="line"><span class="lineno"> 6561</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>);</div>
<div class="line"><span class="lineno"> 6562</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize1 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1].sh_size);</div>
<div class="line"><span class="lineno"> 6563</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize2 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_size);</div>
<div class="line"><span class="lineno"> 6564</span> </div>
<div class="line"><span class="lineno"> 6565</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_offset,          ssize + <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6566</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1].sh_offset, ssize2 + ssize + <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6567</span> </div>
<div class="line"><span class="lineno"> 6568</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>, ssize); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize;</div>
<div class="line"><span class="lineno"> 6569</span> </div>
<div class="line"><span class="lineno"> 6570</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">o_shstrtab</a>, ssize2); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize2;</div>
<div class="line"><span class="lineno"> 6571</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>, ssize1); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize1;</div>
<div class="line"><span class="lineno"> 6572</span>    }</div>
<div class="line"><span class="lineno"> 6573</span> </div>
<div class="line"><span class="lineno"> 6574</span>    <span class="comment">// ph.u_len and ph.c_len are leftover from earliest days when there was</span></div>
<div class="line"><span class="lineno"> 6575</span>    <span class="comment">// only one compressed extent.  Use a good analogy for multiple extents.</span></div>
<div class="line"><span class="lineno"> 6576</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;</div>
<div class="line"><span class="lineno"> 6577</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 6578</span>    <a class="code hl_function" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">super::pack4</a>(fo, ft);  <span class="comment">// write PackHeader and overlay_offset</span></div>
<div class="line"><span class="lineno"> 6579</span> </div>
<div class="line"><span class="lineno"> 6580</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6581</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {  <span class="comment">// shared library</span></div>
<div class="line"><span class="lineno"> 6582</span>        { <span class="comment">// Shouldn&#39;t this special case be handled earlier?</span></div>
<div class="line"><span class="lineno"> 6583</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 6584</span>                <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdro = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(&amp;eho-&gt;phdr);</div>
<div class="line"><span class="lineno"> 6585</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdro-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>, Elf64_Phdr::PF_X | <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdro-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>));</div>
<div class="line"><span class="lineno"> 6586</span>            }</div>
<div class="line"><span class="lineno"> 6587</span>        }</div>
<div class="line"><span class="lineno"> 6588</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> &amp;&amp; !<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a>) {</div>
<div class="line"><span class="lineno"> 6589</span>            <span class="comment">// Make it abundantly clear that there are no Elf64_Shdr in this shlib</span></div>
<div class="line"><span class="lineno"> 6590</span>            eho-&gt;ehdr.e_shoff = 0;</div>
<div class="line"><span class="lineno"> 6591</span>            <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;ehdr.e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));  <span class="comment">// Android bug: cannot use 0</span></div>
<div class="line"><span class="lineno"> 6592</span>            eho-&gt;ehdr.e_shnum = 0;</div>
<div class="line"><span class="lineno"> 6593</span>            eho-&gt;ehdr.e_shstrndx = 0;</div>
<div class="line"><span class="lineno"> 6594</span>        }</div>
<div class="line"><span class="lineno"> 6595</span> </div>
<div class="line"><span class="lineno"> 6596</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 6597</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6598</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));  <span class="comment">// new info: l_checksum, l_size</span></div>
<div class="line"><span class="lineno"> 6599</span> </div>
<div class="line"><span class="lineno"> 6600</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a>) { <span class="comment">// FIXME Does this apply to 64-bit, too?</span></div>
<div class="line"><span class="lineno"> 6601</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> tmp = <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 6602</span>            tmp |= (Elf64_Ehdr::EM_ARM==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);  <span class="comment">// THUMB mode; no-op for 64-bit</span></div>
<div class="line"><span class="lineno"> 6603</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;tmp, tmp);</div>
<div class="line"><span class="lineno"> 6604</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_function" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>-&gt;st_value, <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6605</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;tmp, <span class="keyword">sizeof</span>(tmp));</div>
<div class="line"><span class="lineno"> 6606</span>        }</div>
<div class="line"><span class="lineno"> 6607</span>    }</div>
<div class="line"><span class="lineno"> 6608</span>    <span class="keywordflow">else</span> { <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 6609</span>        <span class="comment">// Cannot pre-round .p_memsz.  If .p_filesz &lt; .p_memsz, then kernel</span></div>
<div class="line"><span class="lineno"> 6610</span>        <span class="comment">// tries to make .bss, which requires PF_W.</span></div>
<div class="line"><span class="lineno"> 6611</span>        <span class="comment">// But strict SELinux (or PaX, grSecurity) disallows PF_W with PF_X.</span></div>
<div class="line"><span class="lineno"> 6612</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno"> 6613</span>                  eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz = eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz;</div>
<div class="line"><span class="lineno"> 6614</span> </div>
<div class="line"><span class="lineno"> 6615</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6616</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;eho-&gt;ehdr, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + 2* <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 6617</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6618</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 6619</span>    }</div>
<div class="line"><span class="lineno"> 6620</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_acc61917c51c71bfcb0f9af20ba7714d6"><div class="ttname"><a href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">PackLinuxElf64::forward_Shdrs</a></div><div class="ttdeci">virtual unsigned forward_Shdrs(OutputFile *fo, Elf64_Ehdr *ehdro)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06244">p_lx_elf.cpp:6244</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a539c946c8c36fa509670ec9948ccb1fc"><div class="ttname"><a href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a></div><div class="ttdeci">upx_uint64_t jni_onload_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00111">p_lx_elf.h:111</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a793632661a0af5efd197304078be1ed0"><div class="ttname"><a href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">PackLinuxElf::o_shstrtab</a></div><div class="ttdeci">static const unsigned char o_shstrtab[]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00136">p_lx_elf.h:136</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a888f94bd6a90f535ea5567e3f8b39ccc"><div class="ttname"><a href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a></div><div class="ttdeci">unsigned linfo_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00116">p_lx_elf.h:116</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a7d92de9aedc1747be87ef5968952838c"><div class="ttname"><a href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix::pack4</a></div><div class="ttdeci">virtual void pack4(OutputFile *, Filter &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00274">p_unix.cpp:274</a></div></div>
<div class="ttc" id="autil_8cpp_html_a49db04c61486d695f7f04b44ac2201c0"><div class="ttname"><a href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a></div><div class="ttdeci">unsigned ptr_udiff_bytes(const void *a, const void *b) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00126">util.cpp:126</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>, <a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">PackLinuxElf::o_shstrtab</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix::pack4()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph" id="aclassPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph">
<area shape="rect" title=" " alt="" coords="5,684,172,709"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="220,875,399,915"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="979,1116,1109,1141"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="722,463,853,488"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="723,1223,852,1248"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="462,1272,631,1297"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="475,481,618,507"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="483,683,611,708"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="483,1321,611,1347"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="483,432,611,457"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="483,1371,611,1396"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="517,633,576,659"/>
<area shape="rect" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c" title=" " alt="" coords="245,407,374,432"/>
<area shape="rect" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0" title=" " alt="" coords="1213,16,1332,41"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="471,1107,622,1147"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="517,732,576,757"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="471,883,622,908"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="523,984,570,1009"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="455,1223,638,1248"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="749,393,825,419"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="730,832,845,857"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="488,781,605,807"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="513,1057,580,1083"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="715,1079,860,1119"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="716,881,859,907"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1396,833,1533,859"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="977,429,1111,455"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1228,392,1317,417"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="979,783,1109,808"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1228,607,1317,632"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="999,380,1089,405"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1209,441,1336,467"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="1208,319,1337,344"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1385,351,1544,391"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1618,268,1737,293"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="729,683,845,708"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="1015,681,1073,707"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="976,632,1112,657"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1395,205,1535,231"/>
<area shape="rect" href="classPackUnix.html#aced1a9bb3fee3c231bfc90051224a6dd" title=" " alt="" coords="447,280,647,305"/>
<area shape="rect" href="classPacker.html#af51db683baf7d75a65f48429b77db475" title="patch util for loader" alt="" coords="971,167,1117,192"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="928,268,1160,293"/>
<area shape="rect" href="classPacker.html#ad1f9499f529513c9d26fc647968dfe7e" title=" " alt="" coords="695,229,880,255"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="749,128,826,153"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1249,167,1297,192"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="1209,117,1337,143"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1395,268,1534,293"/>
<area shape="rect" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225" title="ptr util" alt="" coords="1409,29,1520,55"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="1592,55,1763,80"/>
<area shape="rect" href="util_8h.html#a38df66b3eff123e66d6b92ceb76eb4c3" title=" " alt="" coords="1629,5,1726,31"/>
</map>
</div>

</div>
</div>
<a id="a426e7f90fc3af416c18a3deb0571e4b1" name="a426e7f90fc3af416c18a3deb0571e4b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426e7f90fc3af416c18a3deb0571e4b1">&#9670;&#160;</a></span>packed_struct() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr1&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00423">423</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  423</span>                              {</div>
<div class="line"><span class="lineno">  424</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  425</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[1];</div>
<div class="line"><span class="lineno">  426</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  427</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a95e05ec4a8acf7cac11023b7a57aad85" name="a95e05ec4a8acf7cac11023b7a57aad85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e05ec4a8acf7cac11023b7a57aad85">&#9670;&#160;</a></span>packed_struct() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr2&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00429">429</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  429</span>                              {</div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  431</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[2];</div>
<div class="line"><span class="lineno">  432</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  433</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a5c753db61a98f514bc1b083069692374" name="a5c753db61a98f514bc1b083069692374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c753db61a98f514bc1b083069692374">&#9670;&#160;</a></span>packed_struct() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr3&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00435">435</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  435</span>                              {</div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  437</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[3];</div>
<div class="line"><span class="lineno">  438</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  439</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a36103546d5ed97790537a6f7c6f0e02b" name="a36103546d5ed97790537a6f7c6f0e02b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36103546d5ed97790537a6f7c6f0e02b">&#9670;&#160;</a></span>packed_struct() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr4&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00441">441</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  441</span>                              {</div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  443</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[4];</div>
<div class="line"><span class="lineno">  444</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  445</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="aec3f937f49c167ed74510c02a5afe10a" name="aec3f937f49c167ed74510c02a5afe10a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3f937f49c167ed74510c02a5afe10a">&#9670;&#160;</a></span>packed_struct() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfShdr3&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00449">449</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  449</span>                               {</div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> shdr[3];</div>
<div class="line"><span class="lineno">  451</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c2bb372c567334edd586f78224bc956" name="a8c2bb372c567334edd586f78224bc956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c2bb372c567334edd586f78224bc956">&#9670;&#160;</a></span>PackLinuxElf64help1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::PackLinuxElf64help1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInputFile.html">InputFile</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01022">1022</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1023</span>{</div>
<div class="line"><span class="lineno"> 1024</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>  = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>);</div>
<div class="line"><span class="lineno"> 1025</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 1026</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> e_phentsize = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">e_phentsize</a>);</div>
<div class="line"><span class="lineno"> 1028</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>((<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <span class="stringliteral">&quot;\x7f\x45\x4c\x46&quot;</span>, 4)  <span class="comment">// &quot;\177ELF&quot;</span></div>
<div class="line"><span class="lineno"> 1029</span>    || <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_CLASS]!=Elf64_Ehdr::ELFCLASS64</div>
<div class="line"><span class="lineno"> 1030</span>    || <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) != e_phentsize</div>
<div class="line"><span class="lineno"> 1031</span>    || (Elf64_Ehdr::ELFDATA2MSB == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno"> 1032</span>            &amp;&amp; &amp;<a class="code hl_variable" href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a> != <a class="code hl_variable" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a>)</div>
<div class="line"><span class="lineno"> 1033</span>    || (Elf64_Ehdr::ELFDATA2LSB == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno"> 1034</span>            &amp;&amp; &amp;<a class="code hl_variable" href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a> != <a class="code hl_variable" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a>)) {</div>
<div class="line"><span class="lineno"> 1035</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> = 0;</div>
<div class="line"><span class="lineno"> 1036</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = 0;</div>
<div class="line"><span class="lineno"> 1037</span>        <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = 0;</div>
<div class="line"><span class="lineno"> 1038</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1039</span>    }</div>
<div class="line"><span class="lineno"> 1040</span>    <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;0==e_phnum&quot;</span>);</div>
<div class="line"><span class="lineno"> 1041</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adc7d13d5c0e0eb4b62f0f898f03b2e66">e_phoff</a>);</div>
<div class="line"><span class="lineno"> 1042</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> last_Phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>);</div>
<div class="line"><span class="lineno"> 1043</span>    <span class="keywordflow">if</span> (last_Phdr &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>  <span class="comment">// wrap-around</span></div>
<div class="line"><span class="lineno"> 1044</span>    ||  <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>)  <span class="comment">// must be contiguous</span></div>
<div class="line"><span class="lineno"> 1045</span>    ||  (<span class="keywordtype">unsigned</span> long)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; last_Phdr) {</div>
<div class="line"><span class="lineno"> 1046</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_phoff %p&quot;</span>, (<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>);</div>
<div class="line"><span class="lineno"> 1047</span>    }</div>
<div class="line"><span class="lineno"> 1048</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 1049</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> last_Shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>);</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">if</span> (last_Shdr &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>  <span class="comment">// wrap-around</span></div>
<div class="line"><span class="lineno"> 1051</span>    ||  (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &lt; last_Phdr)</div>
<div class="line"><span class="lineno"> 1052</span>    ||  (<span class="keywordtype">unsigned</span> long)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; last_Shdr) {</div>
<div class="line"><span class="lineno"> 1053</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd == <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>) {</div>
<div class="line"><span class="lineno"> 1054</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_shoff %p&quot;</span>, (<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 1055</span>        }</div>
<div class="line"><span class="lineno"> 1056</span>    }</div>
<div class="line"><span class="lineno"> 1057</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * e_phentsize;</div>
<div class="line"><span class="lineno"> 1058</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) +</div>
<div class="line"><span class="lineno"> 1059</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>);  <span class="comment">// phdrx bodies later: ::generateElfHdr</span></div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>    <span class="keywordflow">if</span> (f &amp;&amp; Elf64_Ehdr::ET_DYN!=<a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno"> 1062</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;  <span class="comment">// (sz_phdrs + e_phoff) except --preserve-build-id</span></div>
<div class="line"><span class="lineno"> 1063</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, len);</div>
<div class="line"><span class="lineno"> 1064</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1065</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, len);</div>
<div class="line"><span class="lineno"> 1066</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>= (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>       *)(<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 1067</span>    }</div>
<div class="line"><span class="lineno"> 1068</span>    <span class="keywordflow">if</span> (f &amp;&amp; Elf64_Ehdr::ET_DYN==<a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno"> 1069</span>        <span class="comment">// The DT_SYMTAB has no designated length.  Read the whole file.</span></div>
<div class="line"><span class="lineno"> 1070</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 1071</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1072</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 1073</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>= (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= (unsigned)<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>) ? nullptr : (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 1074</span>        <span class="keywordflow">if</span> (!(<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd == <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &lt; (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() == 0)) {</div>
<div class="line"><span class="lineno"> 1075</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1076</span>        }</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">e_shentsize</a>) {</div>
<div class="line"><span class="lineno"> 1078</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1079</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 1080</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 1081</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 1082</span>        }</div>
<div class="line"><span class="lineno"> 1083</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1084</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1085</span>        }</div>
<div class="line"><span class="lineno"> 1086</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 1087</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 1088</span>            <span class="keywordtype">unsigned</span> t = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_link);</div>
<div class="line"><span class="lineno"> 1089</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= t)</div>
<div class="line"><span class="lineno"> 1090</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad dynsym-&gt;sh_link&quot;</span>);</div>
<div class="line"><span class="lineno"> 1091</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[t];</div>
<div class="line"><span class="lineno"> 1092</span>        }</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr= <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 1095</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ++phdr)</div>
<div class="line"><span class="lineno"> 1096</span>        <span class="keywordflow">if</span> (Elf64_Phdr::PT_DYNAMIC==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 1097</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic</a>(phdr);</div>
<div class="line"><span class="lineno"> 1098</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>= (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 1099</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>,</div>
<div class="line"><span class="lineno"> 1100</span>                <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>), <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> - offset));</div>
<div class="line"><span class="lineno"> 1101</span>        }</div>
<div class="line"><span class="lineno"> 1102</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 1103</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load</a>(phdr);</div>
<div class="line"><span class="lineno"> 1104</span>        }</div>
<div class="line"><span class="lineno"> 1105</span>        <span class="comment">// elf_find_dynamic() returns 0 if 0==dynseg.</span></div>
<div class="line"><span class="lineno"> 1106</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> =          (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 1107</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> <span class="comment">/*const*/</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_SYMTAB);</div>
<div class="line"><span class="lineno"> 1108</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> =     (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 1109</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a> =     (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 1110</span>        <span class="keywordflow">if</span> (3&amp; ((<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> | (<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> | (<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>)) {</div>
<div class="line"><span class="lineno"> 1111</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;unaligned DT_SYMTAB, DT_GNU_HASH, or DT_HASH/n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1112</span>        }</div>
<div class="line"><span class="lineno"> 1113</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup</a>(<span class="stringliteral">&quot;JNI_OnLoad&quot;</span>);</div>
<div class="line"><span class="lineno"> 1114</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>) {</div>
<div class="line"><span class="lineno"> 1115</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>-&gt;st_value);</div>
<div class="line"><span class="lineno"> 1116</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a> = 0;  <span class="comment">// FIXME not understood; need example</span></div>
<div class="line"><span class="lineno"> 1117</span>        }</div>
<div class="line"><span class="lineno"> 1118</span>    }</div>
<div class="line"><span class="lineno"> 1119</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a02d0e91095e3b2cdfbc913e7bc25abf8"><div class="ttname"><a href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">PackLinuxElf64::elf_lookup</a></div><div class="ttdeci">virtual Elf64_Sym const * elf_lookup(char const *) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08722">p_lx_elf.cpp:8722</a></div></div>
<div class="ttc" id="aclassPacker_html_a18d294254872108f1373a26ccabbd821"><div class="ttname"><a href="classPacker.html#a18d294254872108f1373a26ccabbd821">Packer::bele</a></div><div class="ttdeci">const N_BELE_RTP::AbstractPolicy * bele</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00322">packer.h:322</a></div></div>
<div class="ttc" id="aconf_8h_html_a0290c1b714a32ca216f00e6446342dd8"><div class="ttname"><a href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a></div><div class="ttdeci">acc_uintptr_t upx_uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00172">conf.h:172</a></div></div>
<div class="ttc" id="anamespaceN__BELE__RTP_html_a800eaf3ed4e72268ac7ac7a800df07cd"><div class="ttname"><a href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a></div><div class="ttdeci">const LEPolicy le_policy</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00782">util.cpp:782</a></div></div>
<div class="ttc" id="anamespaceN__BELE__RTP_html_af72fe6f323f96796c843a2e019005de6"><div class="ttname"><a href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a></div><div class="ttdeci">const BEPolicy be_policy</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00781">util.cpp:781</a></div></div>
<div class="ttc" id="aoptions_8h_html_a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86"><div class="ttname"><a href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a></div><div class="ttdeci">@ CMD_COMPRESS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00046">options.h:46</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html"><div class="ttname"><a href="structElf32__Phdr.html">Elf32_Phdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00223">bsd.h:224</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a078af1eaf7681f9d85ff545b6c7aa9c5"><div class="ttname"><a href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">Elf64_Ehdr::e_shentsize</a></div><div class="ttdeci">Elf64_Half e_shentsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00218">bsd.h:218</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_adc7d13d5c0e0eb4b62f0f898f03b2e66"><div class="ttname"><a href="structElf64__Ehdr.html#adc7d13d5c0e0eb4b62f0f898f03b2e66">Elf64_Ehdr::e_phoff</a></div><div class="ttdeci">Elf64_Off e_phoff</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00212">bsd.h:212</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image()</a>, <a class="el" href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a>, <a class="el" href="classPacker.html#a18d294254872108f1373a26ccabbd821">Packer::bele</a>, <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load()</a>, <a class="el" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="structElf64__Ehdr.html#adc7d13d5c0e0eb4b62f0f898f03b2e66">Elf64_Ehdr::e_phoff</a>, <a class="el" href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">Elf64_Ehdr::e_shentsize</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>, <a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a>, <a class="el" href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>, <a class="el" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732">PackLinuxElf64Be::PackLinuxElf64Be()</a>, and <a class="el" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268">PackLinuxElf64Le::PackLinuxElf64Le()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph" id="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph">
<area shape="rect" title=" " alt="" coords="5,1557,199,1597"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="691,1818,825,1843"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1180,311,1299,336"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="474,1868,602,1894"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="933,2015,1084,2040"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="924,1514,1093,1539"/>
<area shape="rect" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014" title=" " alt="" coords="925,396,1092,436"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1175,743,1304,768"/>
<area shape="rect" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6" title=" " alt="" coords="925,332,1092,372"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="465,788,611,828"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="917,1132,1100,1158"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1175,1184,1304,1210"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="685,1233,831,1273"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="465,312,611,352"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="473,1514,603,1539"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="247,1114,413,1154"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="288,2240,372,2266"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="269,2092,391,2118"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="271,2167,389,2192"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="261,184,399,210"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="964,2064,1053,2090"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="971,1768,1047,1794"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="967,1818,1051,1843"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="968,1916,1049,1942"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="901,1867,1116,1892"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="931,1695,1086,1720"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1164,1909,1315,1949"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="673,1867,843,1892"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="734,1916,782,1942"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="963,1966,1054,1991"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="936,814,1081,854"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="663,838,853,878"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="675,270,841,295"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="683,369,833,409"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="934,217,1083,257"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="671,319,845,344"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="725,220,791,246"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="465,1114,611,1154"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="683,953,833,993"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="461,1178,615,1218"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="685,1118,831,1158"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="682,1297,834,1337"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="691,1463,825,1488"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="696,1362,820,1387"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="481,2092,595,2118"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="463,2142,613,2167"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="693,2192,823,2218"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="713,2143,803,2168"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="689,2242,827,2267"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="480,2191,596,2216"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph" id="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph">
<area shape="rect" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,5,440,31"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,55,445,95"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,119,444,159"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="ae5e7655b7e6bff51e5d2d9f8e203a4e3" name="ae5e7655b7e6bff51e5d2d9f8e203a4e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e7655b7e6bff51e5d2d9f8e203a4e3">&#9670;&#160;</a></span>patchLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::patchLoader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackUnix.html#ac4b328c80b7172751702a447aed1afb2">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01199">1199</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1200</span>{</div>
<div class="line"><span class="lineno"> 1201</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acbc068ab20eb6f313fc0abbda76c62a4" name="acbc068ab20eb6f313fc0abbda76c62a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc068ab20eb6f313fc0abbda76c62a4">&#9670;&#160;</a></span>sort_DT64_offsets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::sort_DT64_offsets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *const&#160;</td>
          <td class="paramname"><em>dynp0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08341">8341</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8342</span>{</div>
<div class="line"><span class="lineno"> 8343</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>) * <span class="keyword">sizeof</span>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>)/<span class="keyword">sizeof</span>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>[0]));</div>
<div class="line"><span class="lineno"> 8344</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">clear</a>();</div>
<div class="line"><span class="lineno"> 8345</span>    <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a> = (<span class="keywordtype">unsigned</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 8346</span>    <span class="keywordtype">unsigned</span> n_off = 0, k;</div>
<div class="line"><span class="lineno"> 8347</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; ((k = <a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>[j]),  k); ++j) {</div>
<div class="line"><span class="lineno"> 8348</span>        <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off] = 0;  <span class="comment">// default to &quot;not found&quot;</span></div>
<div class="line"><span class="lineno"> 8349</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> rva = 0;</div>
<div class="line"><span class="lineno"> 8350</span>        <span class="keywordflow">if</span> (k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) { <span class="comment">// in range of easy table</span></div>
<div class="line"><span class="lineno"> 8351</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[k]) {</div>
<div class="line"><span class="lineno"> 8352</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 8353</span>            }</div>
<div class="line"><span class="lineno"> 8354</span>            rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[k]].d_val);</div>
<div class="line"><span class="lineno"> 8355</span>        }</div>
<div class="line"><span class="lineno"> 8356</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) { <span class="comment">// why is this guard necessary?</span></div>
<div class="line"><span class="lineno"> 8357</span>            rva = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(k);  <span class="comment">// zero if not found</span></div>
<div class="line"><span class="lineno"> 8358</span>        }</div>
<div class="line"><span class="lineno"> 8359</span>        <span class="keywordflow">if</span> (!rva) { <span class="comment">// not present in input</span></div>
<div class="line"><span class="lineno"> 8360</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 8361</span>        }</div>
<div class="line"><span class="lineno"> 8362</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> phdr = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(rva, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 8363</span>        <span class="keywordflow">if</span> (!phdr) {</div>
<div class="line"><span class="lineno"> 8364</span>            <span class="keywordtype">char</span> msg[60]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad DT_{%#x} = %#llx (no Phdr)&quot;</span>,</div>
<div class="line"><span class="lineno"> 8365</span>                k, rva);</div>
<div class="line"><span class="lineno"> 8366</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 8367</span>        }</div>
<div class="line"><span class="lineno"> 8368</span>        <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off] = (rva - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>)) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 8369</span> </div>
<div class="line"><span class="lineno"> 8370</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off]) {</div>
<div class="line"><span class="lineno"> 8371</span>            <span class="keywordtype">char</span> msg[60]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad DT_{%#x} = %#x (beyond EOF)&quot;</span>,</div>
<div class="line"><span class="lineno"> 8372</span>                k, <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off]);</div>
<div class="line"><span class="lineno"> 8373</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 8374</span>        }</div>
<div class="line"><span class="lineno"> 8375</span>        n_off += !!<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off];</div>
<div class="line"><span class="lineno"> 8376</span>    }</div>
<div class="line"><span class="lineno"> 8377</span>    <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off++] = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;  <span class="comment">// sentinel</span></div>
<div class="line"><span class="lineno"> 8378</span>    <a class="code hl_define" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>(<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>, n_off, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[0]), <a class="code hl_function" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned</a>);</div>
<div class="line"><span class="lineno"> 8379</span>}</div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a153fe8a7e59d11eee850dcf7aac446dd"><div class="ttname"><a href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned</a></div><div class="ttdeci">static int __acc_cdecl_qsort qcmp_unsigned(void const *const aa, void const *const bb)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02166">p_lx_elf.cpp:2166</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4b2bd0c0bbfe083032e496ebbb7ad5f9"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a></div><div class="ttdeci">static unsigned const dt_keys[]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02149">p_lx_elf.cpp:2149</a></div></div>
<div class="ttc" id="autil_8h_html_afafc04a977e45706ac9f76ed6122ee54"><div class="ttname"><a href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a></div><div class="ttdeci">#define upx_qsort</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00205">util.h:205</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear()</a>, <a class="el" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>, <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph" id="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph">
<area shape="rect" title=" " alt="" coords="5,499,159,539"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="225,155,358,180"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="715,235,833,260"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="224,377,359,403"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="219,470,364,510"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="709,585,839,611"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="216,607,367,647"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="207,672,376,697"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="229,721,353,747"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="487,205,576,231"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="736,308,812,333"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="489,5,573,31"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="491,55,572,80"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="424,104,639,129"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="909,209,1064,235"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="699,47,849,87"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="911,15,1062,55"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="911,79,1062,119"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="472,357,591,383"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="687,357,861,383"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="945,333,1028,359"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="917,383,1057,408"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1112,326,1263,366"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1311,294,1461,334"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1311,358,1461,398"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="440,456,623,481"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="494,407,569,432"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="709,456,839,481"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="459,607,604,647"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph" id="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph">
<area shape="rect" title=" " alt="" coords="949,81,1103,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="ab19e5a4000bc5cc063dee2a31db657e9" name="ab19e5a4000bc5cc063dee2a31db657e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab19e5a4000bc5cc063dee2a31db657e9">&#9670;&#160;</a></span>un_asl_dynsym()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::un_asl_dynsym </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>orig_file_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06753">6753</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6757</span>{</div>
<div class="line"><span class="lineno"> 6758</span>    <span class="comment">// un-Relocate dynsym (DT_SYMTAB) which is below xct_off</span></div>
<div class="line"><span class="lineno"> 6759</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 6760</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 6761</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 6762</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> off_dynsym = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 6763</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> sz_dynsym  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 6764</span>        <span class="keywordflow">if</span> (orig_file_size &lt; sz_dynsym</div>
<div class="line"><span class="lineno"> 6765</span>        ||  orig_file_size &lt; off_dynsym</div>
<div class="line"><span class="lineno"> 6766</span>        || (orig_file_size - off_dynsym) &lt; sz_dynsym) {</div>
<div class="line"><span class="lineno"> 6767</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad SHT_DYNSYM&quot;</span>);</div>
<div class="line"><span class="lineno"> 6768</span>        }</div>
<div class="line"><span class="lineno"> 6769</span>        <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *<span class="keyword">const</span> sym0 = (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 6770</span>            <span class="stringliteral">&quot;bad dynsym&quot;</span>, off_dynsym, sz_dynsym);</div>
<div class="line"><span class="lineno"> 6771</span>        <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *sym = sym0;</div>
<div class="line"><span class="lineno"> 6772</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = sz_dynsym / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>); --j&gt;=0; ++sym) {</div>
<div class="line"><span class="lineno"> 6773</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> symval = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sym-&gt;st_value);</div>
<div class="line"><span class="lineno"> 6774</span>            <span class="keywordtype">unsigned</span> symsec = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;sym-&gt;st_shndx);</div>
<div class="line"><span class="lineno"> 6775</span>            <span class="keywordflow">if</span> (Elf64_Sym::SHN_UNDEF != symsec</div>
<div class="line"><span class="lineno"> 6776</span>            &amp;&amp;  Elf64_Sym::SHN_ABS   != symsec</div>
<div class="line"><span class="lineno"> 6777</span>            &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 6778</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sym-&gt;st_value, symval - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6779</span>            }</div>
<div class="line"><span class="lineno"> 6780</span>            <span class="keywordflow">if</span> (Elf64_Sym::SHN_ABS == symsec &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 6781</span>                <a class="code hl_function" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS</a>(sym, 0ul - (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6782</span>            }</div>
<div class="line"><span class="lineno"> 6783</span>        }</div>
<div class="line"><span class="lineno"> 6784</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6785</span>            <span class="keywordtype">unsigned</span> pos = fo-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6786</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off_dynsym, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6787</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(sym0, sz_dynsym);</div>
<div class="line"><span class="lineno"> 6788</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6789</span>        }</div>
<div class="line"><span class="lineno"> 6790</span>    }</div>
<div class="line"><span class="lineno"> 6791</span>}</div>
<div class="ttc" id="aclassFileBase_html_ac5cf6444d65c14d76b14ae420dd50eff"><div class="ttname"><a href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell</a></div><div class="ttdeci">upx_off_t tell() const</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00151">file.cpp:151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph" id="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph">
<area shape="rect" title=" " alt="" coords="5,775,149,815"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="633,728,808,753"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="197,860,343,900"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="656,897,785,922"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="413,775,559,815"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="205,1054,335,1080"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="199,425,341,450"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="422,624,550,649"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="206,1104,334,1129"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="199,1005,341,1030"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="667,94,774,120"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1065,674,1203,700"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="1059,724,1209,764"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="869,850,998,876"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="900,801,967,826"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1275,704,1394,729"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="413,890,559,930"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="391,1004,581,1044"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="629,946,812,972"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="421,278,551,304"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="653,253,788,278"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1691,121,1821,146"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1481,196,1618,221"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="889,370,978,396"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1089,624,1179,649"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="676,302,765,328"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1271,246,1398,272"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="869,196,998,221"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1456,246,1643,272"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1728,246,1784,272"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1071,196,1197,221"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1261,382,1408,408"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1522,382,1577,408"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1479,433,1619,458"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1055,483,1213,523"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="865,624,1001,649"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="663,497,779,522"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="905,297,962,322"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="397,1069,575,1094"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="651,1098,790,1124"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="860,1098,1007,1124"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1110,1098,1158,1124"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1289,1098,1380,1124"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="1486,1098,1613,1124"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph" id="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph">
<area shape="rect" title=" " alt="" coords="420,5,564,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a03c843122a8d3e44da9fe458643c2589" name="a03c843122a8d3e44da9fe458643c2589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c843122a8d3e44da9fe458643c2589">&#9670;&#160;</a></span>un_DT_INIT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::un_DT_INIT </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>old_dtinit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>dynhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07436">7436</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7442</span>{</div>
<div class="line"><span class="lineno"> 7443</span>    <span class="comment">// DT_INIT must be restored.</span></div>
<div class="line"><span class="lineno"> 7444</span>    <span class="comment">// If android_shlib, then the asl_delta relocations must be un-done.</span></div>
<div class="line"><span class="lineno"> 7445</span>    <span class="keywordtype">unsigned</span> n_plt = 0;</div>
<div class="line"><span class="lineno"> 7446</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_pltrelsz(0), dt_jmprel(0), dt_pltgot(0);</div>
<div class="line"><span class="lineno"> 7447</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_relasz(0), dt_rela(0);</div>
<div class="line"><span class="lineno"> 7448</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> dyn_len = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynhdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 7449</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> dyn_off = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynhdr-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 7450</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; (dyn_len + dyn_off)) {</div>
<div class="line"><span class="lineno"> 7451</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 7452</span>                <span class="stringliteral">&quot;bad PT_DYNAMIC .p_filesz %#lx&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)dyn_len);</div>
<div class="line"><span class="lineno"> 7453</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7454</span>    }</div>
<div class="line"><span class="lineno"> 7455</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(dyn_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7456</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, dyn_len);</div>
<div class="line"><span class="lineno"> 7457</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dyn = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>;</div>
<div class="line"><span class="lineno"> 7458</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a> = dyn; <a class="code hl_function" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>,</div>
<div class="line"><span class="lineno"> 7459</span>        <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(dyn_len, <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> - dyn_off));</div>
<div class="line"><span class="lineno"> 7460</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j2= 0; j2 &lt; dyn_len; ++dyn, j2 += <span class="keyword">sizeof</span>(*dyn)) {</div>
<div class="line"><span class="lineno"> 7461</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> tag = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 7462</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>       val = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_val);</div>
<div class="line"><span class="lineno"> 7463</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) <span class="keywordflow">switch</span> (tag) {</div>
<div class="line"><span class="lineno"> 7464</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_RELASZ:   { dt_relasz   = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7465</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_RELA:     { dt_rela     = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7466</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_JMPREL:   { dt_jmprel   = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7467</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_PLTRELSZ: { dt_pltrelsz = val;</div>
<div class="line"><span class="lineno"> 7468</span>            n_plt = dt_pltrelsz / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>);</div>
<div class="line"><span class="lineno"> 7469</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 7470</span>                n_plt += 3;  <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 7471</span>            }</div>
<div class="line"><span class="lineno"> 7472</span>        };  <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7473</span> </div>
<div class="line"><span class="lineno"> 7474</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_PLTGOT:   { <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = dt_pltgot = val; (void)dt_pltgot;}</div>
<div class="line"><span class="lineno"> 7475</span>        <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 7476</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_PREINIT_ARRAY:</div>
<div class="line"><span class="lineno"> 7477</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_INIT_ARRAY:</div>
<div class="line"><span class="lineno"> 7478</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_FINI_ARRAY:</div>
<div class="line"><span class="lineno"> 7479</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_FINI: <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 7480</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dyn-&gt;d_val, val - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 7481</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7482</span>        } <span class="comment">// end switch() on tag when is_asl</span></div>
<div class="line"><span class="lineno"> 7483</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> == tag) { <span class="comment">// the easy case</span></div>
<div class="line"><span class="lineno"> 7484</span>            <span class="keywordflow">if</span> (Elf64_Dyn::DT_INIT == tag) {</div>
<div class="line"><span class="lineno"> 7485</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dyn-&gt;d_val, old_dtinit);</div>
<div class="line"><span class="lineno"> 7486</span>                <span class="keywordflow">if</span> (!old_dtinit) { <span class="comment">// compressor took the slot</span></div>
<div class="line"><span class="lineno"> 7487</span>                    dyn-&gt;d_tag = Elf64_Dyn::DT_NULL;</div>
<div class="line"><span class="lineno"> 7488</span>                    dyn-&gt;d_val = 0;</div>
<div class="line"><span class="lineno"> 7489</span>                }</div>
<div class="line"><span class="lineno"> 7490</span>            }</div>
<div class="line"><span class="lineno"> 7491</span>            <span class="comment">// Apparently the hard case is common for some Android IDEs.</span></div>
<div class="line"><span class="lineno"> 7492</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Dyn::DT_INIT_ARRAY    == tag</div>
<div class="line"><span class="lineno"> 7493</span>            ||       Elf64_Dyn::DT_PREINIT_ARRAY == tag) {</div>
<div class="line"><span class="lineno"> 7494</span>                <span class="comment">// &#39;val&#39; is the RVA of the first slot, which is the slot that</span></div>
<div class="line"><span class="lineno"> 7495</span>                <span class="comment">// the compressor changed to be the entry to the run-time stub.</span></div>
<div class="line"><span class="lineno"> 7496</span>                <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rp = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_NULL);</div>
<div class="line"><span class="lineno"> 7497</span>                ((<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)<a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(Elf64_Dyn::DT_NULL))-&gt;d_val = 0;</div>
<div class="line"><span class="lineno"> 7498</span>                <span class="keywordflow">if</span> (rp) {</div>
<div class="line"><span class="lineno"> 7499</span>                    <span class="comment">// Compressor saved the original *rp in dynsym[0]</span></div>
<div class="line"><span class="lineno"> 7500</span>                    <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rp_unc = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0];  <span class="comment">// pointer</span></div>
<div class="line"><span class="lineno"> 7501</span>                    rp-&gt;r_info = rp_unc-&gt;r_info;  <span class="comment">// restore original r_info; r_offset not touched</span></div>
<div class="line"><span class="lineno"> 7502</span>                    rp-&gt;r_addend = rp_unc-&gt;r_addend;</div>
<div class="line"><span class="lineno"> 7503</span> </div>
<div class="line"><span class="lineno"> 7504</span>                    <span class="keywordtype">unsigned</span> e_entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>);</div>
<div class="line"><span class="lineno"> 7505</span>                    <span class="keywordtype">unsigned</span> init_rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[e_entry - 3*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)]);</div>
<div class="line"><span class="lineno"> 7506</span>                    <span class="keywordtype">unsigned</span> arr_rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp_unc-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 7507</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(arr_rva, phdro, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7508</span>                    <span class="keywordtype">unsigned</span> arr_off = (arr_rva - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>)) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7509</span> </div>
<div class="line"><span class="lineno"> 7510</span>                    <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(rp_unc, 0, <span class="keyword">sizeof</span>(*rp_unc));</div>
<div class="line"><span class="lineno"> 7511</span>                    <span class="keywordflow">if</span> (fo)  {</div>
<div class="line"><span class="lineno"> 7512</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_SYMTAB), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7513</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rp_unc, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>));  <span class="comment">// clear dynsym[0]</span></div>
<div class="line"><span class="lineno"> 7514</span> </div>
<div class="line"><span class="lineno"> 7515</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>((<span class="keywordtype">char</span> *)rp - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0], <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7516</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rp, <span class="keyword">sizeof</span>(*rp));  <span class="comment">// restore original *rp</span></div>
<div class="line"><span class="lineno"> 7517</span>                    }</div>
<div class="line"><span class="lineno"> 7518</span> </div>
<div class="line"><span class="lineno"> 7519</span>                    <span class="comment">// Set arr[0] to the first user init routine.</span></div>
<div class="line"><span class="lineno"> 7520</span>                    <span class="comment">// Elf64_Rela overwrites anyway, so this is a redundancy</span></div>
<div class="line"><span class="lineno"> 7521</span>                    <span class="comment">// or a Don&#39;t Care.</span></div>
<div class="line"><span class="lineno"> 7522</span>                    <span class="keywordtype">unsigned</span> r_info = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_info);</div>
<div class="line"><span class="lineno"> 7523</span>                    <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 7524</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> word;</div>
<div class="line"><span class="lineno"> 7525</span>                    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_ARM64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 7526</span>                        <span class="keywordflow">if</span> (R_AARCH64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 7527</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;word, init_rva);  <span class="comment">// old_dtinit ?</span></div>
<div class="line"><span class="lineno"> 7528</span>                        }</div>
<div class="line"><span class="lineno"> 7529</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_AARCH64_ABS64 == r_type) {</div>
<div class="line"><span class="lineno"> 7530</span>                            word = 0;</div>
<div class="line"><span class="lineno"> 7531</span>                        }</div>
<div class="line"><span class="lineno"> 7532</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7533</span>                            <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;unknown relocation: %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 7534</span>                                r_type);</div>
<div class="line"><span class="lineno"> 7535</span>                            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7536</span>                        }</div>
<div class="line"><span class="lineno"> 7537</span>                    }</div>
<div class="line"><span class="lineno"> 7538</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AMD64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 7539</span>                        <span class="keywordflow">if</span> (R_X86_64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 7540</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;word, init_rva);</div>
<div class="line"><span class="lineno"> 7541</span>                        }</div>
<div class="line"><span class="lineno"> 7542</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_X86_64_64 == r_type) {</div>
<div class="line"><span class="lineno"> 7543</span>                            word = 0;</div>
<div class="line"><span class="lineno"> 7544</span>                        }</div>
<div class="line"><span class="lineno"> 7545</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7546</span>                            <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;unknown relocation: %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 7547</span>                                r_type);</div>
<div class="line"><span class="lineno"> 7548</span>                            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7549</span>                        }</div>
<div class="line"><span class="lineno"> 7550</span>                    }</div>
<div class="line"><span class="lineno"> 7551</span>                    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7552</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(arr_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7553</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;word, <span class="keyword">sizeof</span>(word));</div>
<div class="line"><span class="lineno"> 7554</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 7555</span>                    }</div>
<div class="line"><span class="lineno"> 7556</span>                }</div>
<div class="line"><span class="lineno"> 7557</span>            }</div>
<div class="line"><span class="lineno"> 7558</span>        }</div>
<div class="line"><span class="lineno"> 7559</span>    }</div>
<div class="line"><span class="lineno"> 7560</span>    <span class="keywordflow">if</span> (fo) { <span class="comment">// Write updated dt_*.val</span></div>
<div class="line"><span class="lineno"> 7561</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dyn_offo = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdro[dynhdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>].p_offset);</div>
<div class="line"><span class="lineno"> 7562</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(dyn_offo, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7563</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, dyn_len);</div>
<div class="line"><span class="lineno"> 7564</span>    }</div>
<div class="line"><span class="lineno"> 7565</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 7566</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 7567</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7568</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// contains relocation tables</span></div>
<div class="line"><span class="lineno"> 7569</span>        <span class="keywordflow">if</span> (dt_relasz &amp;&amp; dt_rela) {</div>
<div class="line"><span class="lineno"> 7570</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *<span class="keyword">const</span> rela0 = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 7571</span>                <span class="stringliteral">&quot;bad Rela offset&quot;</span>, dt_rela, dt_relasz);</div>
<div class="line"><span class="lineno"> 7572</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64</a>(dt_rela, rela0, dt_relasz, old_dtinit, fo);</div>
<div class="line"><span class="lineno"> 7573</span>        }</div>
<div class="line"><span class="lineno"> 7574</span>        <span class="keywordflow">if</span> (dt_pltrelsz &amp;&amp; dt_jmprel) { <span class="comment">// FIXME:  overlap w/ DT_REL ?</span></div>
<div class="line"><span class="lineno"> 7575</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *<span class="keyword">const</span> jmp0 = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 7576</span>                <span class="stringliteral">&quot;bad Jmprel offset&quot;</span>, dt_jmprel, dt_pltrelsz);</div>
<div class="line"><span class="lineno"> 7577</span>            <a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>));</div>
<div class="line"><span class="lineno"> 7578</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 7579</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7580</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7581</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7582</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> - vaddr;</div>
<div class="line"><span class="lineno"> 7583</span>                <span class="keywordflow">if</span> (d &lt; filesz) {</div>
<div class="line"><span class="lineno"> 7584</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7585</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(d + offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7586</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>, n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>));</div>
<div class="line"><span class="lineno"> 7587</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7588</span>                }</div>
<div class="line"><span class="lineno"> 7589</span>            }</div>
<div class="line"><span class="lineno"> 7590</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64</a>(dt_jmprel, jmp0, dt_pltrelsz, old_dtinit, fo);</div>
<div class="line"><span class="lineno"> 7591</span> </div>
<div class="line"><span class="lineno"> 7592</span>            <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> o_ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>;</div>
<div class="line"><span class="lineno"> 7593</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> o_phnum = o_ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>;</div>
<div class="line"><span class="lineno"> 7594</span>            phdr = phdro;</div>
<div class="line"><span class="lineno"> 7595</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; o_phnum; ++j, ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7596</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7597</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7598</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> - vaddr - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 7599</span>                <span class="keywordflow">if</span> (d &lt; filesz) {</div>
<div class="line"><span class="lineno"> 7600</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7601</span>                    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7602</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(d + offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7603</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>, n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>));</div>
<div class="line"><span class="lineno"> 7604</span>                    }</div>
<div class="line"><span class="lineno"> 7605</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7606</span>                }</div>
<div class="line"><span class="lineno"> 7607</span>            }</div>
<div class="line"><span class="lineno"> 7608</span>        }</div>
<div class="line"><span class="lineno"> 7609</span>        <span class="comment">// Modified relocation tables are re-written by unRela64</span></div>
<div class="line"><span class="lineno"> 7610</span>    }</div>
<div class="line"><span class="lineno"> 7611</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a3b7d0324926f0404e61dc997833544f7"><div class="ttname"><a href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">PackLinuxElf64::unRela64</a></div><div class="ttdeci">virtual void unRela64(upx_uint64_t dt_rela, Elf64_Rela *rela0, unsigned relasz, upx_uint64_t const old_dtinit, OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06688">p_lx_elf.cpp:6688</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ab0f4c33a259ca5c14cdc2384285e274f"><div class="ttname"><a href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a></div><div class="ttdeci">MemBuffer jump_slots</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00131">p_lx_elf.h:131</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a5a26c3fc1d8625558cdce93d5a53c6de"><div class="ttname"><a href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a></div><div class="ttdeci">ElfClass_Host32::Rel Elf32_Rel</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00369">p_elf.h:369</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph" id="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph">
<area shape="rect" title=" " alt="" coords="5,746,149,786"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="665,728,798,753"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="944,631,1020,656"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="439,1786,584,1826"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="909,1462,1055,1502"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1148,1441,1277,1467"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="891,1895,1073,1920"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="659,1347,804,1387"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="656,1462,807,1502"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="209,1574,375,1614"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="674,215,789,240"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="450,215,573,240"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="440,527,583,552"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="453,477,570,503"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="447,576,575,601"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="447,880,575,905"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="221,5,363,31"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1356,147,1495,172"/>
<area shape="rect" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7" title=" " alt="" coords="197,779,387,804"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1168,477,1257,503"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="940,831,1024,856"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="941,781,1023,807"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="875,880,1089,905"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="905,732,1059,757"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1563,477,1681,503"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1137,774,1288,814"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="636,1843,827,1883"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1148,1743,1277,1768"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="945,1361,1019,1387"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="439,1517,584,1557"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="897,1032,1067,1057"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="447,1632,576,1657"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="435,1241,588,1281"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="659,1678,804,1718"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="655,1082,807,1122"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="907,1087,1057,1112"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="664,1248,799,1273"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="669,1297,793,1323"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="917,459,1047,484"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1168,283,1257,308"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="913,208,1051,233"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1346,317,1505,357"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="657,165,806,191"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="666,352,797,377"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="915,257,1049,283"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="937,409,1027,435"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="673,489,789,515"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="914,508,1050,533"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="912,557,1052,583"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="1336,36,1515,61"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph" id="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="ad2c315a3286632db9c874ca7a65bb69d" name="ad2c315a3286632db9c874ca7a65bb69d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c315a3286632db9c874ca7a65bb69d">&#9670;&#160;</a></span>un_shlib_1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::un_shlib_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *const&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>o_elfhdrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>c_adler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>u_adler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>orig_file_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06857">6857</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6864</span>{</div>
<div class="line"><span class="lineno"> 6865</span>    <span class="comment">// xct_off [input side] was set by ::unpack when is_shlib</span></div>
<div class="line"><span class="lineno"> 6866</span>    <span class="comment">// yct_off [output side] set here unless is_asl in next &#39;if&#39; block</span></div>
<div class="line"><span class="lineno"> 6867</span>    <span class="keywordtype">unsigned</span> yct_off = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 6868</span> </div>
<div class="line"><span class="lineno"> 6869</span>    <span class="comment">// Below xct_off is not compressed (for benefit of rtld.)</span></div>
<div class="line"><span class="lineno"> 6870</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6871</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>, <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a>));</div>
<div class="line"><span class="lineno"> 6872</span> </div>
<div class="line"><span class="lineno"> 6873</span>    <span class="comment">// Determine if the extra page with copy of _Shdrs was spliced in.</span></div>
<div class="line"><span class="lineno"> 6874</span>    <span class="comment">// This used to be the result of --android-shlib.</span></div>
<div class="line"><span class="lineno"> 6875</span>    <span class="comment">// But in 2023-02 the forwarding of ARM_ATTRIBUTES (by appending)</span></div>
<div class="line"><span class="lineno"> 6876</span>    <span class="comment">// takes care of this, so the 5th word before e_entry does not</span></div>
<div class="line"><span class="lineno"> 6877</span>    <span class="comment">// have the low bit 1, so is_asl should not be set.</span></div>
<div class="line"><span class="lineno"> 6878</span>    <span class="comment">// However, .so that were compressed before 2023-03</span></div>
<div class="line"><span class="lineno"> 6879</span>    <span class="comment">// may be marked.</span></div>
<div class="line"><span class="lineno"> 6880</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 6881</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a></div>
<div class="line"><span class="lineno"> 6882</span>            <span class="comment">// +36: (sizeof(PackHeader) + sizeof(overlay_offset))</span></div>
<div class="line"><span class="lineno"> 6883</span>            <span class="comment">//    after Shdrs for ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 6884</span>    &amp;&amp;  (((<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) + 36) &lt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a>)</div>
<div class="line"><span class="lineno"> 6885</span>    ) { <span class="comment">// possible --android-shlib</span></div>
<div class="line"><span class="lineno"> 6886</span>        <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>) - (1+ 4)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)]);</div>
<div class="line"><span class="lineno"> 6887</span>        <span class="keywordflow">if</span> (1 &amp; x) { <span class="comment">// the clincher</span></div>
<div class="line"><span class="lineno"> 6888</span>            <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = 1;</div>
<div class="line"><span class="lineno"> 6889</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6890</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 6891</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 6892</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 6893</span>            yct_off = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>-&gt;sh_offset);  <span class="comment">// for the output file (de-compressed)</span></div>
<div class="line"><span class="lineno"> 6894</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + yct_off;  <span class="comment">// for the input file (compressed)</span></div>
<div class="line"><span class="lineno"> 6895</span>        }</div>
<div class="line"><span class="lineno"> 6896</span>    }</div>
<div class="line"><span class="lineno"> 6897</span> </div>
<div class="line"><span class="lineno"> 6898</span>    <span class="comment">// Decompress first Extent.  Old style covers [0, xct_off)</span></div>
<div class="line"><span class="lineno"> 6899</span>    <span class="comment">// which includes rtld constant data and eXecutable app code below DT_INIT.</span></div>
<div class="line"><span class="lineno"> 6900</span>    <span class="comment">// In old style, the first compressed Extent is redundant</span></div>
<div class="line"><span class="lineno"> 6901</span>    <span class="comment">// except for the compressed original Elf headers.</span></div>
<div class="line"><span class="lineno"> 6902</span>    <span class="comment">// New style covers just Elf headers: the rest below xct_off is</span></div>
<div class="line"><span class="lineno"> 6903</span>    <span class="comment">// rtld constant data: DT_*HASH, DT_SYMTAB, DT_STRTAB, etc.</span></div>
<div class="line"><span class="lineno"> 6904</span>    <span class="comment">// New style puts eXecutable app code in second PT_LOAD</span></div>
<div class="line"><span class="lineno"> 6905</span>    <span class="comment">// in order to mark Elf headers and rtld data as non-eXecutable.</span></div>
<div class="line"><span class="lineno"> 6906</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6907</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 6908</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structl__info.html">l_info</a> l;</div>
<div class="line"><span class="lineno"> 6909</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structp__info.html">p_info</a> p;</div>
<div class="line"><span class="lineno"> 6910</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structb__info.html">b_info</a> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 6911</span>    } hdr;</div>
<div class="line"><span class="lineno"> 6912</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;hdr, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno"> 6913</span>    <span class="keywordflow">if</span> (hdr.l.l_magic != <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a></div>
<div class="line"><span class="lineno"> 6914</span>    ||  <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hdr.l.l_lsize) != (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a></div>
<div class="line"><span class="lineno"> 6915</span>    ||  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hdr.p.p_filesize) != <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">u_file_size</a></div>
<div class="line"><span class="lineno"> 6916</span>    ||  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hdr.b.sz_unc) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>  <span class="comment">// peek: 1st b_info covers Elf headers</span></div>
<div class="line"><span class="lineno"> 6917</span>    ) {</div>
<div class="line"><span class="lineno"> 6918</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;corrupt l_info/p_info/b_info&quot;</span>);</div>
<div class="line"><span class="lineno"> 6919</span>    }</div>
<div class="line"><span class="lineno"> 6920</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(-(<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structb__info.html">b_info</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>); <span class="comment">// hdr.b_info was a peek</span></div>
<div class="line"><span class="lineno"> 6921</span> </div>
<div class="line"><span class="lineno"> 6922</span><span class="comment">// The default layout for a shared library created by binutils-2.29</span></div>
<div class="line"><span class="lineno"> 6923</span><span class="comment">// (Fedora 28; 2018) has two PT_LOAD: permissions r-x and rw-.</span></div>
<div class="line"><span class="lineno"> 6924</span><span class="comment">// xct_off (the lowest address of executable instructions;</span></div>
<div class="line"><span class="lineno"> 6925</span><span class="comment">// the highest address of read-only data used by rtld (ld-linux))</span></div>
<div class="line"><span class="lineno"> 6926</span><span class="comment">// will be somewhere in the first PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 6927</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6928</span><span class="comment">// The default layout for a shared library created by binutils-2.31</span></div>
<div class="line"><span class="lineno"> 6929</span><span class="comment">// (Fedora 29; 2018) has four PT_LOAD: permissions r--, r-x, r--, rw-.</span></div>
<div class="line"><span class="lineno"> 6930</span><span class="comment">// xct_off will be the base of the second [r-x] PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 6931</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6932</span><span class="comment">// Bytes below xct_off cannot be compressed because they are used</span></div>
<div class="line"><span class="lineno"> 6933</span><span class="comment">// by rtld *before* the UPX run-time de-compression stub gets control</span></div>
<div class="line"><span class="lineno"> 6934</span><span class="comment">// via DT_INIT. Bytes in a Writeable PT_LOAD cannot be compressed</span></div>
<div class="line"><span class="lineno"> 6935</span><span class="comment">// because they may be relocated by rtld, again before stub execution.</span></div>
<div class="line"><span class="lineno"> 6936</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6937</span><span class="comment">// We need to know which layout of PT_LOAD. It seems risky to steal</span></div>
<div class="line"><span class="lineno"> 6938</span><span class="comment">// bits in the input ElfXX_Ehdr or ElfXX_Phdr, so we decompress</span></div>
<div class="line"><span class="lineno"> 6939</span><span class="comment">// the first compressed block.  For an old-style shared library</span></div>
<div class="line"><span class="lineno"> 6940</span><span class="comment">// the first compressed block covers [0, xct_off) which is redundant</span></div>
<div class="line"><span class="lineno"> 6941</span><span class="comment">// with the interval [sz_elf_hdrs, xct_off) because those bytes</span></div>
<div class="line"><span class="lineno"> 6942</span><span class="comment">// must be present for use by rtl  (So that is a large inefficiency.)</span></div>
<div class="line"><span class="lineno"> 6943</span><span class="comment">// Fortunately p_info.p_blocksize fits in ibuf, and unpackExtent</span></div>
<div class="line"><span class="lineno"> 6944</span><span class="comment">// will just decompress it all.  For new style, the first compressed</span></div>
<div class="line"><span class="lineno"> 6945</span><span class="comment">// block covers [0, sz_elf_hdrs).</span></div>
<div class="line"><span class="lineno"> 6946</span> </div>
<div class="line"><span class="lineno"> 6947</span>    <span class="comment">// Peek: unpack into ibuf, but do not write</span></div>
<div class="line"><span class="lineno"> 6948</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_block1 = <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno"> 6949</span>        c_adler, u_adler, <span class="keyword">false</span>, -1);</div>
<div class="line"><span class="lineno"> 6950</span>    <span class="keywordflow">if</span> (sz_block1 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) {</div>
<div class="line"><span class="lineno"> 6951</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;corrupt b_info&quot;</span>);</div>
<div class="line"><span class="lineno"> 6952</span>    }</div>
<div class="line"><span class="lineno"> 6953</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(o_elfhdrs, <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>); <span class="comment">// save de-compressed Elf headers</span></div>
<div class="line"><span class="lineno"> 6954</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> ehdro = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)o_elfhdrs;</div>
<div class="line"><span class="lineno"> 6955</span>    <span class="keywordflow">if</span> (ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>   !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a></div>
<div class="line"><span class="lineno"> 6956</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a></div>
<div class="line"><span class="lineno"> 6957</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a></div>
<div class="line"><span class="lineno"> 6958</span>        <span class="comment">// less strict for EM_PPC64 to workaround earlier bug</span></div>
<div class="line"><span class="lineno"> 6959</span>    ||  !( ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a>==<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a></div>
<div class="line"><span class="lineno"> 6960</span>        || Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>))</div>
<div class="line"><span class="lineno"> 6961</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a> !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a></div>
<div class="line"><span class="lineno"> 6962</span>        <span class="comment">// check EI_MAG[0-3], EI_CLASS, EI_DATA, EI_VERSION</span></div>
<div class="line"><span class="lineno"> 6963</span>    ||  <a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, Elf64_Ehdr::EI_OSABI)) {</div>
<div class="line"><span class="lineno"> 6964</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;ElfXX_Ehdr corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 6965</span>    }</div>
<div class="line"><span class="lineno"> 6966</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6967</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sz_block1);</div>
<div class="line"><span class="lineno"> 6968</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = sz_block1;</div>
<div class="line"><span class="lineno"> 6969</span>    }</div>
<div class="line"><span class="lineno"> 6970</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *o_phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *)(1+ ehdro);</div>
<div class="line"><span class="lineno"> 6971</span>    <span class="comment">// Handle compressed PT_LOADs (must not have PF_W)</span></div>
<div class="line"><span class="lineno"> 6972</span>    <span class="keywordtype">unsigned</span> not_first_LOAD = 0;</div>
<div class="line"><span class="lineno"> 6973</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++o_phdr) {</div>
<div class="line"><span class="lineno"> 6974</span>        <span class="keywordtype">unsigned</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno"> 6975</span>        <span class="keywordtype">unsigned</span> flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>);</div>
<div class="line"><span class="lineno"> 6976</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a> != type || Elf64_Phdr::PF_W &amp; flags) {</div>
<div class="line"><span class="lineno"> 6977</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 6978</span>        }</div>
<div class="line"><span class="lineno"> 6979</span>        <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6980</span>        <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 6981</span>        <span class="keywordtype">unsigned</span> wanted = p_filesz;</div>
<div class="line"><span class="lineno"> 6982</span>        <span class="keywordflow">if</span> (!not_first_LOAD++) { <span class="comment">// first PT_LOAD</span></div>
<div class="line"><span class="lineno"> 6983</span>            wanted -= sz_block1;</div>
<div class="line"><span class="lineno"> 6984</span>            <span class="keywordflow">if</span> (sz_block1 &gt;  <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) { <span class="comment">// old style</span></div>
<div class="line"><span class="lineno"> 6985</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6986</span>                    <a class="code hl_function" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym</a>(orig_file_size, fo);</div>
<div class="line"><span class="lineno"> 6987</span>                }</div>
<div class="line"><span class="lineno"> 6988</span>                p_offset += sz_block1;</div>
<div class="line"><span class="lineno"> 6989</span>            }</div>
<div class="line"><span class="lineno"> 6990</span>            <span class="keywordflow">if</span> (sz_block1 == <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) { <span class="comment">// new style</span></div>
<div class="line"><span class="lineno"> 6991</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = (yct_off ? yct_off : <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 6992</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ipos = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6993</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6994</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>], len);</div>
<div class="line"><span class="lineno"> 6995</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6996</span>                    <a class="code hl_function" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym</a>(orig_file_size, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 6997</span>                }</div>
<div class="line"><span class="lineno"> 6998</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6999</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>], len);</div>
<div class="line"><span class="lineno"> 7000</span>                }</div>
<div class="line"><span class="lineno"> 7001</span>                <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 7002</span> </div>
<div class="line"><span class="lineno"> 7003</span><span class="comment">// github-issue629: (overlay_offset = 0xa500), so initially (xct_off = 0xa494).</span></div>
<div class="line"><span class="lineno"> 7004</span><span class="comment">// But &quot;yct_off = get_te64(&amp;shdri-&gt;sh_offset)&quot; so if _Shdrs are aligned (??)</span></div>
<div class="line"><span class="lineno"> 7005</span><span class="comment">// then (0x10500 == (xct_off = asl_delta + yct_off)), and we read+write</span></div>
<div class="line"><span class="lineno"> 7006</span><span class="comment">// more than we need.</span></div>
<div class="line"><span class="lineno"> 7007</span><span class="comment">// So assume the excess just lives there, or is overwritten later by seek+write.</span></div>
<div class="line"><span class="lineno"> 7008</span>                <span class="keywordflow">if</span> (wanted &lt; len) { <span class="comment">// FIXME: why does this happen?</span></div>
<div class="line"><span class="lineno"> 7009</span>                    wanted = 0;</div>
<div class="line"><span class="lineno"> 7010</span>                }</div>
<div class="line"><span class="lineno"> 7011</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7012</span>                    wanted -= len;</div>
<div class="line"><span class="lineno"> 7013</span>                }</div>
<div class="line"><span class="lineno"> 7014</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(ipos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7015</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> == p_filesz) {</div>
<div class="line"><span class="lineno"> 7016</span>                    <span class="keywordflow">continue</span>;   <span class="comment">// already entirely re-generated</span></div>
<div class="line"><span class="lineno"> 7017</span>                }</div>
<div class="line"><span class="lineno"> 7018</span>                p_offset = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 7019</span>            }</div>
<div class="line"><span class="lineno"> 7020</span>        }</div>
<div class="line"><span class="lineno"> 7021</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7022</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(p_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7023</span>        }</div>
<div class="line"><span class="lineno"> 7024</span>        <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(wanted, fo, c_adler, u_adler, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 7025</span>    }</div>
<div class="line"><span class="lineno"> 7026</span>    <a class="code hl_function" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);</div>
<div class="line"><span class="lineno"> 7027</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 7028</span> </div>
<div class="line"><span class="lineno"> 7029</span>    <span class="comment">// Handle PT_LOAD with PF_W: writeable, so not compressed.  &quot;Slide&quot;</span></div>
<div class="line"><span class="lineno"> 7030</span>    o_phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *)(1+ ehdro);</div>
<div class="line"><span class="lineno"> 7031</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *i_phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 7032</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++o_phdr, ++i_phdr) {</div>
<div class="line"><span class="lineno"> 7033</span>        <span class="keywordtype">unsigned</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_type);</div>
<div class="line"><span class="lineno"> 7034</span>        <span class="keywordtype">unsigned</span> flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_flags);</div>
<div class="line"><span class="lineno"> 7035</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a> != type || !(Elf64_Phdr::PF_W &amp; flags)) {</div>
<div class="line"><span class="lineno"> 7036</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 7037</span>        }</div>
<div class="line"><span class="lineno"> 7038</span>        <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 7039</span>        <span class="keywordtype">unsigned</span> o_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 7040</span>        <span class="keywordtype">unsigned</span> i_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;i_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7041</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(i_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7042</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 7043</span>        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += filesz;</div>
<div class="line"><span class="lineno"> 7044</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7045</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(o_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7046</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 7047</span>        }</div>
<div class="line"><span class="lineno"> 7048</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = filesz + o_offset;  <span class="comment">// high-water mark</span></div>
<div class="line"><span class="lineno"> 7049</span>    }</div>
<div class="line"><span class="lineno"> 7050</span> </div>
<div class="line"><span class="lineno"> 7051</span>    <span class="comment">// Gaps between PT_LOAD will be handled by ::unpack()</span></div>
<div class="line"><span class="lineno"> 7052</span> </div>
<div class="line"><span class="lineno"> 7053</span>    <span class="comment">// position fi at loader offset</span></div>
<div class="line"><span class="lineno"> 7054</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7055</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab19e5a4000bc5cc063dee2a31db657e9"><div class="ttname"><a href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">PackLinuxElf64::un_asl_dynsym</a></div><div class="ttdeci">virtual void un_asl_dynsym(unsigned orig_file_size, OutputFile *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06753">p_lx_elf.cpp:6753</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a4920cc3ff82dcbc60f2a87fdd276d025"><div class="ttname"><a href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a></div><div class="ttdeci">unsigned loader_offset</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00117">p_lx_elf.h:117</a></div></div>
<div class="ttc" id="aclassPackUnix_html_ab16d64e1b95f1dcf5f128665b83660f6"><div class="ttname"><a href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent</a></div><div class="ttdeci">virtual unsigned unpackExtent(unsigned wanted, OutputFile *fo, unsigned &amp;c_adler, unsigned &amp;u_adler, bool first_PF_X, int is_rewrite=false)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00472">p_unix.cpp:472</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a4ccd780b4c08de5d2868a0ffbcf1f6f3"><div class="ttname"><a href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a></div><div class="ttdeci">const upx_uint32_t file_size_u32</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00094">packer.h:94</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae2f3660cdb0ae37f901276a8f136e6a9"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a></div><div class="ttdeci">static unsigned funpad4(InputFile *fi)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00130">p_lx_elf.cpp:130</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a3855471cf08a9e4cd4b898e9a1e11fa4"><div class="ttname"><a href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a></div><div class="ttdeci">Elf64_Word e_version</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00210">bsd.h:210</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a404b7e3566d912b0382cacea17475e92"><div class="ttname"><a href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a></div><div class="ttdeci">Elf64_Half e_ehsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00215">bsd.h:215</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a>, <a class="el" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a84d7768fd6c6ece599d297090900cf92">PT_LOAD</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a>, <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>, <a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent()</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph" id="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph">
<area shape="rect" title=" " alt="" coords="5,1080,149,1120"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="220,862,353,887"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9" title=" " alt="" coords="249,112,324,138"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="473,112,590,138"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="709,184,815,210"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="467,1591,596,1616"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="697,1212,827,1238"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="697,1534,827,1559"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="202,1654,371,1679"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="245,1727,329,1752"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="247,1800,326,1826"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="470,162,593,187"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="467,1062,595,1087"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="462,1111,601,1136"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="215,1290,359,1330"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="697,636,827,662"/>
<area shape="rect" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6" title=" " alt="" coords="197,484,376,510"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1103,786,1193,811"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="493,711,569,736"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="720,586,804,611"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="491,960,572,986"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="424,812,639,838"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="454,862,609,887"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1271,1111,1389,1136"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="687,896,837,936"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="704,384,820,410"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="887,384,1024,410"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="890,434,1021,459"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="927,208,984,234"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="887,686,1023,711"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="885,483,1025,508"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="705,335,819,360"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="687,286,837,311"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1103,560,1193,586"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="444,1327,619,1352"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="459,1526,604,1566"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="459,1262,604,1302"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="460,911,603,936"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="467,1376,595,1402"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="460,1426,603,1451"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="1073,1208,1223,1248"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="729,1338,795,1363"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="888,636,1023,662"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="911,735,1000,760"/>
<area shape="rect" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29" title="decompress" alt="" coords="456,211,607,236"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="456,260,607,286"/>
<area shape="rect" href="classFilter.html#a9ebf9984c147460e8e734225354023df" title=" " alt="" coords="489,310,573,335"/>
<area shape="rect" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49" title=" " alt="" coords="485,383,578,408"/>
<area shape="rect" href="classFilter.html#a34aee2c034f2a84b0b8af53287066c1a" title=" " alt="" coords="477,484,586,510"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="711,434,813,459"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph" id="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a4b789474661dc2f8e40182aae29ee479" name="a4b789474661dc2f8e40182aae29ee479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b789474661dc2f8e40182aae29ee479">&#9670;&#160;</a></span>unpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::unpack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic Unix <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack().">unpack()</a>. </p>
<p>This code looks much like the one in stub/l_linux.c See notes there. </p>

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07613">7613</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7614</span>{</div>
<div class="line"><span class="lineno"> 7615</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>)) {<span class="comment">// Phdrs not contiguous with Ehdr</span></div>
<div class="line"><span class="lineno"> 7616</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_phoff&quot;</span>);</div>
<div class="line"><span class="lineno"> 7617</span>    }</div>
<div class="line"><span class="lineno"> 7618</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> c_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7619</span>    <span class="keywordtype">unsigned</span> u_phnum = 0;</div>
<div class="line"><span class="lineno"> 7620</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> old_dtinit = 0;</div>
<div class="line"><span class="lineno"> 7621</span> </div>
<div class="line"><span class="lineno"> 7622</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_EXEC == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>)) {</div>
<div class="line"><span class="lineno"> 7623</span><span class="comment">// 40fddf17153ee3db73a04ff1bf288b91676138d6 2001-02-01 ph.version 11; b_info 12 bytes</span></div>
<div class="line"><span class="lineno"> 7624</span><span class="comment">// df9db96bd1c013c07da1d7ec740021d588ab2815 2001-01-17 ph.version 11; no b_info (==&gt; 8 bytes)</span></div>
<div class="line"><span class="lineno"> 7625</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">version</a> &lt;= 11</div>
<div class="line"><span class="lineno"> 7626</span>        &amp;&amp;  <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>) &lt; 0x401180</div>
<div class="line"><span class="lineno"> 7627</span>        &amp;&amp;  <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>)==Elf64_Ehdr::EM_X86_64) {</div>
<div class="line"><span class="lineno"> 7628</span>            <span class="comment">// old style, 8-byte b_info:</span></div>
<div class="line"><span class="lineno"> 7629</span>            <span class="comment">// sizeof(b_info.sz_unc) + sizeof(b_info.sz_cpr);</span></div>
<div class="line"><span class="lineno"> 7630</span>            <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> = 2*<span class="keyword">sizeof</span>(unsigned);</div>
<div class="line"><span class="lineno"> 7631</span>        }</div>
<div class="line"><span class="lineno"> 7632</span>    }</div>
<div class="line"><span class="lineno"> 7633</span> </div>
<div class="line"><span class="lineno"> 7634</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7635</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 7636</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> != <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a>)) {</div>
<div class="line"><span class="lineno"> 7637</span>        <a class="code hl_struct" href="structLE32.html">NE32</a> <span class="keyword">const</span> *<span class="keyword">const</span> lp = (<a class="code hl_struct" href="structLE32.html">NE32</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno"> 7638</span>        <span class="comment">// Workaround for bug of extra linfo by some asl_pack2_Shdrs().</span></div>
<div class="line"><span class="lineno"> 7639</span>        <span class="keywordflow">if</span> (0==lp[0] &amp;&amp; 0==lp[1] &amp;&amp; 0==lp[2]) { <span class="comment">// looks like blank extra</span></div>
<div class="line"><span class="lineno"> 7640</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 7641</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> == <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a>)) {</div>
<div class="line"><span class="lineno"> 7642</span>                <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> += <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 7643</span>            }</div>
<div class="line"><span class="lineno"> 7644</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7645</span>                <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;l_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7646</span>            }</div>
<div class="line"><span class="lineno"> 7647</span>        }</div>
<div class="line"><span class="lineno"> 7648</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7649</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;l_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7650</span>        }</div>
<div class="line"><span class="lineno"> 7651</span>    }</div>
<div class="line"><span class="lineno"> 7652</span>    <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_lsize</a>);</div>
<div class="line"><span class="lineno"> 7653</span>    <a class="code hl_struct" href="structp__info.html">p_info</a> hbuf;  <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;hbuf, <span class="keyword">sizeof</span>(hbuf));</div>
<div class="line"><span class="lineno"> 7654</span>    <span class="keywordtype">unsigned</span> orig_file_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_filesize</a>);</div>
<div class="line"><span class="lineno"> 7655</span>    <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_blocksize</a>);</div>
<div class="line"><span class="lineno"> 7656</span>    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &gt; orig_file_size || <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> &gt; orig_file_size</div>
<div class="line"><span class="lineno"> 7657</span>        || !<a class="code hl_function" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid</a>(1, <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>))</div>
<div class="line"><span class="lineno"> 7658</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;p_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7659</span> </div>
<div class="line"><span class="lineno"> 7660</span>    <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> + <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>);</div>
<div class="line"><span class="lineno"> 7661</span>    <a class="code hl_struct" href="structb__info.html">b_info</a> bhdr; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;bhdr, 0, <span class="keyword">sizeof</span>(bhdr));</div>
<div class="line"><span class="lineno"> 7662</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 7663</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7664</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7665</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> &gt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> == 0 || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> == 0</div>
<div class="line"><span class="lineno"> 7666</span>    ||  <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> &gt; orig_file_size)</div>
<div class="line"><span class="lineno"> 7667</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;b_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7668</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">filter_cto</a> = bhdr.<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7669</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a> = bhdr.<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;  <span class="comment">// FIXME if multiple de-compressors</span></div>
<div class="line"><span class="lineno"> 7670</span> </div>
<div class="line"><span class="lineno"> 7671</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> u(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a>);</div>
<div class="line"><span class="lineno"> 7672</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *<span class="keyword">const</span> ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;u[0];</div>
<div class="line"><span class="lineno"> 7673</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7674</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = 0;</div>
<div class="line"><span class="lineno"> 7675</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = 0;</div>
<div class="line"><span class="lineno"> 7676</span>    <span class="keywordtype">unsigned</span> c_adler = <a class="code hl_function" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><span class="lineno"> 7677</span>    <span class="keywordtype">unsigned</span> u_adler = <a class="code hl_function" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><span class="lineno"> 7678</span> </div>
<div class="line"><span class="lineno"> 7679</span>    <span class="keywordtype">unsigned</span> is_shlib = 0;</div>
<div class="line"><span class="lineno"> 7680</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = 0;</div>
<div class="line"><span class="lineno"> 7681</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> o_elfhdrs;</div>
<div class="line"><span class="lineno"> 7682</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> dynhdr = <a class="code hl_function" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">elf_find_ptype</a>(Elf64_Phdr::PT_DYNAMIC, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, c_phnum);</div>
<div class="line"><span class="lineno"> 7683</span>    <span class="comment">// dynseg was set by PackLinuxElf64help1</span></div>
<div class="line"><span class="lineno"> 7684</span>    <span class="keywordflow">if</span> (dynhdr &amp;&amp; !(Elf64_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_FLAGS_1))) {</div>
<div class="line"><span class="lineno"> 7685</span>        <span class="comment">// Packed shlib? (ET_DYN without -fPIE)</span></div>
<div class="line"><span class="lineno"> 7686</span>        is_shlib = 1;</div>
<div class="line"><span class="lineno"> 7687</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>);</div>
<div class="line"><span class="lineno"> 7688</span>        u_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7689</span>        o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno"> 7690</span>        <a class="code hl_function" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1</a>(fo, o_elfhdrs, c_adler, u_adler, orig_file_size);</div>
<div class="line"><span class="lineno"> 7691</span>        *ehdr = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>;</div>
<div class="line"><span class="lineno"> 7692</span>    }</div>
<div class="line"><span class="lineno"> 7693</span>    <span class="keywordflow">else</span> { <span class="comment">// main executable</span></div>
<div class="line"><span class="lineno"> 7694</span>        <span class="comment">// Uncompress Ehdr and Phdrs: info for control of unpacking</span></div>
<div class="line"><span class="lineno"> 7695</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() &lt; <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>)</div>
<div class="line"><span class="lineno"> 7696</span>            <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 7697</span> </div>
<div class="line"><span class="lineno"> 7698</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>);</div>
<div class="line"><span class="lineno"> 7699</span>        <span class="comment">// &quot;clickhouse&quot; ET_EXEC for amd64 has 0x200000 &lt;= .e_entry</span></div>
<div class="line"><span class="lineno"> 7700</span>        <span class="comment">// instead of 0x400000 that we checked earlier.</span></div>
<div class="line"><span class="lineno"> 7701</span>        <span class="keywordflow">if</span> (8 == <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a></div>
<div class="line"><span class="lineno"> 7702</span>        &amp;&amp;  Elf64_Ehdr::EM_X86_64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno"> 7703</span>        &amp;&amp;  Elf64_Ehdr::ET_EXEC   == <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a></div>
<div class="line"><span class="lineno"> 7704</span>        &amp;&amp;  <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> &lt;= <a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a></div>
<div class="line"><span class="lineno"> 7705</span>        ) {</div>
<div class="line"><span class="lineno"> 7706</span>            <span class="keywordtype">unsigned</span> b_method = <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[0];</div>
<div class="line"><span class="lineno"> 7707</span>            <span class="keywordtype">unsigned</span> b_extra  = <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[3];</div>
<div class="line"><span class="lineno"> 7708</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a514747381652f1e72fd56d91a406c6e2">M_ZSTD</a> &gt;= b_method &amp;&amp; 0 == b_extra) {</div>
<div class="line"><span class="lineno"> 7709</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>( -(<a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>)(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> + <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7710</span>                <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> = 12;</div>
<div class="line"><span class="lineno"> 7711</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 7712</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">filter_cto</a> = bhdr.<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7713</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a> = bhdr.<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;  <span class="comment">// FIXME if multiple de-compressors</span></div>
<div class="line"><span class="lineno"> 7714</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>);</div>
<div class="line"><span class="lineno"> 7715</span>            }</div>
<div class="line"><span class="lineno"> 7716</span>        }</div>
<div class="line"><span class="lineno"> 7717</span>        <a class="code hl_function" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">decompress</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, (<a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> *)ehdr, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 7718</span>        <span class="keywordflow">if</span> (ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>   !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a></div>
<div class="line"><span class="lineno"> 7719</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a></div>
<div class="line"><span class="lineno"> 7720</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a></div>
<div class="line"><span class="lineno"> 7721</span>            <span class="comment">// less strict for EM_PPC64 to workaround earlier bug</span></div>
<div class="line"><span class="lineno"> 7722</span>        ||  !( ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a>==<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a></div>
<div class="line"><span class="lineno"> 7723</span>            || Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>))</div>
<div class="line"><span class="lineno"> 7724</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a> !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a></div>
<div class="line"><span class="lineno"> 7725</span>            <span class="comment">// check EI_MAG[0-3], EI_CLASS, EI_DATA, EI_VERSION</span></div>
<div class="line"><span class="lineno"> 7726</span>        ||  <a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, Elf64_Ehdr::EI_OSABI)) {</div>
<div class="line"><span class="lineno"> 7727</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;ElfXX_Ehdr corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7728</span>        }</div>
<div class="line"><span class="lineno"> 7729</span>        <span class="comment">// Rewind: prepare for data phase</span></div>
<div class="line"><span class="lineno"> 7730</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(- (<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>) (<a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> + <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7731</span> </div>
<div class="line"><span class="lineno"> 7732</span>        u_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7733</span>        <span class="keywordflow">if</span> ((<a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a>) - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>))/<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) &lt; u_phnum) {</div>
<div class="line"><span class="lineno"> 7734</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad compressed e_phnum&quot;</span>);</div>
<div class="line"><span class="lineno"> 7735</span>        }</div>
<div class="line"><span class="lineno"> 7736</span>        o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + u_phnum * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 7737</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(o_elfhdrs, ehdr, o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>());</div>
<div class="line"><span class="lineno"> 7738</span> </div>
<div class="line"><span class="lineno"> 7739</span>        <span class="comment">// Decompress each PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 7740</span>        <span class="keywordtype">bool</span> first_PF_X = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7741</span>        phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *) (<span class="keywordtype">void</span> *) (1+ ehdr);  <span class="comment">// uncompressed</span></div>
<div class="line"><span class="lineno"> 7742</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; u_phnum; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 7743</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7744</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7745</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7746</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7747</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7748</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> &lt; offset) {</div>
<div class="line"><span class="lineno"> 7749</span>                        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = offset;  <span class="comment">// FIXME: can it be re-write?</span></div>
<div class="line"><span class="lineno"> 7750</span>                    }</div>
<div class="line"><span class="lineno"> 7751</span>                }</div>
<div class="line"><span class="lineno"> 7752</span>                <span class="keywordflow">if</span> (Elf64_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>)) {</div>
<div class="line"><span class="lineno"> 7753</span>                    <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(filesz, fo,</div>
<div class="line"><span class="lineno"> 7754</span>                        c_adler, u_adler, first_PF_X);</div>
<div class="line"><span class="lineno"> 7755</span>                    first_PF_X = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7756</span>                }</div>
<div class="line"><span class="lineno"> 7757</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7758</span>                    <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(filesz, fo,</div>
<div class="line"><span class="lineno"> 7759</span>                        c_adler, u_adler, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 7760</span>                }</div>
<div class="line"><span class="lineno"> 7761</span>            }</div>
<div class="line"><span class="lineno"> 7762</span>        }</div>
<div class="line"><span class="lineno"> 7763</span>    }</div>
<div class="line"><span class="lineno"> 7764</span> </div>
<div class="line"><span class="lineno"> 7765</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> e_entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>);</div>
<div class="line"><span class="lineno"> 7766</span>    <span class="keywordtype">unsigned</span> off_entry = 0;</div>
<div class="line"><span class="lineno"> 7767</span>    phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 7768</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = 0;</div>
<div class="line"><span class="lineno"> 7769</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; c_phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 7770</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7771</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7772</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7773</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7774</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>) {</div>
<div class="line"><span class="lineno"> 7775</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = vaddr;</div>
<div class="line"><span class="lineno"> 7776</span>            }</div>
<div class="line"><span class="lineno"> 7777</span>            <span class="keywordflow">if</span> ((e_entry - vaddr) &lt; filesz) {</div>
<div class="line"><span class="lineno"> 7778</span>                off_entry = (e_entry - vaddr) + offset;</div>
<div class="line"><span class="lineno"> 7779</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7780</span>            }</div>
<div class="line"><span class="lineno"> 7781</span>        }</div>
<div class="line"><span class="lineno"> 7782</span>    }</div>
<div class="line"><span class="lineno"> 7783</span>    <span class="keywordtype">unsigned</span> d_info[6];</div>
<div class="line"><span class="lineno"> 7784</span>    <span class="keywordtype">unsigned</span> sz_d_info = <span class="keyword">sizeof</span>(d_info);</div>
<div class="line"><span class="lineno"> 7785</span>    <span class="keywordflow">if</span> (!is_shlib) {</div>
<div class="line"><span class="lineno"> 7786</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0].p_flags) &amp; Elf64_Phdr::PF_X) {</div>
<div class="line"><span class="lineno"> 7787</span>            <span class="comment">// Old style, such as upx-3.91 thru upx-3.95</span></div>
<div class="line"><span class="lineno"> 7788</span>            <span class="keywordflow">switch</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 7789</span>                <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 7790</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 7791</span>                        <span class="stringliteral">&quot;Unknown architecture %d&quot;</span>, this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);</div>
<div class="line"><span class="lineno"> 7792</span>                    <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7793</span>                }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7794</span>                <span class="keywordflow">case</span> Elf64_Ehdr::EM_AARCH64: sz_d_info = 4 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7795</span>                <span class="keywordflow">case</span> Elf64_Ehdr::EM_PPC64:   sz_d_info = 3 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7796</span>                <span class="keywordflow">case</span> Elf64_Ehdr::EM_X86_64:  sz_d_info = 2 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7797</span>            }</div>
<div class="line"><span class="lineno"> 7798</span>        }</div>
<div class="line"><span class="lineno"> 7799</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = off_entry - sz_d_info;</div>
<div class="line"><span class="lineno"> 7800</span>    }</div>
<div class="line"><span class="lineno"> 7801</span> </div>
<div class="line"><span class="lineno"> 7802</span>    <span class="keywordflow">if</span> (0x1000==<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0].p_filesz)  <span class="comment">// detect C_BASE style</span></div>
<div class="line"><span class="lineno"> 7803</span>    &amp;&amp;  0==<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_offset)</div>
<div class="line"><span class="lineno"> 7804</span>    &amp;&amp;  0==<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0].p_offset)</div>
<div class="line"><span class="lineno"> 7805</span>    &amp;&amp;     <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_filesz) == <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_memsz)) {</div>
<div class="line"><span class="lineno"> 7806</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_memsz)), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);  <span class="comment">// past the loader</span></div>
<div class="line"><span class="lineno"> 7807</span>    }</div>
<div class="line"><span class="lineno"> 7808</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_shlib</div>
<div class="line"><span class="lineno"> 7809</span>    ||  (off_entry + <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>) + <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_function" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">getPackHeaderSize</a>() + <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a>))</div>
<div class="line"><span class="lineno"> 7810</span>            &lt; <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>)) {</div>
<div class="line"><span class="lineno"> 7811</span>        <span class="comment">// Loader is not at end; skip past it.</span></div>
<div class="line"><span class="lineno"> 7812</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>) {</div>
<div class="line"><span class="lineno"> 7813</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7814</span>        }</div>
<div class="line"><span class="lineno"> 7815</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7816</span>            <a class="code hl_function" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);  <span class="comment">// MATCH01</span></div>
<div class="line"><span class="lineno"> 7817</span>        }</div>
<div class="line"><span class="lineno"> 7818</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(d_info, sz_d_info);</div>
<div class="line"><span class="lineno"> 7819</span>        <span class="keywordflow">if</span> (is_shlib &amp;&amp; 0==old_dtinit) {</div>
<div class="line"><span class="lineno"> 7820</span>            old_dtinit = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;d_info[2 + (0==d_info[0])]);</div>
<div class="line"><span class="lineno"> 7821</span>            <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = 1u&amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;d_info[0 + (0==d_info[0])]);</div>
<div class="line"><span class="lineno"> 7822</span>        }</div>
<div class="line"><span class="lineno"> 7823</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a> - sz_d_info, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7824</span>    }</div>
<div class="line"><span class="lineno"> 7825</span> </div>
<div class="line"><span class="lineno"> 7826</span>    <span class="comment">// The gaps between PT_LOAD and after last PT_LOAD</span></div>
<div class="line"><span class="lineno"> 7827</span>    phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)o_elfhdrs);</div>
<div class="line"><span class="lineno"> 7828</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> hi_offset(0);</div>
<div class="line"><span class="lineno"> 7829</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; u_phnum; ++j) {</div>
<div class="line"><span class="lineno"> 7830</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_offset);</div>
<div class="line"><span class="lineno"> 7831</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD</a>(&amp;phdr[j])</div>
<div class="line"><span class="lineno"> 7832</span>        &amp;&amp;  hi_offset &lt; offset) {</div>
<div class="line"><span class="lineno"> 7833</span>            hi_offset = offset;</div>
<div class="line"><span class="lineno"> 7834</span>        }</div>
<div class="line"><span class="lineno"> 7835</span>    }</div>
<div class="line"><span class="lineno"> 7836</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; u_phnum; ++j) {</div>
<div class="line"><span class="lineno"> 7837</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(phdr, j, u_phnum);</div>
<div class="line"><span class="lineno"> 7838</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>) {</div>
<div class="line"><span class="lineno"> 7839</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> where = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_offset) +</div>
<div class="line"><span class="lineno"> 7840</span>                                   <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_filesz);</div>
<div class="line"><span class="lineno"> 7841</span>            <span class="keywordflow">if</span> (fo)</div>
<div class="line"><span class="lineno"> 7842</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(where, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7843</span>            { <span class="comment">// Recover from some piracy [also serves as error tolerance :-) ]</span></div>
<div class="line"><span class="lineno"> 7844</span>              <span class="comment">// Getting past the loader is problematic, due to unintended</span></div>
<div class="line"><span class="lineno"> 7845</span>              <span class="comment">// variances between released versions:</span></div>
<div class="line"><span class="lineno"> 7846</span>              <span class="comment">//   l_info.l_lsize might be rounded up by 8 instead of by 4, and</span></div>
<div class="line"><span class="lineno"> 7847</span>              <span class="comment">//   sz_d_info might have changed.</span></div>
<div class="line"><span class="lineno"> 7848</span>                <a class="code hl_struct" href="structb__info.html">b_info</a> b_peek, *bp = &amp;b_peek;</div>
<div class="line"><span class="lineno"> 7849</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(bp, <span class="keyword">sizeof</span>(b_peek));</div>
<div class="line"><span class="lineno"> 7850</span>                <a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a> pos = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(-(<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)<span class="keyword">sizeof</span>(b_peek), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7851</span>                <span class="keywordtype">unsigned</span> sz_unc = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7852</span>                <span class="keywordtype">unsigned</span> sz_cpr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7853</span>                <span class="keywordtype">unsigned</span> word3  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>);</div>
<div class="line"><span class="lineno"> 7854</span>                <span class="keywordtype">unsigned</span> method = bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;</div>
<div class="line"><span class="lineno"> 7855</span>                <span class="keywordtype">unsigned</span> ftid = bp-&gt;<a class="code hl_variable" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_ftid</a>;</div>
<div class="line"><span class="lineno"> 7856</span>                <span class="keywordtype">unsigned</span> cto8 = bp-&gt;<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7857</span>                <span class="keywordflow">if</span> (!( ((sz_cpr == sz_unc) &amp;&amp; (0 == word3) &amp;&amp; (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> == sz_unc)) <span class="comment">// incompressible literal</span></div>
<div class="line"><span class="lineno"> 7858</span>                    || ((sz_cpr &lt;  sz_unc) &amp;&amp; (method == <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a>) &amp;&amp; (0 == ftid) &amp;&amp; (0 == cto8)))</div>
<div class="line"><span class="lineno"> 7859</span>                ) {</div>
<div class="line"><span class="lineno"> 7860</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode++;</div>
<div class="line"><span class="lineno"> 7861</span>                    <a class="code hl_function" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a>(<span class="stringliteral">&quot;bad b_info at %#zx&quot;</span>, (<span class="keywordtype">size_t</span>)pos);</div>
<div class="line"><span class="lineno"> 7862</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> N_PEEK(16 * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)), H_PEEK(N_PEEK &gt;&gt; 1);</div>
<div class="line"><span class="lineno"> 7863</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> peek_arr[N_PEEK];</div>
<div class="line"><span class="lineno"> 7864</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos - H_PEEK, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7865</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(peek_arr, <span class="keyword">sizeof</span>(peek_arr));</div>
<div class="line"><span class="lineno"> 7866</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7867</span>                    <span class="keywordtype">bool</span> <span class="keyword">const</span> is_be = ELFDATA2MSB == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[EI_DATA];</div>
<div class="line"><span class="lineno"> 7868</span>                    <span class="keywordflow">if</span> (is_be) {</div>
<div class="line"><span class="lineno"> 7869</span>                        <span class="comment">// Does the right thing for sz_unc and sz_cpr,</span></div>
<div class="line"><span class="lineno"> 7870</span>                        <span class="comment">// but swaps b_method and b_extra.  Need find_be32() :-)</span></div>
<div class="line"><span class="lineno"> 7871</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; N_PEEK; k += <span class="keyword">sizeof</span>(int)) {</div>
<div class="line"><span class="lineno"> 7872</span>                            <a class="code hl_function" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a>(&amp;peek_arr[k], <a class="code hl_function" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32</a>(&amp;peek_arr[k]));</div>
<div class="line"><span class="lineno"> 7873</span>                        }</div>
<div class="line"><span class="lineno"> 7874</span>                    }</div>
<div class="line"><span class="lineno"> 7875</span>                    <span class="keywordtype">int</span> boff = <a class="code hl_function" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32</a>(peek_arr, <span class="keyword">sizeof</span>(peek_arr), <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>);</div>
<div class="line"><span class="lineno"> 7876</span>                    <span class="keywordflow">if</span> (boff &lt; 0</div>
<div class="line"><span class="lineno"> 7877</span>                    || <span class="keyword">sizeof</span>(peek_arr) &lt; (boff + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structb__info.html">b_info</a>))) {</div>
<div class="line"><span class="lineno"> 7878</span>                        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;b_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7879</span>                    }</div>
<div class="line"><span class="lineno"> 7880</span>                    bp = (<a class="code hl_struct" href="structb__info.html">b_info</a> *)(<span class="keywordtype">void</span> *)&amp;peek_arr[boff];</div>
<div class="line"><span class="lineno"> 7881</span> </div>
<div class="line"><span class="lineno"> 7882</span>                    sz_unc = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7883</span>                    sz_cpr = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7884</span>                    word3  = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>);</div>
<div class="line"><span class="lineno"> 7885</span>                    ftid = bp-&gt;<a class="code hl_variable" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_ftid</a>;</div>
<div class="line"><span class="lineno"> 7886</span>                    cto8 = bp-&gt;<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7887</span>                    <span class="keywordflow">if</span> (0 &lt;= boff  <span class="comment">// found</span></div>
<div class="line"><span class="lineno"> 7888</span>                    &amp;&amp; ( ((sz_cpr == sz_unc) &amp;&amp; (0 == word3) &amp;&amp; (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> == sz_unc)) <span class="comment">// incompressible literal</span></div>
<div class="line"><span class="lineno"> 7889</span>                      || ((sz_cpr &lt;  sz_unc) &amp;&amp; (0 == ftid) &amp;&amp; (0 == cto8)</div>
<div class="line"><span class="lineno"> 7890</span>                          &amp;&amp; ((is_be ? bp-&gt;b_extra : bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>) == <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a>)) )</div>
<div class="line"><span class="lineno"> 7891</span>                    ) {</div>
<div class="line"><span class="lineno"> 7892</span>                        pos -= H_PEEK;</div>
<div class="line"><span class="lineno"> 7893</span>                        pos += boff;</div>
<div class="line"><span class="lineno"> 7894</span>                        <a class="code hl_function" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a>(<span class="stringliteral">&quot;... recovery at %#zx&quot;</span>, (<span class="keywordtype">size_t</span>)pos);</div>
<div class="line"><span class="lineno"> 7895</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7896</span>                    }</div>
<div class="line"><span class="lineno"> 7897</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode--;</div>
<div class="line"><span class="lineno"> 7898</span>                }</div>
<div class="line"><span class="lineno"> 7899</span>            }</div>
<div class="line"><span class="lineno"> 7900</span>            <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>, fo,</div>
<div class="line"><span class="lineno"> 7901</span>                c_adler, u_adler, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 7902</span>                (hi_offset != <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_offset)));</div>
<div class="line"><span class="lineno"> 7903</span>        }</div>
<div class="line"><span class="lineno"> 7904</span>    }</div>
<div class="line"><span class="lineno"> 7905</span> </div>
<div class="line"><span class="lineno"> 7906</span>    <span class="comment">// check for end-of-file</span></div>
<div class="line"><span class="lineno"> 7907</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 7908</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_unc = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7909</span> </div>
<div class="line"><span class="lineno"> 7910</span>    <span class="keywordflow">if</span> (sz_unc == 0) { <span class="comment">// uncompressed size 0 -&gt; EOF</span></div>
<div class="line"><span class="lineno"> 7911</span>        <span class="comment">// note: magic is always stored le32</span></div>
<div class="line"><span class="lineno"> 7912</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_cpr = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7913</span>        <span class="keywordflow">if</span> (sz_cpr != <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>)  <span class="comment">// sz_cpr must be h-&gt;magic</span></div>
<div class="line"><span class="lineno"> 7914</span>            <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 7915</span>    }</div>
<div class="line"><span class="lineno"> 7916</span>    <span class="keywordflow">else</span> { <span class="comment">// extra bytes after end?</span></div>
<div class="line"><span class="lineno"> 7917</span>        <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 7918</span>    }</div>
<div class="line"><span class="lineno"> 7919</span> </div>
<div class="line"><span class="lineno"> 7920</span>    <span class="keywordflow">if</span> (is_shlib) {</div>
<div class="line"><span class="lineno"> 7921</span>        <a class="code hl_function" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT</a>(old_dtinit, (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)(<span class="keywordtype">void</span> *)o_elfhdrs), dynhdr, fo);</div>
<div class="line"><span class="lineno"> 7922</span>    }</div>
<div class="line"><span class="lineno"> 7923</span> </div>
<div class="line"><span class="lineno"> 7924</span>    <span class="comment">// update header with totals</span></div>
<div class="line"><span class="lineno"> 7925</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>;</div>
<div class="line"><span class="lineno"> 7926</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 7927</span> </div>
<div class="line"><span class="lineno"> 7928</span>    <span class="comment">// all bytes must be written</span></div>
<div class="line"><span class="lineno"> 7929</span>    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> != orig_file_size)</div>
<div class="line"><span class="lineno"> 7930</span>        <a class="code hl_function" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a>();</div>
<div class="line"><span class="lineno"> 7931</span> </div>
<div class="line"><span class="lineno"> 7932</span>    <span class="comment">// finally test the checksums</span></div>
<div class="line"><span class="lineno"> 7933</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">c_adler</a> != c_adler || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">u_adler</a> != u_adler)</div>
<div class="line"><span class="lineno"> 7934</span>        <a class="code hl_function" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError</a>();</div>
<div class="line"><span class="lineno"> 7935</span>}</div>
<div class="ttc" id="abele_8h_html_a16e4a11a30290f102ab4d44df1e0547d"><div class="ttname"><a href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_be32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00315">bele.h:315</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a03c843122a8d3e44da9fe458643c2589"><div class="ttname"><a href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">PackLinuxElf64::un_DT_INIT</a></div><div class="ttdeci">virtual void un_DT_INIT(unsigned old_dtinit, Elf64_Phdr const *phdro, Elf64_Phdr const *dynhdr, OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07436">p_lx_elf.cpp:7436</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad2c315a3286632db9c874ca7a65bb69d"><div class="ttname"><a href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">PackLinuxElf64::un_shlib_1</a></div><div class="ttdeci">virtual void un_shlib_1(OutputFile *const fo, MemBuffer &amp;o_elfhdrs, unsigned &amp;c_adler, unsigned &amp;u_adler, unsigned const orig_file_size)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06857">p_lx_elf.cpp:6857</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af746b688a3b13d3bf0895095ae5c3212"><div class="ttname"><a href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">PackLinuxElf64::elf_find_ptype</a></div><div class="ttdeci">Elf64_Phdr const * elf_find_ptype(unsigned type, Elf64_Phdr const *phdr0, unsigned phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02456">p_lx_elf.cpp:2456</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a691359a24fbf2963d4ac5f625dd0299c"><div class="ttname"><a href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">PackLinuxElf::prev_method</a></div><div class="ttdeci">unsigned char prev_method</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00123">p_lx_elf.h:123</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a05a8d9222b7627fa48786c128340b0c0"><div class="ttname"><a href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">PackUnix::szb_info</a></div><div class="ttdeci">unsigned szb_info</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00105">p_unix.h:105</a></div></div>
<div class="ttc" id="aclassPacker_html_ab53d9fc8308aa5467d38425ad3673b29"><div class="ttname"><a href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">Packer::decompress</a></div><div class="ttdeci">void decompress(SPAN_P(const byte) in, SPAN_P(byte) out, bool verify_checksum=true, Filter *ft=nullptr)</div><div class="ttdoc">decompress</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00305">packer.cpp:305</a></div></div>
<div class="ttc" id="acompress_8cpp_html_ac78c1624c94e1e6b82fc6d9882285671"><div class="ttname"><a href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a></div><div class="ttdeci">unsigned upx_adler32(const void *buf, unsigned len, unsigned adler)</div><div class="ttdef"><b>Definition:</b> <a href="compress_8cpp_source.html#l00035">compress.cpp:35</a></div></div>
<div class="ttc" id="aconf_8h_html_a514747381652f1e72fd56d91a406c6e2"><div class="ttname"><a href="conf_8h.html#a514747381652f1e72fd56d91a406c6e2">M_ZSTD</a></div><div class="ttdeci">#define M_ZSTD</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00601">conf.h:601</a></div></div>
<div class="ttc" id="aconf_8h_html_ad8f1b4770ed40d94738e95587f35d75e"><div class="ttname"><a href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a></div><div class="ttdeci">void void void infoWarning(const char *format,...) attribute_format(1</div></div>
<div class="ttc" id="aexcept_8cpp_html_a3b79341230572b77353447647a3cd498"><div class="ttname"><a href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a></div><div class="ttdeci">void throwCompressedDataViolation()</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00122">except.cpp:122</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a75193d7ea3127c37580a384eca372630"><div class="ttname"><a href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError</a></div><div class="ttdeci">void throwChecksumError()</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00120">except.cpp:120</a></div></div>
<div class="ttc" id="astructLE32_html"><div class="ttname"><a href="structLE32.html">LE32</a></div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00756">bele.h:756</a></div></div>
<div class="ttc" id="astructPackHeader_html_a4b3ba8dce6c3cc4eb44a412fd743125c"><div class="ttname"><a href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">PackHeader::u_adler</a></div><div class="ttdeci">unsigned u_adler</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00056">packhead.h:56</a></div></div>
<div class="ttc" id="astructPackHeader_html_abe9892837b086ae9e9d52c06e4ccffdb"><div class="ttname"><a href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">PackHeader::getPackHeaderSize</a></div><div class="ttdeci">int getPackHeaderSize() const</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00070">packhead.cpp:70</a></div></div>
<div class="ttc" id="astructPackHeader_html_ae01f8532b828892b503c900efe3b7f6f"><div class="ttname"><a href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a></div><div class="ttdeci">int version</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00050">packhead.h:50</a></div></div>
<div class="ttc" id="astructPackHeader_html_af3810d94cc6ec509ce906269114169f9"><div class="ttname"><a href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">PackHeader::filter_cto</a></div><div class="ttdeci">int filter_cto</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00060">packhead.h:60</a></div></div>
<div class="ttc" id="astructPackHeader_html_af8203b5d7f51a8fb27e917c9d571087b"><div class="ttname"><a href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">PackHeader::c_adler</a></div><div class="ttdeci">unsigned c_adler</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00057">packhead.h:57</a></div></div>
<div class="ttc" id="astructb__info_html_a420b07fc7e6c56d5f59a6b169dfc1b6f"><div class="ttname"><a href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_info::b_cto8</a></div><div class="ttdeci">unsigned char b_cto8</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00327">bsd.h:327</a></div></div>
<div class="ttc" id="astructb__info_html_ab0002ff09884ac6ed5137f678d9ca865"><div class="ttname"><a href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a></div><div class="ttdeci">unsigned char b_method</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00325">bsd.h:325</a></div></div>
<div class="ttc" id="astructb__info_html_add96d538b23e18c8ab3223c184fd7960"><div class="ttname"><a href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a></div><div class="ttdeci">uint32_t sz_unc</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00323">bsd.h:323</a></div></div>
<div class="ttc" id="astructb__info_html_ae26f59906590a2fff73341fe397993d2"><div class="ttname"><a href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_info::b_ftid</a></div><div class="ttdeci">unsigned char b_ftid</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00326">bsd.h:326</a></div></div>
<div class="ttc" id="astructl__info_html_aa0149de209589df53c7af51a2fb2eba6"><div class="ttname"><a href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a></div><div class="ttdeci">uint32_t l_magic</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00334">bsd.h:334</a></div></div>
<div class="ttc" id="astructl__info_html_aa0f743c0ef6a36494c5ad64218a6a86f"><div class="ttname"><a href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a></div><div class="ttdeci">uint16_t l_lsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00335">bsd.h:335</a></div></div>
<div class="ttc" id="astructp__info_html_a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0"><div class="ttname"><a href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a></div><div class="ttdeci">uint32_t p_filesize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00343">bsd.h:343</a></div></div>
<div class="ttc" id="astructp__info_html_a461ce9b60cfbb8fa0faab3b7e404c702"><div class="ttname"><a href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a></div><div class="ttdeci">uint32_t p_blocksize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00344">bsd.h:344</a></div></div>
<div class="ttc" id="autil_8cpp_html_aa692c787bee35bf08628018de7aa42d1"><div class="ttname"><a href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid</a></div><div class="ttdeci">bool mem_size_valid(upx_uint64_t element_size, upx_uint64_t n, upx_uint64_t extra1, upx_uint64_t extra2) noexcept</div><div class="ttdoc">upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma...</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00056">util.cpp:56</a></div></div>
<div class="ttc" id="autil_8cpp_html_aca065128666a7d8af5864a1fc875c156"><div class="ttname"><a href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32</a></div><div class="ttdeci">int find_le32(const void *b, int blen, unsigned what) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00709">util.cpp:709</a></div></div>
<div class="ttc" id="axspan__impl__common_8h_html_a60304b65bf89363bcc3165d3cde67f86"><div class="ttname"><a href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="xspan__impl__common_8h_source.html#l00460">xspan_impl_common.h:460</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_info::b_cto8</a>, <a class="el" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_info::b_ftid</a>, <a class="el" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">PackHeader::c_adler</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">Packer::decompress()</a>, <a class="el" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">elf_find_ptype()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">PackHeader::filter_cto</a>, <a class="el" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32()</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4()</a>, <a class="el" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32()</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">PackHeader::getPackHeaderSize()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec">is_LOAD()</a>, <a class="el" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a>, <a class="el" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="conf_8h.html#a514747381652f1e72fd56d91a406c6e2">M_ZSTD</a>, <a class="el" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>, <a class="el" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid()</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a>, <a class="el" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">PackLinuxElf::prev_method</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32()</a>, <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a>, <a class="el" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">PackUnix::szb_info</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError()</a>, <a class="el" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation()</a>, <a class="el" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">PackHeader::u_adler</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>, <a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent()</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, <a class="el" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32()</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph" id="aclassPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph">
<area shape="rect" title="Generic Unix unpack()." alt="" coords="5,1108,180,1134"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="453,1124,586,1150"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="698,1276,774,1302"/>
<area shape="rect" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29" title="decompress" alt="" coords="661,899,811,924"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1187,1127,1325,1152"/>
<area shape="rect" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630" title=" " alt="" coords="1177,352,1335,378"/>
<area shape="rect" href="except_8cpp.html#a3b79341230572b77353447647a3cd498" title=" " alt="" coords="1141,700,1371,726"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="1205,899,1307,924"/>
<area shape="rect" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212" title=" " alt="" coords="231,361,377,401"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="671,506,801,531"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="444,654,595,694"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="913,684,1042,710"/>
<area shape="rect" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156" title=" " alt="" coords="263,556,345,582"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="694,456,778,482"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="481,555,558,580"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="228,246,380,286"/>
<area shape="rect" href="classPackLinuxElf64.html#a5e4e0a8150ba291145c388c9c00705ec" title=" " alt="" coords="428,506,611,531"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9" title=" " alt="" coords="482,2059,557,2084"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="677,1907,795,1932"/>
<area shape="rect" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d" title=" " alt="" coords="263,756,345,782"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="265,679,343,704"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="455,1631,584,1656"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="861,1480,1093,1506"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="661,1858,811,1883"/>
<area shape="rect" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e" title=" " alt="" coords="254,1604,354,1630"/>
<area shape="rect" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="240,1654,368,1679"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="480,1704,559,1730"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="675,1530,797,1555"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="903,1856,1052,1882"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="455,1530,583,1555"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="280,1907,328,1932"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="232,1129,376,1169"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="232,1388,376,1428"/>
<area shape="rect" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6" title=" " alt="" coords="430,1226,609,1251"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="281,2160,327,2186"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1211,1202,1301,1227"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="694,1151,778,1176"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="695,579,777,604"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1149,1000,1363,1026"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="659,1102,813,1127"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1419,1127,1537,1152"/>
<area shape="rect" href="packhead_8cpp.html#a9bc7fbed8b0117cf25aae706dff178cb" title="ph decompress util" alt="" coords="915,899,1039,924"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="663,705,809,745"/>
<area shape="rect" href="util_8cpp.html#a579960b01d469d1969571dcf757871bc" title="find and mem_replace util" alt="" coords="496,456,543,482"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="683,2008,789,2034"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="919,1807,1035,1832"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1187,1844,1325,1870"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1186,1770,1326,1795"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="478,604,561,630"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="920,1530,1035,1555"/>
</map>
</div>

</div>
</div>
<a id="a3b7d0324926f0404e61dc997833544f7" name="a3b7d0324926f0404e61dc997833544f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7d0324926f0404e61dc997833544f7">&#9670;&#160;</a></span>unRela64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::unRela64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>dt_rela</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *&#160;</td>
          <td class="paramname"><em>rela0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relasz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> const&#160;</td>
          <td class="paramname"><em>old_dtinit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06688">6688</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6695</span>{</div>
<div class="line"><span class="lineno"> 6696</span>    <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rela = rela0;</div>
<div class="line"><span class="lineno"> 6697</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = relasz / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>); --k &gt;= 0; ++rela) {</div>
<div class="line"><span class="lineno"> 6698</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_addend = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 6699</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_addend) {</div>
<div class="line"><span class="lineno"> 6700</span>            r_addend -= <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6701</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_addend, r_addend);</div>
<div class="line"><span class="lineno"> 6702</span>        }</div>
<div class="line"><span class="lineno"> 6703</span> </div>
<div class="line"><span class="lineno"> 6704</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 6705</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 6706</span>            <span class="comment">//r_offset -= asl_delta;  // keep compressed value vs plt_va</span></div>
<div class="line"><span class="lineno"> 6707</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_offset, r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);  <span class="comment">// uncompressed value</span></div>
<div class="line"><span class="lineno"> 6708</span>        }</div>
<div class="line"><span class="lineno"> 6709</span> </div>
<div class="line"><span class="lineno"> 6710</span>        <span class="comment">// ElfXX_Rela (used only on 64-bit) ignores the contents of memory</span></div>
<div class="line"><span class="lineno"> 6711</span>        <span class="comment">// at the target designated by r_offset.  The target is completely</span></div>
<div class="line"><span class="lineno"> 6712</span>        <span class="comment">// overwritten by (r_addend + f_reloc(r_info)).</span></div>
<div class="line"><span class="lineno"> 6713</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6714</span>        <span class="comment">// Nevertheless, the existing targets of .rela.plt in the .got</span></div>
<div class="line"><span class="lineno"> 6715</span>        <span class="comment">// seem to have values that matter to somebody. So restore original</span></div>
<div class="line"><span class="lineno"> 6716</span>        <span class="comment">// values when is_asl.</span></div>
<div class="line"><span class="lineno"> 6717</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_info);</div>
<div class="line"><span class="lineno"> 6718</span>        <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 6719</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> &amp;&amp; Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 6720</span>            <span class="keywordflow">if</span> (R_AARCH64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6721</span><span class="preprocessor">#if 0  </span><span class="comment">//{ FIXME</span></div>
<div class="line"><span class="lineno"> 6722</span>                <span class="keywordflow">if</span> (old_dtinit == r_addend) {</div>
<div class="line"><span class="lineno"> 6723</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;ptload1[r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a>], r_addend);</div>
<div class="line"><span class="lineno"> 6724</span>                }</div>
<div class="line"><span class="lineno"> 6725</span><span class="preprocessor">#endif  </span><span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 6726</span>            }</div>
<div class="line"><span class="lineno"> 6727</span>            <span class="keywordflow">if</span> (R_AARCH64_JUMP_SLOT == r_type) {</div>
<div class="line"><span class="lineno"> 6728</span>                ++<a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 6729</span>                <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 6730</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() &lt; (r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a>)) {</div>
<div class="line"><span class="lineno"> 6731</span>                    <a class="code hl_function" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a>(<span class="stringliteral">&quot;bad r_offset for jump_slots&quot;</span>);</div>
<div class="line"><span class="lineno"> 6732</span>                }</div>
<div class="line"><span class="lineno"> 6733</span>                <span class="comment">// really upx_uint64_t *, but clang makes it hard to say that</span></div>
<div class="line"><span class="lineno"> 6734</span>                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *slot = r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a></div>
<div class="line"><span class="lineno"> 6735</span>                    + (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 6736</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(slot);</div>
<div class="line"><span class="lineno"> 6737</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 6738</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(slot, w - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6739</span>                }</div>
<div class="line"><span class="lineno"> 6740</span>            }</div>
<div class="line"><span class="lineno"> 6741</span>        }</div>
<div class="line"><span class="lineno"> 6742</span>        <span class="comment">// FIXME: but what about old_dtinit?</span></div>
<div class="line"><span class="lineno"> 6743</span>        (void)old_dtinit;</div>
<div class="line"><span class="lineno"> 6744</span> </div>
<div class="line"><span class="lineno"> 6745</span>    }  <span class="comment">// end each RELA</span></div>
<div class="line"><span class="lineno"> 6746</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6747</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(dt_rela, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6748</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rela0, relasz);</div>
<div class="line"><span class="lineno"> 6749</span>    }</div>
<div class="line"><span class="lineno"> 6750</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph" id="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph">
<area shape="rect" title=" " alt="" coords="5,424,195,449"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="263,276,392,301"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="252,325,403,351"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="243,375,412,400"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="256,424,399,449"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1430,424,1570,449"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="461,424,589,449"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="263,627,391,652"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="460,145,591,171"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="639,71,773,96"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1641,327,1772,352"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1431,109,1569,135"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="845,171,934,196"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1040,225,1129,251"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="661,120,751,145"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1222,59,1349,84"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="825,97,954,123"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1407,60,1593,85"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1679,60,1735,85"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1022,105,1147,131"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1212,160,1359,185"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1473,160,1527,185"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1005,161,1164,201"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1226,220,1345,245"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="821,323,957,348"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="648,424,764,449"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="861,475,918,500"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph" id="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph">
<area shape="rect" title=" " alt="" coords="420,13,609,38"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="afdf1b9c1ce448039ac4eaec55de40c3e" name="afdf1b9c1ce448039ac4eaec55de40c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf1b9c1ce448039ac4eaec55de40c3e">&#9670;&#160;</a></span>updateLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::updateLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackUnix.html#a2cee24303a1b5e7676c8d98acada2be0">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01237">1237</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1238</span>{</div>
<div class="line"><span class="lineno"> 1239</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 1240</span>        <span class="keywordflow">return</span>;  <span class="comment">// FIXME elfout has no values at all</span></div>
<div class="line"><span class="lineno"> 1241</span>    }</div>
<div class="line"><span class="lineno"> 1242</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> vbase = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 1243</span>    <span class="keywordtype">unsigned</span> start = linker-&gt;getSymbolOffset(<span class="stringliteral">&quot;_start&quot;</span>);</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_machine)==Elf64_Ehdr::EM_PPC64</div>
<div class="line"><span class="lineno"> 1246</span>    &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_ident[Elf64_Ehdr::EI_DATA]==Elf64_Ehdr::ELFDATA2MSB) {</div>
<div class="line"><span class="lineno"> 1247</span>        <span class="keywordtype">unsigned</span> descr = linker-&gt;getSymbolOffset(<span class="stringliteral">&quot;entry_descr&quot;</span>);</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>        <span class="comment">// External relocation of PPC64 function descriptor.</span></div>
<div class="line"><span class="lineno"> 1250</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dot_entry = start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase;</div>
<div class="line"><span class="lineno"> 1251</span>        <a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> *p = <a class="code hl_function" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">getLoader</a>();</div>
<div class="line"><span class="lineno"> 1252</span> </div>
<div class="line"><span class="lineno"> 1253</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;p[descr], dot_entry);</div>
<div class="line"><span class="lineno"> 1254</span>        <span class="comment">// Kernel 3.16.0 (2017-09-19) uses start, not descr</span></div>
<div class="line"><span class="lineno"> 1255</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry, start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase);</div>
<div class="line"><span class="lineno"> 1256</span>    }</div>
<div class="line"><span class="lineno"> 1257</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1258</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry, start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase);</div>
<div class="line"><span class="lineno"> 1259</span>    }</div>
<div class="line"><span class="lineno"> 1260</span>}</div>
<div class="ttc" id="aclassPacker_html_a6e094d3b47373817a66457952f26dc70"><div class="ttname"><a href="classPacker.html#a6e094d3b47373817a66457952f26dc70">Packer::getLoader</a></div><div class="ttdeci">virtual byte * getLoader() const</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00799">packer.cpp:799</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">Packer::getLoader()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph" id="aclassPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,223,105"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="275,5,404,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="275,55,404,80"/>
<area shape="rect" href="classPacker.html#a6e094d3b47373817a66457952f26dc70" title=" " alt="" coords="271,104,408,129"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="275,153,403,179"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="496,80,544,105"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="456,129,584,155"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="657,80,747,105"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="820,80,947,105"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="632,129,772,155"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a53f97eabbbe04201c83cd03c9103ce88" name="a53f97eabbbe04201c83cd03c9103ce88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53f97eabbbe04201c83cd03c9103ce88">&#9670;&#160;</a></span>dynseg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>* PackLinuxElf64::dynseg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00412">412</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">canPack_Shdr()</a>, <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>

</div>
</div>
<a id="ad4f613581a3950b9df0a33e1dee728e9" name="ad4f613581a3950b9df0a33e1dee728e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f613581a3950b9df0a33e1dee728e9">&#9670;&#160;</a></span>dynsym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>* PackLinuxElf64::dynsym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00415">415</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">canPack_Shdr()</a>, <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>

</div>
</div>
<a id="a0d71085c7179ef591535acdc5347e2dd" name="a0d71085c7179ef591535acdc5347e2dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d71085c7179ef591535acdc5347e2dd">&#9670;&#160;</a></span>e_phoff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::e_phoff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00406">406</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>

</div>
</div>
<a id="a0e16265acea35917d1e57a65fb5ffc70" name="a0e16265acea35917d1e57a65fb5ffc70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e16265acea35917d1e57a65fb5ffc70">&#9670;&#160;</a></span>e_shoff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::e_shoff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00407">407</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>.</p>

</div>
</div>
<a id="ad10baff449a3519d7386cf0519374a15" name="ad10baff449a3519d7386cf0519374a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad10baff449a3519d7386cf0519374a15">&#9670;&#160;</a></span>ehdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> PackLinuxElf64::ehdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00398">398</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, <a class="el" href="classPackLinuxElf64.html#afc05d6aa59c55c25d1faf101a5c557b7">PackLinuxElf64()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>

</div>
</div>
<a id="a9448025599860ae8d5773f15c09d73a4" name="a9448025599860ae8d5773f15c09d73a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9448025599860ae8d5773f15c09d73a4">&#9670;&#160;</a></span>elfout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cprElfHdr4 PackLinuxElf64::elfout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00447">447</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341">buildLinuxLoader()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, and <a class="el" href="classPackLinuxElf64.html#afdf1b9c1ce448039ac4eaec55de40c3e">updateLoader()</a>.</p>

</div>
</div>
<a id="a898ffb3ab797ebed36d6f8e8e69848f0" name="a898ffb3ab797ebed36d6f8e8e69848f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a898ffb3ab797ebed36d6f8e8e69848f0">&#9670;&#160;</a></span>END_PHDRX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned const PackLinuxElf64::END_PHDRX = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00402">402</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>.</p>

</div>
</div>
<a id="ad626f92218bc4ac19501c91a513ae75c" name="ad626f92218bc4ac19501c91a513ae75c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad626f92218bc4ac19501c91a513ae75c">&#9670;&#160;</a></span>gashend</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const * PackLinuxElf64::gashend</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00414">414</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, and <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>

</div>
</div>
<a id="af841cae6e65e727111a3e5bc134135c0" name="af841cae6e65e727111a3e5bc134135c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af841cae6e65e727111a3e5bc134135c0">&#9670;&#160;</a></span>gashtab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const* PackLinuxElf64::gashtab</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00414">414</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="a1a367c1ee6e43cb116f980f9046a0fce" name="a1a367c1ee6e43cb116f980f9046a0fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a367c1ee6e43cb116f980f9046a0fce">&#9670;&#160;</a></span>hashend</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const * PackLinuxElf64::hashend</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00413">413</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>

</div>
</div>
<a id="a9d14a83cf8a4300cf26946d4c16f8421" name="a9d14a83cf8a4300cf26946d4c16f8421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d14a83cf8a4300cf26946d4c16f8421">&#9670;&#160;</a></span>hashtab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const* PackLinuxElf64::hashtab</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00413">413</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="afb6babf0e9aac66eec1cdfe3c0fb6247" name="afb6babf0e9aac66eec1cdfe3c0fb6247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb6babf0e9aac66eec1cdfe3c0fb6247">&#9670;&#160;</a></span>jni_onload_sym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const* PackLinuxElf64::jni_onload_sym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00416">416</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="a847fd85f9cecd8abe44afd346f2ae168" name="a847fd85f9cecd8abe44afd346f2ae168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a847fd85f9cecd8abe44afd346f2ae168">&#9670;&#160;</a></span>n_jmp_slot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::n_jmp_slot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00409">409</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc05d6aa59c55c25d1faf101a5c557b7">PackLinuxElf64()</a>, and <a class="el" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64()</a>.</p>

</div>
</div>
<a id="ad07514aa5c9db6acc6b2bdad24113943" name="ad07514aa5c9db6acc6b2bdad24113943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07514aa5c9db6acc6b2bdad24113943">&#9670;&#160;</a></span>n_phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::n_phdrx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00404">404</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="acf726e188c8c471755ee3f00cf7c4226" name="acf726e188c8c471755ee3f00cf7c4226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf726e188c8c471755ee3f00cf7c4226">&#9670;&#160;</a></span>page_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::page_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00410">410</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, and <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>.</p>

</div>
</div>
<a id="aa11131540dea71d341de36cf39325c17" name="aa11131540dea71d341de36cf39325c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa11131540dea71d341de36cf39325c17">&#9670;&#160;</a></span>phdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a>* PackLinuxElf64::phdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00399">399</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd::pack1()</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm::pack1()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle::pack1()</a>, <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc::pack1()</a>, <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>

</div>
</div>
<a id="ac4fe837eb5fd3cff1d6b76758ab9a58c" name="ac4fe837eb5fd3cff1d6b76758ab9a58c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4fe837eb5fd3cff1d6b76758ab9a58c">&#9670;&#160;</a></span>phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const* PackLinuxElf64::phdrx[<a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00403">403</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, and <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>.</p>

</div>
</div>
<a id="a98d5fb25525360d037499ea920927602" name="a98d5fb25525360d037499ea920927602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d5fb25525360d037499ea920927602">&#9670;&#160;</a></span>sec_arm_attr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::sec_arm_attr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00421">421</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, and <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>.</p>

</div>
</div>
<a id="a4e8c011204377d30ff0f1283c7eca923" name="a4e8c011204377d30ff0f1283c7eca923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e8c011204377d30ff0f1283c7eca923">&#9670;&#160;</a></span>sec_dynstr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const* PackLinuxElf64::sec_dynstr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00420">420</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="a6d6524ff7018c3899073535eb33f4920" name="a6d6524ff7018c3899073535eb33f4920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6524ff7018c3899073535eb33f4920">&#9670;&#160;</a></span>sec_dynsym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::sec_dynsym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00419">419</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>.</p>

</div>
</div>
<a id="af723e5e6c9919f309a40134658df5a4d" name="af723e5e6c9919f309a40134658df5a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af723e5e6c9919f309a40134658df5a4d">&#9670;&#160;</a></span>sec_strndx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::sec_strndx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00418">418</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>.</p>

</div>
</div>
<a id="a43aff2a214341cb27a7f07ec997e443d" name="a43aff2a214341cb27a7f07ec997e443d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43aff2a214341cb27a7f07ec997e443d">&#9670;&#160;</a></span>shdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::shdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00400">400</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#aa31c4b9fe8bb49ee9fa220b0c1d149bd">canPack_Shdr()</a>, <a class="el" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>.</p>

</div>
</div>
<a id="a923425254661af8d150e99087569da9f" name="a923425254661af8d150e99087569da9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923425254661af8d150e99087569da9f">&#9670;&#160;</a></span>shdro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::shdro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00401">401</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>.</p>

</div>
</div>
<a id="aae6931a0bd5d2fca80befbd24a574c3e" name="aae6931a0bd5d2fca80befbd24a574c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae6931a0bd5d2fca80befbd24a574c3e">&#9670;&#160;</a></span>shdrout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cprElfShdr3 PackLinuxElf64::shdrout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00453">453</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, and <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>.</p>

</div>
</div>
<a id="a9da32af4a0e9814653edd2d72c3e2dda" name="a9da32af4a0e9814653edd2d72c3e2dda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9da32af4a0e9814653edd2d72c3e2dda">&#9670;&#160;</a></span>sz_dynseg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::sz_dynseg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00408">408</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>.</p>

</div>
</div>
<a id="a689b9c7fa3bd70c22d9703fbcc288819" name="a689b9c7fa3bd70c22d9703fbcc288819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689b9c7fa3bd70c22d9703fbcc288819">&#9670;&#160;</a></span>sz_phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::sz_phdrx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00405">405</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, and <a class="el" href="classPackLinuxElf64.html#a72eb546964b4b777ec38c3da1972eeb8">pack2_shlib()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a></li>
<li>src/<a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classPackLinuxElf64.html">PackLinuxElf64</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
