<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: PackLinuxElf64 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classPackLinuxElf64.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="classPackLinuxElf64-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PackLinuxElf64 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PackLinuxElf64:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64__inherit__graph.png" border="0" usemap="#aPackLinuxElf64_inherit__map" alt="Inheritance graph"/></div>
<map name="aPackLinuxElf64_inherit__map" id="aPackLinuxElf64_inherit__map">
<area shape="rect" title=" " alt="" coords="187,299,307,324"/>
<area shape="rect" href="classPackLinuxElf64Be.html" title=" " alt="" coords="99,372,236,397"/>
<area shape="rect" href="classPackLinuxElf64Le.html" title=" " alt="" coords="265,372,400,397"/>
<area shape="rect" href="classPackLinuxElf.html" title=" " alt="" coords="195,225,299,251"/>
<area shape="rect" href="classPackUnix.html" title="Abstract class for all Unix&#45;type packers." alt="" coords="206,152,289,177"/>
<area shape="rect" href="classPacker.html" title="Packer: default implementation base class for all current packers." alt="" coords="215,79,279,104"/>
<area shape="rect" href="classPackerBase.html" title="PackerBase: abstract minimal base class for all packers." alt="" coords="199,5,295,31"/>
<area shape="rect" href="classPackLinuxElf64ppc.html" title=" " alt="" coords="5,445,148,471"/>
<area shape="rect" href="classPackLinuxElf64amd.html" title="linux/elf64amd" alt="" coords="173,445,322,471"/>
<area shape="rect" href="classPackLinuxElf64arm.html" title=" " alt="" coords="346,445,493,471"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html" title="linux/elf64ppcle" alt="" coords="517,445,671,471"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for PackLinuxElf64:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64__coll__graph.png" border="0" usemap="#aPackLinuxElf64_coll__map" alt="Collaboration graph"/></div>
<map name="aPackLinuxElf64_coll__map" id="aPackLinuxElf64_coll__map">
<area shape="rect" title=" " alt="" coords="1636,346,1756,371"/>
<area shape="rect" href="classPackLinuxElf.html" title=" " alt="" coords="1447,321,1551,346"/>
<area shape="rect" href="classPackUnix.html" title="Abstract class for all Unix&#45;type packers." alt="" coords="1315,201,1397,226"/>
<area shape="rect" href="classPacker.html" title="Packer: default implementation base class for all current packers." alt="" coords="1103,159,1167,185"/>
<area shape="rect" href="classPackerBase.html" title="PackerBase: abstract minimal base class for all packers." alt="" coords="923,133,1019,158"/>
<area shape="rect" href="classInputFile.html" title=" " alt="" coords="705,95,784,121"/>
<area shape="rect" href="classFileBase.html" title=" " alt="" coords="367,95,445,121"/>
<area shape="rect" href="structPackHeader.html" title="PackHeader also see stub/src/include/header.S." alt="" coords="695,145,794,170"/>
<area shape="rect" href="structupx__compress__result__t.html" title=" " alt="" coords="320,145,492,170"/>
<area shape="rect" href="structupx__compress__result__t_1_1Debug.html" title=" " alt="" coords="17,5,177,45"/>
<area shape="rect" href="structbzip2__compress__result__t.html" title="compression &#45; result_t" alt="" coords="5,70,188,95"/>
<area shape="rect" href="structlzma__compress__result__t.html" title=" " alt="" coords="7,119,187,145"/>
<area shape="rect" href="structucl__compress__result__t.html" title=" " alt="" coords="13,169,180,194"/>
<area shape="rect" href="structzlib__compress__result__t.html" title=" " alt="" coords="11,218,182,243"/>
<area shape="rect" href="structzstd__compress__result__t.html" title=" " alt="" coords="9,267,184,293"/>
<area shape="rect" href="classMemBuffer.html" title="MemBuffer." alt="" coords="923,226,1018,251"/>
<area shape="rect" href="classMemBufferBase.html" title=" " alt="" coords="652,215,837,241"/>
<area shape="rect" href="structMemBuffer_1_1Stats.html" title=" " alt="" coords="677,265,812,290"/>
<area shape="rect" href="structl__info.html" title=" " alt="" coords="1105,110,1164,135"/>
<area shape="rect" href="structElf64__Phdr.html" title=" " alt="" coords="1453,370,1544,395"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afc05d6aa59c55c25d1faf101a5c557b7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afc05d6aa59c55c25d1faf101a5c557b7">PackLinuxElf64</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:afc05d6aa59c55c25d1faf101a5c557b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af736dee54f1eb95750dfb45531efb66c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af736dee54f1eb95750dfb45531efb66c">~PackLinuxElf64</a> ()</td></tr>
<tr class="separator:af736dee54f1eb95750dfb45531efb66c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:ac95c781c95ed54d3f82d6957d13563ef inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac95c781c95ed54d3f82d6957d13563ef">PackLinuxElf</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:ac95c781c95ed54d3f82d6957d13563ef inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cbfa44abec2d5cbfb7fad953ebd852a inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5cbfa44abec2d5cbfb7fad953ebd852a">~PackLinuxElf</a> ()</td></tr>
<tr class="separator:a5cbfa44abec2d5cbfb7fad953ebd852a inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b7b16256150aeee5316b817b469b93f inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a2b7b16256150aeee5316b817b469b93f">getVersion</a> () const override</td></tr>
<tr class="separator:a2b7b16256150aeee5316b817b469b93f inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3924832e55889e051ae9ad0ab43c5c9 inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac3924832e55889e051ae9ad0ab43c5c9">canUnpackVersion</a> (int version) const override</td></tr>
<tr class="separator:ac3924832e55889e051ae9ad0ab43c5c9 inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">canUnpack</a> () override</td></tr>
<tr class="memdesc:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:a2749869eea115d88727ccd4f60b0c474 inherit pub_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a2918e27dbfa2989e2bebbc9d55278502 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2918e27dbfa2989e2bebbc9d55278502">~PackUnix</a> ()</td></tr>
<tr class="separator:a2918e27dbfa2989e2bebbc9d55278502 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a4ffa6385cc3e65f0e0edf03f1a689 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a56a4ffa6385cc3e65f0e0edf03f1a689">getVersion</a> () const override</td></tr>
<tr class="separator:a56a4ffa6385cc3e65f0e0edf03f1a689 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bbbfbba5b4b2b33de9d7801bd58b2cb inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">getFilters</a> () const override</td></tr>
<tr class="separator:a6bbbfbba5b4b2b33de9d7801bd58b2cb inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362bc5d4016b05a3e36f20f364950602 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602">getStrategy</a> (<a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a362bc5d4016b05a3e36f20f364950602 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421acb038daef916fef027bd5e2a7427 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a421acb038daef916fef027bd5e2a7427">pack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="separator:a421acb038daef916fef027bd5e2a7427 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a62fec1407c3b1d45bd049df4b9f5e6f7">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#a62fec1407c3b1d45bd049df4b9f5e6f7" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a62fec1407c3b1d45bd049df4b9f5e6f7 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935b7961d8278ae7b19c53d6ef3fe3cf inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">canPack</a> () override</td></tr>
<tr class="separator:a935b7961d8278ae7b19c53d6ef3fe3cf inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120">canUnpack</a> () override</td></tr>
<tr class="memdesc:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:aea9d5cdf25d2396d775cbdf846664120 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1d471152b26686e619f2e8b6744366 inherit pub_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4f1d471152b26686e619f2e8b6744366">find_overlay_offset</a> (<a class="el" href="classMemBuffer.html">MemBuffer</a> const &amp;<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>)</td></tr>
<tr class="separator:a4f1d471152b26686e619f2e8b6744366 inherit pub_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a53a278648f1e7dd8409c81134ca110bc inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a53a278648f1e7dd8409c81134ca110bc">~Packer</a> () noexcept</td></tr>
<tr class="separator:a53a278648f1e7dd8409c81134ca110bc inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65e855c1df3707b0e054eac328a520c5 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a65e855c1df3707b0e054eac328a520c5">assertPacker</a> () const override</td></tr>
<tr class="separator:a65e855c1df3707b0e054eac328a520c5 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a06289b68601b59ba96d2d0bacec15aa6">initPackHeader</a> () final override</td></tr>
<tr class="memdesc:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">packheader util  <br /></td></tr>
<tr class="separator:a06289b68601b59ba96d2d0bacec15aa6 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcb7d756fd4914ecba61720460873904 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afcb7d756fd4914ecba61720460873904">updatePackHeader</a> () final override</td></tr>
<tr class="separator:afcb7d756fd4914ecba61720460873904 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0f04afb915721f1dc846115241895eb6">doPack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) final override</td></tr>
<tr class="memdesc:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">public entries called from class <a class="el" href="classPackMaster.html" title="dispatch to a concrete subclass of class PackerBase; see work.cpp">PackMaster</a>  <br /></td></tr>
<tr class="separator:a0f04afb915721f1dc846115241895eb6 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bfdeba49a1c92bcc0d7a5bb3e10345 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad4bfdeba49a1c92bcc0d7a5bb3e10345">doUnpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) final override</td></tr>
<tr class="separator:ad4bfdeba49a1c92bcc0d7a5bb3e10345 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cfe7201a1e90ac2df2e21778b09bf9c inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4cfe7201a1e90ac2df2e21778b09bf9c">doTest</a> () final override</td></tr>
<tr class="separator:a4cfe7201a1e90ac2df2e21778b09bf9c inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303bc70d7e7247ee535e9750a26c714a inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a303bc70d7e7247ee535e9750a26c714a">doList</a> () final override</td></tr>
<tr class="separator:a303bc70d7e7247ee535e9750a26c714a inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ac0c24f13d1ba6fa3e450539ea2933 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a01ac0c24f13d1ba6fa3e450539ea2933">doFileInfo</a> () final override</td></tr>
<tr class="separator:a01ac0c24f13d1ba6fa3e450539ea2933 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d96e4d4cbfe8e5f01711f47098ccc9 inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a73d96e4d4cbfe8e5f01711f47098ccc9">canUnpackVersion</a> (int version) const</td></tr>
<tr class="separator:a73d96e4d4cbfe8e5f01711f47098ccc9 inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c73202b82e8ce8970cca8881d9a82e inherit pub_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a31c73202b82e8ce8970cca8881d9a82e">canUnpackFormat</a> (int format) const</td></tr>
<tr class="separator:a31c73202b82e8ce8970cca8881d9a82e inherit pub_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:aad37a4b709f2215c2dd790268e3e596f inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aad37a4b709f2215c2dd790268e3e596f">~PackerBase</a> () noexcept</td></tr>
<tr class="separator:aad37a4b709f2215c2dd790268e3e596f inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe9d6b0ba4f236e640f8610b6688a6db inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#abe9d6b0ba4f236e640f8610b6688a6db">getVersion</a> () const =0</td></tr>
<tr class="separator:abe9d6b0ba4f236e640f8610b6688a6db inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6132cc9ef747b35947837d463aeac60 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa6132cc9ef747b35947837d463aeac60">getFormat</a> () const =0</td></tr>
<tr class="separator:aa6132cc9ef747b35947837d463aeac60 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf646b36342d8706c83e7c26fe47108e inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#adf646b36342d8706c83e7c26fe47108e">getName</a> () const =0</td></tr>
<tr class="separator:adf646b36342d8706c83e7c26fe47108e inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3699d96b9dc2a2531fa15d2cd348c110 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a3699d96b9dc2a2531fa15d2cd348c110">getFullName</a> (const <a class="el" href="structOptions.html">Options</a> *) const =0</td></tr>
<tr class="separator:a3699d96b9dc2a2531fa15d2cd348c110 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237baf1e217ee3aae78235baba4ad05c inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a237baf1e217ee3aae78235baba4ad05c">getCompressionMethods</a> (int method, int level) const =0</td></tr>
<tr class="separator:a237baf1e217ee3aae78235baba4ad05c inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0204dbe7106f6ac24aa712ad1ab3a5b8 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0204dbe7106f6ac24aa712ad1ab3a5b8">getFilters</a> () const =0</td></tr>
<tr class="separator:a0204dbe7106f6ac24aa712ad1ab3a5b8 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fc9b13105ad33ec6cca04b4abb507b inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a53fc9b13105ad33ec6cca04b4abb507b">canPack</a> ()=0</td></tr>
<tr class="separator:a53fc9b13105ad33ec6cca04b4abb507b inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa758490b3cc414478d262f753257d634 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa758490b3cc414478d262f753257d634">canUnpack</a> ()=0</td></tr>
<tr class="separator:aa758490b3cc414478d262f753257d634 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a83499a5451f8ab84d24fcc77f9b19 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#aa0a83499a5451f8ab84d24fcc77f9b19">assertPacker</a> () const =0</td></tr>
<tr class="separator:aa0a83499a5451f8ab84d24fcc77f9b19 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b4191ca6e4ca14fd425215afe129c1 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a41b4191ca6e4ca14fd425215afe129c1">initPackHeader</a> ()=0</td></tr>
<tr class="separator:a41b4191ca6e4ca14fd425215afe129c1 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1168410761f4965c7069d69628ebf203 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a1168410761f4965c7069d69628ebf203">updatePackHeader</a> ()=0</td></tr>
<tr class="separator:a1168410761f4965c7069d69628ebf203 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade8c0ee5d2501df14980c744b2fa47f4 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#ade8c0ee5d2501df14980c744b2fa47f4">doPack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:ade8c0ee5d2501df14980c744b2fa47f4 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c4c814d3afebb81309699ea0d8d8c6 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a28c4c814d3afebb81309699ea0d8d8c6">doUnpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:a28c4c814d3afebb81309699ea0d8d8c6 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90e5d42ed9b00879eb0811d9492cb6a9 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a90e5d42ed9b00879eb0811d9492cb6a9">doTest</a> ()=0</td></tr>
<tr class="separator:a90e5d42ed9b00879eb0811d9492cb6a9 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bb2533c208ee20b3951b1c4a8641084 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a4bb2533c208ee20b3951b1c4a8641084">doList</a> ()=0</td></tr>
<tr class="separator:a4bb2533c208ee20b3951b1c4a8641084 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30d9d32792e01d4ecb6d1068939be150 inherit pub_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a30d9d32792e01d4ecb6d1068939be150">doFileInfo</a> ()=0</td></tr>
<tr class="separator:a30d9d32792e01d4ecb6d1068939be150 inherit pub_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8c2bb372c567334edd586f78224bc956"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a8c2bb372c567334edd586f78224bc956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26dade234148980bd9f8a06ee31bf3c"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr</a> (<a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> const *ehdr) const</td></tr>
<tr class="separator:ab26dade234148980bd9f8a06ee31bf3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f8b3a6d6203c2a09d5058a18423fee2"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack</a> () override</td></tr>
<tr class="separator:a3f8b3a6d6203c2a09d5058a18423fee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71bc2f0e1a1ec856b3f9a08b63add0ae"><td class="memItemLeft" align="right" valign="top">virtual tribool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack</a> () override</td></tr>
<tr class="memdesc:a71bc2f0e1a1ec856b3f9a08b63add0ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack().">canUnpack()</a>.  <br /></td></tr>
<tr class="separator:a71bc2f0e1a1ec856b3f9a08b63add0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39227a27d84b3a9beeef257f95b00215"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:a39227a27d84b3a9beeef257f95b00215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eefcbb2a42d861b12d2c309d93771b8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, unsigned pre_xct_top)</td></tr>
<tr class="separator:a6eefcbb2a42d861b12d2c309d93771b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c3d3d66cd14ea19fc44d0f90274092"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:ae4c3d3d66cd14ea19fc44d0f90274092"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34abb7fc5a62a52800339d603f78f562"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:a34abb7fc5a62a52800339d603f78f562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc239684c1874f0a29ee97eca4e8d4d6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override</td></tr>
<tr class="separator:afc239684c1874f0a29ee97eca4e8d4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc61917c51c71bfcb0f9af20ba7714d6"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, <a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *ehdro)</td></tr>
<tr class="separator:acc61917c51c71bfcb0f9af20ba7714d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b789474661dc2f8e40182aae29ee479"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a4b789474661dc2f8e40182aae29ee479"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a4b789474661dc2f8e40182aae29ee479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19e5a4000bc5cc063dee2a31db657e9"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym</a> (unsigned orig_file_size, <a class="el" href="classOutputFile.html">OutputFile</a> *)</td></tr>
<tr class="separator:ab19e5a4000bc5cc063dee2a31db657e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c315a3286632db9c874ca7a65bb69d"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *const fo, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;o_elfhdrs, unsigned &amp;c_adler, unsigned &amp;u_adler, unsigned const orig_file_size)</td></tr>
<tr class="separator:ad2c315a3286632db9c874ca7a65bb69d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c843122a8d3e44da9fe458643c2589"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT</a> (unsigned old_dtinit, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdro, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *dynhdr, <a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:a03c843122a8d3e44da9fe458643c2589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b7d0324926f0404e61dc997833544f7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64</a> (<a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_rela, <a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rela0, unsigned relasz, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> const old_dtinit, <a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:a3b7d0324926f0404e61dc997833544f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18903ac12b1370cdf82daef90aa27717"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, void const *proto, unsigned const brka) override</td></tr>
<tr class="separator:a18903ac12b1370cdf82daef90aa27717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab000c2eb42eb50ba4dd570fb0e20e4f2"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *) override</td></tr>
<tr class="separator:ab000c2eb42eb50ba4dd570fb0e20e4f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf98749f15000ddd7c39f330ec145341"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341">buildLinuxLoader</a> (<a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const proto, unsigned const szproto, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const fold, unsigned const szfold, <a class="el" href="classFilter.html">Filter</a> const *ft)</td></tr>
<tr class="separator:acf98749f15000ddd7c39f330ec145341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac405aa11c3c356e93dc38f2365701466"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk</a> (const <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr, int <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) const</td></tr>
<tr class="separator:ac405aa11c3c356e93dc38f2365701466"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e7655b7e6bff51e5d2d9f8e203a4e3"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ae5e7655b7e6bff51e5d2d9f8e203a4e3">patchLoader</a> () override</td></tr>
<tr class="separator:ae5e7655b7e6bff51e5d2d9f8e203a4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdf1b9c1ce448039ac4eaec55de40c3e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afdf1b9c1ce448039ac4eaec55de40c3e">updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="separator:afdf1b9c1ce448039ac4eaec55de40c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c77e1df704fbb16e2d048937bdb0663"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *const <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, unsigned const k, unsigned const <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>)</td></tr>
<tr class="separator:a6c77e1df704fbb16e2d048937bdb0663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4b086d6062198ab02e25fcc4cd5a2c3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1</a> (<a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> const *rela, int sz)</td></tr>
<tr class="separator:af4b086d6062198ab02e25fcc4cd5a2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d0e91095e3b2cdfbc913e7bc25abf8"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup</a> (char const *) const</td></tr>
<tr class="separator:a02d0e91095e3b2cdfbc913e7bc25abf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a047a7534432a2a090049ba2eee67bfb9"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a> (<a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>) const</td></tr>
<tr class="separator:a047a7534432a2a090049ba2eee67bfb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7458e15967252113c7b45332b973287"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a> (<a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> addr, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdr, unsigned phnum)</td></tr>
<tr class="separator:ac7458e15967252113c7b45332b973287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af746b688a3b13d3bf0895095ae5c3212"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">elf_find_ptype</a> (unsigned type, <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdr0, unsigned phnum)</td></tr>
<tr class="separator:af746b688a3b13d3bf0895095ae5c3212"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a154b135064ce4e1a6e58ba23d9e50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name</a> (char const *) const</td></tr>
<tr class="separator:a19a154b135064ce4e1a6e58ba23d9e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af80d289e1d9fe56882aa494f2afc0e9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a> (unsigned) const</td></tr>
<tr class="separator:af80d289e1d9fe56882aa494f2afc0e9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a39ae989d67ccb9239bcff7750a6e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a> (unsigned) const</td></tr>
<tr class="separator:ab6a39ae989d67ccb9239bcff7750a6e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c99e9dc4cb9e94309dfb49b13ff09d"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a> (unsigned dt_type, unsigned sh_type)</td></tr>
<tr class="separator:ab5c99e9dc4cb9e94309dfb49b13ff09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc068ab20eb6f313fc0abbda76c62a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets</a> (<a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *const dynp0)</td></tr>
<tr class="separator:acbc068ab20eb6f313fc0abbda76c62a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c2c8ef98d3669846a7f666f6833698"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">is_LOAD64</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *phdr) const</td></tr>
<tr class="separator:aa0c2c8ef98d3669846a7f666f6833698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae528cb01cbf686b624e2fffe159ad5b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *)</td></tr>
<tr class="separator:ae528cb01cbf686b624e2fffe159ad5b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d86b1c186506105d0a1143fd364c014"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *)</td></tr>
<tr class="separator:a5d86b1c186506105d0a1143fd364c014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34544f047b9808c7416a3a3666a7d6bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a> (<a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_filesz)</td></tr>
<tr class="separator:a34544f047b9808c7416a3a3666a7d6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1befccbbdde5d8977b9d2e5883507d4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a> (unsigned) const</td></tr>
<tr class="separator:ad1befccbbdde5d8977b9d2e5883507d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fb0d975feeb7b1b02f9e4a22ab227ed"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic</a> (unsigned) const</td></tr>
<tr class="separator:a5fb0d975feeb7b1b02f9e4a22ab227ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4204f3ad0b4eff8655e10f62ac640a22"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a> (unsigned) const override</td></tr>
<tr class="separator:a4204f3ad0b4eff8655e10f62ac640a22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4cfbd2d81ab91d393764f41c48ad44"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">find_dt_ndx</a> (<a class="el" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> rva)</td></tr>
<tr class="separator:a4b4cfbd2d81ab91d393764f41c48ad44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b85151ad06f0b457773686f047903f4"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS</a> (<a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *sym, unsigned long delta)</td></tr>
<tr class="separator:a6b85151ad06f0b457773686f047903f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd6eb82fa691109eb7fa267d6c8570f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx</a> (<a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *)</td></tr>
<tr class="separator:abd6eb82fa691109eb7fa267d6c8570f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd825cbaf5a768993a7f0b90a24c7a4c"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a> (unsigned st_name, unsigned symnum) const</td></tr>
<tr class="separator:acd825cbaf5a768993a7f0b90a24c7a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0587b38413f853b20625a28bf2a369e8"><td class="memItemLeft" align="right" valign="top">char const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name</a> (unsigned symnum, unsigned relnum) const</td></tr>
<tr class="separator:a0587b38413f853b20625a28bf2a369e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426e7f90fc3af416c18a3deb0571e4b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a426e7f90fc3af416c18a3deb0571e4b1">packed_struct</a> (cprElfHdr1)</td></tr>
<tr class="separator:a426e7f90fc3af416c18a3deb0571e4b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e05ec4a8acf7cac11023b7a57aad85"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a95e05ec4a8acf7cac11023b7a57aad85">packed_struct</a> (cprElfHdr2)</td></tr>
<tr class="separator:a95e05ec4a8acf7cac11023b7a57aad85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c753db61a98f514bc1b083069692374"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a5c753db61a98f514bc1b083069692374">packed_struct</a> (cprElfHdr3)</td></tr>
<tr class="separator:a5c753db61a98f514bc1b083069692374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36103546d5ed97790537a6f7c6f0e02b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a36103546d5ed97790537a6f7c6f0e02b">packed_struct</a> (cprElfHdr4)</td></tr>
<tr class="separator:a36103546d5ed97790537a6f7c6f0e02b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3f937f49c167ed74510c02a5afe10a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aec3f937f49c167ed74510c02a5afe10a">packed_struct</a> (cprElfShdr3)</td></tr>
<tr class="separator:aec3f937f49c167ed74510c02a5afe10a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a622b799334a48cb6634e790f2566248a inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">getCompressionMethods</a> (int method, int level) const override</td></tr>
<tr class="separator:a622b799334a48cb6634e790f2566248a inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af01b0f8403997790f28a72329e7b28f6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af01b0f8403997790f28a72329e7b28f6">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:af01b0f8403997790f28a72329e7b28f6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619d0ed2f97d37150ed5b1437c67b6f1 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a619d0ed2f97d37150ed5b1437c67b6f1">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:a619d0ed2f97d37150ed5b1437c67b6f1 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3409fd940ae9b30dc51e68f69e0160f6 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;) override=0</td></tr>
<tr class="separator:a3409fd940ae9b30dc51e68f69e0160f6 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378dd6608963beeae5bb6393ef4b23d5 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a378dd6608963beeae5bb6393ef4b23d5">generateElfHdr</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, void const *proto, unsigned const brka)=0</td></tr>
<tr class="separator:a378dd6608963beeae5bb6393ef4b23d5 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addaacfe47a36eb9d70929a58ba311e29 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">defineSymbols</a> (<a class="el" href="classFilter.html">Filter</a> const *)</td></tr>
<tr class="separator:addaacfe47a36eb9d70929a58ba311e29 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0c06e7772712b8f5cb8a7101a2e052 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">addStubEntrySections</a> (<a class="el" href="classFilter.html">Filter</a> const *, unsigned m_decompr)</td></tr>
<tr class="separator:afe0c06e7772712b8f5cb8a7101a2e052 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo) override</td></tr>
<tr class="memdesc:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c" title="Generic Unix unpack().">unpack()</a>.  <br /></td></tr>
<tr class="separator:a0d45a89448e9776719f57f84b11f828c inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7cb95fd27c29245be62f4e388fc3f09 inherit pro_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac7cb95fd27c29245be62f4e388fc3f09">elf_unsigned_dynamic</a> (unsigned) const =0</td></tr>
<tr class="separator:ac7cb95fd27c29245be62f4e388fc3f09 inherit pro_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a326420727ef64feb46ddcd2f12b96a96 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a326420727ef64feb46ddcd2f12b96a96">PackUnix</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a326420727ef64feb46ddcd2f12b96a96 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67466cfa57e26dc50991e0bf9a610a05 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a67466cfa57e26dc50991e0bf9a610a05">pack1</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a67466cfa57e26dc50991e0bf9a610a05 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a90e16aac8e8c0e11180da8082bfd0f inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2a90e16aac8e8c0e11180da8082bfd0f">pack2</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a2a90e16aac8e8c0e11180da8082bfd0f inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573f3c8c4c540f51c2a7b168535d4741 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a573f3c8c4c540f51c2a7b168535d4741">pack3</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a573f3c8c4c540f51c2a7b168535d4741 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d92de9aedc1747be87ef5968952838c inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">pack4</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *, <a class="el" href="classFilter.html">Filter</a> &amp;)</td></tr>
<tr class="separator:a7d92de9aedc1747be87ef5968952838c inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b328c80b7172751702a447aed1afb2 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ac4b328c80b7172751702a447aed1afb2">patchLoader</a> ()=0</td></tr>
<tr class="separator:ac4b328c80b7172751702a447aed1afb2 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20942814df6e718e04462ac03aebe08 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#af20942814df6e718e04462ac03aebe08">patchLoaderChecksum</a> ()</td></tr>
<tr class="separator:af20942814df6e718e04462ac03aebe08 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cee24303a1b5e7676c8d98acada2be0 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a2cee24303a1b5e7676c8d98acada2be0">updateLoader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *)=0</td></tr>
<tr class="separator:a2cee24303a1b5e7676c8d98acada2be0 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aced1a9bb3fee3c231bfc90051224a6dd inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aced1a9bb3fee3c231bfc90051224a6dd">writePackHeader</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)</td></tr>
<tr class="separator:aced1a9bb3fee3c231bfc90051224a6dd inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aeddca239c9109efe577257d5ac798ba7">checkCompressionRatio</a> (unsigned, unsigned) const override</td></tr>
<tr class="memdesc:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic Unix <a class="el" href="classPackUnix.html#a421acb038daef916fef027bd5e2a7427">pack()</a>.  <br /></td></tr>
<tr class="separator:aeddca239c9109efe577257d5ac798ba7 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3f398fa4a3b34fd79f441e3069f78b1 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a> (const <a class="el" href="structPackUnix_1_1Extent.html">Extent</a> &amp;x, <a class="el" href="classFilter.html">Filter</a> *, <a class="el" href="classOutputFile.html">OutputFile</a> *, unsigned hdr_len=0, unsigned b_extra=0, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:ad3f398fa4a3b34fd79f441e3069f78b1 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16d64e1b95f1dcf5f128665b83660f6 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a> (unsigned wanted, <a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned &amp;c_adler, unsigned &amp;u_adler, bool first_PF_X, int is_rewrite=false)</td></tr>
<tr class="separator:ab16d64e1b95f1dcf5f128665b83660f6 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bd8340ae0c422e428d1a0874791c47b inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4bd8340ae0c422e428d1a0874791c47b">packed_struct</a> (<a class="el" href="structb__info.html">b_info</a>)</td></tr>
<tr class="separator:a4bd8340ae0c422e428d1a0874791c47b inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40aab492369d544f29a717b571d7f004 inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a40aab492369d544f29a717b571d7f004">packed_struct</a> (<a class="el" href="structl__info.html">l_info</a>)</td></tr>
<tr class="separator:a40aab492369d544f29a717b571d7f004 inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22613c8b5d9a79ac5cdeae1d6664537d inherit pro_methods_classPackUnix"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a22613c8b5d9a79ac5cdeae1d6664537d">packed_struct</a> (<a class="el" href="structp__info.html">p_info</a>)</td></tr>
<tr class="separator:a22613c8b5d9a79ac5cdeae1d6664537d inherit pro_methods_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a133376f040e1a9677374b6b799a0b630 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a133376f040e1a9677374b6b799a0b630">Packer</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:a133376f040e1a9677374b6b799a0b630 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd46726f44d4d6ecbb38ca0b682abff inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0dd46726f44d4d6ecbb38ca0b682abff">testUnpackVersion</a> (int version) const <a class="el" href="conf_8h.html#aac314c25ecc359ec37c364e623d312c1">may_throw</a></td></tr>
<tr class="separator:a0dd46726f44d4d6ecbb38ca0b682abff inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb5aa92c52d38f3c7f4cc75d111debd inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abcb5aa92c52d38f3c7f4cc75d111debd">testUnpackFormat</a> (int format) const <a class="el" href="conf_8h.html#aac314c25ecc359ec37c364e623d312c1">may_throw</a></td></tr>
<tr class="separator:abcb5aa92c52d38f3c7f4cc75d111debd inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4856b75dcd93c17a197b3cc0f6f631b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa4856b75dcd93c17a197b3cc0f6f631b">pack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:aa4856b75dcd93c17a197b3cc0f6f631b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa29c743954e67295ef1793155a96c7d3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa29c743954e67295ef1793155a96c7d3">unpack</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo)=0</td></tr>
<tr class="separator:aa29c743954e67295ef1793155a96c7d3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4224ba769e4e9f5839f4e8a320a60e09">test</a> ()</td></tr>
<tr class="memdesc:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">default actions  <br /></td></tr>
<tr class="separator:a4224ba769e4e9f5839f4e8a320a60e09 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2a1baf71486055fcf2010eff9ddad3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aec2a1baf71486055fcf2010eff9ddad3">list</a> ()</td></tr>
<tr class="separator:aec2a1baf71486055fcf2010eff9ddad3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758c9c8f833608e7744538587c72653d inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a758c9c8f833608e7744538587c72653d">fileInfo</a> ()</td></tr>
<tr class="separator:a758c9c8f833608e7744538587c72653d inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e">compress</a> (<a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) i_ptr, unsigned i_len, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) o_ptr, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf=nullptr)</td></tr>
<tr class="memdesc:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">compress - wrap call to low-level <a class="el" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress()</a>  <br /></td></tr>
<tr class="separator:add5cc1c8eff3bbc8aaf7ec0cf03cb82e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">decompress</a> (<a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) in, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) out, bool verify_checksum=true, <a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="memdesc:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">decompress  <br /></td></tr>
<tr class="separator:ab53d9fc8308aa5467d38425ad3673b29 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9864c9f06e96c60330ae5df35f285d9 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab9864c9f06e96c60330ae5df35f285d9">checkDefaultCompressionRatio</a> (unsigned u_len, unsigned c_len) const</td></tr>
<tr class="separator:ab9864c9f06e96c60330ae5df35f285d9 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2456e468bbb9b026d301c3e668f28d05 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a2456e468bbb9b026d301c3e668f28d05">checkCompressionRatio</a> (unsigned u_len, unsigned c_len) const</td></tr>
<tr class="separator:a2456e468bbb9b026d301c3e668f28d05 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc1b90e1cf536d0dd0bcd90799d6195f inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#acc1b90e1cf536d0dd0bcd90799d6195f">checkFinalCompressionRatio</a> (const <a class="el" href="classOutputFile.html">OutputFile</a> *fo) const</td></tr>
<tr class="separator:acc1b90e1cf536d0dd0bcd90799d6195f inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0ae5b698e68d64585e5be87a256f675 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a> (<a class="el" href="classFilter.html">Filter</a> *ft, const unsigned overlap_range, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf, int filter_strategy=0, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:ad0ae5b698e68d64585e5be87a256f675 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeabf0f70b5c414b04a5d7a895c50351b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aeabf0f70b5c414b04a5d7a895c50351b">compressWithFilters</a> (<a class="el" href="classFilter.html">Filter</a> *ft, const unsigned overlap_range, const <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> *cconf, int filter_strategy, unsigned filter_buf_off, unsigned compress_ibuf_off, unsigned compress_obuf_off, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *const hdr_ptr, unsigned hdr_len, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:aeabf0f70b5c414b04a5d7a895c50351b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c29dbab3c13461ccccdf08ba3b6cde2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a6c29dbab3c13461ccccdf08ba3b6cde2">compressWithFilters</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *i_ptr, unsigned i_len, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *o_ptr, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *f_ptr, unsigned f_len, <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *const hdr_ptr, unsigned hdr_len, <a class="el" href="classFilter.html">Filter</a> *parm_ft, unsigned overlap_range, <a class="el" href="structupx__compress__config__t.html">upx_compress_config_t</a> const *cconf, int filter_strategy, bool inhibit_compression_check=false)</td></tr>
<tr class="separator:a6c29dbab3c13461ccccdf08ba3b6cde2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78">testOverlappingDecompression</a> (const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *tbuf, unsigned overlap_overhead) const</td></tr>
<tr class="memdesc:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">overlapping decompression  <br /></td></tr>
<tr class="separator:ae0b134c6d419c733cb3283f4403a6f78 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af11da16aeb96ac7ccd05f31472793ca7">findOverlapOverhead</a> (const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *tbuf, unsigned range=0, unsigned upper_limit=~0u) const</td></tr>
<tr class="memdesc:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find overhead for in-place decompression in a heuristic way (using a binary search).  <br /></td></tr>
<tr class="separator:af11da16aeb96ac7ccd05f31472793ca7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98836d189865b8496d759334c6257608 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a98836d189865b8496d759334c6257608">verifyOverlappingDecompression</a> (<a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="separator:a98836d189865b8496d759334c6257608 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b1f4ce72c7ddc53b424653ffde5ff8 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a34b1f4ce72c7ddc53b424653ffde5ff8">verifyOverlappingDecompression</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *o_ptr, unsigned o_size, <a class="el" href="classFilter.html">Filter</a> *ft=nullptr)</td></tr>
<tr class="separator:a34b1f4ce72c7ddc53b424653ffde5ff8 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1f9499f529513c9d26fc647968dfe7e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad1f9499f529513c9d26fc647968dfe7e">patchPackHeader</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen) final</td></tr>
<tr class="separator:ad1f9499f529513c9d26fc647968dfe7e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeee17a50e4f350eebc14b1704ec9a39 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afeee17a50e4f350eebc14b1704ec9a39">getPackHeader</a> (const void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, bool allow_incompressible=false) final</td></tr>
<tr class="separator:afeee17a50e4f350eebc14b1704ec9a39 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42fa62442193d76789d049cbc3635bd2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a42fa62442193d76789d049cbc3635bd2">readPackHeader</a> (int len, bool allow_incompressible=false) final</td></tr>
<tr class="separator:a42fa62442193d76789d049cbc3635bd2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b9cb85a2382ebc043228597992283b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a14b9cb85a2382ebc043228597992283b">checkAlreadyPacked</a> (const void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen) final</td></tr>
<tr class="separator:a14b9cb85a2382ebc043228597992283b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e0b2c2bbf482db53bf6a40811348d45 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a1e0b2c2bbf482db53bf6a40811348d45">buildLoader</a> (const <a class="el" href="classFilter.html">Filter</a> *ft)=0</td></tr>
<tr class="separator:a1e0b2c2bbf482db53bf6a40811348d45 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fe94299cf76c70de7ed953aa774330 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a86b1e444574bf0cf210927b9494cdc95">Linker</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa7fe94299cf76c70de7ed953aa774330">newLinker</a> () const =0</td></tr>
<tr class="separator:aa7fe94299cf76c70de7ed953aa774330 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9f88864fd7faa59c8130bd59a811a3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a> ()</td></tr>
<tr class="separator:a2c9f88864fd7faa59c8130bd59a811a3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e094d3b47373817a66457952f26dc70 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">getLoader</a> () const</td></tr>
<tr class="separator:a6e094d3b47373817a66457952f26dc70 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade07bbe55dcfe9cc68a6c785e9b0c33c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ade07bbe55dcfe9cc68a6c785e9b0c33c">getLoaderSize</a> () const</td></tr>
<tr class="separator:ade07bbe55dcfe9cc68a6c785e9b0c33c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af6a45574697d68421e70baef1c8d8c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a> (const void *pdata, int plen, int small=-1, int pextra=0)</td></tr>
<tr class="separator:a4af6a45574697d68421e70baef1c8d8c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a516182985490860d361a8266fa418235 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a516182985490860d361a8266fa418235 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37fb57f49864a5d22b43a13f4fc52923 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a37fb57f49864a5d22b43a13f4fc52923">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a37fb57f49864a5d22b43a13f4fc52923 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a762161bd9480b458295cb0393633e224 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a762161bd9480b458295cb0393633e224">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a762161bd9480b458295cb0393633e224 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc42fc3224a7d9c6f4c9bc304392bab2 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abc42fc3224a7d9c6f4c9bc304392bab2">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:abc42fc3224a7d9c6f4c9bc304392bab2 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d8132ddf586284fc04b4798aac0597 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a69d8132ddf586284fc04b4798aac0597">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a69d8132ddf586284fc04b4798aac0597 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9320791ae051214ea71d7dade2c7c8e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ab9320791ae051214ea71d7dade2c7c8e">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:ab9320791ae051214ea71d7dade2c7c8e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcf659cf5575651c05425f9943f3cf7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#adfcf659cf5575651c05425f9943f3cf7">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:adfcf659cf5575651c05425f9943f3cf7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20bd3abaf7f257ad69660ce6624585c6 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a20bd3abaf7f257ad69660ce6624585c6">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a20bd3abaf7f257ad69660ce6624585c6 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a813dc5ab0d1fb4bebb24261a297e5a87 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a813dc5ab0d1fb4bebb24261a297e5a87">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:a813dc5ab0d1fb4bebb24261a297e5a87 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2163953fd8aa0c3af6085c03425931c inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aa2163953fd8aa0c3af6085c03425931c">addLoader</a> (<a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>, <a class="el" href="packer_8h.html#ac4cf4b2ab929bd23951a8676eeac086b">C</a>)</td></tr>
<tr class="separator:aa2163953fd8aa0c3af6085c03425931c inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf81a88111b09b6bd3353864484510b7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aaf81a88111b09b6bd3353864484510b7">addLoaderVA</a> (const char *s,...)</td></tr>
<tr class="separator:aaf81a88111b09b6bd3353864484510b7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c72885ba3799acf227862f721ddd5ab inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab">hasLoaderSection</a> (const char *name) const</td></tr>
<tr class="separator:a0c72885ba3799acf227862f721ddd5ab inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebb62f4bf76fae3dcf2c64aac6bbf5ce inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aebb62f4bf76fae3dcf2c64aac6bbf5ce">getLoaderSection</a> (const char *name, int *slen=nullptr) const</td></tr>
<tr class="separator:aebb62f4bf76fae3dcf2c64aac6bbf5ce inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5239dbc85d3edd59b558deb94ed8e40d inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a5239dbc85d3edd59b558deb94ed8e40d">getLoaderSectionStart</a> (const char *name, int *slen=nullptr) const</td></tr>
<tr class="separator:a5239dbc85d3edd59b558deb94ed8e40d inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968ed89b0a113c54e982a497fdb8a97b inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a968ed89b0a113c54e982a497fdb8a97b">getDefaultCompressionMethods_8</a> (int method, int level, int small=-1) const</td></tr>
<tr class="separator:a968ed89b0a113c54e982a497fdb8a97b inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac91d266e1612ca6108035e22fe8b1203 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">const int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac91d266e1612ca6108035e22fe8b1203">getDefaultCompressionMethods_le32</a> (int method, int level, int small=-1) const</td></tr>
<tr class="separator:ac91d266e1612ca6108035e22fe8b1203 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">prepareMethods</a> (int *methods, int ph_method, const int *all_methods) const</td></tr>
<tr class="memdesc:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">void <a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters()</a>: Try compression with several methods and filters, choose the best / or first working one.  <br /></td></tr>
<tr class="separator:a476d801b02376434abccfd4b84e057fe inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a173933a7adb7d38dcc12ee8043457aa4 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a173933a7adb7d38dcc12ee8043457aa4">getDecompressorSections</a> () const</td></tr>
<tr class="separator:a173933a7adb7d38dcc12ee8043457aa4 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28302b0171618cd0b4949ab6c026dc31 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a28302b0171618cd0b4949ab6c026dc31">getDecompressorWrkmemSize</a> () const</td></tr>
<tr class="separator:a28302b0171618cd0b4949ab6c026dc31 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2cf462e56fc1876b93f047d8b222ce3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac2cf462e56fc1876b93f047d8b222ce3">defineDecompressorSymbols</a> ()</td></tr>
<tr class="separator:ac2cf462e56fc1876b93f047d8b222ce3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a02f8ef879cf94330288554bc525e8fd3">isValidFilter</a> (int filter_id) const</td></tr>
<tr class="memdesc:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">filter util; see class <a class="el" href="classFilterImpl.html" title="We don&#39;t want a full OO interface here because of certain implementation speed reasons.">FilterImpl</a>  <br /></td></tr>
<tr class="separator:a02f8ef879cf94330288554bc525e8fd3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0525cfe60bfaae0ef0cf3efde338cd57 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0525cfe60bfaae0ef0cf3efde338cd57">optimizeFilter</a> (<a class="el" href="classFilter.html">Filter</a> *, const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *, unsigned) const</td></tr>
<tr class="separator:a0525cfe60bfaae0ef0cf3efde338cd57 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a451951590472595cfd04a238624d1 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a07a451951590472595cfd04a238624d1">addFilter32</a> (int filter_id)</td></tr>
<tr class="separator:a07a451951590472595cfd04a238624d1 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec73793b1e58249dff949fad71520901 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aec73793b1e58249dff949fad71520901">defineFilterSymbols</a> (const <a class="el" href="classFilter.html">Filter</a> *ft)</td></tr>
<tr class="separator:aec73793b1e58249dff949fad71520901 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b47a6575142d8a8fafd88256c8a26e8 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a0b47a6575142d8a8fafd88256c8a26e8">checkOverlay</a> (unsigned overlay)</td></tr>
<tr class="separator:a0b47a6575142d8a8fafd88256c8a26e8 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a781dc4327dd4bcab50a94bfc85f52802 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a781dc4327dd4bcab50a94bfc85f52802">copyOverlay</a> (<a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned overlay, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;<a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, bool do_seek=true)</td></tr>
<tr class="separator:a781dc4327dd4bcab50a94bfc85f52802 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3c0c359a5fa3597aeef5dcb6783b53 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">virtual unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a1e3c0c359a5fa3597aeef5dcb6783b53">getRandomId</a> () const</td></tr>
<tr class="separator:a1e3c0c359a5fa3597aeef5dcb6783b53 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90882bb1ff87aee14e72be4d953064d9 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a90882bb1ff87aee14e72be4d953064d9">patch_be16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:a90882bb1ff87aee14e72be4d953064d9 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d3293543c5f6b6ab634203eb6f7e6d7 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a8d3293543c5f6b6ab634203eb6f7e6d7">patch_be16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a8d3293543c5f6b6ab634203eb6f7e6d7 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba76e5b8b8d7504893344a9a166c7364 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#aba76e5b8b8d7504893344a9a166c7364">patch_be32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:aba76e5b8b8d7504893344a9a166c7364 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4245c8c4fc839068b12989ee67b5f351 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4245c8c4fc839068b12989ee67b5f351">patch_be32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a4245c8c4fc839068b12989ee67b5f351 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affcb9d7db4f85cd7a88ba890da7965c6 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#affcb9d7db4f85cd7a88ba890da7965c6">patch_le16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:affcb9d7db4f85cd7a88ba890da7965c6 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9336ee74f309cd9a47b91c426dc260a inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac9336ee74f309cd9a47b91c426dc260a">patch_le16</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:ac9336ee74f309cd9a47b91c426dc260a inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8f9280a6a5ddf2cbb669bd9a4aabf92 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ac8f9280a6a5ddf2cbb669bd9a4aabf92">patch_le32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, unsigned old, unsigned new_)</td></tr>
<tr class="separator:ac8f9280a6a5ddf2cbb669bd9a4aabf92 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721bade28a259d93e7a7e0f93509f6e5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a721bade28a259d93e7a7e0f93509f6e5">patch_le32</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, const void *old, unsigned new_)</td></tr>
<tr class="separator:a721bade28a259d93e7a7e0f93509f6e5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af51db683baf7d75a65f48429b77db475">checkPatch</a> (void *<a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, int blen, int boff, int <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>)</td></tr>
<tr class="memdesc:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">patch util for loader  <br /></td></tr>
<tr class="separator:af51db683baf7d75a65f48429b77db475 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad01e10cd32d88f80d316455b55bcb1a5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a> (const void *p) const noexcept</td></tr>
<tr class="separator:ad01e10cd32d88f80d316455b55bcb1a5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a54fc63360923941cec0aa6060ae01 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a> (const void *p) const noexcept</td></tr>
<tr class="separator:a47a54fc63360923941cec0aa6060ae01 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae85a3d8295d26480a18f0abea6912451 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a> (const void *p) const noexcept</td></tr>
<tr class="separator:ae85a3d8295d26480a18f0abea6912451 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860499fa0849a7c7a7c4d43ee084f76e inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a> (void *p, unsigned v) noexcept</td></tr>
<tr class="separator:a860499fa0849a7c7a7c4d43ee084f76e inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9cad2c8624ee68213d01eb606be0382 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a> (void *p, unsigned v) noexcept</td></tr>
<tr class="separator:af9cad2c8624ee68213d01eb606be0382 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ee35ba69e590153658a06d471c4184 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a> (void *p, <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> v) noexcept</td></tr>
<tr class="separator:a36ee35ba69e590153658a06d471c4184 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe77995491ee79eda48b8ca480687bb5 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#abe77995491ee79eda48b8ca480687bb5">OwningPointer</a> (<a class="el" href="classUiPacker.html">UiPacker</a>) uip</td></tr>
<tr class="separator:abe77995491ee79eda48b8ca480687bb5 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82badd32867f847f506da476cce326f3 inherit pro_methods_classPacker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a82badd32867f847f506da476cce326f3">OwningPointer</a> (<a class="el" href="conf_8h.html#a86b1e444574bf0cf210927b9494cdc95">Linker</a>) linker</td></tr>
<tr class="separator:a82badd32867f847f506da476cce326f3 inherit pro_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:af7608c13cbf253eea98ad6eb7cee8b61 inherit pro_methods_classPackerBase"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#af7608c13cbf253eea98ad6eb7cee8b61">PackerBase</a> (<a class="el" href="classInputFile.html">InputFile</a> *f)</td></tr>
<tr class="separator:af7608c13cbf253eea98ad6eb7cee8b61 inherit pro_methods_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-methods" name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:a3af121bec7063696881a30fd96d8c96b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a3af121bec7063696881a30fd96d8c96b">compileTimeAssertions</a> ()</td></tr>
<tr class="separator:a3af121bec7063696881a30fd96d8c96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a9cdb0429d3e2faba00ef2d67b2c628c0 inherit pro_static_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">elf_hash</a> (char const *)</td></tr>
<tr class="separator:a9cdb0429d3e2faba00ef2d67b2c628c0 inherit pro_static_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a504fe912dd96ebfcd443b89dd425317f inherit pro_static_methods_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">gnu_hash</a> (char const *)</td></tr>
<tr class="separator:a504fe912dd96ebfcd443b89dd425317f inherit pro_static_methods_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#af727b6b460db28607ea976e650dbb16f">handleStub</a> (<a class="el" href="classInputFile.html">InputFile</a> *<a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>, <a class="el" href="classOutputFile.html">OutputFile</a> *fo, unsigned <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>)</td></tr>
<tr class="memdesc:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">file i/o utils  <br /></td></tr>
<tr class="separator:af727b6b460db28607ea976e650dbb16f inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a55f33ae9a3b893a0811404d4aa85592e">optimizeReloc</a> (unsigned relocnum, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) relocs, <a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) out, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) image, unsigned image_size, int bits, bool bswap, int *big)</td></tr>
<tr class="memdesc:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">sort and delta-compress relocations with optional bswap within image returns number of <b>bytes</b> written to 'out'  <br /></td></tr>
<tr class="separator:a55f33ae9a3b893a0811404d4aa85592e inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#ad50f653ca4844165671764219a33eb74">unoptimizeReloc</a> (<a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(const <a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) &amp;in, <a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;out, <a class="el" href="xspan_8h.html#a49f7592ebec61af4a9ff449f60ea2f8e">SPAN_P</a>(<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) image, unsigned image_size, int bits, bool bswap)</td></tr>
<tr class="memdesc:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">delta-decompress relocations advances 'in' allocates 'out' and returns number of <b>relocs</b> written to 'out'  <br /></td></tr>
<tr class="separator:ad50f653ca4844165671764219a33eb74 inherit pro_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ad10baff449a3519d7386cf0519374a15"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a></td></tr>
<tr class="separator:ad10baff449a3519d7386cf0519374a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa11131540dea71d341de36cf39325c17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a></td></tr>
<tr class="separator:aa11131540dea71d341de36cf39325c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43aff2a214341cb27a7f07ec997e443d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a></td></tr>
<tr class="separator:a43aff2a214341cb27a7f07ec997e443d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923425254661af8d150e99087569da9f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a></td></tr>
<tr class="separator:a923425254661af8d150e99087569da9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4fe837eb5fd3cff1d6b76758ab9a58c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a> [<a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a>]</td></tr>
<tr class="separator:ac4fe837eb5fd3cff1d6b76758ab9a58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07514aa5c9db6acc6b2bdad24113943"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a></td></tr>
<tr class="separator:ad07514aa5c9db6acc6b2bdad24113943"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689b9c7fa3bd70c22d9703fbcc288819"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a></td></tr>
<tr class="separator:a689b9c7fa3bd70c22d9703fbcc288819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d71085c7179ef591535acdc5347e2dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a></td></tr>
<tr class="separator:a0d71085c7179ef591535acdc5347e2dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e16265acea35917d1e57a65fb5ffc70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a></td></tr>
<tr class="separator:a0e16265acea35917d1e57a65fb5ffc70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9da32af4a0e9814653edd2d72c3e2dda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a></td></tr>
<tr class="separator:a9da32af4a0e9814653edd2d72c3e2dda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a847fd85f9cecd8abe44afd346f2ae168"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a></td></tr>
<tr class="separator:a847fd85f9cecd8abe44afd346f2ae168"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf726e188c8c471755ee3f00cf7c4226"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a></td></tr>
<tr class="separator:acf726e188c8c471755ee3f00cf7c4226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f97eabbbe04201c83cd03c9103ce88"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a></td></tr>
<tr class="separator:a53f97eabbbe04201c83cd03c9103ce88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d14a83cf8a4300cf26946d4c16f8421"><td class="memItemLeft" align="right" valign="top">unsigned int const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a></td></tr>
<tr class="separator:a9d14a83cf8a4300cf26946d4c16f8421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a367c1ee6e43cb116f980f9046a0fce"><td class="memItemLeft" align="right" valign="top">unsigned int const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a></td></tr>
<tr class="separator:a1a367c1ee6e43cb116f980f9046a0fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af841cae6e65e727111a3e5bc134135c0"><td class="memItemLeft" align="right" valign="top">unsigned int const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a></td></tr>
<tr class="separator:af841cae6e65e727111a3e5bc134135c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad626f92218bc4ac19501c91a513ae75c"><td class="memItemLeft" align="right" valign="top">unsigned int const *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a></td></tr>
<tr class="separator:ad626f92218bc4ac19501c91a513ae75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f613581a3950b9df0a33e1dee728e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a></td></tr>
<tr class="separator:ad4f613581a3950b9df0a33e1dee728e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb6babf0e9aac66eec1cdfe3c0fb6247"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a></td></tr>
<tr class="separator:afb6babf0e9aac66eec1cdfe3c0fb6247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af723e5e6c9919f309a40134658df5a4d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a></td></tr>
<tr class="separator:af723e5e6c9919f309a40134658df5a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6524ff7018c3899073535eb33f4920"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a></td></tr>
<tr class="separator:a6d6524ff7018c3899073535eb33f4920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e8c011204377d30ff0f1283c7eca923"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a></td></tr>
<tr class="separator:a4e8c011204377d30ff0f1283c7eca923"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98d5fb25525360d037499ea920927602"><td class="memItemLeft" align="right" valign="top"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a></td></tr>
<tr class="separator:a98d5fb25525360d037499ea920927602"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9448025599860ae8d5773f15c09d73a4"><td class="memItemLeft" align="right" valign="top">cprElfHdr4&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a></td></tr>
<tr class="separator:a9448025599860ae8d5773f15c09d73a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae6931a0bd5d2fca80befbd24a574c3e"><td class="memItemLeft" align="right" valign="top">cprElfShdr3&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a></td></tr>
<tr class="separator:aae6931a0bd5d2fca80befbd24a574c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:ae803acdbc60d287ce17afb401b844f43 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ae803acdbc60d287ce17afb401b844f43">old_data_off</a></td></tr>
<tr class="separator:ae803acdbc60d287ce17afb401b844f43 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a362fdf6e7ad11e117be7166b119d80fa inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a362fdf6e7ad11e117be7166b119d80fa">old_data_len</a></td></tr>
<tr class="separator:a362fdf6e7ad11e117be7166b119d80fa inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf175264167b93a8ce865a34937584e6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a></td></tr>
<tr class="separator:aaf175264167b93a8ce865a34937584e6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0f5122457c7d42172531d3cb116f00 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a></td></tr>
<tr class="separator:a3b0f5122457c7d42172531d3cb116f00 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca43f8d44f554de5f8129732f291f2d inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a></td></tr>
<tr class="separator:aaca43f8d44f554de5f8129732f291f2d inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc48dc344bb8340e9691a43d45f8458 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></td></tr>
<tr class="separator:afcc48dc344bb8340e9691a43d45f8458 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e3d4f8dd219c66f8a2d78e20ca5df4 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a></td></tr>
<tr class="separator:ad4e3d4f8dd219c66f8a2d78e20ca5df4 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e8bd1f64f0d8583676289f7329eb31 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a></td></tr>
<tr class="separator:a29e8bd1f64f0d8583676289f7329eb31 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55541b4f9e0f8f1fe16cb785b093ab1c inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a></td></tr>
<tr class="separator:a55541b4f9e0f8f1fe16cb785b093ab1c inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834063e926d1118a24f23a8106edcd4e inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a></td></tr>
<tr class="separator:a834063e926d1118a24f23a8106edcd4e inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe0a4831f0aafe74de573ca657ea430 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a></td></tr>
<tr class="separator:acbe0a4831f0aafe74de573ca657ea430 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc33d310cb391da2166a1dd3857ee4d inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a></td></tr>
<tr class="separator:a4cc33d310cb391da2166a1dd3857ee4d inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c581148f2345d127c21f0ba5a33a656 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a></td></tr>
<tr class="separator:a4c581148f2345d127c21f0ba5a33a656 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ec71c63b3b76a8847d2a5989c2f3fbb inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a></td></tr>
<tr class="separator:a6ec71c63b3b76a8847d2a5989c2f3fbb inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3ca408b94c072437e9e96a3b4e3ab1f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a></td></tr>
<tr class="separator:ab3ca408b94c072437e9e96a3b4e3ab1f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac334df9f0f0666906d1b49d1d45be792 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a></td></tr>
<tr class="separator:ac334df9f0f0666906d1b49d1d45be792 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99ee39bcba2a438ad1728c8332356ce2 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a></td></tr>
<tr class="separator:a99ee39bcba2a438ad1728c8332356ce2 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae86e3eeb56091063ef73bbcab2c1262a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">sz_pack2a</a></td></tr>
<tr class="separator:ae86e3eeb56091063ef73bbcab2c1262a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd64335916d77771c6dd2f5b71e9a77 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a></td></tr>
<tr class="separator:a8cd64335916d77771c6dd2f5b71e9a77 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80989e5fdaa51b0650d6f5d66eaf3766 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a></td></tr>
<tr class="separator:a80989e5fdaa51b0650d6f5d66eaf3766 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6c41a7dc3caa60ac369d2776ee5a12 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">is_pie</a></td></tr>
<tr class="separator:a9f6c41a7dc3caa60ac369d2776ee5a12 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8b16212a7cce313d106777dc6c198af inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a></td></tr>
<tr class="separator:af8b16212a7cce313d106777dc6c198af inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8dc91b5f08ffdd31586e4d0c8ef2cb inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></td></tr>
<tr class="separator:a3a8dc91b5f08ffdd31586e4d0c8ef2cb inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac769941a308e20fdce0e86d1ec3b2f3 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a></td></tr>
<tr class="separator:aac769941a308e20fdce0e86d1ec3b2f3 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371519bdb05124340b9d78e067bee1e0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a></td></tr>
<tr class="separator:a371519bdb05124340b9d78e067bee1e0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8be817665d0219026ebd50acdd3700af inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a></td></tr>
<tr class="separator:a8be817665d0219026ebd50acdd3700af inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa692858672c20488c367295681b28422 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a></td></tr>
<tr class="separator:aa692858672c20488c367295681b28422 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fa8506d335cb1116f720aff4611a337 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a></td></tr>
<tr class="separator:a3fa8506d335cb1116f720aff4611a337 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539c946c8c36fa509670ec9948ccb1fc inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a></td></tr>
<tr class="separator:a539c946c8c36fa509670ec9948ccb1fc inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bb9134e6f6d635119bbce8ee9fc2cc0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a></td></tr>
<tr class="separator:a3bb9134e6f6d635119bbce8ee9fc2cc0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8e26f797ec69a6c183c8b15fcd4f53 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a></td></tr>
<tr class="separator:a8c8e26f797ec69a6c183c8b15fcd4f53 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f1dfda6aea57348d0720fa78b782d0 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a></td></tr>
<tr class="separator:aa2f1dfda6aea57348d0720fa78b782d0 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae0ac0fb5a7d76ec145e96317d6501d7 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#aae0ac0fb5a7d76ec145e96317d6501d7">plt_off</a></td></tr>
<tr class="separator:aae0ac0fb5a7d76ec145e96317d6501d7 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a59994ceb7e3d20444f07a08cd1cfe inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a></td></tr>
<tr class="separator:a59a59994ceb7e3d20444f07a08cd1cfe inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a888f94bd6a90f535ea5567e3f8b39ccc inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a></td></tr>
<tr class="separator:a888f94bd6a90f535ea5567e3f8b39ccc inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4920cc3ff82dcbc60f2a87fdd276d025 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a></td></tr>
<tr class="separator:a4920cc3ff82dcbc60f2a87fdd276d025 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc257b84970a37def2e57221bf91c48 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a01856cf6f1215fb3b66cb3547550f99a">upx_uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></td></tr>
<tr class="separator:accc257b84970a37def2e57221bf91c48 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c2c447099336ae2bc5cc1539c36610 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">ei_class</a></td></tr>
<tr class="separator:af6c2c447099336ae2bc5cc1539c36610 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dabe40d6f7f71e6b9bce64b9cc3290f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">ei_data</a></td></tr>
<tr class="separator:a5dabe40d6f7f71e6b9bce64b9cc3290f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad930777406ea601d200de0ab59de88d6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a></td></tr>
<tr class="separator:ad930777406ea601d200de0ab59de88d6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a691359a24fbf2963d4ac5f625dd0299c inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a></td></tr>
<tr class="separator:a691359a24fbf2963d4ac5f625dd0299c inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946ebc79f94eff58bd559c7b5bb60057 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a946ebc79f94eff58bd559c7b5bb60057">osabi_note</a></td></tr>
<tr class="separator:a946ebc79f94eff58bd559c7b5bb60057 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5789e03712ad5c821ed718be76cb006a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></td></tr>
<tr class="separator:a5789e03712ad5c821ed718be76cb006a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93d9de72bcb60bbea6757e0d44e5e296 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a> [<a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>]</td></tr>
<tr class="separator:a93d9de72bcb60bbea6757e0d44e5e296 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76c2a145b6739ad4cd1035af406a821a inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a></td></tr>
<tr class="separator:a76c2a145b6739ad4cd1035af406a821a inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193d50a7694d9bbdd607514c4fe691ab inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">char const  *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a></td></tr>
<tr class="separator:a193d50a7694d9bbdd607514c4fe691ab inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0f4c33a259ca5c14cdc2384285e274f inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a></td></tr>
<tr class="separator:ab0f4c33a259ca5c14cdc2384285e274f inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4036b37656b78e0053108ad8f9a17ef8 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a></td></tr>
<tr class="separator:a4036b37656b78e0053108ad8f9a17ef8 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e2664a0d3b21d1e9fc0871a9acefff6 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a3e2664a0d3b21d1e9fc0871a9acefff6">note_body</a></td></tr>
<tr class="separator:a3e2664a0d3b21d1e9fc0871a9acefff6 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d39fd80fb77e53dd4d79b5042a2941 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a63d39fd80fb77e53dd4d79b5042a2941">note_size</a></td></tr>
<tr class="separator:a63d39fd80fb77e53dd4d79b5042a2941 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a02a5314fbdff34469cfa4b59ddde10 inherit pro_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a></td></tr>
<tr class="separator:a1a02a5314fbdff34469cfa4b59ddde10 inherit pro_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a614b94da58152b4585040e30a72a0de3 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a></td></tr>
<tr class="separator:a614b94da58152b4585040e30a72a0de3 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb3e459ee90ee28853a76401b8145123 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a></td></tr>
<tr class="separator:aeb3e459ee90ee28853a76401b8145123 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a449871a4fd2081e1399999ef05741f92 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a></td></tr>
<tr class="separator:a449871a4fd2081e1399999ef05741f92 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3408c180ca78a03f0c06da6c8c25dc34 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a></td></tr>
<tr class="separator:a3408c180ca78a03f0c06da6c8c25dc34 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e6db1e979cfd371114262e2887980ee inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">progid</a></td></tr>
<tr class="separator:a4e6db1e979cfd371114262e2887980ee inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3e227135d766557eb3e012e610d72a0 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a></td></tr>
<tr class="separator:aa3e227135d766557eb3e012e610d72a0 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce6e18bbda8d182b25bc7188740b55b inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a0ce6e18bbda8d182b25bc7188740b55b">loader</a></td></tr>
<tr class="separator:a0ce6e18bbda8d182b25bc7188740b55b inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914345298d86f797a6c960ca80afdeb7 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a></td></tr>
<tr class="separator:a914345298d86f797a6c960ca80afdeb7 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a7532bf1dac1d3df6a453729750505 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#ac7a7532bf1dac1d3df6a453729750505">pt_dynamic</a></td></tr>
<tr class="separator:ac7a7532bf1dac1d3df6a453729750505 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe548f0eb818215a9924b273022ad71f inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#afe548f0eb818215a9924b273022ad71f">sz_dynamic</a></td></tr>
<tr class="separator:afe548f0eb818215a9924b273022ad71f inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055b87f94fa37391fb1c356b215ec027 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a055b87f94fa37391fb1c356b215ec027">b_len</a></td></tr>
<tr class="separator:a055b87f94fa37391fb1c356b215ec027 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa33d54bc7392e242453b126d23c3ecbd inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a></td></tr>
<tr class="separator:aa33d54bc7392e242453b126d23c3ecbd inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a8d9222b7627fa48786c128340b0c0 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a></td></tr>
<tr class="separator:a05a8d9222b7627fa48786c128340b0c0 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ab714a14f4ff2f120107dfc08b2a3a5 inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a></td></tr>
<tr class="separator:a8ab714a14f4ff2f120107dfc08b2a3a5 inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a994baf32174356ff73af67ad5d15ba inherit pro_attribs_classPackUnix"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structl__info.html">l_info</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a></td></tr>
<tr class="separator:a8a994baf32174356ff73af67ad5d15ba inherit pro_attribs_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPacker')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a18d294254872108f1373a26ccabbd821 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">const N_BELE_RTP::AbstractPolicy *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a> = nullptr</td></tr>
<tr class="separator:a18d294254872108f1373a26ccabbd821 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d498ce73ff0a988560ff88f603e50ae inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a7d498ce73ff0a988560ff88f603e50ae">ph_format</a> = -1</td></tr>
<tr class="separator:a7d498ce73ff0a988560ff88f603e50ae inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096e8f1e0d39dd91a106bfb89451a25e inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a096e8f1e0d39dd91a106bfb89451a25e">ph_version</a> = -1</td></tr>
<tr class="separator:a096e8f1e0d39dd91a106bfb89451a25e inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95d40264330fe966e66718440b450ec8 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a></td></tr>
<tr class="separator:a95d40264330fe966e66718440b450ec8 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f51aecfca1c5d86cc11a7d2ab574d5e inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemBuffer.html">MemBuffer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a8f51aecfca1c5d86cc11a7d2ab574d5e">obuf</a></td></tr>
<tr class="separator:a8f51aecfca1c5d86cc11a7d2ab574d5e inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afda0c36e70bfaeeecc0494abfb924ae7 inherit pro_attribs_classPacker"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#afda0c36e70bfaeeecc0494abfb924ae7">ibufgood</a> = 0</td></tr>
<tr class="separator:afda0c36e70bfaeeecc0494abfb924ae7 inherit pro_attribs_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:a0306ca7a6b44bd2b88bda7eefa46d49b inherit pro_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classInputFile.html">InputFile</a> *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a></td></tr>
<tr class="separator:a0306ca7a6b44bd2b88bda7eefa46d49b inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memItemLeft" >union {</td></tr>
<tr class="memitem:ae9574c21b6d500a7a2d0e20bcbc6f512 inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a58b8dd6274f8ad1eca2637b12665167f">upx_int64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a></td></tr>
<tr class="separator:ae9574c21b6d500a7a2d0e20bcbc6f512 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa805ae048630f146d2abf38797fea52d inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a></td></tr>
<tr class="separator:aa805ae048630f146d2abf38797fea52d inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a3f0252ee140d3a44d4a1d47ea1a9da inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a58b8dd6274f8ad1eca2637b12665167f">upx_int64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a76d1e66f0b3c637fdb874858bcda14e8">file_size_i64</a></td></tr>
<tr class="separator:a9a3f0252ee140d3a44d4a1d47ea1a9da inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae30790328b3b3bb901099d1dd6aaab inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a0fcea265b45d10fd12879bc2031bf7ab">file_size_u64</a></td></tr>
<tr class="separator:a1ae30790328b3b3bb901099d1dd6aaab inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:adcdd3bf516786229578329915cc555d7 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memItemLeft" >union {</td></tr>
<tr class="memitem:ad2f05b968c3b089b974b6ee0d58f5f3d inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#ab4a628cc601ebd17416219a120bedc22">upx_int32_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a5149b8b54da86de4aece59e39d73e676">file_size_i32</a></td></tr>
<tr class="separator:ad2f05b968c3b089b974b6ee0d58f5f3d inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9da74dad6d9e37f7a927a94587ae04f inherit pro_attribs_classPackerBase"><td class="memItemLeft" >&#160;&#160;&#160;const <a class="el" href="conf_8h.html#a8e3030ad36a1cb27a77eb87e12a648bc">upx_uint32_t</a>&#160;&#160;&#160;<a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a></td></tr>
<tr class="separator:ac9da74dad6d9e37f7a927a94587ae04f inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memItemLeft" valign="top">};&#160;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr class="separator:a8015bda37d1d7abd5cf04eb0c8a87aab inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01f3c918e5ce5b4de630d11c703cec05 inherit pro_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPackHeader.html">PackHeader</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a></td></tr>
<tr class="separator:a01f3c918e5ce5b4de630d11c703cec05 inherit pro_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a898ffb3ab797ebed36d6f8e8e69848f0"><td class="memItemLeft" align="right" valign="top">static unsigned const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a> = 5</td></tr>
<tr class="separator:a898ffb3ab797ebed36d6f8e8e69848f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_attribs_classPackLinuxElf"><td colspan="2" onclick="javascript:toggleInherit('pro_static_attribs_classPackLinuxElf')"><img src="closed.png" alt="-"/>&#160;Static Protected Attributes inherited from <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a></td></tr>
<tr class="memitem:a14a0202c4a2a508fef4009ae120b44b8 inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned int const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> = (1u&lt;&lt;12)</td></tr>
<tr class="separator:a14a0202c4a2a508fef4009ae120b44b8 inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7515af27403f7b035c02bc0f92dee48c inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static unsigned const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a> = 34</td></tr>
<tr class="separator:a7515af27403f7b035c02bc0f92dee48c inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793632661a0af5efd197304078be1ed0 inherit pro_static_attribs_classPackLinuxElf"><td class="memItemLeft" align="right" valign="top">static const unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">o_shstrtab</a> []</td></tr>
<tr class="separator:a793632661a0af5efd197304078be1ed0 inherit pro_static_attribs_classPackLinuxElf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-types" name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a13b054a58cbbd3183bef75f38036faac"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">super</a></td></tr>
<tr class="separator:a13b054a58cbbd3183bef75f38036faac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a5d4431054206626f898a559c0bb183c4 inherit pub_types_classPackUnix"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classPacker.html">Packer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackUnix.html#a5d4431054206626f898a559c0bb183c4">super</a></td></tr>
<tr class="separator:a5d4431054206626f898a559c0bb183c4 inherit pub_types_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_methods_classPacker"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classPacker')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classPacker.html">Packer</a></td></tr>
<tr class="memitem:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacker.html#a4a969f788c3bad61abe0eec73fca0f0c">isValidCompressionMethod</a> (int method)</td></tr>
<tr class="memdesc:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="mdescLeft">&#160;</td><td class="mdescRight">compression method util  <br /></td></tr>
<tr class="separator:a4a969f788c3bad61abe0eec73fca0f0c inherit pub_static_methods_classPacker"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classPackerBase"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classPackerBase')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classPackerBase.html">PackerBase</a></td></tr>
<tr class="memitem:a0c49d00b430fd8a28f49499748875943 inherit pub_static_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top">static constexpr unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a0c49d00b430fd8a28f49499748875943">MAX_METHODS</a> = 8</td></tr>
<tr class="separator:a0c49d00b430fd8a28f49499748875943 inherit pub_static_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8691a09f947ec86dd6437b357c277851 inherit pub_static_attribs_classPackerBase"><td class="memItemLeft" align="right" valign="top">static constexpr unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPackerBase.html#a8691a09f947ec86dd6437b357c277851">MAX_FILTERS</a> = 16</td></tr>
<tr class="separator:a8691a09f947ec86dd6437b357c277851 inherit pub_static_attribs_classPackerBase"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_types_classPackUnix"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classPackUnix')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classPackUnix.html">PackUnix</a></td></tr>
<tr class="memitem:a1f6547d32f13116f4f888f8f359cdbef inherit pro_types_classPackUnix"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a> = 2048
 }</td></tr>
<tr class="separator:a1f6547d32f13116f4f888f8f359cdbef inherit pro_types_classPackUnix"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00307">307</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a13b054a58cbbd3183bef75f38036faac" name="a13b054a58cbbd3183bef75f38036faac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13b054a58cbbd3183bef75f38036faac">&#9670;&#160;</a></span>super</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classPackLinuxElf.html">PackLinuxElf</a> <a class="el" href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">PackLinuxElf64::super</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00309">309</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="afc05d6aa59c55c25d1faf101a5c557b7" name="afc05d6aa59c55c25d1faf101a5c557b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc05d6aa59c55c25d1faf101a5c557b7">&#9670;&#160;</a></span>PackLinuxElf64()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::PackLinuxElf64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInputFile.html">InputFile</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00991">991</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  992</span>    : <a class="code hl_typedef" href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">super</a>(f), <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  993</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>(0), <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>(0),</div>
<div class="line"><span class="lineno">  994</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>(~0ull&lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>),</div>
<div class="line"><span class="lineno">  995</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  996</span>                     <a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  997</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><span class="lineno">  998</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>(<span class="keyword">nullptr</span>), <a class="code hl_variable" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  999</span>    , <a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno"> 1000</span>{</div>
<div class="line"><span class="lineno"> 1001</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>));</div>
<div class="line"><span class="lineno"> 1002</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a> = 0;</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">if</span> (f) {</div>
<div class="line"><span class="lineno"> 1004</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1005</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>));</div>
<div class="line"><span class="lineno"> 1006</span>    }</div>
<div class="line"><span class="lineno"> 1007</span>}</div>
<div class="ttc" id="absd_8h_html_a0d112bae8fd35be772185b6ec6bcbe64"><div class="ttname"><a href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a></div><div class="ttdeci">#define SEEK_SET</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00101">bsd.h:101</a></div></div>
<div class="ttc" id="aclassInputFile_html_a6fad8c9902f939edfcb0e48ee8379232"><div class="ttname"><a href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx</a></div><div class="ttdeci">int readx(SPAN_P(void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00201">file.cpp:201</a></div></div>
<div class="ttc" id="aclassInputFile_html_aa76b4db751f0d4ad6c47e93fa676d4a9"><div class="ttname"><a href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek</a></div><div class="ttdeci">virtual upx_off_t seek(upx_off_t off, int whence) override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00208">file.cpp:208</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a13b054a58cbbd3183bef75f38036faac"><div class="ttname"><a href="classPackLinuxElf64.html#a13b054a58cbbd3183bef75f38036faac">PackLinuxElf64::super</a></div><div class="ttdeci">PackLinuxElf super</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00309">p_lx_elf.h:309</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a1a367c1ee6e43cb116f980f9046a0fce"><div class="ttname"><a href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">PackLinuxElf64::hashend</a></div><div class="ttdeci">unsigned int const * hashend</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00403">p_lx_elf.h:403</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a43aff2a214341cb27a7f07ec997e443d"><div class="ttname"><a href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">PackLinuxElf64::shdri</a></div><div class="ttdeci">Elf64_Shdr * shdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00390">p_lx_elf.h:390</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a4e8c011204377d30ff0f1283c7eca923"><div class="ttname"><a href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">PackLinuxElf64::sec_dynstr</a></div><div class="ttdeci">Elf64_Shdr const  * sec_dynstr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00410">p_lx_elf.h:410</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a53f97eabbbe04201c83cd03c9103ce88"><div class="ttname"><a href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">PackLinuxElf64::dynseg</a></div><div class="ttdeci">Elf64_Dyn * dynseg</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00402">p_lx_elf.h:402</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a689b9c7fa3bd70c22d9703fbcc288819"><div class="ttname"><a href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">PackLinuxElf64::sz_phdrx</a></div><div class="ttdeci">unsigned sz_phdrx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00395">p_lx_elf.h:395</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6d6524ff7018c3899073535eb33f4920"><div class="ttname"><a href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">PackLinuxElf64::sec_dynsym</a></div><div class="ttdeci">Elf64_Shdr * sec_dynsym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00409">p_lx_elf.h:409</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a847fd85f9cecd8abe44afd346f2ae168"><div class="ttname"><a href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">PackLinuxElf64::n_jmp_slot</a></div><div class="ttdeci">unsigned n_jmp_slot</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00399">p_lx_elf.h:399</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a98d5fb25525360d037499ea920927602"><div class="ttname"><a href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">PackLinuxElf64::sec_arm_attr</a></div><div class="ttdeci">Elf64_Shdr * sec_arm_attr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00411">p_lx_elf.h:411</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a9d14a83cf8a4300cf26946d4c16f8421"><div class="ttname"><a href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">PackLinuxElf64::hashtab</a></div><div class="ttdeci">unsigned int const  * hashtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00403">p_lx_elf.h:403</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_aa11131540dea71d341de36cf39325c17"><div class="ttname"><a href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">PackLinuxElf64::phdri</a></div><div class="ttdeci">Elf64_Phdr * phdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00389">p_lx_elf.h:389</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_acf726e188c8c471755ee3f00cf7c4226"><div class="ttname"><a href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">PackLinuxElf64::page_mask</a></div><div class="ttdeci">upx_uint64_t page_mask</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00400">p_lx_elf.h:400</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad07514aa5c9db6acc6b2bdad24113943"><div class="ttname"><a href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">PackLinuxElf64::n_phdrx</a></div><div class="ttdeci">unsigned n_phdrx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00394">p_lx_elf.h:394</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad10baff449a3519d7386cf0519374a15"><div class="ttname"><a href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">PackLinuxElf64::ehdri</a></div><div class="ttdeci">Elf64_Ehdr ehdri</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00388">p_lx_elf.h:388</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad4f613581a3950b9df0a33e1dee728e9"><div class="ttname"><a href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">PackLinuxElf64::dynsym</a></div><div class="ttdeci">Elf64_Sym * dynsym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00405">p_lx_elf.h:405</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad626f92218bc4ac19501c91a513ae75c"><div class="ttname"><a href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">PackLinuxElf64::gashend</a></div><div class="ttdeci">unsigned int const * gashend</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00404">p_lx_elf.h:404</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af723e5e6c9919f309a40134658df5a4d"><div class="ttname"><a href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">PackLinuxElf64::sec_strndx</a></div><div class="ttdeci">Elf64_Shdr * sec_strndx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00408">p_lx_elf.h:408</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af841cae6e65e727111a3e5bc134135c0"><div class="ttname"><a href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">PackLinuxElf64::gashtab</a></div><div class="ttdeci">unsigned int const  * gashtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00404">p_lx_elf.h:404</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_afb6babf0e9aac66eec1cdfe3c0fb6247"><div class="ttname"><a href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">PackLinuxElf64::jni_onload_sym</a></div><div class="ttdeci">Elf64_Sym const  * jni_onload_sym</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00406">p_lx_elf.h:406</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8cd64335916d77771c6dd2f5b71e9a77"><div class="ttname"><a href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">PackLinuxElf::lg2_page</a></div><div class="ttdeci">unsigned lg2_page</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00095">p_lx_elf.h:95</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a4ffffab0dc6ead4a09af1dba0b85f71c"><div class="ttname"><a href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a></div><div class="ttdeci">void * memset(const C&lt; T &gt; &amp;a, int v, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00139">xspan_fwd.h:139</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, and <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph" id="aclassPackLinuxElf64_afc05d6aa59c55c25d1faf101a5c557b7_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,199,162"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="270,80,346,105"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="247,129,369,155"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="249,180,367,205"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="435,80,549,105"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="417,129,567,155"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="619,131,750,156"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="837,87,927,112"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="640,29,729,55"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="616,180,753,205"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1009,59,1128,84"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="803,22,961,62"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="434,231,550,256"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="656,279,713,304"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="617,229,753,255"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="615,328,755,353"/>
</map>
</div>

</div>
</div>
<a id="af736dee54f1eb95750dfb45531efb66c" name="af736dee54f1eb95750dfb45531efb66c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af736dee54f1eb95750dfb45531efb66c">&#9670;&#160;</a></span>~PackLinuxElf64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::~PackLinuxElf64 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01009">1009</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1010</span>{</div>
<div class="line"><span class="lineno"> 1011</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abd6eb82fa691109eb7fa267d6c8570f6" name="abd6eb82fa691109eb7fa267d6c8570f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd6eb82fa691109eb7fa267d6c8570f6">&#9670;&#160;</a></span>add_phdrx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::add_phdrx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01013">1013</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1014</span>{</div>
<div class="line"><span class="lineno"> 1015</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>) {</div>
<div class="line"><span class="lineno"> 1016</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many Phdr %u&quot;</span>, (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 1017</span>    }</div>
<div class="line"><span class="lineno"> 1018</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>[<a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>++] = phdr;</div>
<div class="line"><span class="lineno"> 1019</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a898ffb3ab797ebed36d6f8e8e69848f0"><div class="ttname"><a href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">PackLinuxElf64::END_PHDRX</a></div><div class="ttdeci">static unsigned const END_PHDRX</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00392">p_lx_elf.h:392</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ac4fe837eb5fd3cff1d6b76758ab9a58c"><div class="ttname"><a href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">PackLinuxElf64::phdrx</a></div><div class="ttdeci">Elf64_Phdr const  * phdrx[END_PHDRX]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00393">p_lx_elf.h:393</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a388ab1f73d9ba5222a35cbdd67b396ff"><div class="ttname"><a href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a></div><div class="ttdeci">void throwCantPack(const char *msg)</div><div class="ttdoc">compression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00075">except.cpp:75</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a>, <a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph" id="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="205,13,324,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph" id="aclassPackLinuxElf64_abd6eb82fa691109eb7fa267d6c8570f6_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a6b85151ad06f0b457773686f047903f4" name="a6b85151ad06f0b457773686f047903f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b85151ad06f0b457773686f047903f4">&#9670;&#160;</a></span>adjABS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::adjABS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *&#160;</td>
          <td class="paramname"><em>sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03878">3878</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3879</span>{</div>
<div class="line"><span class="lineno"> 3880</span>    <span class="keywordtype">unsigned</span> st_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sym-&gt;st_name);</div>
<div class="line"><span class="lineno"> 3881</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; <a class="code hl_variable" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>[j][0]; ++j) {</div>
<div class="line"><span class="lineno"> 3882</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>[j], <a class="code hl_function" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a>(st_name, (<span class="keywordtype">unsigned</span>)-1))) {</div>
<div class="line"><span class="lineno"> 3883</span>            sym-&gt;st_value += delta;</div>
<div class="line"><span class="lineno"> 3884</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 3885</span>        }</div>
<div class="line"><span class="lineno"> 3886</span>    }</div>
<div class="line"><span class="lineno"> 3887</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 3888</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_acd825cbaf5a768993a7f0b90a24c7a4c"><div class="ttname"><a href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">PackLinuxElf64::get_str_name</a></div><div class="ttdeci">char const * get_str_name(unsigned st_name, unsigned symnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02381">p_lx_elf.cpp:2381</a></div></div>
<div class="ttc" id="aclassPacker_html_a47a54fc63360923941cec0aa6060ae01"><div class="ttname"><a href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32</a></div><div class="ttdeci">unsigned get_te32(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00262">packer.h:262</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aa76502ba73704544aa4c5bf2afca9195"><div class="ttname"><a href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a></div><div class="ttdeci">static char const abs_symbol_names[][14]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03853">p_lx_elf.cpp:3853</a></div></div>
<div class="ttc" id="asnprintf_8h_html_a674a04e474d5db68cb6272b9d46940cf"><div class="ttname"><a href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a></div><div class="ttdeci">forceinline int strcmp(const uchar *s1, const char *s2) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00077">snprintf.h:77</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aa76502ba73704544aa4c5bf2afca9195">abs_symbol_names</a>, <a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, and <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph" id="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_cgraph">
<area shape="rect" title=" " alt="" coords="5,70,180,95"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="228,5,377,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="238,70,367,95"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="269,143,336,169"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="425,13,544,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph" id="aclassPackLinuxElf64_a6b85151ad06f0b457773686f047903f4_icgraph">
<area shape="rect" title=" " alt="" coords="637,45,812,70"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="443,5,589,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="444,69,588,109"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="228,13,395,38"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="239,69,383,109"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,77,180,102"/>
</map>
</div>

</div>
</div>
<a id="a6eefcbb2a42d861b12d2c309d93771b8" name="a6eefcbb2a42d861b12d2c309d93771b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eefcbb2a42d861b12d2c309d93771b8">&#9670;&#160;</a></span>asl_pack2_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::asl_pack2_Shdrs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>pre_xct_top</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04173">4173</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4174</span>{</div>
<div class="line"><span class="lineno"> 4175</span>    <span class="keywordflow">if</span> (!fo) {</div>
<div class="line"><span class="lineno"> 4176</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 4177</span>    }</div>
<div class="line"><span class="lineno"> 4178</span>    <span class="comment">// In order to pacify the runtime linker on Android &quot;O&quot; (&quot;Oreo&quot;),</span></div>
<div class="line"><span class="lineno"> 4179</span>    <span class="comment">// we will splice-in a 4KiB page that contains an &quot;extra&quot; copy</span></div>
<div class="line"><span class="lineno"> 4180</span>    <span class="comment">// of the Shdr, any PT_NOTE above xct_off, and shstrtab.</span></div>
<div class="line"><span class="lineno"> 4181</span>    <span class="comment">// File order: Ehdr, Phdr[], section contents below xct_off,</span></div>
<div class="line"><span class="lineno"> 4182</span>    <span class="comment">//    Shdr_copy[], PT_NOTEs.hi, shstrtab.</span></div>
<div class="line"><span class="lineno"> 4183</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>  += <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 4184</span>    <span class="comment">//xct_off += asl_delta;  // not until ::pack3()</span></div>
<div class="line"><span class="lineno"> 4185</span> </div>
<div class="line"><span class="lineno"> 4186</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = pre_xct_top;</div>
<div class="line"><span class="lineno"> 4187</span> </div>
<div class="line"><span class="lineno"> 4188</span>    <span class="comment">// Relocate PT_DYNAMIC (in PT_LOAD with PF_W)</span></div>
<div class="line"><span class="lineno"> 4189</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dyn = <span class="keyword">const_cast&lt;</span><a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>);</div>
<div class="line"><span class="lineno"> 4190</span>    <span class="keywordflow">for</span> (; dyn-&gt;d_tag; ++dyn) {</div>
<div class="line"><span class="lineno"> 4191</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d_tag = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 4192</span>        <span class="keywordflow">if</span> (Elf64_Dyn::DT_FINI       == d_tag</div>
<div class="line"><span class="lineno"> 4193</span>        ||  Elf64_Dyn::DT_FINI_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4194</span>        ||  Elf64_Dyn::DT_INIT_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4195</span>        ||  Elf64_Dyn::DT_PREINIT_ARRAY == d_tag</div>
<div class="line"><span class="lineno"> 4196</span>        ||  Elf64_Dyn::DT_PLTGOT      == d_tag) {</div>
<div class="line"><span class="lineno"> 4197</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d_val = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_val);</div>
<div class="line"><span class="lineno"> 4198</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dyn-&gt;d_val, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + d_val);</div>
<div class="line"><span class="lineno"> 4199</span>        }</div>
<div class="line"><span class="lineno"> 4200</span>    }</div>
<div class="line"><span class="lineno"> 4201</span>    <span class="comment">// Updated dynseg (.dynamic, in PT_DYNAMIC (PT_LOAD{PF_W})) has not been written.</span></div>
<div class="line"><span class="lineno"> 4202</span>    <span class="comment">// dynseg is in file_image[] but not in low_mem[].</span></div>
<div class="line"><span class="lineno"> 4203</span> </div>
<div class="line"><span class="lineno"> 4204</span>    <span class="comment">// Relocate dynsym (DT_SYMTAB) which is below xct_va</span></div>
<div class="line"><span class="lineno"> 4205</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> off_dynsym = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4206</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> sz_dynsym  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4207</span>    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sz_dynsym</div>
<div class="line"><span class="lineno"> 4208</span>    ||  (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; off_dynsym</div>
<div class="line"><span class="lineno"> 4209</span>    || ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - off_dynsym) &lt; sz_dynsym) {</div>
<div class="line"><span class="lineno"> 4210</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_SYMTAB&quot;</span>);</div>
<div class="line"><span class="lineno"> 4211</span>    }</div>
<div class="line"><span class="lineno"> 4212</span>    <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *dyntym = (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4213</span>        <span class="stringliteral">&quot;bad dynsym&quot;</span>, off_dynsym, sz_dynsym);</div>
<div class="line"><span class="lineno"> 4214</span>    <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *sym = dyntym;</div>
<div class="line"><span class="lineno"> 4215</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = sz_dynsym / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>); --j&gt;=0; ++sym) {</div>
<div class="line"><span class="lineno"> 4216</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> symval = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sym-&gt;st_value);</div>
<div class="line"><span class="lineno"> 4217</span>        <span class="keywordtype">unsigned</span> symsec = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;sym-&gt;st_shndx);</div>
<div class="line"><span class="lineno"> 4218</span>        <span class="keywordflow">if</span> (Elf64_Sym::SHN_UNDEF != symsec</div>
<div class="line"><span class="lineno"> 4219</span>        &amp;&amp;  Elf64_Sym::SHN_ABS   != symsec</div>
<div class="line"><span class="lineno"> 4220</span>        &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 4221</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sym-&gt;st_value, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + symval);</div>
<div class="line"><span class="lineno"> 4222</span>        }</div>
<div class="line"><span class="lineno"> 4223</span>        <span class="keywordflow">if</span> (Elf64_Sym::SHN_ABS == symsec &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 4224</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS</a>(sym, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 4225</span>        }</div>
<div class="line"><span class="lineno"> 4226</span>    }</div>
<div class="line"><span class="lineno"> 4227</span> </div>
<div class="line"><span class="lineno"> 4228</span>    <span class="comment">// Relocate Phdr virtual addresses, but not physical offsets and sizes</span></div>
<div class="line"><span class="lineno"> 4229</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf_notes[512]; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(buf_notes, 0, <span class="keyword">sizeof</span>(buf_notes));</div>
<div class="line"><span class="lineno"> 4230</span>    <span class="keywordtype">unsigned</span> len_notes = 0;</div>
<div class="line"><span class="lineno"> 4231</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4232</span>        <span class="stringliteral">&quot;bad e_phoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 4233</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 4234</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4235</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= offset) { <span class="comment">// above the extra page</span></div>
<div class="line"><span class="lineno"> 4236</span>            {</div>
<div class="line"><span class="lineno"> 4237</span>                <span class="comment">//set_te64(&amp;phdr-&gt;p_offset, asl_delta + offset);  // physical</span></div>
<div class="line"><span class="lineno"> 4238</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> addr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a>);</div>
<div class="line"><span class="lineno"> 4239</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4240</span>                             addr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 4241</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4242</span>            }</div>
<div class="line"><span class="lineno"> 4243</span>        }</div>
<div class="line"><span class="lineno"> 4244</span>        <span class="comment">// .p_filesz,.p_memsz are updated in ::pack3</span></div>
<div class="line"><span class="lineno"> 4245</span>    }</div>
<div class="line"><span class="lineno"> 4246</span> </div>
<div class="line"><span class="lineno"> 4247</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *<span class="keyword">const</span> ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0];</div>
<div class="line"><span class="lineno"> 4248</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> e_entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>);</div>
<div class="line"><span class="lineno"> 4249</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; e_entry) {</div>
<div class="line"><span class="lineno"> 4250</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + e_entry);</div>
<div class="line"><span class="lineno"> 4251</span>    }</div>
<div class="line"><span class="lineno"> 4252</span>    <span class="comment">// Relocate Shdr; and Rela, Rel (below xct_off)</span></div>
<div class="line"><span class="lineno"> 4253</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> pal_xct_top = <a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(pre_xct_top);</div>
<div class="line"><span class="lineno"> 4254</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>, <a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(pal_xct_top));  <span class="comment">// Shdr alignment</span></div>
<div class="line"><span class="lineno"> 4255</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[pal_xct_top], <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4256</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[pal_xct_top];</div>
<div class="line"><span class="lineno"> 4257</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>;</div>
<div class="line"><span class="lineno"> 4258</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sz_shstrtab  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4259</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++j, ++shdr) {</div>
<div class="line"><span class="lineno"> 4260</span>        <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 4261</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4262</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 4263</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_entsize = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_entsize);</div>
<div class="line"><span class="lineno"> 4264</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_size</div>
<div class="line"><span class="lineno"> 4265</span>        ||  (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_offset</div>
<div class="line"><span class="lineno"> 4266</span>        || (Elf64_Shdr::SHT_NOBITS != sh_type</div>
<div class="line"><span class="lineno"> 4267</span>           &amp;&amp; ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - sh_offset) &lt; sh_size) ) {</div>
<div class="line"><span class="lineno"> 4268</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad SHT_STRNDX&quot;</span>);</div>
<div class="line"><span class="lineno"> 4269</span>        }</div>
<div class="line"><span class="lineno"> 4270</span> </div>
<div class="line"><span class="lineno"> 4271</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 4272</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> addr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 4273</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_addr, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + addr);</div>
<div class="line"><span class="lineno"> 4274</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 4275</span>        }</div>
<div class="line"><span class="lineno"> 4276</span>        <span class="keywordflow">switch</span> (sh_type) {</div>
<div class="line"><span class="lineno"> 4277</span>        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4278</span>        <span class="keywordflow">case</span> Elf64_Shdr::SHT_RELA: {</div>
<div class="line"><span class="lineno"> 4279</span>            <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>) != sh_entsize) {</div>
<div class="line"><span class="lineno"> 4280</span>                <span class="keywordtype">char</span> msg[50];</div>
<div class="line"><span class="lineno"> 4281</span>                <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad Rela.sh_entsize %lu&quot;</span>, (<span class="keywordtype">long</span>)sh_entsize);</div>
<div class="line"><span class="lineno"> 4282</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4283</span>            }</div>
<div class="line"><span class="lineno"> 4284</span>            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = ~0ull;</div>
<div class="line"><span class="lineno"> 4285</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *<span class="keyword">const</span> relb = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4286</span>                 <span class="stringliteral">&quot;bad Rela offset&quot;</span>, sh_offset, sh_size);</div>
<div class="line"><span class="lineno"> 4287</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rela = relb;</div>
<div class="line"><span class="lineno"> 4288</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sh_size / sh_entsize; --k &gt;= 0; ++rela) {</div>
<div class="line"><span class="lineno"> 4289</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_addend = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 4290</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 4291</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_info);</div>
<div class="line"><span class="lineno"> 4292</span>                <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 4293</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 4294</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4295</span>                }</div>
<div class="line"><span class="lineno"> 4296</span>                <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) <span class="keywordflow">switch</span> (r_type) {</div>
<div class="line"><span class="lineno"> 4297</span>                    <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 4298</span>                        <span class="keywordtype">char</span> msg[90]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 4299</span>                            <span class="stringliteral">&quot;unexpected relocation %#x [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 4300</span>                            r_type, -1 + (<span class="keywordtype">unsigned</span>)(sh_size / sh_entsize) - k);</div>
<div class="line"><span class="lineno"> 4301</span>                        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4302</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4303</span>                    <span class="keywordflow">case</span> R_AARCH64_ABS64: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4304</span>                    <span class="keywordflow">case</span> R_AARCH64_GLOB_DAT: <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 4305</span>                    <span class="keywordflow">case</span> R_AARCH64_RELATIVE: {</div>
<div class="line"><span class="lineno"> 4306</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_addend) {</div>
<div class="line"><span class="lineno"> 4307</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_addend, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_addend);</div>
<div class="line"><span class="lineno"> 4308</span>                        }</div>
<div class="line"><span class="lineno"> 4309</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4310</span>                    <span class="keywordflow">case</span> R_AARCH64_JUMP_SLOT: {</div>
<div class="line"><span class="lineno"> 4311</span>                        <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 4312</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> &gt; r_offset) {</div>
<div class="line"><span class="lineno"> 4313</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = r_offset;</div>
<div class="line"><span class="lineno"> 4314</span>                        }</div>
<div class="line"><span class="lineno"> 4315</span>                        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(r_offset);</div>
<div class="line"><span class="lineno"> 4316</span>                        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4317</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 4318</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4319</span>                        }</div>
<div class="line"><span class="lineno"> 4320</span>                        ++<a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 4321</span>                    } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4322</span>                }</div>
<div class="line"><span class="lineno"> 4323</span>            }</div>
<div class="line"><span class="lineno"> 4324</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4325</span>        <span class="keywordflow">case</span> Elf64_Shdr::SHT_REL: {</div>
<div class="line"><span class="lineno"> 4326</span>            <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a>) != sh_entsize) {</div>
<div class="line"><span class="lineno"> 4327</span>                <span class="keywordtype">char</span> msg[50];</div>
<div class="line"><span class="lineno"> 4328</span>                <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad Rel.sh_entsize %lu&quot;</span>, (<span class="keywordtype">long</span>)sh_entsize);</div>
<div class="line"><span class="lineno"> 4329</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 4330</span>            }</div>
<div class="line"><span class="lineno"> 4331</span>            <a class="code hl_typedef" href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a> *rel = (<a class="code hl_typedef" href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 4332</span>                    <span class="stringliteral">&quot;bad Rel sh_offset&quot;</span>, sh_offset, sh_size);</div>
<div class="line"><span class="lineno"> 4333</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = sh_size / sh_entsize; --k &gt;= 0; ++rel) {</div>
<div class="line"><span class="lineno"> 4334</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rel-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 4335</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 4336</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rel-&gt;r_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4337</span>                }</div>
<div class="line"><span class="lineno"> 4338</span>                <span class="comment">// r_offset must be in 2nd PT_LOAD; .p_vaddr was already relocated</span></div>
<div class="line"><span class="lineno"> 4339</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + r_offset);</div>
<div class="line"><span class="lineno"> 4340</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d]);</div>
<div class="line"><span class="lineno"> 4341</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rel-&gt;r_info);</div>
<div class="line"><span class="lineno"> 4342</span>                <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 4343</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w</div>
<div class="line"><span class="lineno"> 4344</span>                &amp;&amp;  Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno"> 4345</span>                &amp;&amp;  (  R_AARCH64_RELATIVE  == r_type</div>
<div class="line"><span class="lineno"> 4346</span>                    || R_AARCH64_JUMP_SLOT == r_type)) {</div>
<div class="line"><span class="lineno"> 4347</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[d], <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + w);</div>
<div class="line"><span class="lineno"> 4348</span>                }</div>
<div class="line"><span class="lineno"> 4349</span>            }</div>
<div class="line"><span class="lineno"> 4350</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4351</span>        <span class="keywordflow">case</span> Elf64_Shdr::SHT_NOTE: {</div>
<div class="line"><span class="lineno"> 4352</span>            <span class="keywordflow">if</span> (!(Elf64_Shdr::SHF_ALLOC &amp; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags))) {</div>
<div class="line"><span class="lineno"> 4353</span>                <span class="comment">// example: version number of &#39;gold&#39; linker (static binder)</span></div>
<div class="line"><span class="lineno"> 4354</span>                <span class="keywordflow">if</span> (<span class="keyword">sizeof</span>(buf_notes) &lt; (sh_size + len_notes)) {</div>
<div class="line"><span class="lineno"> 4355</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;SHT_NOTEs too big&quot;</span>);</div>
<div class="line"><span class="lineno"> 4356</span>                }</div>
<div class="line"><span class="lineno"> 4357</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>[j].sh_offset,</div>
<div class="line"><span class="lineno"> 4358</span>                    len_notes + (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>)) + <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 4359</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;buf_notes[len_notes], &amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[sh_offset], sh_size);</div>
<div class="line"><span class="lineno"> 4360</span>                len_notes += sh_size;</div>
<div class="line"><span class="lineno"> 4361</span>            }</div>
<div class="line"><span class="lineno"> 4362</span>            <span class="keywordflow">else</span> { <span class="comment">// SHF_ALLOC: in PT_LOAD; but move sh_addr and sh_offset</span></div>
<div class="line"><span class="lineno"> 4363</span>                <span class="comment">// Not sure why we need this conditional.</span></div>
<div class="line"><span class="lineno"> 4364</span>                <span class="comment">// Anyway, some Android have multiple SHT_NOTE sections.</span></div>
<div class="line"><span class="lineno"> 4365</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 4366</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> pos = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>);</div>
<div class="line"><span class="lineno"> 4367</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_addr,   pos);</div>
<div class="line"><span class="lineno"> 4368</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, pos);</div>
<div class="line"><span class="lineno"> 4369</span>                }</div>
<div class="line"><span class="lineno"> 4370</span>            }</div>
<div class="line"><span class="lineno"> 4371</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4372</span>        } <span class="comment">// end switch (sh_type)</span></div>
<div class="line"><span class="lineno"> 4373</span>    }</div>
<div class="line"><span class="lineno"> 4374</span>    <span class="comment">// shstrndx will move</span></div>
<div class="line"><span class="lineno"> 4375</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>[<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a>)].sh_offset,</div>
<div class="line"><span class="lineno"> 4376</span>        len_notes + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) + pal_xct_top);</div>
<div class="line"><span class="lineno"> 4377</span> </div>
<div class="line"><span class="lineno"> 4378</span>    <span class="comment">// (&quot;Re-&quot;)write all changes below pal_xct_top</span></div>
<div class="line"><span class="lineno"> 4379</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4380</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, pal_xct_top);</div>
<div class="line"><span class="lineno"> 4381</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = pal_xct_top;</div>
<div class="line"><span class="lineno"> 4382</span> </div>
<div class="line"><span class="lineno"> 4383</span>    <span class="comment">// New copy of Shdr</span></div>
<div class="line"><span class="lineno"> 4384</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> blank; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;blank, 0, <span class="keyword">sizeof</span>(blank));</div>
<div class="line"><span class="lineno"> 4385</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;blank.sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// hint for &quot;upx -d&quot;</span></div>
<div class="line"><span class="lineno"> 4386</span>    <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);  <span class="comment">// Shdr alignment</span></div>
<div class="line"><span class="lineno"> 4387</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;blank, <span class="keyword">sizeof</span>(blank));</div>
<div class="line"><span class="lineno"> 4388</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>[1], (-1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4389</span> </div>
<div class="line"><span class="lineno"> 4390</span>    <span class="keywordflow">if</span> (len_notes) {</div>
<div class="line"><span class="lineno"> 4391</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(buf_notes, len_notes);</div>
<div class="line"><span class="lineno"> 4392</span>    }</div>
<div class="line"><span class="lineno"> 4393</span> </div>
<div class="line"><span class="lineno"> 4394</span>    <span class="comment">// New copy of Shdr[.e_shstrndx].[ sh_offset, +.sh_size )</span></div>
<div class="line"><span class="lineno"> 4395</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>,  sz_shstrtab);</div>
<div class="line"><span class="lineno"> 4396</span> </div>
<div class="line"><span class="lineno"> 4397</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 4398</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 4399</span>    <span class="comment">//xct_off += asl_delta;  // wait until ::pack3</span></div>
<div class="line"><span class="lineno"> 4400</span>    <span class="keywordtype">unsigned</span> d = <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + pal_xct_top - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 4401</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(d, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 4402</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += d;</div>
<div class="line"><span class="lineno"> 4403</span>}</div>
<div class="ttc" id="absd_8h_html_a4c8d0b76b470ba65a43ca46a88320f39"><div class="ttname"><a href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a></div><div class="ttdeci">#define SEEK_CUR</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00102">bsd.h:102</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a4909e2f9df016dda4d2a9e4d1991e7be"><div class="ttname"><a href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref</a></div><div class="ttdeci">forceinline pointer subref(const char *errfmt, size_t skip, size_t take) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00219">membuffer.h:219</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a8b1b934391e5d959387552e48a5fb4b4"><div class="ttname"><a href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek</a></div><div class="ttdeci">virtual upx_off_t seek(upx_off_t off, int whence) override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00320">file.cpp:320</a></div></div>
<div class="ttc" id="aclassOutputFile_html_aa8beb793956b90404c940c5821936718"><div class="ttname"><a href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write</a></div><div class="ttdeci">void write(SPAN_0(const void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00274">file.cpp:274</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a047a7534432a2a090049ba2eee67bfb9"><div class="ttname"><a href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">PackLinuxElf64::elf_get_offset_from_address</a></div><div class="ttdeci">virtual upx_uint64_t elf_get_offset_from_address(upx_uint64_t) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07788">p_lx_elf.cpp:7788</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a0d71085c7179ef591535acdc5347e2dd"><div class="ttname"><a href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">PackLinuxElf64::e_phoff</a></div><div class="ttdeci">upx_uint64_t e_phoff</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00396">p_lx_elf.h:396</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6b85151ad06f0b457773686f047903f4"><div class="ttname"><a href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">PackLinuxElf64::adjABS</a></div><div class="ttdeci">virtual int adjABS(Elf64_Sym *sym, unsigned long delta)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03878">p_lx_elf.cpp:3878</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a923425254661af8d150e99087569da9f"><div class="ttname"><a href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">PackLinuxElf64::shdro</a></div><div class="ttdeci">Elf64_Shdr * shdro</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00391">p_lx_elf.h:391</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a14a0202c4a2a508fef4009ae120b44b8"><div class="ttname"><a href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a></div><div class="ttdeci">static unsigned int const asl_delta</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00077">p_lx_elf.h:77</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a193d50a7694d9bbdd607514c4fe691ab"><div class="ttname"><a href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a></div><div class="ttdeci">char const  * shstrtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00124">p_lx_elf.h:124</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a29e8bd1f64f0d8583676289f7329eb31"><div class="ttname"><a href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a></div><div class="ttdeci">MemBuffer lowmem</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00083">p_lx_elf.h:83</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3a8dc91b5f08ffdd31586e4d0c8ef2cb"><div class="ttname"><a href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a></div><div class="ttdeci">unsigned xct_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00099">p_lx_elf.h:99</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3b0f5122457c7d42172531d3cb116f00"><div class="ttname"><a href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a></div><div class="ttdeci">unsigned e_phnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00079">p_lx_elf.h:79</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3fa8506d335cb1116f720aff4611a337"><div class="ttname"><a href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a></div><div class="ttdeci">upx_uint64_t xct_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00104">p_lx_elf.h:104</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aa2f1dfda6aea57348d0720fa78b782d0"><div class="ttname"><a href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a></div><div class="ttdeci">upx_uint64_t plt_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00108">p_lx_elf.h:108</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aaca43f8d44f554de5f8129732f291f2d"><div class="ttname"><a href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a></div><div class="ttdeci">unsigned e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00080">p_lx_elf.h:80</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ac334df9f0f0666906d1b49d1d45be792"><div class="ttname"><a href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a></div><div class="ttdeci">unsigned sz_elf_hdrs</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00092">p_lx_elf.h:92</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_accc257b84970a37def2e57221bf91c48"><div class="ttname"><a href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a></div><div class="ttdeci">upx_uint16_t e_machine</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00113">p_lx_elf.h:113</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ad4e3d4f8dd219c66f8a2d78e20ca5df4"><div class="ttname"><a href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a></div><div class="ttdeci">MemBuffer file_image</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00082">p_lx_elf.h:82</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a614b94da58152b4585040e30a72a0de3"><div class="ttname"><a href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a></div><div class="ttdeci">unsigned total_in</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00091">p_unix.h:91</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aeb3e459ee90ee28853a76401b8145123"><div class="ttname"><a href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a></div><div class="ttdeci">unsigned total_out</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00091">p_unix.h:91</a></div></div>
<div class="ttc" id="aclassPackerBase_html_ace3319e7b055b7328edc18f48dba58db"><div class="ttname"><a href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a></div><div class="ttdeci">const upx_int64_t file_size</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00087">packer.h:87</a></div></div>
<div class="ttc" id="aclassPacker_html_a36ee35ba69e590153658a06d471c4184"><div class="ttname"><a href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64</a></div><div class="ttdeci">void set_te64(void *p, upx_uint64_t v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00266">packer.h:266</a></div></div>
<div class="ttc" id="aclassPacker_html_ad01e10cd32d88f80d316455b55bcb1a5"><div class="ttname"><a href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16</a></div><div class="ttdeci">unsigned get_te16(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00261">packer.h:261</a></div></div>
<div class="ttc" id="aclassPacker_html_ae85a3d8295d26480a18f0abea6912451"><div class="ttname"><a href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64</a></div><div class="ttdeci">upx_uint64_t get_te64(const void *p) const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00263">packer.h:263</a></div></div>
<div class="ttc" id="aconf_8h_html_a89d95f84118e61993a0a97429e8b8274"><div class="ttname"><a href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a></div><div class="ttdeci">acc_uint64_t upx_uint64_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00167">conf.h:167</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a21e9cd6b9bcb032db9a6cda007013662"><div class="ttname"><a href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a></div><div class="ttdeci">ElfClass_Host64::Sym Elf64_Sym</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00380">p_elf.h:380</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a7cc1da9f1c15c68a7204d1846d6533ed"><div class="ttname"><a href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a></div><div class="ttdeci">ElfClass_Host64::Shdr Elf64_Shdr</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00376">p_elf.h:376</a></div></div>
<div class="ttc" id="ap__elf_8h_html_aa76cda786f88d3847afd663e85ff85bc"><div class="ttname"><a href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a></div><div class="ttdeci">ElfClass_Host64::Dyn Elf64_Dyn</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00377">p_elf.h:377</a></div></div>
<div class="ttc" id="ap__elf_8h_html_aabcf5f0de441c6290f5828bc243265b3"><div class="ttname"><a href="p__elf_8h.html#aabcf5f0de441c6290f5828bc243265b3">Elf64_Rel</a></div><div class="ttdeci">ElfClass_Host64::Rel Elf64_Rel</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00378">p_elf.h:378</a></div></div>
<div class="ttc" id="ap__elf_8h_html_abbe4299005772efa79a79dc90ccbfc0e"><div class="ttname"><a href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a></div><div class="ttdeci">ElfClass_Host64::Rela Elf64_Rela</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00379">p_elf.h:379</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a5487e5169059653e4841e5aa6fe72859"><div class="ttname"><a href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a></div><div class="ttdeci">static unsigned up8(unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00083">p_lx_elf.cpp:83</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae67031a5cdb8843f862b05500cb6984f"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a></div><div class="ttdeci">static off_t fpad8(OutputFile *fo, unsigned pos)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00115">p_lx_elf.cpp:115</a></div></div>
<div class="ttc" id="asnprintf_8h_html_aa367b75c5aed883fef5befbdf04835a4"><div class="ttname"><a href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a></div><div class="ttdeci">#define snprintf</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8h_source.html#l00061">snprintf.h:61</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html"><div class="ttname"><a href="structElf64__Ehdr.html">Elf64_Ehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00205">bsd.h:206</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a63fca3f9b273e5fd4d190d9cb7fba9b0"><div class="ttname"><a href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a></div><div class="ttdeci">Elf64_Off e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00213">bsd.h:213</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a943c7d038a3cc3c1115e84b4cd19966d"><div class="ttname"><a href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a></div><div class="ttdeci">Elf64_Addr e_entry</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00211">bsd.h:211</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_ae8289d7705794be744876f6246242b9b"><div class="ttname"><a href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a></div><div class="ttdeci">Elf64_Half e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00220">bsd.h:220</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html"><div class="ttname"><a href="structElf64__Phdr.html">Elf64_Phdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00235">bsd.h:236</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_a5c69879e1229b175020ff011af46fcb9"><div class="ttname"><a href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a></div><div class="ttdeci">Elf64_Addr p_vaddr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00240">bsd.h:240</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_a83f4adb032fc307f5af79bdee5ef692d"><div class="ttname"><a href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a></div><div class="ttdeci">Elf64_Addr p_paddr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00241">bsd.h:241</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_aa2d51fb4517ded0c74903f8d0c9abea7"><div class="ttname"><a href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a></div><div class="ttdeci">Elf64_Off p_offset</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00239">bsd.h:239</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a9cf3296ee41855b4ced7b3bdfcaf8e5d"><div class="ttname"><a href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a></div><div class="ttdeci">void * memcpy(C&lt; T &gt; a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00095">xspan_fwd.h:95</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf64.html#a923425254661af8d150e99087569da9f">shdro</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8()</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph" id="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_cgraph">
<area shape="rect" title=" " alt="" coords="5,530,152,570"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="208,245,383,271"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1278,385,1397,411"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="463,296,593,321"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="200,397,391,437"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="463,461,593,487"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="266,860,325,885"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="463,736,593,761"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="231,563,360,588"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="256,636,335,661"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="257,709,333,735"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="464,347,592,372"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="231,811,359,836"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="224,125,367,151"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="272,909,319,935"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="665,215,815,255"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="495,195,561,220"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="1065,860,1208,885"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1483,683,1621,708"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="673,785,807,811"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1693,568,1824,593"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="891,709,981,735"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1092,360,1181,385"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="695,736,785,761"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1274,771,1401,796"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="871,759,1001,784"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1459,757,1645,783"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1731,757,1787,783"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1074,731,1199,756"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1264,619,1411,644"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1525,619,1579,644"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1482,345,1622,371"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1057,515,1216,555"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="868,360,1004,385"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="682,295,798,320"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="907,259,965,284"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="439,56,617,81"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="671,5,809,31"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="863,5,1009,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1113,5,1161,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1292,5,1383,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="1489,5,1615,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph" id="aclassPackLinuxElf64_a6eefcbb2a42d861b12d2c309d93771b8_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,367,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="acf98749f15000ddd7c39f330ec145341" name="acf98749f15000ddd7c39f330ec145341"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf98749f15000ddd7c39f330ec145341">&#9670;&#160;</a></span>buildLinuxLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::buildLinuxLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>szproto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> const *const&#160;</td>
          <td class="paramname"><em>fold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>szfold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01549">1549</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1556</span>{</div>
<div class="line"><span class="lineno"> 1557</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_cprLoader;</div>
<div class="line"><span class="lineno"> 1558</span>    <span class="keywordtype">unsigned</span> sz_cpr = 0;</div>
<div class="line"><span class="lineno"> 1559</span>    <span class="keywordtype">unsigned</span> sz_unc = 0;</div>
<div class="line"><span class="lineno"> 1560</span>    <span class="keywordtype">unsigned</span> method = 0;</div>
<div class="line"><span class="lineno"> 1561</span>    <a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> <span class="keyword">const</span> *uncLoader = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1562</span> </div>
<div class="line"><span class="lineno"> 1563</span>  <span class="keywordflow">if</span> (0 &lt; szfold) {</div>
<div class="line"><span class="lineno"> 1564</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 1565</span>      &amp;&amp; (  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64</div>
<div class="line"><span class="lineno"> 1566</span>         || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_AARCH64)</div>
<div class="line"><span class="lineno"> 1567</span>    ) {</div>
<div class="line"><span class="lineno"> 1568</span>        <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(fold, szfold);</div>
<div class="line"><span class="lineno"> 1569</span><span class="comment">// Typical layout of &#39;sections&#39; in compressed stub code for shared library:</span></div>
<div class="line"><span class="lineno"> 1570</span><span class="comment">//   SO_HEAD</span></div>
<div class="line"><span class="lineno"> 1571</span><span class="comment">//   ptr_NEXT</span></div>
<div class="line"><span class="lineno"> 1572</span><span class="comment">//   EXP_HEAD  NRV getbit(), copy</span></div>
<div class="line"><span class="lineno"> 1573</span><span class="comment">//   NRV2B etc: daisy chain of de-compressor for each method used</span></div>
<div class="line"><span class="lineno"> 1574</span><span class="comment">//   EXP_TAIL  FIXME: unfilter</span></div>
<div class="line"><span class="lineno"> 1575</span><span class="comment">//   SO_TAIL</span></div>
<div class="line"><span class="lineno"> 1576</span><span class="comment">//   SO_MAIN  C-language supervision based on PT_LOADs</span></div>
<div class="line"><span class="lineno"> 1577</span>        <span class="keywordtype">char</span> sec[120];</div>
<div class="line"><span class="lineno"> 1578</span>        <span class="keywordtype">int</span> len = 0;</div>
<div class="line"><span class="lineno"> 1579</span>        <span class="keywordtype">unsigned</span> m_decompr = (<a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> ? <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> : (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>)));</div>
<div class="line"><span class="lineno"> 1580</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(sec, <span class="keyword">sizeof</span>(sec), <span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;SO_HEAD,ptr_NEXT,EXP_HEAD&quot;</span>);</div>
<div class="line"><span class="lineno"> 1581</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1582</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2B&quot;</span>);</div>
<div class="line"><span class="lineno"> 1583</span>        }</div>
<div class="line"><span class="lineno"> 1584</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1585</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2D&quot;</span>);</div>
<div class="line"><span class="lineno"> 1586</span>        }</div>
<div class="line"><span class="lineno"> 1587</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>)|(1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1588</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;NRV2E&quot;</span>);</div>
<div class="line"><span class="lineno"> 1589</span>        }</div>
<div class="line"><span class="lineno"> 1590</span>        <span class="keywordflow">if</span> (((1u&lt;&lt;<a class="code hl_define" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>)) &amp; m_decompr) {</div>
<div class="line"><span class="lineno"> 1591</span>            len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;LZMA_ELF00,LZMA_DEC20,LZMA_DEC30&quot;</span>);</div>
<div class="line"><span class="lineno"> 1592</span>        }</div>
<div class="line"><span class="lineno"> 1593</span>        len += <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(&amp;sec[len], <span class="keyword">sizeof</span>(sec) - len, <span class="stringliteral">&quot;,%s&quot;</span>, <span class="stringliteral">&quot;EXP_TAIL,SO_TAIL,SO_MAIN&quot;</span>);</div>
<div class="line"><span class="lineno"> 1594</span>        (void)len;</div>
<div class="line"><span class="lineno"> 1595</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(sec, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1596</span>        <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1597</span>        {</div>
<div class="line"><span class="lineno"> 1598</span>            <span class="keywordtype">int</span> sz_unc_int;</div>
<div class="line"><span class="lineno"> 1599</span>            uncLoader = linker-&gt;getLoader(&amp;sz_unc_int);</div>
<div class="line"><span class="lineno"> 1600</span>            sz_unc = sz_unc_int;</div>
<div class="line"><span class="lineno"> 1601</span>        }</div>
<div class="line"><span class="lineno"> 1602</span>        method = <a class="code hl_define" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>;  <span class="comment">// requires unaligned fetch</span></div>
<div class="line"><span class="lineno"> 1603</span>    }</div>
<div class="line"><span class="lineno"> 1604</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1605</span>        cprElfHdr1 <span class="keyword">const</span> *<span class="keyword">const</span> hf = (cprElfHdr1 <span class="keyword">const</span> *)fold;</div>
<div class="line"><span class="lineno"> 1606</span>        <span class="keywordtype">unsigned</span> fold_hdrlen = <a class="code hl_function" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7">upx::umax</a>(0x80u, <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(hf-&gt;ehdr) +</div>
<div class="line"><span class="lineno"> 1607</span>            <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_phentsize) * <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hf-&gt;ehdr.e_phnum) +</div>
<div class="line"><span class="lineno"> 1608</span>                <a class="code hl_define" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>(<a class="code hl_struct" href="structl__info.html">l_info</a>) );</div>
<div class="line"><span class="lineno"> 1609</span>        uncLoader = fold_hdrlen + fold;</div>
<div class="line"><span class="lineno"> 1610</span>        sz_unc = ((szfold &lt; fold_hdrlen) ? 0 : (szfold - fold_hdrlen));</div>
<div class="line"><span class="lineno"> 1611</span>        method = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>;</div>
<div class="line"><span class="lineno"> 1612</span>    }</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>    <span class="keyword">struct </span><a class="code hl_struct" href="structb__info.html">b_info</a> h; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;h, 0, <span class="keyword">sizeof</span>(h));</div>
<div class="line"><span class="lineno"> 1615</span>    h.b_method = method;</div>
<div class="line"><span class="lineno"> 1616</span>    <span class="comment">// _Ehdr and _Phdr are NOT filtered, so Leave h.b_ftid and h.b_cto8 as zero.</span></div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>    mb_cprLoader.<a class="code hl_function" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">allocForCompression</a>(<span class="keyword">sizeof</span>(h) + sz_unc);</div>
<div class="line"><span class="lineno"> 1619</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> cprLoader = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)mb_cprLoader;  <span class="comment">// less typing</span></div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>    h.sz_unc = sz_unc;</div>
<div class="line"><span class="lineno"> 1622</span>    h.sz_cpr = mb_cprLoader.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>();  <span class="comment">// max that upx_compress may use</span></div>
<div class="line"><span class="lineno"> 1623</span>    {</div>
<div class="line"><span class="lineno"> 1624</span>        <span class="keywordtype">int</span> r = <a class="code hl_function" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress</a>(uncLoader, sz_unc, <span class="keyword">sizeof</span>(h) + cprLoader, &amp;sz_cpr,</div>
<div class="line"><span class="lineno"> 1625</span>            <span class="keyword">nullptr</span>, <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(method), 10, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span> );</div>
<div class="line"><span class="lineno"> 1626</span>        h.sz_cpr = sz_cpr;  <span class="comment">// actual length used</span></div>
<div class="line"><span class="lineno"> 1627</span>        <span class="keywordflow">if</span> (r != <a class="code hl_define" href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a> || h.sz_cpr &gt;= h.sz_unc)</div>
<div class="line"><span class="lineno"> 1628</span>            <a class="code hl_function" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a>(<span class="stringliteral">&quot;loader compression failed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1629</span>    }</div>
<div class="line"><span class="lineno"> 1630</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h.sz_cpr, h.sz_cpr);</div>
<div class="line"><span class="lineno"> 1631</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h.sz_unc, h.sz_unc);</div>
<div class="line"><span class="lineno"> 1632</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(cprLoader, &amp;h, <span class="keyword">sizeof</span>(h)); <span class="comment">// cprLoader will become FOLDEXEC</span></div>
<div class="line"><span class="lineno"> 1633</span>  }</div>
<div class="line"><span class="lineno"> 1634</span> </div>
<div class="line"><span class="lineno"> 1635</span>    <a class="code hl_function" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">initLoader</a>(proto, szproto, -1, sz_cpr);</div>
<div class="line"><span class="lineno"> 1636</span>    <a class="code hl_function" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a>(<span class="stringliteral">&quot;FOLDEXEC unc=%#x  cpr=%#x\n&quot;</span>, sz_unc, sz_cpr);</div>
<div class="line"><span class="lineno"> 1637</span>    linker-&gt;addSection(<span class="stringliteral">&quot;FOLDEXEC&quot;</span>, mb_cprLoader, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structb__info.html">b_info</a>) + sz_cpr, 0);</div>
<div class="line"><span class="lineno"> 1638</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 1639</span>       &amp;&amp; (  this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_X86_64</div>
<div class="line"><span class="lineno"> 1640</span>          || this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>==Elf64_Ehdr::EM_AARCH64)</div>
<div class="line"><span class="lineno"> 1641</span>    ) {</div>
<div class="line"><span class="lineno"> 1642</span>        <a class="code hl_function" href="classPacker.html#a516182985490860d361a8266fa418235">addLoader</a>(<span class="stringliteral">&quot;ELFMAINX,ELFMAINZ,FOLDEXEC,IDENTSTR&quot;</span>);</div>
<div class="line"><span class="lineno"> 1643</span>    }</div>
<div class="line"><span class="lineno"> 1644</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1645</span>        <a class="code hl_function" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">addStubEntrySections</a>(ft, (<a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a> ? <a class="code hl_variable" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">methods_used</a></div>
<div class="line"><span class="lineno"> 1646</span>                            : (1u &lt;&lt; <a class="code hl_function" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a>(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>))) );</div>
<div class="line"><span class="lineno"> 1647</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 1648</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno"> 1649</span>        }</div>
<div class="line"><span class="lineno"> 1650</span>    }</div>
<div class="line"><span class="lineno"> 1651</span>    <a class="code hl_function" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">relocateLoader</a>();</div>
<div class="line"><span class="lineno"> 1652</span>}</div>
<div class="ttc" id="aclassMemBuffer_html"><div class="ttname"><a href="classMemBuffer.html">MemBuffer</a></div><div class="ttdoc">MemBuffer.</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00187">membuffer.h:187</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a15705698799e612d2ed4b439837c649a"><div class="ttname"><a href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize</a></div><div class="ttdeci">unsigned getSize() const noexcept</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00208">membuffer.h:208</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_aa7fca1d24644887e92e728c1d3f3785f"><div class="ttname"><a href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression</a></div><div class="ttdeci">void allocForCompression(unsigned uncompressed_size, unsigned extra=0) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8cpp_source.html#l00125">membuffer.cpp:125</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab000c2eb42eb50ba4dd570fb0e20e4f2"><div class="ttname"><a href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">PackLinuxElf64::defineSymbols</a></div><div class="ttdeci">virtual void defineSymbols(Filter const *) override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00956">p_lx_elf.cpp:956</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_afe0c06e7772712b8f5cb8a7101a2e052"><div class="ttname"><a href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">PackLinuxElf::addStubEntrySections</a></div><div class="ttdeci">virtual void addStubEntrySections(Filter const *, unsigned m_decompr)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00905">p_lx_elf.cpp:905</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aa33d54bc7392e242453b126d23c3ecbd"><div class="ttname"><a href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">PackUnix::methods_used</a></div><div class="ttdeci">unsigned methods_used</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00104">p_unix.h:104</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a01f3c918e5ce5b4de630d11c703cec05"><div class="ttname"><a href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a></div><div class="ttdeci">PackHeader ph</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00096">packer.h:96</a></div></div>
<div class="ttc" id="aclassPacker_html_a2c9f88864fd7faa59c8130bd59a811a3"><div class="ttname"><a href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">Packer::relocateLoader</a></div><div class="ttdeci">virtual void relocateLoader()</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00841">packer.cpp:841</a></div></div>
<div class="ttc" id="aclassPacker_html_a4af6a45574697d68421e70baef1c8d8c"><div class="ttname"><a href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">Packer::initLoader</a></div><div class="ttdeci">virtual void initLoader(const void *pdata, int plen, int small=-1, int pextra=0)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00760">packer.cpp:760</a></div></div>
<div class="ttc" id="aclassPacker_html_a516182985490860d361a8266fa418235"><div class="ttname"><a href="classPacker.html#a516182985490860d361a8266fa418235">Packer::addLoader</a></div><div class="ttdeci">void addLoader(C)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00773">packer.cpp:773</a></div></div>
<div class="ttc" id="aclassPacker_html_af9cad2c8624ee68213d01eb606be0382"><div class="ttname"><a href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32</a></div><div class="ttdeci">void set_te32(void *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00265">packer.h:265</a></div></div>
<div class="ttc" id="acompress_8cpp_html_a503ce434d639fefff3eee167b8bc5b64"><div class="ttname"><a href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress</a></div><div class="ttdeci">int upx_compress(const upx_bytep src, unsigned src_len, upx_bytep dst, unsigned *dst_len, upx_callback_t *cb, int method, int level, const upx_compress_config_t *cconf, upx_compress_result_t *cresult)</div><div class="ttdef"><b>Definition:</b> <a href="compress_8cpp_source.html#l00064">compress.cpp:64</a></div></div>
<div class="ttc" id="aconf_8h_html_a019151729ec9d9cd6f87106a18fdfb50"><div class="ttname"><a href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a></div><div class="ttdeci">#define M_LZMA</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00599">conf.h:599</a></div></div>
<div class="ttc" id="aconf_8h_html_a1bbfdab7b8396bae1dcb8f14f235d862"><div class="ttname"><a href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a></div><div class="ttdeci">#define M_NRV2E_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00594">conf.h:594</a></div></div>
<div class="ttc" id="aconf_8h_html_a28d10b43a6177d2d5f9b2e76d728d241"><div class="ttname"><a href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a></div><div class="ttdeci">#define upx_byte</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00185">conf.h:185</a></div></div>
<div class="ttc" id="aconf_8h_html_a3143e9be3cc076994dd57e0c1a2ed4d8"><div class="ttname"><a href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a></div><div class="ttdeci">#define M_NRV2E_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00595">conf.h:595</a></div></div>
<div class="ttc" id="aconf_8h_html_a514895bc5cc851af35523494bbdedc36"><div class="ttname"><a href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a></div><div class="ttdeci">#define M_NRV2B_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00588">conf.h:588</a></div></div>
<div class="ttc" id="aconf_8h_html_a5d201f974fac93da9a7fe4821477ca70"><div class="ttname"><a href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a></div><div class="ttdeci">#define M_NRV2B_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00587">conf.h:587</a></div></div>
<div class="ttc" id="aconf_8h_html_a5fc25c01aa02e925d76494b476074a7d"><div class="ttname"><a href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a></div><div class="ttdeci">#define usizeof(expr)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00484">conf.h:484</a></div></div>
<div class="ttc" id="aconf_8h_html_a6633961dc2e4df53ee07eacffeb154d3"><div class="ttname"><a href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a></div><div class="ttdeci">#define UPX_E_OK</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00513">conf.h:513</a></div></div>
<div class="ttc" id="aconf_8h_html_a71fca72da6661281c6b285f5507da415"><div class="ttname"><a href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a></div><div class="ttdeci">#define M_NRV2D_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00590">conf.h:590</a></div></div>
<div class="ttc" id="aconf_8h_html_a7b1664a2d7051a8e85beaa77e98aa157"><div class="ttname"><a href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a></div><div class="ttdeci">#define M_NRV2B_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00589">conf.h:589</a></div></div>
<div class="ttc" id="aconf_8h_html_a8cfb2c5a5eeaaad5aead9d35339242c8"><div class="ttname"><a href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a></div><div class="ttdeci">#define M_NRV2E_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00593">conf.h:593</a></div></div>
<div class="ttc" id="aconf_8h_html_a9c028313c33deb35227a3e5af1b1513d"><div class="ttname"><a href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a></div><div class="ttdeci">#define M_NRV2D_LE16</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00592">conf.h:592</a></div></div>
<div class="ttc" id="aconf_8h_html_aa54a53fd4499f1e86cac93fb7f7b802a"><div class="ttname"><a href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a></div><div class="ttdeci">#define M_NRV2D_8</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00591">conf.h:591</a></div></div>
<div class="ttc" id="aconf_8h_html_af79eab1f480f5a57b6bfbff38256b0d2"><div class="ttname"><a href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a></div><div class="ttdeci">void NO_printf(const char *,...) noexcept attribute_format(1</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00375">conf.h:375</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a57b532c382fd20e682bf0393b6d63050"><div class="ttname"><a href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a></div><div class="ttdeci">void throwInternalError(const char *msg)</div><div class="ttdoc">other</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00128">except.cpp:128</a></div></div>
<div class="ttc" id="anamespaceupx_html_a45583c0cc56452ba56d9a16895c7f0d7"><div class="ttname"><a href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7">upx::umax</a></div><div class="ttdeci">forceinline constexpr T umax(const T &amp;a, const T &amp;b) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cxxlib_8h_source.html#l00254">cxxlib.h:254</a></div></div>
<div class="ttc" id="apackhead_8cpp_html_a772d316c45ac4858f5cffa5f842fff49"><div class="ttname"><a href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method</a></div><div class="ttdeci">int ph_forced_method(int method) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00300">packhead.cpp:300</a></div></div>
<div class="ttc" id="astructPackHeader_html_af1d11217d186dee6524ad3ab35768b0a"><div class="ttname"><a href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a></div><div class="ttdeci">int method</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00052">packhead.h:52</a></div></div>
<div class="ttc" id="astructb__info_html"><div class="ttname"><a href="structb__info.html">b_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00322">bsd.h:322</a></div></div>
<div class="ttc" id="astructl__info_html"><div class="ttname"><a href="structl__info.html">l_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00331">bsd.h:332</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a516182985490860d361a8266fa418235">Packer::addLoader()</a>, <a class="el" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052">PackLinuxElf::addStubEntrySections()</a>, <a class="el" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f">MemBuffer::allocForCompression()</a>, <a class="el" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a>, <a class="el" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2">defineSymbols()</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c">Packer::initLoader()</a>, <a class="el" href="conf_8h.html#a019151729ec9d9cd6f87106a18fdfb50">M_LZMA</a>, <a class="el" href="conf_8h.html#a514895bc5cc851af35523494bbdedc36">M_NRV2B_8</a>, <a class="el" href="conf_8h.html#a7b1664a2d7051a8e85beaa77e98aa157">M_NRV2B_LE16</a>, <a class="el" href="conf_8h.html#a5d201f974fac93da9a7fe4821477ca70">M_NRV2B_LE32</a>, <a class="el" href="conf_8h.html#aa54a53fd4499f1e86cac93fb7f7b802a">M_NRV2D_8</a>, <a class="el" href="conf_8h.html#a9c028313c33deb35227a3e5af1b1513d">M_NRV2D_LE16</a>, <a class="el" href="conf_8h.html#a71fca72da6661281c6b285f5507da415">M_NRV2D_LE32</a>, <a class="el" href="conf_8h.html#a1bbfdab7b8396bae1dcb8f14f235d862">M_NRV2E_8</a>, <a class="el" href="conf_8h.html#a3143e9be3cc076994dd57e0c1a2ed4d8">M_NRV2E_LE16</a>, <a class="el" href="conf_8h.html#a8cfb2c5a5eeaaad5aead9d35339242c8">M_NRV2E_LE32</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a>, <a class="el" href="classPackUnix.html#aa33d54bc7392e242453b126d23c3ecbd">PackUnix::methods_used</a>, <a class="el" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49">ph_forced_method()</a>, <a class="el" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3">Packer::relocateLoader()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a>, <a class="el" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError()</a>, <a class="el" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7">upx::umax()</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, <a class="el" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64">upx_compress()</a>, <a class="el" href="conf_8h.html#a6633961dc2e4df53ee07eacffeb154d3">UPX_E_OK</a>, <a class="el" href="conf_8h.html#a5fc25c01aa02e925d76494b476074a7d">usizeof</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64amd.html#a4e925c41e1f85114a34b4fec6a0bfc18">PackLinuxElf64amd::buildLoader()</a>, <a class="el" href="classPackLinuxElf64arm.html#a433b6323d27480148574ea89b6ee3634">PackLinuxElf64arm::buildLoader()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#adeb403f68ec4aeb636a5ecf2ce9039f1">PackLinuxElf64ppcle::buildLoader()</a>, and <a class="el" href="classPackLinuxElf64ppc.html#ad2998d239264bc145084afbd56fec5b7">PackLinuxElf64ppc::buildLoader()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph" id="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_cgraph">
<area shape="rect" title=" " alt="" coords="5,406,200,446"/>
<area shape="rect" href="classPacker.html#a516182985490860d361a8266fa418235" title=" " alt="" coords="569,24,709,49"/>
<area shape="rect" href="classPackLinuxElf.html#afe0c06e7772712b8f5cb8a7101a2e052" title=" " alt="" coords="261,70,459,110"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="568,130,711,156"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="520,286,759,312"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1179,186,1255,212"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1175,237,1259,262"/>
<area shape="rect" href="namespaceupx.html#a45583c0cc56452ba56d9a16895c7f0d7" title=" " alt="" coords="1171,461,1262,486"/>
<area shape="rect" href="classPackLinuxElf64.html#ab000c2eb42eb50ba4dd570fb0e20e4f2" title=" " alt="" coords="248,388,472,413"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="295,437,425,462"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="285,486,435,512"/>
<area shape="rect" href="classPacker.html#a4af6a45574697d68421e70baef1c8d8c" title=" " alt="" coords="291,536,429,561"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="1177,650,1256,676"/>
<area shape="rect" href="classPacker.html#a2c9f88864fd7faa59c8130bd59a811a3" title=" " alt="" coords="275,977,445,1002"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1147,902,1287,928"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="296,853,424,878"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="581,593,697,618"/>
<area shape="rect" href="classPacker.html#aaf81a88111b09b6bd3353864484510b7" title=" " alt="" coords="855,24,1013,49"/>
<area shape="rect" href="classPacker.html#a0c72885ba3799acf227862f721ddd5ab" title=" " alt="" coords="546,77,733,102"/>
<area shape="rect" href="packhead_8cpp.html#a99fd3f5cbc734f9863205a1e892ea48c" title="ph method util" alt="" coords="853,130,1015,156"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="867,286,1001,312"/>
<area shape="rect" href="classMemBuffer.html#a3dcd6ad1b690292fd215302825ceaf5b" title=" " alt="" coords="807,486,1061,512"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1172,412,1261,437"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1176,853,1257,878"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1109,336,1324,361"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1139,286,1294,312"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1372,512,1491,537"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="536,388,743,413"/>
<area shape="rect" href="packer_8cpp.html#afa767aba089a4d3b97fe3a1f391004d0" title="loader util (interface to linker)" alt="" coords="593,445,686,470"/>
<area shape="rect" href="classPacker.html#aa7fe94299cf76c70de7ed953aa774330" title=" " alt="" coords="570,494,709,520"/>
<area shape="rect" href="namespaceupx.html#a0c83095d93809bd5537d12d7217b1b64" title=" " alt="" coords="568,544,711,569"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="910,853,958,878"/>
<area shape="rect" href="util_8cpp.html#a9d6effb3a2dacaed842c2e588220b3d5" title=" " alt="" coords="879,536,989,561"/>
<area shape="rect" href="conf_8h.html#a24c77e0d6845ec1a80a990def321c620" title=" " alt="" coords="863,388,1005,413"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1171,804,1262,829"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="1177,1253,1256,1278"/>
<area shape="rect" href="classPacker.html#a6e094d3b47373817a66457952f26dc70" title=" " alt="" coords="571,934,708,960"/>
<area shape="rect" href="classPacker.html#a5239dbc85d3edd59b558deb94ed8e40d" title=" " alt="" coords="547,870,732,910"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="818,1152,1050,1177"/>
<area shape="rect" href="structPackHeader.html#a3c61166ce01a954f2c2ec5c9a563f478" title="see stub/src/include/header.S" alt="" coords="537,1028,742,1053"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1390,1253,1473,1278"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="870,902,998,928"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1147,1052,1286,1077"/>
<area shape="rect" href="packhead_8cpp.html#a316db91362bd31b5ff8c167f8456ead5" title="extremely simple checksum for the header itself (since version 10)" alt="" coords="835,1253,1033,1278"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="889,1102,979,1128"/>
<area shape="rect" href="bele_8h.html#abc3e7ac42e0d364d55e526be7243cc7f" title=" " alt="" coords="893,952,975,977"/>
<area shape="rect" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1" title=" " alt="" coords="895,1053,973,1078"/>
<area shape="rect" href="structupx__compress__result__t.html#a92ddd8771e00cf86eedb13cda3e3c52c" title=" " alt="" coords="854,586,1014,626"/>
<area shape="rect" href="compress__lzma_8cpp.html#a16968f66ecd1f6e7a199462fc20b5b9c" title=" " alt="" coords="857,437,1011,462"/>
<area shape="rect" href="compress__ucl_8cpp.html#aee4e34700d3f36ec3ae2aee005649204" title=" " alt="" coords="863,650,1005,676"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph" id="aclassPackLinuxElf64_acf98749f15000ddd7c39f330ec145341_icgraph">
<area shape="rect" title=" " alt="" coords="211,101,405,141"/>
<area shape="rect" href="classPackLinuxElf64amd.html#a4e925c41e1f85114a34b4fec6a0bfc18" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#a433b6323d27480148574ea89b6ee3634" title=" " alt="" coords="7,69,161,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#adeb403f68ec4aeb636a5ecf2ce9039f1" title=" " alt="" coords="7,133,161,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#ad2998d239264bc145084afbd56fec5b7" title=" " alt="" coords="9,197,159,237"/>
</map>
</div>

</div>
</div>
<a id="af4b086d6062198ab02e25fcc4cd5a2c3" name="af4b086d6062198ab02e25fcc4cd5a2c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b086d6062198ab02e25fcc4cd5a2c3">&#9670;&#160;</a></span>calls_crt1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PackLinuxElf64::calls_crt1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> const *&#160;</td>
          <td class="paramname"><em>rela</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02400">2400</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2401</span>{</div>
<div class="line"><span class="lineno"> 2402</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> || !<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> || !rela) {</div>
<div class="line"><span class="lineno"> 2403</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2404</span>    }</div>
<div class="line"><span class="lineno"> 2405</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> relnum= 0; 0 &lt; sz; (sz -= <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>)), ++rela, ++relnum) {</div>
<div class="line"><span class="lineno"> 2406</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symnum = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_info) &gt;&gt; 32;</div>
<div class="line"><span class="lineno"> 2407</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> symnam = <a class="code hl_function" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name</a>(symnum, relnum);</div>
<div class="line"><span class="lineno"> 2408</span>        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__libc_start_main&quot;</span>)  <span class="comment">// glibc</span></div>
<div class="line"><span class="lineno"> 2409</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__libc_init&quot;</span>)  <span class="comment">// Android</span></div>
<div class="line"><span class="lineno"> 2410</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__uClibc_main&quot;</span>)</div>
<div class="line"><span class="lineno"> 2411</span>        ||  0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(symnam, <span class="stringliteral">&quot;__uClibc_start_main&quot;</span>))</div>
<div class="line"><span class="lineno"> 2412</span>            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2413</span>    }</div>
<div class="line"><span class="lineno"> 2414</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2415</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a0587b38413f853b20625a28bf2a369e8"><div class="ttname"><a href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">PackLinuxElf64::get_dynsym_name</a></div><div class="ttdeci">char const * get_dynsym_name(unsigned symnum, unsigned relnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02391">p_lx_elf.cpp:2391</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a6ec71c63b3b76a8847d2a5989c2f3fbb"><div class="ttname"><a href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a></div><div class="ttdeci">char const  * dynstr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00089">p_lx_elf.h:89</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, and <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph" id="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_cgraph">
<area shape="rect" title=" " alt="" coords="5,98,196,123"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="244,33,393,73"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="254,98,383,123"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="285,171,352,197"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="441,5,591,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="451,70,581,95"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="639,13,757,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph" id="aclassPackLinuxElf64_af4b086d6062198ab02e25fcc4cd5a2c3_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,425,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a3f8b3a6d6203c2a09d5058a18423fee2" name="a3f8b3a6d6203c2a09d5058a18423fee2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f8b3a6d6203c2a09d5058a18423fee2">&#9670;&#160;</a></span>canPack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tribool PackLinuxElf64::canPack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03008">3008</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3009</span>{</div>
<div class="line"><span class="lineno"> 3010</span>    <span class="keyword">union </span>{</div>
<div class="line"><span class="lineno"> 3011</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[<a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>];</div>
<div class="line"><span class="lineno"> 3012</span>        <span class="comment">//struct { Elf64_Ehdr ehdr; Elf64_Phdr phdr; } e;</span></div>
<div class="line"><span class="lineno"> 3013</span>    } u;</div>
<div class="line"><span class="lineno"> 3014</span>    <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(u) &lt;= (2*1024))</div>
<div class="line"><span class="lineno"> 3015</span> </div>
<div class="line"><span class="lineno"> 3016</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;readx(u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, sizeof(u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>));</div>
<div class="line"><span class="lineno"> 3017</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;seek(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3018</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> const *const ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *) u.<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>;</div>
<div class="line"><span class="lineno"> 3019</span> </div>
<div class="line"><span class="lineno"> 3020</span>    <span class="comment">// now check the ELF header</span></div>
<div class="line"><span class="lineno"> 3021</span>    if (<a class="code hl_function" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr</a>(ehdr) != 0)</div>
<div class="line"><span class="lineno"> 3022</span>        return false;</div>
<div class="line"><span class="lineno"> 3023</span> </div>
<div class="line"><span class="lineno"> 3024</span>    <span class="comment">// additional requirements for linux/elf386</span></div>
<div class="line"><span class="lineno"> 3025</span>    if (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_ehsize) != sizeof(*ehdr)) {</div>
<div class="line"><span class="lineno"> 3026</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;invalid Ehdr e_ehsize; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3027</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3028</span>    }</div>
<div class="line"><span class="lineno"> 3029</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> != <span class="keyword">sizeof</span>(*ehdr)) {<span class="comment">// Phdrs not contiguous with Ehdr</span></div>
<div class="line"><span class="lineno"> 3030</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;non-contiguous Ehdr/Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3031</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3032</span>    }</div>
<div class="line"><span class="lineno"> 3033</span> </div>
<div class="line"><span class="lineno"> 3034</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> max_LOADsz = 0, max_offset = 0;</div>
<div class="line"><span class="lineno"> 3035</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 3036</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3037</span>        <span class="keywordflow">if</span> (j &gt; ((<a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>)) / <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>))) {</div>
<div class="line"><span class="lineno"> 3038</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many ElfXX_Phdr; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3039</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3040</span>        }</div>
<div class="line"><span class="lineno"> 3041</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno"> 3042</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == p_type) {</div>
<div class="line"><span class="lineno"> 3043</span>            <span class="comment">// The first PT_LOAD64 must cover the beginning of the file (0==p_offset).</span></div>
<div class="line"><span class="lineno"> 3044</span>            <span class="keywordflow">if</span> (1!= <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a>) {</div>
<div class="line"><span class="lineno"> 3045</span>                <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 1;</div>
<div class="line"><span class="lineno"> 3046</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);  <span class="comment">// class data member</span></div>
<div class="line"><span class="lineno"> 3047</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 3048</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> off = ~page_mask &amp; <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>;</div>
<div class="line"><span class="lineno"> 3049</span>                <span class="keywordflow">if</span> (off &amp;&amp; off == p_offset) { <span class="comment">// specific hint</span></div>
<div class="line"><span class="lineno"> 3050</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;Go-language PT_LOAD: try hemfix.c, or try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3051</span>                    <span class="comment">// Fixing it inside upx fails because packExtent() reads original file.</span></div>
<div class="line"><span class="lineno"> 3052</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3053</span>                }</div>
<div class="line"><span class="lineno"> 3054</span>                <span class="keywordflow">if</span> (0 != p_offset) { <span class="comment">// 1st PT_LOAD must cover Ehdr and Phdr</span></div>
<div class="line"><span class="lineno"> 3055</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;first PT_LOAD.p_offset != 0; try &#39;--force-execve&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3056</span>                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3057</span>                }</div>
<div class="line"><span class="lineno"> 3058</span>                <span class="comment">// FIXME: bad for shlib!</span></div>
<div class="line"><span class="lineno"> 3059</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">hatch_off</a> = ~3ul &amp; (3+ <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>));</div>
<div class="line"><span class="lineno"> 3060</span>            }</div>
<div class="line"><span class="lineno"> 3061</span>            max_LOADsz = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>));</div>
<div class="line"><span class="lineno"> 3062</span>            max_offset = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_offset, <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>));</div>
<div class="line"><span class="lineno"> 3063</span>        }</div>
<div class="line"><span class="lineno"> 3064</span>    }</div>
<div class="line"><span class="lineno"> 3065</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack</a>()) {</div>
<div class="line"><span class="lineno"> 3066</span>        <a class="code hl_function" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a>();</div>
<div class="line"><span class="lineno"> 3067</span>    }</div>
<div class="line"><span class="lineno"> 3068</span>    <span class="comment">// Heuristic for lopped trailing PackHeader (packed and &quot;hacked&quot;!)</span></div>
<div class="line"><span class="lineno"> 3069</span>    <span class="keywordflow">if</span> (3 == <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>  <span class="comment">// not shlib: PT_LOAD.C_BASE, PT_LOAD.C_TEXT, PT_GNU_STACK</span></div>
<div class="line"><span class="lineno"> 3070</span>    &amp;&amp; <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> == <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;((<a class="code hl_struct" href="structl__info.html">l_info</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>])-&gt;l_magic)) {</div>
<div class="line"><span class="lineno"> 3071</span>        <a class="code hl_function" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a>();</div>
<div class="line"><span class="lineno"> 3072</span>    }</div>
<div class="line"><span class="lineno"> 3073</span>    <span class="comment">// We want to compress position-independent executable (gcc -pie)</span></div>
<div class="line"><span class="lineno"> 3074</span>    <span class="comment">// main programs, but compressing a shared library must be avoided</span></div>
<div class="line"><span class="lineno"> 3075</span>    <span class="comment">// because the result is no longer usable.  In theory, there is no way</span></div>
<div class="line"><span class="lineno"> 3076</span>    <span class="comment">// to tell them apart: both are just ET_DYN.  Also in theory,</span></div>
<div class="line"><span class="lineno"> 3077</span>    <span class="comment">// neither the presence nor the absence of any particular symbol name</span></div>
<div class="line"><span class="lineno"> 3078</span>    <span class="comment">// can be used to tell them apart; there are counterexamples.</span></div>
<div class="line"><span class="lineno"> 3079</span>    <span class="comment">// However, we will use the following heuristic suggested by</span></div>
<div class="line"><span class="lineno"> 3080</span>    <span class="comment">// Peter S. Mazinger &lt;ps.m@gmx.net&gt; September 2005:</span></div>
<div class="line"><span class="lineno"> 3081</span>    <span class="comment">// If a ET_DYN has __libc_start_main as a global undefined symbol,</span></div>
<div class="line"><span class="lineno"> 3082</span>    <span class="comment">// then the file is a position-independent executable main program</span></div>
<div class="line"><span class="lineno"> 3083</span>    <span class="comment">// (that depends on libc.so.6) and is eligible to be compressed.</span></div>
<div class="line"><span class="lineno"> 3084</span>    <span class="comment">// Otherwise (no __libc_start_main as global undefined): skip it.</span></div>
<div class="line"><span class="lineno"> 3085</span>    <span class="comment">// Also allow  __uClibc_main  and  __uClibc_start_main .</span></div>
<div class="line"><span class="lineno"> 3086</span> </div>
<div class="line"><span class="lineno"> 3087</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_DYN==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_type)) {</div>
<div class="line"><span class="lineno"> 3088</span>        <span class="comment">// The DT_SYMTAB has no designated length.  Read the whole file.</span></div>
<div class="line"><span class="lineno"> 3089</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 3090</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 3091</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 3092</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, ehdr, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 3093</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>= (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)((<span class="keywordtype">size_t</span>)<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 3094</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)((<span class="keywordtype">size_t</span>)<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 3095</span> </div>
<div class="line"><span class="lineno"> 3096</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3097</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 3098</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno"> 3099</span>            <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_shstrndx);</div>
<div class="line"><span class="lineno"> 3100</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) {</div>
<div class="line"><span class="lineno"> 3101</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) {</div>
<div class="line"><span class="lineno"> 3102</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3103</span>                        <span class="stringliteral">&quot;bad e_shstrndx %#x &gt;= e_shnum %d&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 3104</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3105</span>                }</div>
<div class="line"><span class="lineno"> 3106</span>                <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>];</div>
<div class="line"><span class="lineno"> 3107</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 3108</span>                <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= sh_offset) {</div>
<div class="line"><span class="lineno"> 3109</span>                    <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3110</span>                        <span class="stringliteral">&quot;bad .e_shstrndx-&gt;sh_offset %#lx&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)sh_offset);</div>
<div class="line"><span class="lineno"> 3111</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3112</span>                }</div>
<div class="line"><span class="lineno"> 3113</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(sh_offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 3114</span>            }</div>
<div class="line"><span class="lineno"> 3115</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 3116</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 3117</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_link = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_link);</div>
<div class="line"><span class="lineno"> 3118</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= sh_link) {</div>
<div class="line"><span class="lineno"> 3119</span>                    <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3120</span>                        <span class="stringliteral">&quot;bad SHT_DYNSYM.sh_link %#x&quot;</span>, sh_link);</div>
<div class="line"><span class="lineno"> 3121</span>                }</div>
<div class="line"><span class="lineno"> 3122</span>                <a class="code hl_variable" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[sh_link];</div>
<div class="line"><span class="lineno"> 3123</span>            }</div>
<div class="line"><span class="lineno"> 3124</span> </div>
<div class="line"><span class="lineno"> 3125</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>) {</div>
<div class="line"><span class="lineno"> 3126</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_name);</div>
<div class="line"><span class="lineno"> 3127</span>                <span class="keywordflow">if</span> (Elf64_Shdr::SHT_STRTAB != <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_type)</div>
<div class="line"><span class="lineno"> 3128</span>                || (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= (<span class="keyword">sizeof</span>(<span class="stringliteral">&quot;.shstrtab&quot;</span>)</div>
<div class="line"><span class="lineno"> 3129</span>                    + sh_name + (<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> - (<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0]))</div>
<div class="line"><span class="lineno"> 3130</span>                || (sh_name</div>
<div class="line"><span class="lineno"> 3131</span>                  &amp;&amp; 0!=<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>((<span class="keywordtype">char</span> <span class="keyword">const</span> *)<span class="stringliteral">&quot;.shstrtab&quot;</span>, &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[sh_name]))</div>
<div class="line"><span class="lineno"> 3132</span>                ) {</div>
<div class="line"><span class="lineno"> 3133</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad e_shstrtab&quot;</span>);</div>
<div class="line"><span class="lineno"> 3134</span>                }</div>
<div class="line"><span class="lineno"> 3135</span>            }</div>
<div class="line"><span class="lineno"> 3136</span>        }</div>
<div class="line"><span class="lineno"> 3137</span> </div>
<div class="line"><span class="lineno"> 3138</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *pload_x0(<span class="keyword">nullptr</span>);  <span class="comment">// first eXecutable PT_LOAD</span></div>
<div class="line"><span class="lineno"> 3139</span>        phdr= <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 3140</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ++phdr)</div>
<div class="line"><span class="lineno"> 3141</span>        <span class="keywordflow">if</span> (Elf64_Phdr::PT_DYNAMIC==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 3142</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic</a>(phdr);</div>
<div class="line"><span class="lineno"> 3143</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>= (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 3144</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>,</div>
<div class="line"><span class="lineno"> 3145</span>                <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>), <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - offset));</div>
<div class="line"><span class="lineno"> 3146</span>        }</div>
<div class="line"><span class="lineno"> 3147</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">is_LOAD64</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 3148</span>            <span class="keywordflow">if</span> (!pload_x0</div>
<div class="line"><span class="lineno"> 3149</span>            &amp;&amp;  Elf64_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>)</div>
<div class="line"><span class="lineno"> 3150</span>            ) {</div>
<div class="line"><span class="lineno"> 3151</span>                pload_x0 = phdr;</div>
<div class="line"><span class="lineno"> 3152</span>            }</div>
<div class="line"><span class="lineno"> 3153</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load</a>(phdr);</div>
<div class="line"><span class="lineno"> 3154</span>        }</div>
<div class="line"><span class="lineno"> 3155</span>        <span class="keywordflow">if</span> (!pload_x0) {</div>
<div class="line"><span class="lineno"> 3156</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;No PT_LOAD has (p_flags &amp; PF_X)&quot;</span>);</div>
<div class="line"><span class="lineno"> 3157</span>        }</div>
<div class="line"><span class="lineno"> 3158</span>        <span class="comment">// elf_find_dynamic() returns 0 if 0==dynseg.</span></div>
<div class="line"><span class="lineno"> 3159</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>=          (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 3160</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>= (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> <span class="comment">/*const*/</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_SYMTAB);</div>
<div class="line"><span class="lineno"> 3161</span> </div>
<div class="line"><span class="lineno"> 3162</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.force_pie</div>
<div class="line"><span class="lineno"> 3163</span>        ||       Elf64_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_FLAGS_1)</div>
<div class="line"><span class="lineno"> 3164</span>        ||  <a class="code hl_function" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1</a>((<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_RELA),</div>
<div class="line"><span class="lineno"> 3165</span>                                  (<span class="keywordtype">int</span>)<a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELASZ))</div>
<div class="line"><span class="lineno"> 3166</span>        ||  <a class="code hl_function" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1</a>((<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_JMPREL),</div>
<div class="line"><span class="lineno"> 3167</span>                                  (<span class="keywordtype">int</span>)<a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_PLTRELSZ))) {</div>
<div class="line"><span class="lineno"> 3168</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">is_pie</a> = <span class="keyword">true</span>;  <span class="comment">// UNUSED except to ignore is_shlib and xct_off</span></div>
<div class="line"><span class="lineno"> 3169</span>            <span class="keywordflow">goto</span> proceed;  <span class="comment">// calls C library init for main program</span></div>
<div class="line"><span class="lineno"> 3170</span>        }</div>
<div class="line"><span class="lineno"> 3171</span> </div>
<div class="line"><span class="lineno"> 3172</span>        <span class="comment">// Heuristic HACK for shared libraries (compare Darwin (MacOS) Dylib.)</span></div>
<div class="line"><span class="lineno"> 3173</span>        <span class="comment">// If there is an existing DT_INIT, and if everything that the dynamic</span></div>
<div class="line"><span class="lineno"> 3174</span>        <span class="comment">// linker ld-linux needs to perform relocations before calling DT_INIT</span></div>
<div class="line"><span class="lineno"> 3175</span>        <span class="comment">// resides below the first SHT_EXECINSTR Section in one PT_LOAD, then</span></div>
<div class="line"><span class="lineno"> 3176</span>        <span class="comment">// compress from the first executable Section to the end of that PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 3177</span>        <span class="comment">// We must not alter anything that ld-linux might touch before it calls</span></div>
<div class="line"><span class="lineno"> 3178</span>        <span class="comment">// the DT_INIT function.</span></div>
<div class="line"><span class="lineno"> 3179</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3180</span>        <span class="comment">// Obviously this hack requires that the linker script put pieces</span></div>
<div class="line"><span class="lineno"> 3181</span>        <span class="comment">// into good positions when building the original shared library,</span></div>
<div class="line"><span class="lineno"> 3182</span>        <span class="comment">// and also requires ld-linux to behave.</span></div>
<div class="line"><span class="lineno"> 3183</span> </div>
<div class="line"><span class="lineno"> 3184</span>        <span class="keywordflow">if</span> (<span class="comment">/*jni_onload_sym ||*/</span> <a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>)) {</div>
<div class="line"><span class="lineno"> 3185</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic</a>(Elf64_Dyn::DT_TEXTREL)) {</div>
<div class="line"><span class="lineno"> 3186</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;DT_TEXTREL found; re-compile with -fPIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 3187</span>                <span class="keywordflow">goto</span> abandon;</div>
<div class="line"><span class="lineno"> 3188</span>            }</div>
<div class="line"><span class="lineno"> 3189</span>            <span class="keywordflow">if</span> (!(Elf64_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_FLAGS_1))) {</div>
<div class="line"><span class="lineno"> 3190</span>                <span class="comment">// not explicitly PIE main program</span></div>
<div class="line"><span class="lineno"> 3191</span>                <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>  <span class="comment">// Android is common</span></div>
<div class="line"><span class="lineno"> 3192</span>                &amp;&amp;  !<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib  <span class="comment">// but not explicit</span></div>
<div class="line"><span class="lineno"> 3193</span>                &amp;&amp;    !<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a></div>
<div class="line"><span class="lineno"> 3194</span>                ) {</div>
<div class="line"><span class="lineno"> 3195</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode++;</div>
<div class="line"><span class="lineno"> 3196</span>                    <a class="code hl_function" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a>(<span class="stringliteral">&quot;note: use --android-shlib if appropriate&quot;</span>);</div>
<div class="line"><span class="lineno"> 3197</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode--;</div>
<div class="line"><span class="lineno"> 3198</span>                }</div>
<div class="line"><span class="lineno"> 3199</span>            }</div>
<div class="line"><span class="lineno"> 3200</span>            <span class="keywordflow">if</span> (Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine)) {</div>
<div class="line"><span class="lineno"> 3201</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;This test UPX cannot pack .so for PowerPC64; coming soon.&quot;</span>);</div>
<div class="line"><span class="lineno"> 3202</span>            }</div>
<div class="line"><span class="lineno"> 3203</span>            <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 3204</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = ~0ull;</div>
<div class="line"><span class="lineno"> 3205</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) {</div>
<div class="line"><span class="lineno"> 3206</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; --j&gt;=0; ++shdr) {</div>
<div class="line"><span class="lineno"> 3207</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 3208</span>                    <span class="keywordflow">if</span> (Elf64_Shdr::SHF_EXECINSTR &amp; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags)) {</div>
<div class="line"><span class="lineno"> 3209</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>, <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr));</div>
<div class="line"><span class="lineno"> 3210</span>                    }</div>
<div class="line"><span class="lineno"> 3211</span>                    <span class="comment">// Hook the first slot of DT_PREINIT_ARRAY or DT_INIT_ARRAY.</span></div>
<div class="line"><span class="lineno"> 3212</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> &amp;&amp; (</div>
<div class="line"><span class="lineno"> 3213</span>                           (     Elf64_Dyn::DT_PREINIT_ARRAY==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></div>
<div class="line"><span class="lineno"> 3214</span>                           &amp;&amp;  Elf64_Shdr::SHT_PREINIT_ARRAY==sh_type)</div>
<div class="line"><span class="lineno"> 3215</span>                        || (     Elf64_Dyn::DT_INIT_ARRAY   ==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a></div>
<div class="line"><span class="lineno"> 3216</span>                           &amp;&amp;  Elf64_Shdr::SHT_INIT_ARRAY   ==sh_type) )) {</div>
<div class="line"><span class="lineno"> 3217</span>                        <span class="keywordtype">unsigned</span> user_init_ava = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 3218</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 3219</span>                        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>) {</div>
<div class="line"><span class="lineno"> 3220</span>                            <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3221</span>                                <span class="stringliteral">&quot;bad Elf64_Shdr[%d].sh_offset %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 3222</span>                                -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> - j, <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>);</div>
<div class="line"><span class="lineno"> 3223</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3224</span>                        }</div>
<div class="line"><span class="lineno"> 3225</span>                        <span class="comment">// Check that &amp;file_image[user_init_off] has</span></div>
<div class="line"><span class="lineno"> 3226</span>                        <span class="comment">// *_RELATIVE or *_ABS* relocation, and fetch user_init_va.</span></div>
<div class="line"><span class="lineno"> 3227</span>                        <span class="comment">// If Elf_Rela then the actual value is in Rela.r_addend.</span></div>
<div class="line"><span class="lineno"> 3228</span>                        <span class="keywordtype">int</span> z_rel = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_RELA];</div>
<div class="line"><span class="lineno"> 3229</span>                        <span class="keywordtype">int</span> z_rsz = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_RELASZ];</div>
<div class="line"><span class="lineno"> 3230</span>                        <span class="keywordflow">if</span> (z_rel &amp;&amp; z_rsz) {</div>
<div class="line"><span class="lineno"> 3231</span>                            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> rel_off = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>[-1+ z_rel].d_val);</div>
<div class="line"><span class="lineno"> 3232</span>                            <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= rel_off) {</div>
<div class="line"><span class="lineno"> 3233</span>                                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3234</span>                                     <span class="stringliteral">&quot;bad Elf64_Dynamic[DT_RELA] %#llx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3235</span>                                     rel_off);</div>
<div class="line"><span class="lineno"> 3236</span>                                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3237</span>                            }</div>
<div class="line"><span class="lineno"> 3238</span>                            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rp = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[rel_off];</div>
<div class="line"><span class="lineno"> 3239</span>                            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> relsz   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>[-1+ z_rsz].d_val);</div>
<div class="line"><span class="lineno"> 3240</span>                            <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= relsz) {</div>
<div class="line"><span class="lineno"> 3241</span>                                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3242</span>                                     <span class="stringliteral">&quot;bad Elf64_Dynamic[DT_RELASZ] %#llx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3243</span>                                     relsz);</div>
<div class="line"><span class="lineno"> 3244</span>                                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3245</span>                            }</div>
<div class="line"><span class="lineno"> 3246</span>                            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *last = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)(relsz + (<span class="keywordtype">char</span> *)rp);</div>
<div class="line"><span class="lineno"> 3247</span>                            <span class="keywordflow">for</span> (; rp &lt; last; ++rp) {</div>
<div class="line"><span class="lineno"> 3248</span>                                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_va = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 3249</span>                                <span class="keywordflow">if</span> (r_va == user_init_ava) { <span class="comment">// found the Elf64_Rela</span></div>
<div class="line"><span class="lineno"> 3250</span>                                    <a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> = rp;</div>
<div class="line"><span class="lineno"> 3251</span>                                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_info);</div>
<div class="line"><span class="lineno"> 3252</span>                                    <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 3253</span>                                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0].st_name, r_va);  <span class="comment">// for decompressor</span></div>
<div class="line"><span class="lineno"> 3254</span>                                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0].st_value, r_info);</div>
<div class="line"><span class="lineno"> 3255</span>                                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0].st_size, <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_addend));</div>
<div class="line"><span class="lineno"> 3256</span>                                    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 3257</span>                                        <span class="keywordflow">if</span> (R_AARCH64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 3258</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 3259</span>                                        }</div>
<div class="line"><span class="lineno"> 3260</span>                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_AARCH64_ABS64 == r_type) {</div>
<div class="line"><span class="lineno"> 3261</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[ELF64_R_SYM(r_info)].st_value);</div>
<div class="line"><span class="lineno"> 3262</span>                                        }</div>
<div class="line"><span class="lineno"> 3263</span>                                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3264</span>                                            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3265</span>                                                <span class="stringliteral">&quot;bad relocation %#llx DT_INIT_ARRAY[0]&quot;</span>,</div>
<div class="line"><span class="lineno"> 3266</span>                                                r_info);</div>
<div class="line"><span class="lineno"> 3267</span>                                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3268</span>                                        }</div>
<div class="line"><span class="lineno"> 3269</span>                                    }</div>
<div class="line"><span class="lineno"> 3270</span>                                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf64_Ehdr::EM_X86_64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 3271</span>                                        <span class="keywordflow">if</span> (R_X86_64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 3272</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 3273</span>                                        }</div>
<div class="line"><span class="lineno"> 3274</span>                                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_X86_64_64 == r_type) {</div>
<div class="line"><span class="lineno"> 3275</span>                                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[ELF64_R_SYM(r_info)].st_value);</div>
<div class="line"><span class="lineno"> 3276</span>                                        }</div>
<div class="line"><span class="lineno"> 3277</span>                                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3278</span>                                            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3279</span>                                                <span class="stringliteral">&quot;bad relocation %#llx DT_INIT_ARRAY[0]&quot;</span>,</div>
<div class="line"><span class="lineno"> 3280</span>                                                r_info);</div>
<div class="line"><span class="lineno"> 3281</span>                                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3282</span>                                        }</div>
<div class="line"><span class="lineno"> 3283</span>                                    }</div>
<div class="line"><span class="lineno"> 3284</span>                                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3285</span>                                }</div>
<div class="line"><span class="lineno"> 3286</span>                            }</div>
<div class="line"><span class="lineno"> 3287</span>                        }</div>
<div class="line"><span class="lineno"> 3288</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> p_filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;pload_x0-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 3289</span>                        <span class="keywordflow">if</span> (!((<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> - <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>) &lt; p_filesz)) {</div>
<div class="line"><span class="lineno"> 3290</span>                            <span class="comment">// Not in executable portion of first executable PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 3291</span>                            <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> &amp;&amp; <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib) {</div>
<div class="line"><span class="lineno"> 3292</span>                                <span class="comment">// Android allows (0 ==&gt; skip) ?</span></div>
<div class="line"><span class="lineno"> 3293</span>                                <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = 0;  <span class="comment">// force steal of &#39;extra&#39; DT_NULL</span></div>
<div class="line"><span class="lineno"> 3294</span>                                <span class="comment">// XXX: FIXME: depends on SHT_DYNAMIC coming later</span></div>
<div class="line"><span class="lineno"> 3295</span>                            }</div>
<div class="line"><span class="lineno"> 3296</span>                            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3297</span>                                <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 3298</span>                                    <span class="stringliteral">&quot;bad init address %#x in Elf64_Shdr[%d].%#x\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3299</span>                                    (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a>, -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> - j, <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>);</div>
<div class="line"><span class="lineno"> 3300</span>                                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 3301</span>                            }</div>
<div class="line"><span class="lineno"> 3302</span>                        }</div>
<div class="line"><span class="lineno"> 3303</span>                    }</div>
<div class="line"><span class="lineno"> 3304</span>                    <span class="comment">// By default /usr/bin/ld leaves 4 extra DT_NULL to support pre-linking.</span></div>
<div class="line"><span class="lineno"> 3305</span>                    <span class="comment">// Take one as a last resort.</span></div>
<div class="line"><span class="lineno"> 3306</span>                    <span class="keywordflow">if</span> ((Elf64_Dyn::DT_INIT==<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> || !<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>)</div>
<div class="line"><span class="lineno"> 3307</span>                    &amp;&amp;  Elf64_Shdr::SHT_DYNAMIC == sh_type) {</div>
<div class="line"><span class="lineno"> 3308</span>                        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 3309</span>                        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 3310</span>                        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_size</div>
<div class="line"><span class="lineno"> 3311</span>                        ||  (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; sh_offset</div>
<div class="line"><span class="lineno"> 3312</span>                        || ((<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - sh_offset) &lt; sh_size) {</div>
<div class="line"><span class="lineno"> 3313</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad SHT_DYNAMIC&quot;</span>);</div>
<div class="line"><span class="lineno"> 3314</span>                        }</div>
<div class="line"><span class="lineno"> 3315</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> <a class="code hl_variable" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a> = sh_size / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>);</div>
<div class="line"><span class="lineno"> 3316</span>                        <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dynp = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[sh_offset];</div>
<div class="line"><span class="lineno"> 3317</span>                        <span class="keywordflow">for</span> (; Elf64_Dyn::DT_NULL != dynp-&gt;d_tag; ++dynp) {</div>
<div class="line"><span class="lineno"> 3318</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> == <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag)) {</div>
<div class="line"><span class="lineno"> 3319</span>                                <span class="keywordflow">break</span>;  <span class="comment">// re-found DT_INIT</span></div>
<div class="line"><span class="lineno"> 3320</span>                            }</div>
<div class="line"><span class="lineno"> 3321</span>                        }</div>
<div class="line"><span class="lineno"> 3322</span>                        <span class="keywordflow">if</span> ((1+ dynp) &lt; (<a class="code hl_variable" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a>+ <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>)) { <span class="comment">// not the terminator, so take it</span></div>
<div class="line"><span class="lineno"> 3323</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val);  <span class="comment">// 0 if (0==upx_dt_init)</span></div>
<div class="line"><span class="lineno"> 3324</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dynp-&gt;d_tag, <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_INIT);</div>
<div class="line"><span class="lineno"> 3325</span>                            <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;dynp-&gt;d_val - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0];</div>
<div class="line"><span class="lineno"> 3326</span>                        }</div>
<div class="line"><span class="lineno"> 3327</span>                    }</div>
<div class="line"><span class="lineno"> 3328</span>                }</div>
<div class="line"><span class="lineno"> 3329</span>            }</div>
<div class="line"><span class="lineno"> 3330</span>            <span class="keywordflow">else</span> { <span class="comment">// no Sections; use heuristics</span></div>
<div class="line"><span class="lineno"> 3331</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> strsz  = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRSZ);</div>
<div class="line"><span class="lineno"> 3332</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> strtab = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 3333</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> relsz  = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELSZ);</div>
<div class="line"><span class="lineno"> 3334</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> rel    = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_REL);</div>
<div class="line"><span class="lineno"> 3335</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> init   = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>);</div>
<div class="line"><span class="lineno"> 3336</span>                <span class="keywordflow">if</span> ((init == (relsz + rel   ) &amp;&amp; rel    == (strsz + strtab))</div>
<div class="line"><span class="lineno"> 3337</span>                ||  (init == (strsz + strtab) &amp;&amp; strtab == (relsz + rel   ))</div>
<div class="line"><span class="lineno"> 3338</span>                ) {</div>
<div class="line"><span class="lineno"> 3339</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> = init;</div>
<div class="line"><span class="lineno"> 3340</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">user_init_va</a> = init;</div>
<div class="line"><span class="lineno"> 3341</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(init);</div>
<div class="line"><span class="lineno"> 3342</span>                }</div>
<div class="line"><span class="lineno"> 3343</span>            }</div>
<div class="line"><span class="lineno"> 3344</span>            <span class="comment">// Rely on 0==elf_unsigned_dynamic(tag) if no such tag.</span></div>
<div class="line"><span class="lineno"> 3345</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> va_gash = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 3346</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> va_hash = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 3347</span>            <span class="keywordtype">unsigned</span> y = 0;</div>
<div class="line"><span class="lineno"> 3348</span>            <span class="keywordflow">if</span> ((y=1, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; va_gash)  ||  (y=2, (0==va_gash &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; va_hash))</div>
<div class="line"><span class="lineno"> 3349</span>            ||  (y=3, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRTAB))</div>
<div class="line"><span class="lineno"> 3350</span>            ||  (y=4, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_SYMTAB))</div>
<div class="line"><span class="lineno"> 3351</span>            ||  (y=5, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_REL))</div>
<div class="line"><span class="lineno"> 3352</span>            ||  (y=6, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELA))</div>
<div class="line"><span class="lineno"> 3353</span>            ||  (y=7, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_JMPREL))</div>
<div class="line"><span class="lineno"> 3354</span>            ||  (y=8, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERDEF))</div>
<div class="line"><span class="lineno"> 3355</span>            ||  (y=9, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERSYM))</div>
<div class="line"><span class="lineno"> 3356</span>            ||  (y=10, <a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a> &lt; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERNEED)) ) {</div>
<div class="line"><span class="lineno"> 3357</span>                <span class="keyword">static</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *which[] = {</div>
<div class="line"><span class="lineno"> 3358</span>                    <span class="stringliteral">&quot;unknown&quot;</span>,</div>
<div class="line"><span class="lineno"> 3359</span>                    <span class="stringliteral">&quot;DT_GNU_HASH&quot;</span>,</div>
<div class="line"><span class="lineno"> 3360</span>                    <span class="stringliteral">&quot;DT_HASH&quot;</span>,</div>
<div class="line"><span class="lineno"> 3361</span>                    <span class="stringliteral">&quot;DT_STRTAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 3362</span>                    <span class="stringliteral">&quot;DT_SYMTAB&quot;</span>,</div>
<div class="line"><span class="lineno"> 3363</span>                    <span class="stringliteral">&quot;DT_REL&quot;</span>,</div>
<div class="line"><span class="lineno"> 3364</span>                    <span class="stringliteral">&quot;DT_RELA&quot;</span>,</div>
<div class="line"><span class="lineno"> 3365</span>                    <span class="stringliteral">&quot;DT_JMPREL&quot;</span>,</div>
<div class="line"><span class="lineno"> 3366</span>                    <span class="stringliteral">&quot;DT_VERDEF&quot;</span>,</div>
<div class="line"><span class="lineno"> 3367</span>                    <span class="stringliteral">&quot;DT_VERSYM&quot;</span>,</div>
<div class="line"><span class="lineno"> 3368</span>                    <span class="stringliteral">&quot;DT_VERNEED&quot;</span>,</div>
<div class="line"><span class="lineno"> 3369</span>                };</div>
<div class="line"><span class="lineno"> 3370</span>                <span class="keywordtype">char</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[30]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>), <span class="stringliteral">&quot;%s above stub&quot;</span>, which[y]);</div>
<div class="line"><span class="lineno"> 3371</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>);</div>
<div class="line"><span class="lineno"> 3372</span>                <span class="keywordflow">goto</span> abandon;</div>
<div class="line"><span class="lineno"> 3373</span>            }</div>
<div class="line"><span class="lineno"> 3374</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>);</div>
<div class="line"><span class="lineno"> 3375</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;debug.debug_level) {</div>
<div class="line"><span class="lineno"> 3376</span>                fprintf(stderr, <span class="stringliteral">&quot;shlib canPack: xct_va=%#lx  xct_off=%#lx\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 3377</span>                    (<span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">xct_va</a>, (<span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 3378</span>            }</div>
<div class="line"><span class="lineno"> 3379</span>            <span class="keywordflow">goto</span> proceed;  <span class="comment">// But proper packing depends on checking xct_va.</span></div>
<div class="line"><span class="lineno"> 3380</span>        }</div>
<div class="line"><span class="lineno"> 3381</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3382</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;need DT_INIT; try \&quot;void _init(void){}\&quot;&quot;</span>);</div>
<div class="line"><span class="lineno"> 3383</span>        }</div>
<div class="line"><span class="lineno"> 3384</span>abandon:</div>
<div class="line"><span class="lineno"> 3385</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3386</span>proceed: ;</div>
<div class="line"><span class="lineno"> 3387</span>    }</div>
<div class="line"><span class="lineno"> 3388</span>    <span class="comment">// XXX Theoretically the following test should be first,</span></div>
<div class="line"><span class="lineno"> 3389</span>    <span class="comment">// but PackUnix::canPack() wants 0!=exetype ?</span></div>
<div class="line"><span class="lineno"> 3390</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">super::canPack</a>())</div>
<div class="line"><span class="lineno"> 3391</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3392</span>    assert(<a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> == 1);</div>
<div class="line"><span class="lineno"> 3393</span>    <a class="code hl_variable" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">exetype</a> = 0;</div>
<div class="line"><span class="lineno"> 3394</span> </div>
<div class="line"><span class="lineno"> 3395</span>    <span class="comment">// set options</span></div>
<div class="line"><span class="lineno"> 3396</span>    <span class="comment">// this-&gt;blocksize: avoid over-allocating.</span></div>
<div class="line"><span class="lineno"> 3397</span>    <span class="comment">// (file_size - max_offset): debug info, non-globl symbols, etc.</span></div>
<div class="line"><span class="lineno"> 3398</span>    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.blocksize = <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_LOADsz, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - max_offset);</div>
<div class="line"><span class="lineno"> 3399</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3400</span>}</div>
<div class="ttc" id="abele_8h_html_a975f8af4219a9c95cf3395cbd46fc472"><div class="ttname"><a href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_le32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00327">bele.h:327</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a0e16265acea35917d1e57a65fb5ffc70"><div class="ttname"><a href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">PackLinuxElf64::e_shoff</a></div><div class="ttdeci">upx_uint64_t e_shoff</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00397">p_lx_elf.h:397</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a34544f047b9808c7416a3a3666a7d6bb"><div class="ttname"><a href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">PackLinuxElf64::invert_pt_dynamic</a></div><div class="ttdeci">void invert_pt_dynamic(Elf64_Dyn const *, upx_uint64_t dt_filesz)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07945">p_lx_elf.cpp:7945</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a4204f3ad0b4eff8655e10f62ac640a22"><div class="ttname"><a href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">PackLinuxElf64::elf_unsigned_dynamic</a></div><div class="ttdeci">virtual upx_uint64_t elf_unsigned_dynamic(unsigned) const override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07768">p_lx_elf.cpp:7768</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a5d86b1c186506105d0a1143fd364c014"><div class="ttname"><a href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">PackLinuxElf64::check_pt_dynamic</a></div><div class="ttdeci">upx_uint64_t check_pt_dynamic(Elf64_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07840">p_lx_elf.cpp:7840</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a5fb0d975feeb7b1b02f9e4a22ab227ed"><div class="ttname"><a href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">PackLinuxElf64::elf_has_dynamic</a></div><div class="ttdeci">Elf64_Dyn const * elf_has_dynamic(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07829">p_lx_elf.cpp:7829</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a71bc2f0e1a1ec856b3f9a08b63add0ae"><div class="ttname"><a href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">PackLinuxElf64::canUnpack</a></div><div class="ttdeci">virtual tribool canUnpack() override</div><div class="ttdoc">Generic Unix canUnpack().</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02991">p_lx_elf.cpp:2991</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_aa0c2c8ef98d3669846a7f666f6833698"><div class="ttname"><a href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">PackLinuxElf64::is_LOAD64</a></div><div class="ttdeci">int is_LOAD64(Elf64_Phdr const *phdr) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00271">p_lx_elf.cpp:271</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab26dade234148980bd9f8a06ee31bf3c"><div class="ttname"><a href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">PackLinuxElf64::checkEhdr</a></div><div class="ttdeci">virtual int checkEhdr(Elf64_Ehdr const *ehdr) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00196">p_lx_elf.cpp:196</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad1befccbbdde5d8977b9d2e5883507d4"><div class="ttname"><a href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">PackLinuxElf64::elf_find_dynamic</a></div><div class="ttdeci">void * elf_find_dynamic(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07755">p_lx_elf.cpp:7755</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ae528cb01cbf686b624e2fffe159ad5b6"><div class="ttname"><a href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">PackLinuxElf64::check_pt_load</a></div><div class="ttdeci">upx_uint64_t check_pt_load(Elf64_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07809">p_lx_elf.cpp:7809</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af4b086d6062198ab02e25fcc4cd5a2c3"><div class="ttname"><a href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">PackLinuxElf64::calls_crt1</a></div><div class="ttdeci">bool calls_crt1(Elf64_Rela const *rela, int sz)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02400">p_lx_elf.cpp:2400</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af80d289e1d9fe56882aa494f2afc0e9b"><div class="ttname"><a href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">PackLinuxElf64::elf_find_section_type</a></div><div class="ttdeci">Elf64_Shdr * elf_find_section_type(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02364">p_lx_elf.cpp:2364</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3bb9134e6f6d635119bbce8ee9fc2cc0"><div class="ttname"><a href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a></div><div class="ttdeci">upx_uint64_t user_init_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00106">p_lx_elf.h:106</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a5789e03712ad5c821ed718be76cb006a"><div class="ttname"><a href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a></div><div class="ttdeci">unsigned upx_dt_init</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00119">p_lx_elf.h:119</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a59a59994ceb7e3d20444f07a08cd1cfe"><div class="ttname"><a href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a></div><div class="ttdeci">unsigned user_init_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00109">p_lx_elf.h:109</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8c8e26f797ec69a6c183c8b15fcd4f53"><div class="ttname"><a href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a></div><div class="ttdeci">void * user_init_rp</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00107">p_lx_elf.h:107</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a93d9de72bcb60bbea6757e0d44e5e296"><div class="ttname"><a href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a></div><div class="ttdeci">unsigned dt_table[DT_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00121">p_lx_elf.h:121</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a9f6c41a7dc3caa60ac369d2776ee5a12"><div class="ttname"><a href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">PackLinuxElf::is_pie</a></div><div class="ttdeci">bool is_pie</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00097">p_lx_elf.h:97</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aa692858672c20488c367295681b28422"><div class="ttname"><a href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a></div><div class="ttdeci">upx_uint64_t load_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00103">p_lx_elf.h:103</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aac769941a308e20fdce0e86d1ec3b2f3"><div class="ttname"><a href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a></div><div class="ttdeci">unsigned hatch_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00100">p_lx_elf.h:100</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_afcc48dc344bb8340e9691a43d45f8458"><div class="ttname"><a href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a></div><div class="ttdeci">unsigned e_shstrndx</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00081">p_lx_elf.h:81</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a3408c180ca78a03f0c06da6c8c25dc34"><div class="ttname"><a href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a></div><div class="ttdeci">unsigned blocksize</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00094">p_unix.h:94</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a449871a4fd2081e1399999ef05741f92"><div class="ttname"><a href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a></div><div class="ttdeci">int exetype</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00093">p_unix.h:93</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a8ab714a14f4ff2f120107dfc08b2a3a5"><div class="ttname"><a href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a></div><div class="ttdeci">unsigned saved_opt_android_shlib</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00106">p_unix.h:106</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a935b7961d8278ae7b19c53d6ef3fe3cf"><div class="ttname"><a href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix::canPack</a></div><div class="ttdeci">virtual tribool canPack() override</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00070">p_unix.cpp:70</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a0306ca7a6b44bd2b88bda7eefa46d49b"><div class="ttname"><a href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a></div><div class="ttdeci">InputFile *const fi</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00084">packer.h:84</a></div></div>
<div class="ttc" id="aconf_8h_html_a2ce9aaa3ef74889b5352e4a6025db5bc"><div class="ttname"><a href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a></div><div class="ttdeci">#define UPX_MAGIC_LE32</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00509">conf.h:509</a></div></div>
<div class="ttc" id="aconf_8h_html_a92f0ba69c0f889de4efac3dea2b0cc8a"><div class="ttname"><a href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT(e)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00237">conf.h:237</a></div></div>
<div class="ttc" id="aconf_8h_html_aafadbc56bd61f1a892099d70ff71b6e4"><div class="ttname"><a href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a></div><div class="ttdeci">#define UPX_MAX(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00488">conf.h:488</a></div></div>
<div class="ttc" id="aconf_8h_html_af1fdeecf9ad80f9618354edc154be54a"><div class="ttname"><a href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a></div><div class="ttdeci">void void void void void info(const char *format,...) attribute_format(1</div></div>
<div class="ttc" id="aexcept_8cpp_html_a263a7fe48ef7383a4fd0b9daf6c317fa"><div class="ttname"><a href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked</a></div><div class="ttdeci">void throwAlreadyPacked(const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00097">except.cpp:97</a></div></div>
<div class="ttc" id="anamespaceupx_html_a79bf3f180bc97aea86be54634b455c77"><div class="ttname"><a href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">upx::umin</a></div><div class="ttdeci">forceinline constexpr T umin(const T &amp;a, const T &amp;b) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="cxxlib_8h_source.html#l00250">cxxlib.h:250</a></div></div>
<div class="ttc" id="aoptions_8cpp_html_a887b9edd7a68b4cde1de1f0d7ac1d6eb"><div class="ttname"><a href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a></div><div class="ttdeci">#define opt</div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a34f9d3637288371175e78109dfbabef4"><div class="ttname"><a href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a></div><div class="ttdeci">static void alloc_file_image(MemBuffer &amp;mb, off_t size)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00139">p_lx_elf.cpp:139</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a487f2c5bedc799066863f22832798bd8"><div class="ttname"><a href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a></div><div class="ttdeci">#define PT_LOAD64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00054">p_lx_elf.cpp:54</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a5c15cec3b8e2056be6bf0b188bae4f82"><div class="ttname"><a href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a></div><div class="ttdeci">static constexpr unsigned MAX_ELF_HDR_64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00064">p_lx_elf.cpp:64</a></div></div>
<div class="ttc" id="ap__lx__elf_8h_html_a68e5abb5d6e413b99c6e37512b057090"><div class="ttname"><a href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a></div><div class="ttdeci">upx_uint32_t u32_t</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00037">p_lx_elf.h:37</a></div></div>
<div class="ttc" id="ap__lx__elf_8h_html_add593f4cfdc5ddcbd94ea2638b7a96e7"><div class="ttname"><a href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a></div><div class="ttdeci">upx_uint64_t u64_t</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00038">p_lx_elf.h:38</a></div></div>
<div class="ttc" id="ap__unix_8cpp_html_aa29b866765bdc5bdf87b7eb666d66093"><div class="ttname"><a href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a></div><div class="ttdeci">#define buf</div></div>
<div class="ttc" id="astructElf64__Phdr_html_a55fae01175fc4e3f1c23e52b14459235"><div class="ttname"><a href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a></div><div class="ttdeci">Elf64_Xword p_memsz</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00243">bsd.h:243</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_ab96e7784733c2192a76d5a42897cb38b"><div class="ttname"><a href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a></div><div class="ttdeci">Elf64_Word p_flags</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00238">bsd.h:238</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_aee6ec430eaaf8b8faf82ae6397282cb3"><div class="ttname"><a href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a></div><div class="ttdeci">Elf64_Word p_type</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00237">bsd.h:237</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_af50e5756da2acda5ccb02ebaa3367092"><div class="ttname"><a href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a></div><div class="ttdeci">Elf64_Xword p_filesz</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00242">bsd.h:242</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_af532e634462c5e42c213735f6869b383"><div class="ttname"><a href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a></div><div class="ttdeci">const C&lt; U &gt; size_t n</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00080">xspan_fwd.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image()</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1()</a>, <a class="el" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf">PackUnix::canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load()</a>, <a class="el" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr()</a>, <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackUnix.html#a449871a4fd2081e1399999ef05741f92">PackUnix::exetype</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#aac769941a308e20fdce0e86d1ec3b2f3">PackLinuxElf::hatch_off</a>, <a class="el" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">is_LOAD64()</a>, <a class="el" href="classPackLinuxElf.html#a9f6c41a7dc3caa60ac369d2776ee5a12">PackLinuxElf::is_pie</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#af532e634462c5e42c213735f6869b383">n</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa">throwAlreadyPacked()</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a>, <a class="el" href="classPackLinuxElf.html#a3bb9134e6f6d635119bbce8ee9fc2cc0">PackLinuxElf::user_init_va</a>, <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>, and <a class="el" href="classPackLinuxElf.html#a3fa8506d335cb1116f720aff4611a337">PackLinuxElf::xct_va</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph" id="aclassPackLinuxElf64_a3f8b3a6d6203c2a09d5058a18423fee2_cgraph">
<area shape="rect" title=" " alt="" coords="5,1701,187,1726"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="764,647,892,673"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1656,662,1775,687"/>
<area shape="rect" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3" title=" " alt="" coords="239,1931,430,1957"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1455,1790,1584,1815"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1651,1513,1780,1538"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="547,1890,613,1915"/>
<area shape="rect" href="classPackUnix.html#a935b7961d8278ae7b19c53d6ef3fe3cf" title=" " alt="" coords="509,207,651,233"/>
<area shape="rect" href="except_8cpp.html#a263a7fe48ef7383a4fd0b9daf6c317fa" title=" " alt="" coords="987,43,1141,69"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="767,207,889,233"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="769,294,887,319"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="235,1179,435,1205"/>
<area shape="rect" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c" title=" " alt="" coords="483,1434,677,1459"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="999,1154,1129,1179"/>
<area shape="rect" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014" title=" " alt="" coords="1436,763,1603,803"/>
<area shape="rect" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6" title=" " alt="" coords="1209,625,1376,665"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="991,1471,1137,1511"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="1197,1532,1388,1572"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="1220,1700,1365,1740"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="745,1481,911,1521"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="1217,1347,1368,1387"/>
<area shape="rect" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed" title=" " alt="" coords="1447,2143,1592,2183"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="295,2307,374,2333"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="311,2258,358,2283"/>
<area shape="rect" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698" title=" " alt="" coords="1223,1916,1362,1956"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="295,2381,374,2406"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="271,2430,399,2455"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="271,2479,399,2505"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="1226,901,1359,926"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="989,698,1139,723"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="1208,1098,1377,1123"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="979,497,1149,522"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1040,546,1088,571"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1475,294,1564,319"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1481,901,1557,926"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1477,827,1561,853"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="505,1940,655,1980"/>
<area shape="rect" href="classPacker.html#a14b9cb85a2382ebc043228597992283b" title=" " alt="" coords="725,94,931,119"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="1007,194,1121,219"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="989,145,1139,170"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1224,245,1361,270"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="1006,243,1122,269"/>
<area shape="rect" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack()." alt="" coords="489,1154,671,1179"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="483,920,677,960"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="759,598,897,623"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="786,1381,870,1406"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="1447,1397,1592,1437"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="991,1585,1137,1625"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="987,1305,1141,1345"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="539,2307,621,2333"/>
</map>
</div>

</div>
</div>
<a id="a71bc2f0e1a1ec856b3f9a08b63add0ae" name="a71bc2f0e1a1ec856b3f9a08b63add0ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71bc2f0e1a1ec856b3f9a08b63add0ae">&#9670;&#160;</a></span>canUnpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tribool PackLinuxElf64::canUnpack </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic Unix <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack().">canUnpack()</a>. </p>

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02991">2991</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2992</span>{</div>
<div class="line"><span class="lineno"> 2993</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>)) {</div>
<div class="line"><span class="lineno"> 2994</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2995</span>    }</div>
<div class="line"><span class="lineno"> 2996</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>) &lt; 2) {</div>
<div class="line"><span class="lineno"> 2997</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;e_phnum must be &gt;= 2&quot;</span>);</div>
<div class="line"><span class="lineno"> 2998</span>    }</div>
<div class="line"><span class="lineno"> 2999</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_DYN==<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>)) {</div>
<div class="line"><span class="lineno"> 3000</span>        <a class="code hl_function" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);</div>
<div class="line"><span class="lineno"> 3001</span>    }</div>
<div class="line"><span class="lineno"> 3002</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">super::canUnpack</a>()) {</div>
<div class="line"><span class="lineno"> 3003</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3004</span>    }</div>
<div class="line"><span class="lineno"> 3005</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3006</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a8c2bb372c567334edd586f78224bc956"><div class="ttname"><a href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64::PackLinuxElf64help1</a></div><div class="ttdeci">virtual void PackLinuxElf64help1(InputFile *f)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01023">p_lx_elf.cpp:1023</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a2749869eea115d88727ccd4f60b0c474"><div class="ttname"><a href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf::canUnpack</a></div><div class="ttdeci">virtual tribool canUnpack() override</div><div class="ttdoc">Generic Unix canUnpack().</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00049">p_lx_elf.h:49</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_aeec259360ad810df576d7012b3f054f3"><div class="ttname"><a href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a></div><div class="ttdeci">void throwCantUnpack(const char *msg)</div><div class="ttdoc">decompression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00109">except.cpp:109</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a031210e6571dad798c4ed66b85631d58"><div class="ttname"><a href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a></div><div class="ttdeci">Elf64_Half e_type</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00208">bsd.h:208</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_af13bac5685d725c2ba9930c1176f3082"><div class="ttname"><a href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a></div><div class="ttdeci">Elf64_Half e_phnum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00217">bsd.h:217</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474">PackLinuxElf::canUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c">checkEhdr()</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph" id="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_cgraph">
<area shape="rect" title="Generic Unix canUnpack()." alt="" coords="5,431,205,456"/>
<area shape="rect" href="classPackLinuxElf.html#a2749869eea115d88727ccd4f60b0c474" title="Generic Unix canUnpack()." alt="" coords="259,313,441,339"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1274,124,1413,149"/>
<area shape="rect" href="classPackLinuxElf64.html#ab26dade234148980bd9f8a06ee31bf3c" title=" " alt="" coords="495,431,689,456"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="758,583,887,608"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="253,927,447,967"/>
<area shape="rect" href="classPackUnix.html#aea9d5cdf25d2396d775cbdf846664120" title="Generic Unix canUnpack()." alt="" coords="511,251,673,276"/>
<area shape="rect" href="classPackUnix.html#a4f1d471152b26686e619f2e8b6744366" title=" " alt="" coords="737,163,908,203"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="761,352,884,377"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="764,251,881,276"/>
<area shape="rect" href="classFileBase.html#a7ae5a36714da37350db8bf0c9e6618b3" title=" " alt="" coords="757,113,888,139"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="1279,1071,1408,1096"/>
<area shape="rect" href="classPacker.html#afeee17a50e4f350eebc14b1704ec9a39" title=" " alt="" coords="987,99,1157,124"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="956,49,1188,75"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1515,1157,1633,1183"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="1015,301,1129,327"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="997,403,1147,428"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1299,404,1388,429"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1275,251,1412,276"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="1014,200,1130,225"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1509,1657,1639,1683"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="781,533,865,559"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="1005,555,1139,580"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="528,859,656,884"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="747,735,898,760"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="987,1197,1157,1223"/>
<area shape="rect" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014" title=" " alt="" coords="1260,1909,1427,1949"/>
<area shape="rect" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6" title=" " alt="" coords="1260,1845,1427,1885"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="750,1642,895,1682"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="999,1298,1145,1338"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="750,985,895,1025"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="509,1413,675,1453"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1305,677,1381,703"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1301,505,1385,531"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1303,355,1384,380"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1236,555,1451,580"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1266,604,1421,629"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1499,347,1649,387"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="737,784,908,809"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="799,833,847,859"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="1271,1679,1416,1719"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="977,1514,1167,1554"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="989,757,1155,783"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="997,981,1147,1021"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="1269,981,1418,1021"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="985,807,1159,832"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="1039,880,1105,905"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="750,1527,895,1567"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="997,1629,1147,1669"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="746,1413,899,1453"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph" id="aclassPackLinuxElf64_a71bc2f0e1a1ec856b3f9a08b63add0ae_icgraph">
<area shape="rect" title="Generic Unix canUnpack()." alt="" coords="235,5,435,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a5d86b1c186506105d0a1143fd364c014" name="a5d86b1c186506105d0a1143fd364c014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d86b1c186506105d0a1143fd364c014">&#9670;&#160;</a></span>check_pt_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::check_pt_dynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07840">7840</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7841</span>{</div>
<div class="line"><span class="lineno"> 7842</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> t = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_offset), s = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>) + t;</div>
<div class="line"><span class="lineno"> 7843</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr);</div>
<div class="line"><span class="lineno"> 7844</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_filesz), memsz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_memsz);</div>
<div class="line"><span class="lineno"> 7845</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno"> 7846</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; t || s &lt; t</div>
<div class="line"><span class="lineno"> 7847</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; filesz</div>
<div class="line"><span class="lineno"> 7848</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; (filesz + t)</div>
<div class="line"><span class="lineno"> 7849</span>    ||  t &lt; (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>*<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>))</div>
<div class="line"><span class="lineno"> 7850</span>    ||  (7 &amp; t) || (0xf &amp; (filesz | memsz))  <span class="comment">// .balign 8; 16==sizeof(Elf64_Dyn)</span></div>
<div class="line"><span class="lineno"> 7851</span>    ||  (-1+ align) &amp; (t ^ vaddr)</div>
<div class="line"><span class="lineno"> 7852</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= memsz</div>
<div class="line"><span class="lineno"> 7853</span>    ||  filesz &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>)</div>
<div class="line"><span class="lineno"> 7854</span>    ||  memsz  &lt; <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>)</div>
<div class="line"><span class="lineno"> 7855</span>    ||  filesz &lt; memsz) {</div>
<div class="line"><span class="lineno"> 7856</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad PT_DYNAMIC phdr[%u]&quot;</span>,</div>
<div class="line"><span class="lineno"> 7857</span>            (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 7858</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7859</span>    }</div>
<div class="line"><span class="lineno"> 7860</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a> = memsz;</div>
<div class="line"><span class="lineno"> 7861</span>    <span class="keywordflow">return</span> t;</div>
<div class="line"><span class="lineno"> 7862</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a9da32af4a0e9814653edd2d72c3e2dda"><div class="ttname"><a href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">PackLinuxElf64::sz_dynseg</a></div><div class="ttdeci">upx_uint64_t sz_dynseg</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00398">p_lx_elf.h:398</a></div></div>
<div class="ttc" id="aclassPackerBase_html_ac91973d9b4ba31e291970a8a058f6b07"><div class="ttname"><a href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a></div><div class="ttdeci">const upx_uint64_t file_size_u</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00088">packer.h:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph" id="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,172,63"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="220,5,349,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="225,55,344,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph" id="aclassPackLinuxElf64_a5d86b1c186506105d0a1143fd364c014_icgraph">
<area shape="rect" title=" " alt="" coords="735,27,901,67"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
</map>
</div>

</div>
</div>
<a id="ae528cb01cbf686b624e2fffe159ad5b6" name="ae528cb01cbf686b624e2fffe159ad5b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae528cb01cbf686b624e2fffe159ad5b6">&#9670;&#160;</a></span>check_pt_load()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> PackLinuxElf64::check_pt_load </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07809">7809</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7810</span>{</div>
<div class="line"><span class="lineno"> 7811</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 7812</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_offset), offend = filesz + offset;</div>
<div class="line"><span class="lineno"> 7813</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> vaddr  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr);</div>
<div class="line"><span class="lineno"> 7814</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> paddr  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_paddr);</div>
<div class="line"><span class="lineno"> 7815</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> align  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno"> 7816</span> </div>
<div class="line"><span class="lineno"> 7817</span>    <span class="keywordflow">if</span> ((-1+ align) &amp; (paddr ^ vaddr)</div>
<div class="line"><span class="lineno"> 7818</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)offset</div>
<div class="line"><span class="lineno"> 7819</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;  (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)offend</div>
<div class="line"><span class="lineno"> 7820</span>    ||  <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;  (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)filesz) {</div>
<div class="line"><span class="lineno"> 7821</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad PT_LOAD phdr[%u]&quot;</span>,</div>
<div class="line"><span class="lineno"> 7822</span>            (<span class="keywordtype">unsigned</span>)(phdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 7823</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7824</span>    }</div>
<div class="line"><span class="lineno"> 7825</span>    <span class="keywordflow">return</span> offset;</div>
<div class="line"><span class="lineno"> 7826</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph" id="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,172,63"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="220,5,349,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="225,55,344,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph" id="aclassPackLinuxElf64_ae528cb01cbf686b624e2fffe159ad5b6_icgraph">
<area shape="rect" title=" " alt="" coords="735,27,901,67"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
</map>
</div>

</div>
</div>
<a id="ab26dade234148980bd9f8a06ee31bf3c" name="ab26dade234148980bd9f8a06ee31bf3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab26dade234148980bd9f8a06ee31bf3c">&#9670;&#160;</a></span>checkEhdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::checkEhdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> const *&#160;</td>
          <td class="paramname"><em>ehdr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00196">196</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>{</div>
<div class="line"><span class="lineno">  198</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a> = ehdr-&gt;e_ident;</div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> osabi0 = <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf32_Ehdr::EI_OSABI];</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">if</span> (0==osabi0) {</div>
<div class="line"><span class="lineno">  201</span>        osabi0 = <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.osabi0;</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <span class="stringliteral">&quot;\x7f\x45\x4c\x46&quot;</span>, 4)  <span class="comment">// &quot;\177ELF&quot;</span></div>
<div class="line"><span class="lineno">  205</span>    ||  <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf64_Ehdr::EI_CLASS]!=<a class="code hl_variable" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">ei_class</a></div>
<div class="line"><span class="lineno">  206</span>    ||  <a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>[Elf64_Ehdr::EI_DATA] !=<a class="code hl_variable" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">ei_data</a></div>
<div class="line"><span class="lineno">  207</span>    ||                     osabi0!=<a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a></div>
<div class="line"><span class="lineno">  208</span>    ) {</div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  210</span>    }</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(<a class="code hl_define" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>+8, <span class="stringliteral">&quot;FreeBSD&quot;</span>, 7))                   <span class="comment">// branded</span></div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordtype">int</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_type);</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> (type != Elf64_Ehdr::ET_EXEC &amp;&amp; type != Elf64_Ehdr::ET_DYN)</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">return</span> 2;</div>
<div class="line"><span class="lineno">  217</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_machine) != (<span class="keywordtype">unsigned</span>) <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>)</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">return</span> 3;</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;ehdr-&gt;e_version) != Elf64_Ehdr::EV_CURRENT)</div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">return</span> 4;</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> &lt; 1)</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">return</span> 5;</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;e_phentsize) != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>))</div>
<div class="line"><span class="lineno">  224</span>        <span class="keywordflow">return</span> 6;</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="keywordflow">if</span> (type == Elf64_Ehdr::ET_EXEC) {</div>
<div class="line"><span class="lineno">  227</span>        <span class="comment">// check for Linux kernels</span></div>
<div class="line"><span class="lineno">  228</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;ehdr-&gt;e_entry);</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">if</span> (entry == 0xC0100000)    <span class="comment">// uncompressed vmlinux</span></div>
<div class="line"><span class="lineno">  230</span>            <span class="keywordflow">return</span> 1000;</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">if</span> (entry == 0x00001000)    <span class="comment">// compressed vmlinux</span></div>
<div class="line"><span class="lineno">  232</span>            <span class="keywordflow">return</span> 1001;</div>
<div class="line"><span class="lineno">  233</span>        <span class="keywordflow">if</span> (entry == 0x00100000)    <span class="comment">// compressed bvmlinux</span></div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordflow">return</span> 1002;</div>
<div class="line"><span class="lineno">  235</span>    }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    <span class="comment">// FIXME: add more checks for kernels</span></div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="comment">// FIXME: add special checks for other ELF i386 formats, like</span></div>
<div class="line"><span class="lineno">  240</span>    <span class="comment">//        NetBSD, OpenBSD, Solaris, ....</span></div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>    <span class="comment">// success</span></div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  244</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a5dabe40d6f7f71e6b9bce64b9cc3290f"><div class="ttname"><a href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">PackLinuxElf::ei_data</a></div><div class="ttdeci">unsigned char ei_data</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00115">p_lx_elf.h:115</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ad930777406ea601d200de0ab59de88d6"><div class="ttname"><a href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a></div><div class="ttdeci">unsigned char ei_osabi</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00116">p_lx_elf.h:116</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_af6c2c447099336ae2bc5cc1539c36610"><div class="ttname"><a href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">PackLinuxElf::ei_class</a></div><div class="ttdeci">unsigned char ei_class</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00114">p_lx_elf.h:114</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a1a9f236758b0df388ddf70ed0e05e350"><div class="ttname"><a href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a></div><div class="ttdeci">int memcmp(const C&lt; T &gt; &amp;a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00073">xspan_fwd.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__unix_8cpp.html#aa29b866765bdc5bdf87b7eb666d66093">buf</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf.html#af6c2c447099336ae2bc5cc1539c36610">PackLinuxElf::ei_class</a>, <a class="el" href="classPackLinuxElf.html#a5dabe40d6f7f71e6b9bce64b9cc3290f">PackLinuxElf::ei_data</a>, <a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, and <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph" id="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,200,105"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="248,5,377,31"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="248,55,377,80"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="248,104,377,129"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="271,177,355,203"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph" id="aclassPackLinuxElf64_ab26dade234148980bd9f8a06ee31bf3c_icgraph">
<area shape="rect" title=" " alt="" coords="483,5,677,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="235,31,435,56"/>
</map>
</div>

</div>
</div>
<a id="a3af121bec7063696881a30fd96d8c96b" name="a3af121bec7063696881a30fd96d8c96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3af121bec7063696881a30fd96d8c96b">&#9670;&#160;</a></span>compileTimeAssertions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void PackLinuxElf64::compileTimeAssertions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00445">445</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  445</span>                                        {</div>
<div class="line"><span class="lineno">  446</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(cprElfHdr1) == 64 + 1*56 + 12)</div>
<div class="line"><span class="lineno">  447</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr2) == 64 + 2*56 + 12)</div>
<div class="line"><span class="lineno">  448</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr3) == 64 + 3*56 + 12)</div>
<div class="line"><span class="lineno">  449</span>        <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(sizeof(cprElfHdr4) == 64 + 4*56 + 12)</div>
<div class="line"><span class="lineno">  450</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr1)</div>
<div class="line"><span class="lineno">  451</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr2)</div>
<div class="line"><span class="lineno">  452</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr3)</div>
<div class="line"><span class="lineno">  453</span>        <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(cprElfHdr4)</div>
<div class="line"><span class="lineno">  454</span>    }</div>
<div class="ttc" id="aconf_8h_html_a20a79123be4e1110319dc90522f4b563"><div class="ttname"><a href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT_ALIGNED1(a)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00432">conf.h:432</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, and <a class="el" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>.</p>

</div>
</div>
<a id="ab000c2eb42eb50ba4dd570fb0e20e4f2" name="ab000c2eb42eb50ba4dd570fb0e20e4f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab000c2eb42eb50ba4dd570fb0e20e4f2">&#9670;&#160;</a></span>defineSymbols()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::defineSymbols </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> const *&#160;</td>
          <td class="paramname"><em>ft</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf64amd.html#af36770a77fe0872431300e7da76429d9">PackLinuxElf64amd</a>, and <a class="el" href="classPackLinuxElf64arm.html#a10aaeb12a6288a69bff959f0cd7da183">PackLinuxElf64arm</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00956">956</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  957</span>{</div>
<div class="line"><span class="lineno">  958</span>    <a class="code hl_function" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols</a>(ft);</div>
<div class="line"><span class="lineno">  959</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_addaacfe47a36eb9d70929a58ba311e29"><div class="ttname"><a href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols</a></div><div class="ttdeci">virtual void defineSymbols(Filter const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00944">p_lx_elf.cpp:944</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29">PackLinuxElf::defineSymbols()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341">buildLinuxLoader()</a>, <a class="el" href="classPackLinuxElf64amd.html#af36770a77fe0872431300e7da76429d9">PackLinuxElf64amd::defineSymbols()</a>, and <a class="el" href="classPackLinuxElf64arm.html#a10aaeb12a6288a69bff959f0cd7da183">PackLinuxElf64arm::defineSymbols()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph" id="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,229,31"/>
<area shape="rect" href="classPackLinuxElf.html#addaacfe47a36eb9d70929a58ba311e29" title=" " alt="" coords="277,5,484,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph" id="aclassPackLinuxElf64_ab000c2eb42eb50ba4dd570fb0e20e4f2_icgraph">
<area shape="rect" title=" " alt="" coords="453,173,677,198"/>
<area shape="rect" href="classPackLinuxElf64.html#acf98749f15000ddd7c39f330ec145341" title=" " alt="" coords="211,101,405,141"/>
<area shape="rect" href="classPackLinuxElf64amd.html#af36770a77fe0872431300e7da76429d9" title=" " alt="" coords="229,165,387,205"/>
<area shape="rect" href="classPackLinuxElf64arm.html#a10aaeb12a6288a69bff959f0cd7da183" title=" " alt="" coords="231,229,385,269"/>
<area shape="rect" href="classPackLinuxElf64amd.html#a4e925c41e1f85114a34b4fec6a0bfc18" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#a433b6323d27480148574ea89b6ee3634" title=" " alt="" coords="7,69,161,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#adeb403f68ec4aeb636a5ecf2ce9039f1" title=" " alt="" coords="7,133,161,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#ad2998d239264bc145084afbd56fec5b7" title=" " alt="" coords="9,197,159,237"/>
</map>
</div>

</div>
</div>
<a id="ad1befccbbdde5d8977b9d2e5883507d4" name="ad1befccbbdde5d8977b9d2e5883507d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1befccbbdde5d8977b9d2e5883507d4">&#9670;&#160;</a></span>elf_find_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * PackLinuxElf64::elf_find_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07755">7755</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7756</span>{</div>
<div class="line"><span class="lineno"> 7757</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(key);</div>
<div class="line"><span class="lineno"> 7758</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 7759</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> t= <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val));</div>
<div class="line"><span class="lineno"> 7760</span>        <span class="keywordflow">if</span> (t &amp;&amp; t &lt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a>) {</div>
<div class="line"><span class="lineno"> 7761</span>            <span class="keywordflow">return</span> t + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>;</div>
<div class="line"><span class="lineno"> 7762</span>        }</div>
<div class="line"><span class="lineno"> 7763</span>    }</div>
<div class="line"><span class="lineno"> 7764</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7765</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab6a39ae989d67ccb9239bcff7750a6e5"><div class="ttname"><a href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">PackLinuxElf64::elf_find_dynptr</a></div><div class="ttdeci">Elf64_Dyn * elf_find_dynptr(unsigned) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07724">p_lx_elf.cpp:7724</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, and <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph" id="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_cgraph">
<area shape="rect" title=" " alt="" coords="5,63,151,103"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="221,5,367,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="437,70,567,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="199,120,389,160"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="437,123,567,149"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="443,173,561,198"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph" id="aclassPackLinuxElf64_ad1befccbbdde5d8977b9d2e5883507d4_icgraph">
<area shape="rect" title=" " alt="" coords="949,198,1095,238"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,27,187,52"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,198,901,238"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,141,687,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,256,662,296"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,316,890,356"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,27,440,52"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,77,445,117"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,141,444,181"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,295,427,320"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,320,662,360"/>
</map>
</div>

</div>
</div>
<a id="ab6a39ae989d67ccb9239bcff7750a6e5" name="ab6a39ae989d67ccb9239bcff7750a6e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6a39ae989d67ccb9239bcff7750a6e5">&#9670;&#160;</a></span>elf_find_dynptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> * PackLinuxElf64::elf_find_dynptr </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07724">7724</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7725</span>{</div>
<div class="line"><span class="lineno"> 7726</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dynp= <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>;</div>
<div class="line"><span class="lineno"> 7727</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 7728</span>        <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *<span class="keyword">const</span> last = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(<a class="code hl_variable" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a> + (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>);</div>
<div class="line"><span class="lineno"> 7729</span>        <span class="keywordflow">for</span> (; dynp &lt; last; ++dynp) {</div>
<div class="line"><span class="lineno"> 7730</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag)==key) {</div>
<div class="line"><span class="lineno"> 7731</span>                <span class="keywordflow">return</span> dynp;</div>
<div class="line"><span class="lineno"> 7732</span>            }</div>
<div class="line"><span class="lineno"> 7733</span>            <span class="keywordflow">if</span> (Elf64_Dyn::DT_NULL == dynp-&gt;d_tag) {</div>
<div class="line"><span class="lineno"> 7734</span>                <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7735</span>            }</div>
<div class="line"><span class="lineno"> 7736</span>        }</div>
<div class="line"><span class="lineno"> 7737</span>    }</div>
<div class="line"><span class="lineno"> 7738</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7739</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, and <a class="el" href="classPackLinuxElf64.html#a9da32af4a0e9814653edd2d72c3e2dda">sz_dynseg</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph" id="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph" id="aclassPackLinuxElf64_ab6a39ae989d67ccb9239bcff7750a6e5_icgraph">
<area shape="rect" title=" " alt="" coords="1375,403,1520,443"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="966,231,1111,271"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,339,662,379"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="1176,518,1327,558"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="955,741,1122,767"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,295,187,320"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,397,901,437"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,119,687,159"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,231,890,271"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,5,440,31"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,119,445,159"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,55,444,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,347,427,372"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,254,662,294"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="966,461,1111,501"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="949,626,1128,666"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="962,346,1115,386"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="735,633,901,659"/>
</map>
</div>

</div>
</div>
<a id="ac7458e15967252113c7b45332b973287" name="ac7458e15967252113c7b45332b973287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7458e15967252113c7b45332b973287">&#9670;&#160;</a></span>elf_find_Phdr_for_va()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const  * PackLinuxElf64::elf_find_Phdr_for_va </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00469">469</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>{</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno">  472</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_align);</div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type)</div>
<div class="line"><span class="lineno">  474</span>        &amp;&amp; <a class="code hl_function" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a>(align) &amp;&amp; !((-1+ align) &amp;</div>
<div class="line"><span class="lineno">  475</span>            (<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr) ^ <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_offset)))</div>
<div class="line"><span class="lineno">  476</span>        &amp;&amp;  (addr - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_vaddr)) &lt; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;p_filesz)) {</div>
<div class="line"><span class="lineno">  477</span>            <span class="keywordflow">return</span> phdr;</div>
<div class="line"><span class="lineno">  478</span>        }</div>
<div class="line"><span class="lineno">  479</span>    }</div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  481</span>}</div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a0a26281ee961fe926e04c93f395d76cf"><div class="ttname"><a href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a></div><div class="ttdeci">static unsigned is_pow2(u64_t x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00448">p_lx_elf.cpp:448</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2()</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, and <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph" id="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,151,87"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,5,328,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="199,55,328,80"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="226,104,301,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph" id="aclassPackLinuxElf64_ac7458e15967252113c7b45332b973287_icgraph">
<area shape="rect" title=" " alt="" coords="1164,92,1309,132"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="960,63,1105,103"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,5,662,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="949,127,1116,153"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="956,177,1109,217"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,63,901,103"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,127,187,153"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,149,687,189"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,185,440,210"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,235,445,275"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,120,444,160"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,13,427,38"/>
</map>
</div>

</div>
</div>
<a id="af746b688a3b13d3bf0895095ae5c3212" name="af746b688a3b13d3bf0895095ae5c3212"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af746b688a3b13d3bf0895095ae5c3212">&#9670;&#160;</a></span>elf_find_ptype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const  * PackLinuxElf64::elf_find_ptype </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02289">2289</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2290</span>{</div>
<div class="line"><span class="lineno"> 2291</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 2292</span>        <span class="keywordflow">if</span> (type == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type)) {</div>
<div class="line"><span class="lineno"> 2293</span>            <span class="keywordflow">return</span> phdr;</div>
<div class="line"><span class="lineno"> 2294</span>        }</div>
<div class="line"><span class="lineno"> 2295</span>    }</div>
<div class="line"><span class="lineno"> 2296</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2297</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph" id="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph" id="aclassPackLinuxElf64_af746b688a3b13d3bf0895095ae5c3212_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,373,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a19a154b135064ce4e1a6e58ba23d9e50" name="a19a154b135064ce4e1a6e58ba23d9e50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a154b135064ce4e1a6e58ba23d9e50">&#9670;&#160;</a></span>elf_find_section_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const  * PackLinuxElf64::elf_find_section_name </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02323">2323</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2326</span>{</div>
<div class="line"><span class="lineno"> 2327</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 2328</span>    <span class="keywordflow">if</span> (!shdr) {</div>
<div class="line"><span class="lineno"> 2329</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2330</span>    }</div>
<div class="line"><span class="lineno"> 2331</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>;</div>
<div class="line"><span class="lineno"> 2332</span>    <span class="keywordflow">for</span> (; 0 &lt;=--j; ++shdr) {</div>
<div class="line"><span class="lineno"> 2333</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sh_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_name);</div>
<div class="line"><span class="lineno"> 2334</span>        <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= sh_name) {  <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 2335</span>            <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2336</span>                <span class="stringliteral">&quot;bad Elf64_Shdr[%d].sh_name %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 2337</span>                -1+ <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> -j, sh_name);</div>
<div class="line"><span class="lineno"> 2338</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2339</span>        }</div>
<div class="line"><span class="lineno"> 2340</span>        <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[sh_name])) {</div>
<div class="line"><span class="lineno"> 2341</span>            <span class="keywordflow">return</span> shdr;</div>
<div class="line"><span class="lineno"> 2342</span>        }</div>
<div class="line"><span class="lineno"> 2343</span>    }</div>
<div class="line"><span class="lineno"> 2344</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2345</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph" id="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,156,111"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="204,5,333,31"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="235,79,302,104"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="209,128,328,153"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph" id="aclassPackLinuxElf64_a19a154b135064ce4e1a6e58ba23d9e50_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,371,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="af80d289e1d9fe56882aa494f2afc0e9b" name="af80d289e1d9fe56882aa494f2afc0e9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af80d289e1d9fe56882aa494f2afc0e9b">&#9670;&#160;</a></span>elf_find_section_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> * PackLinuxElf64::elf_find_section_type </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02364">2364</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2367</span>{</div>
<div class="line"><span class="lineno"> 2368</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 2369</span>    <span class="keywordflow">if</span> (!shdr) {</div>
<div class="line"><span class="lineno"> 2370</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2371</span>    }</div>
<div class="line"><span class="lineno"> 2372</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>;</div>
<div class="line"><span class="lineno"> 2373</span>    <span class="keywordflow">for</span> (; 0 &lt;=--j; ++shdr) {</div>
<div class="line"><span class="lineno"> 2374</span>        <span class="keywordflow">if</span> (type==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type)) {</div>
<div class="line"><span class="lineno"> 2375</span>            <span class="keywordflow">return</span> shdr;</div>
<div class="line"><span class="lineno"> 2376</span>        }</div>
<div class="line"><span class="lineno"> 2377</span>    }</div>
<div class="line"><span class="lineno"> 2378</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2379</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph" id="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph" id="aclassPackLinuxElf64_af80d289e1d9fe56882aa494f2afc0e9b_icgraph">
<area shape="rect" title=" " alt="" coords="1143,82,1288,122"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,159,187,184"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="949,135,1095,175"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,209,687,249"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="950,65,1094,105"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,146,901,186"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,94,662,134"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,337,440,363"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,209,445,249"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,273,444,313"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,72,427,97"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="746,54,890,94"/>
</map>
</div>

</div>
</div>
<a id="ab5c99e9dc4cb9e94309dfb49b13ff09d" name="ab5c99e9dc4cb9e94309dfb49b13ff09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c99e9dc4cb9e94309dfb49b13ff09d">&#9670;&#160;</a></span>elf_find_table_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::elf_find_table_size </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dt_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>sh_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07917">7917</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7918</span>{</div>
<div class="line"><span class="lineno"> 7919</span>    <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *sec = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(sh_type);</div>
<div class="line"><span class="lineno"> 7920</span>    <span class="keywordflow">if</span> (sec) { <span class="comment">// Cheat the easy way: use _Shdr.  (No _Shdr anyway for de-compression)</span></div>
<div class="line"><span class="lineno"> 7921</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sec-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 7922</span>    }</div>
<div class="line"><span class="lineno"> 7923</span>    <span class="comment">// Honest hard work: use _Phdr</span></div>
<div class="line"><span class="lineno"> 7924</span>    <span class="keywordtype">unsigned</span> x_rva;</div>
<div class="line"><span class="lineno"> 7925</span>    <span class="keywordflow">if</span> (dt_type &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) {</div>
<div class="line"><span class="lineno"> 7926</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> x_ndx = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[dt_type];</div>
<div class="line"><span class="lineno"> 7927</span>        <span class="keywordflow">if</span> (!x_ndx) { <span class="comment">// no such entry</span></div>
<div class="line"><span class="lineno"> 7928</span>            <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7929</span>        }</div>
<div class="line"><span class="lineno"> 7930</span>        x_rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>[-1+ x_ndx].d_val);</div>
<div class="line"><span class="lineno"> 7931</span>    }</div>
<div class="line"><span class="lineno"> 7932</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7933</span>        x_rva = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(dt_type);</div>
<div class="line"><span class="lineno"> 7934</span>    }</div>
<div class="line"><span class="lineno"> 7935</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> x_phdr = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(x_rva, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7936</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>           d_off =             x_rva - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;x_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7937</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>           y_ndx = <a class="code hl_function" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">find_dt_ndx</a>(d_off + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;x_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>));</div>
<div class="line"><span class="lineno"> 7938</span>    <span class="keywordflow">if</span> (~0u != y_ndx) {</div>
<div class="line"><span class="lineno"> 7939</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[1+ y_ndx] - <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[y_ndx];</div>
<div class="line"><span class="lineno"> 7940</span>    }</div>
<div class="line"><span class="lineno"> 7941</span>    <span class="keywordflow">return</span> ~0u;</div>
<div class="line"><span class="lineno"> 7942</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a4b4cfbd2d81ab91d393764f41c48ad44"><div class="ttname"><a href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">PackLinuxElf64::find_dt_ndx</a></div><div class="ttdeci">unsigned find_dt_ndx(u64_t rva)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07905">p_lx_elf.cpp:7905</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ac7458e15967252113c7b45332b973287"><div class="ttname"><a href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">PackLinuxElf64::elf_find_Phdr_for_va</a></div><div class="ttdeci">virtual Elf64_Phdr const * elf_find_Phdr_for_va(upx_uint64_t addr, Elf64_Phdr const *phdr, unsigned phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00469">p_lx_elf.cpp:469</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a7515af27403f7b035c02bc0f92dee48c"><div class="ttname"><a href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a></div><div class="ttdeci">static unsigned const DT_NUM</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00120">p_lx_elf.h:120</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_acbe0a4831f0aafe74de573ca657ea430"><div class="ttname"><a href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a></div><div class="ttdeci">unsigned * dt_offsets</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00086">p_lx_elf.h:86</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44">find_dt_ndx()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, and <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph" id="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_cgraph">
<area shape="rect" title=" " alt="" coords="5,150,151,190"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="202,78,347,118"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="616,183,745,208"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="202,6,347,46"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="199,207,350,247"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="199,315,351,355"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="419,5,548,31"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="446,107,521,132"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="411,258,556,298"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="408,323,559,348"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="399,372,568,397"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph" id="aclassPackLinuxElf64_ab5c99e9dc4cb9e94309dfb49b13ff09d_icgraph">
<area shape="rect" title=" " alt="" coords="949,81,1095,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="a047a7534432a2a090049ba2eee67bfb9" name="a047a7534432a2a090049ba2eee67bfb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a047a7534432a2a090049ba2eee67bfb9">&#9670;&#160;</a></span>elf_get_offset_from_address()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::elf_get_offset_from_address </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07788">7788</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7789</span>{</div>
<div class="line"><span class="lineno"> 7790</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 7791</span>    <span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>;</div>
<div class="line"><span class="lineno"> 7792</span>    <span class="keywordflow">for</span> (; --j&gt;=0; ++phdr) <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 7793</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> t = addr - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7794</span>        <span class="keywordflow">if</span> (t &lt; <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>)) {</div>
<div class="line"><span class="lineno"> 7795</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7796</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= p_offset) { <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 7797</span>                <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 7798</span>                    <span class="stringliteral">&quot;bad Elf64_Phdr[%d].p_offset %#lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 7799</span>                    -1+ <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - j, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)p_offset);</div>
<div class="line"><span class="lineno"> 7800</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7801</span>            }</div>
<div class="line"><span class="lineno"> 7802</span>            <span class="keywordflow">return</span> t + p_offset;</div>
<div class="line"><span class="lineno"> 7803</span>        }</div>
<div class="line"><span class="lineno"> 7804</span>    }</div>
<div class="line"><span class="lineno"> 7805</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7806</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph" id="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,196,87"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="244,5,373,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="244,55,373,80"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="249,104,368,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph" id="aclassPackLinuxElf64_a047a7534432a2a090049ba2eee67bfb9_icgraph">
<area shape="rect" title=" " alt="" coords="1144,254,1335,294"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="949,82,1096,122"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,260,187,285"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="950,282,1095,322"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,253,901,293"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="735,5,901,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,195,687,235"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,310,662,350"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="746,370,890,410"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,235,440,260"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,170,445,210"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,106,444,146"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,359,427,384"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,374,662,414"/>
</map>
</div>

</div>
</div>
<a id="a5fb0d975feeb7b1b02f9e4a22ab227ed" name="a5fb0d975feeb7b1b02f9e4a22ab227ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fb0d975feeb7b1b02f9e4a22ab227ed">&#9670;&#160;</a></span>elf_has_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const  * PackLinuxElf64::elf_has_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07829">7829</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7830</span>{</div>
<div class="line"><span class="lineno"> 7831</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>;</div>
<div class="line"><span class="lineno"> 7832</span>    <span class="keywordflow">if</span> (dynp)</div>
<div class="line"><span class="lineno"> 7833</span>    <span class="keywordflow">for</span> (; Elf64_Dyn::DT_NULL!=dynp-&gt;d_tag; ++dynp) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag)==key) {</div>
<div class="line"><span class="lineno"> 7834</span>        <span class="keywordflow">return</span> dynp;</div>
<div class="line"><span class="lineno"> 7835</span>    }</div>
<div class="line"><span class="lineno"> 7836</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7837</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, and <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph" id="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,151,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="199,13,328,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph" id="aclassPackLinuxElf64_a5fb0d975feeb7b1b02f9e4a22ab227ed_icgraph">
<area shape="rect" title=" " alt="" coords="235,5,380,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,13,187,38"/>
</map>
</div>

</div>
</div>
<a id="a02d0e91095e3b2cdfbc913e7bc25abf8" name="a02d0e91095e3b2cdfbc913e7bc25abf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d0e91095e3b2cdfbc913e7bc25abf8">&#9670;&#160;</a></span>elf_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const  * PackLinuxElf64::elf_lookup </td>
          <td>(</td>
          <td class="paramtype">char const *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l08242">8242</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 8243</span>{</div>
<div class="line"><span class="lineno"> 8244</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>) {</div>
<div class="line"><span class="lineno"> 8245</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> nbucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8246</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[2];</div>
<div class="line"><span class="lineno"> 8247</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> chains = &amp;buckets[nbucket];</div>
<div class="line"><span class="lineno"> 8248</span>        <span class="keywordflow">if</span> (nbucket) { <span class="comment">// -rust-musl can have &quot;empty&quot; hashtab</span></div>
<div class="line"><span class="lineno"> 8249</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> m = <a class="code hl_function" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">elf_hash</a>(name) % nbucket;</div>
<div class="line"><span class="lineno"> 8250</span>            <span class="keywordtype">unsigned</span> nvisit = 0;</div>
<div class="line"><span class="lineno"> 8251</span>            <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>;</div>
<div class="line"><span class="lineno"> 8252</span>            <span class="keywordflow">for</span> (<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>= <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[m]); <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>; ) {</div>
<div class="line"><span class="lineno"> 8253</span>                <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> p= <a class="code hl_function" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name</a>(<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>, (<span class="keywordtype">unsigned</span>)-1);</div>
<div class="line"><span class="lineno"> 8254</span>                <span class="keywordflow">if</span> (p &amp;&amp; 0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, p)) {</div>
<div class="line"><span class="lineno"> 8255</span>                    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>];</div>
<div class="line"><span class="lineno"> 8256</span>                }</div>
<div class="line"><span class="lineno"> 8257</span>                <span class="keywordflow">if</span> (nbucket &lt;= ++nvisit) {</div>
<div class="line"><span class="lineno"> 8258</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;circular DT_HASH chain %d\n&quot;</span>, <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>);</div>
<div class="line"><span class="lineno"> 8259</span>                }</div>
<div class="line"><span class="lineno"> 8260</span>                <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;chains[<a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>]);</div>
<div class="line"><span class="lineno"> 8261</span>                <span class="keywordflow">if</span> (nbucket &lt;= <a class="code hl_variable" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>) { <span class="comment">// bad hashtab</span></div>
<div class="line"><span class="lineno"> 8262</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8263</span>                }</div>
<div class="line"><span class="lineno"> 8264</span>            }</div>
<div class="line"><span class="lineno"> 8265</span>        }</div>
<div class="line"><span class="lineno"> 8266</span>    }</div>
<div class="line"><span class="lineno"> 8267</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>) {</div>
<div class="line"><span class="lineno"> 8268</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8269</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symbias  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[1]);</div>
<div class="line"><span class="lineno"> 8270</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bitmask = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[2]);</div>
<div class="line"><span class="lineno"> 8271</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> gnu_shift = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[3]);</div>
<div class="line"><span class="lineno"> 8272</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *<span class="keyword">const</span> bitmask = (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[4];</div>
<div class="line"><span class="lineno"> 8273</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> buckets = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)&amp;bitmask[n_bitmask];</div>
<div class="line"><span class="lineno"> 8274</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> hasharr = &amp;buckets[n_bucket];</div>
<div class="line"><span class="lineno"> 8275</span> </div>
<div class="line"><span class="lineno"> 8276</span>        <span class="keywordflow">if</span> (31 &lt; gnu_shift) {</div>
<div class="line"><span class="lineno"> 8277</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_shift %#x&quot;</span>, gnu_shift);</div>
<div class="line"><span class="lineno"> 8278</span>        }</div>
<div class="line"><span class="lineno"> 8279</span>        <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) &lt;= (<span class="keywordtype">void</span> <span class="keyword">const</span> *)hasharr) {</div>
<div class="line"><span class="lineno"> 8280</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bucket %#x\n&quot;</span>, n_bucket);</div>
<div class="line"><span class="lineno"> 8281</span>        }</div>
<div class="line"><span class="lineno"> 8282</span>        <span class="keywordflow">if</span> (!n_bitmask</div>
<div class="line"><span class="lineno"> 8283</span>        || (<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)bitmask - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 8284</span>                &lt;= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*n_bitmask ) {</div>
<div class="line"><span class="lineno"> 8285</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bitmask %#x\n&quot;</span>, n_bitmask);</div>
<div class="line"><span class="lineno"> 8286</span>        }</div>
<div class="line"><span class="lineno"> 8287</span>        <span class="keywordflow">if</span> (n_bucket) { <span class="comment">// -rust-musl can have &quot;empty&quot; gashtab</span></div>
<div class="line"><span class="lineno"> 8288</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> h = <a class="code hl_function" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">gnu_hash</a>(name);</div>
<div class="line"><span class="lineno"> 8289</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hbit1 = 077&amp; h;</div>
<div class="line"><span class="lineno"> 8290</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hbit2 = 077&amp; (h&gt;&gt;gnu_shift);</div>
<div class="line"><span class="lineno"> 8291</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;bitmask[(n_bitmask -1) &amp; (h&gt;&gt;6)]);</div>
<div class="line"><span class="lineno"> 8292</span>            <span class="keywordflow">if</span> (1&amp; (w&gt;&gt;hbit1) &amp; (w&gt;&gt;hbit2)) {</div>
<div class="line"><span class="lineno"> 8293</span>                <span class="keywordtype">unsigned</span> hhead = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[h % n_bucket]);</div>
<div class="line"><span class="lineno"> 8294</span>                <span class="keywordflow">if</span> (hhead) {</div>
<div class="line"><span class="lineno"> 8295</span>                    <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> <span class="keyword">const</span> *dsp = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[hhead];</div>
<div class="line"><span class="lineno"> 8296</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *hp = &amp;hasharr[hhead - symbias];</div>
<div class="line"><span class="lineno"> 8297</span>                    <span class="keywordtype">unsigned</span> k;</div>
<div class="line"><span class="lineno"> 8298</span>                    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno"> 8299</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a> &lt;= hp) {</div>
<div class="line"><span class="lineno"> 8300</span>                            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_hash[%#tx]  head=%u&quot;</span>,</div>
<div class="line"><span class="lineno"> 8301</span>                                hp - hasharr, hhead);</div>
<div class="line"><span class="lineno"> 8302</span>                        }</div>
<div class="line"><span class="lineno"> 8303</span>                        k = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(hp);</div>
<div class="line"><span class="lineno"> 8304</span>                        <span class="keywordflow">if</span> (0==((h ^ k)&gt;&gt;1)) {</div>
<div class="line"><span class="lineno"> 8305</span>                            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> st_name = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;dsp-&gt;st_name);</div>
<div class="line"><span class="lineno"> 8306</span>                            <span class="keywordtype">char</span> <span class="keyword">const</span> *<span class="keyword">const</span> p = <a class="code hl_function" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a>(st_name, (<span class="keywordtype">unsigned</span>)-1);</div>
<div class="line"><span class="lineno"> 8307</span>                            <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(name, p)) {</div>
<div class="line"><span class="lineno"> 8308</span>                                <span class="keywordflow">return</span> dsp;</div>
<div class="line"><span class="lineno"> 8309</span>                            }</div>
<div class="line"><span class="lineno"> 8310</span>                        }</div>
<div class="line"><span class="lineno"> 8311</span>                    } <span class="keywordflow">while</span> (++dsp, ++hp, 0==(1u&amp; k));</div>
<div class="line"><span class="lineno"> 8312</span>                }</div>
<div class="line"><span class="lineno"> 8313</span>            }</div>
<div class="line"><span class="lineno"> 8314</span>        }</div>
<div class="line"><span class="lineno"> 8315</span>    }</div>
<div class="line"><span class="lineno"> 8316</span>    <span class="comment">// 2021-12-25  FIXME: Some Rust programs use</span></div>
<div class="line"><span class="lineno"> 8317</span>    <span class="comment">//    (1==n_bucket &amp;&amp; 0==buckets[0] &amp;&amp; 1==n_bitmask &amp;&amp; 0==bitmask[0])</span></div>
<div class="line"><span class="lineno"> 8318</span>    <span class="comment">// to minimize space in DT_GNU_HASH. This causes the fancy lookup to fail.</span></div>
<div class="line"><span class="lineno"> 8319</span>    <span class="comment">// Is a fallback to linear search assumed?</span></div>
<div class="line"><span class="lineno"> 8320</span>    <span class="comment">// 2022-03-12  Some Rust programs have 0==n_bucket.</span></div>
<div class="line"><span class="lineno"> 8321</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 8322</span> </div>
<div class="line"><span class="lineno"> 8323</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a504fe912dd96ebfcd443b89dd425317f"><div class="ttname"><a href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">PackLinuxElf::gnu_hash</a></div><div class="ttdeci">static unsigned gnu_hash(char const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08134">p_lx_elf.cpp:8134</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a9cdb0429d3e2faba00ef2d67b2c628c0"><div class="ttname"><a href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">PackLinuxElf::elf_hash</a></div><div class="ttdeci">static unsigned elf_hash(char const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08145">p_lx_elf.cpp:8145</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a9bd631b0b513dae0e31c1042265af539"><div class="ttname"><a href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov si</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00258">lzma_m.h:258</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0">PackLinuxElf::elf_hash()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a>, <a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>, <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>, <a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f">PackLinuxElf::gnu_hash()</a>, <a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>, <a class="el" href="lzma__m_8h.html#a9bd631b0b513dae0e31c1042265af539">si</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph" id="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_cgraph">
<area shape="rect" title=" " alt="" coords="5,189,151,229"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="202,5,369,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="211,106,360,146"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="420,106,569,146"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="617,168,736,193"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="430,171,559,196"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="221,272,350,297"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="199,321,372,347"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="252,395,319,420"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph" id="aclassPackLinuxElf64_a02d0e91095e3b2cdfbc913e7bc25abf8_icgraph">
<area shape="rect" title=" " alt="" coords="735,55,880,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,5,440,31"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,55,445,95"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,119,444,159"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="a4204f3ad0b4eff8655e10f62ac640a22" name="a4204f3ad0b4eff8655e10f62ac640a22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4204f3ad0b4eff8655e10f62ac640a22">&#9670;&#160;</a></span>elf_unsigned_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::elf_unsigned_dynamic </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#ac7cb95fd27c29245be62f4e388fc3f09">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07768">7768</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7769</span>{</div>
<div class="line"><span class="lineno"> 7770</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *dynp= <a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(key);</div>
<div class="line"><span class="lineno"> 7771</span>    <span class="keywordflow">if</span> (dynp) {</div>
<div class="line"><span class="lineno"> 7772</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val);</div>
<div class="line"><span class="lineno"> 7773</span>    }</div>
<div class="line"><span class="lineno"> 7774</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 7775</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, and <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph" id="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,156,75"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="204,5,349,45"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="397,42,527,67"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph" id="aclassPackLinuxElf64_a4204f3ad0b4eff8655e10f62ac640a22_icgraph">
<area shape="rect" title=" " alt="" coords="1176,251,1327,291"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,43,187,69"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="966,221,1111,261"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,187,901,227"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,272,662,312"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,307,427,333"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="949,437,1128,477"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="955,387,1122,413"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="962,157,1115,197"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,125,687,165"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,43,440,69"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,93,445,133"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,157,444,197"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="735,445,901,470"/>
</map>
</div>

</div>
</div>
<a id="a4b4cfbd2d81ab91d393764f41c48ad44" name="a4b4cfbd2d81ab91d393764f41c48ad44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4cfbd2d81ab91d393764f41c48ad44">&#9670;&#160;</a></span>find_dt_ndx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::find_dt_ndx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>&#160;</td>
          <td class="paramname"><em>rva</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07905">7905</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7906</span>{</div>
<div class="line"><span class="lineno"> 7907</span>    <span class="keywordtype">unsigned</span> *<span class="keyword">const</span> dto = (<span class="keywordtype">unsigned</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 7908</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> dto_size = <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() / <span class="keyword">sizeof</span>(*dto);</div>
<div class="line"><span class="lineno"> 7909</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; dto_size &amp;&amp; dto[j]; ++j) { <span class="comment">// linear search of short table</span></div>
<div class="line"><span class="lineno"> 7910</span>        <span class="keywordflow">if</span> (rva == dto[j]) {</div>
<div class="line"><span class="lineno"> 7911</span>            <span class="keywordflow">return</span> j;</div>
<div class="line"><span class="lineno"> 7912</span>        }</div>
<div class="line"><span class="lineno"> 7913</span>    }</div>
<div class="line"><span class="lineno"> 7914</span>    <span class="keywordflow">return</span> ~0u;</div>
<div class="line"><span class="lineno"> 7915</span>}</div>
<div class="ttc" id="aclassMemBuffer_html_a50cf45756c991e8d65a6b90b8e6a5be2"><div class="ttname"><a href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr</a></div><div class="ttdeci">void * getVoidPtr() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00205">membuffer.h:205</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a834063e926d1118a24f23a8106edcd4e"><div class="ttname"><a href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a></div><div class="ttdeci">MemBuffer mb_dt_offsets</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00085">p_lx_elf.h:85</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, and <a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph" id="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,157,63"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="215,5,365,31"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="205,55,375,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph" id="aclassPackLinuxElf64_a4b4cfbd2d81ab91d393764f41c48ad44_icgraph">
<area shape="rect" title=" " alt="" coords="1143,81,1295,121"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="949,81,1095,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="a6c77e1df704fbb16e2d048937bdb0663" name="a6c77e1df704fbb16e2d048937bdb0663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c77e1df704fbb16e2d048937bdb0663">&#9670;&#160;</a></span>find_LOAD_gap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::find_LOAD_gap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *const&#160;</td>
          <td class="paramname"><em>phdri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05212">5212</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5217</span>{</div>
<div class="line"><span class="lineno"> 5218</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>!=<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[k].p_type)) {</div>
<div class="line"><span class="lineno"> 5219</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 5220</span>    }</div>
<div class="line"><span class="lineno"> 5221</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> hi = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[k].p_offset) +</div>
<div class="line"><span class="lineno"> 5222</span>                        <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5223</span>    <span class="keywordtype">unsigned</span> lo = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">u_file_size</a>;</div>
<div class="line"><span class="lineno"> 5224</span>    <span class="keywordflow">if</span> (lo &lt; hi)</div>
<div class="line"><span class="lineno"> 5225</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad input: PT_LOAD beyond end-of-file&quot;</span>);</div>
<div class="line"><span class="lineno"> 5226</span>    <span class="keywordtype">unsigned</span> j = k;</div>
<div class="line"><span class="lineno"> 5227</span>    <span class="keywordflow">for</span> (;;) { <span class="comment">// circular search, optimize for adjacent ascending</span></div>
<div class="line"><span class="lineno"> 5228</span>        ++j;</div>
<div class="line"><span class="lineno"> 5229</span>        <span class="keywordflow">if</span> (nph==j) {</div>
<div class="line"><span class="lineno"> 5230</span>            j = 0;</div>
<div class="line"><span class="lineno"> 5231</span>        }</div>
<div class="line"><span class="lineno"> 5232</span>        <span class="keywordflow">if</span> (k==j) {</div>
<div class="line"><span class="lineno"> 5233</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5234</span>        }</div>
<div class="line"><span class="lineno"> 5235</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr[j].p_type)) {</div>
<div class="line"><span class="lineno"> 5236</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> t = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_offset);</div>
<div class="line"><span class="lineno"> 5237</span>            <span class="keywordflow">if</span> ((t - hi) &lt; (lo - hi)) {</div>
<div class="line"><span class="lineno"> 5238</span>                lo = t;</div>
<div class="line"><span class="lineno"> 5239</span>                <span class="keywordflow">if</span> (hi==lo) {</div>
<div class="line"><span class="lineno"> 5240</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5241</span>                }</div>
<div class="line"><span class="lineno"> 5242</span>            }</div>
<div class="line"><span class="lineno"> 5243</span>        }</div>
<div class="line"><span class="lineno"> 5244</span>    }</div>
<div class="line"><span class="lineno"> 5245</span>    <span class="keywordflow">return</span> lo - hi;</div>
<div class="line"><span class="lineno"> 5246</span>}</div>
<div class="ttc" id="astructPackHeader_html_ae3a40ba7325ebc8b86301bc9e7c5d3d6"><div class="ttname"><a href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a></div><div class="ttdeci">unsigned u_file_size</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00058">packhead.h:58</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph" id="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_cgraph">
<area shape="rect" title=" " alt="" coords="5,47,157,87"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="205,5,335,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="205,55,335,80"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="211,104,329,129"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph" id="aclassPackLinuxElf64_a6c77e1df704fbb16e2d048937bdb0663_icgraph">
<area shape="rect" title=" " alt="" coords="228,47,380,87"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="9,5,176,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="9,55,176,80"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,104,180,129"/>
</map>
</div>

</div>
</div>
<a id="acc61917c51c71bfcb0f9af20ba7714d6" name="acc61917c51c71bfcb0f9af20ba7714d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc61917c51c71bfcb0f9af20ba7714d6">&#9670;&#160;</a></span>forward_Shdrs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::forward_Shdrs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *&#160;</td>
          <td class="paramname"><em>ehdro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05776">5776</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5777</span>{</div>
<div class="line"><span class="lineno"> 5778</span>    <span class="keywordflow">if</span> (!fo) {</div>
<div class="line"><span class="lineno"> 5779</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 5780</span>    }</div>
<div class="line"><span class="lineno"> 5781</span>    <span class="keywordtype">unsigned</span> penalty = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 5782</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a>) { <span class="comment">// Forward select _Shdr</span></div>
<div class="line"><span class="lineno"> 5783</span>        <span class="comment">// Keep _Shdr for rtld data (below xct_off).</span></div>
<div class="line"><span class="lineno"> 5784</span>        <span class="comment">// Discard _Shdr for compressed regions, except &quot;.text&quot; for gdb.</span></div>
<div class="line"><span class="lineno"> 5785</span>        <span class="comment">// Keep _Shdr for SHF_WRITE.</span></div>
<div class="line"><span class="lineno"> 5786</span>        <span class="comment">// Discard _Shdr with (0==sh_addr), except _Shdr[0]</span></div>
<div class="line"><span class="lineno"> 5787</span>        <span class="comment">// Keep ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 5788</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> want_types_mask =</div>
<div class="line"><span class="lineno"> 5789</span>              1u&lt;&lt;SHT_SYMTAB</div>
<div class="line"><span class="lineno"> 5790</span>            | 1u&lt;&lt;SHT_RELA</div>
<div class="line"><span class="lineno"> 5791</span>            | 1u&lt;&lt;SHT_PROGBITS  <span class="comment">// see comment above</span></div>
<div class="line"><span class="lineno"> 5792</span>            | 1u&lt;&lt;SHT_HASH</div>
<div class="line"><span class="lineno"> 5793</span>            | 1u&lt;&lt;SHT_DYNAMIC</div>
<div class="line"><span class="lineno"> 5794</span>            | 1u&lt;&lt;SHT_NOTE</div>
<div class="line"><span class="lineno"> 5795</span>            | 1u&lt;&lt;SHT_REL</div>
<div class="line"><span class="lineno"> 5796</span>            | 1u&lt;&lt;SHT_DYNSYM</div>
<div class="line"><span class="lineno"> 5797</span>            | 1u&lt;&lt;SHT_STRTAB  <span class="comment">// .shstrtab and .dynstr</span></div>
<div class="line"><span class="lineno"> 5798</span>            | 1u&lt;&lt;SHT_INIT_ARRAY</div>
<div class="line"><span class="lineno"> 5799</span>            | 1u&lt;&lt;SHT_FINI_ARRAY</div>
<div class="line"><span class="lineno"> 5800</span>            | 1u&lt;&lt;SHT_PREINIT_ARRAY</div>
<div class="line"><span class="lineno"> 5801</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_versym)</div>
<div class="line"><span class="lineno"> 5802</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_verneed)</div>
<div class="line"><span class="lineno"> 5803</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_verdef)</div>
<div class="line"><span class="lineno"> 5804</span>            | 1u&lt;&lt;(0x1f &amp; SHT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 5805</span> </div>
<div class="line"><span class="lineno"> 5806</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> xct_off_hi = 0;</div>
<div class="line"><span class="lineno"> 5807</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, *ptr_end = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>];</div>
<div class="line"><span class="lineno"> 5808</span>        <span class="keywordflow">for</span> (; <a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> &lt; ptr_end; ++<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>) {</div>
<div class="line"><span class="lineno"> 5809</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_type)) {</div>
<div class="line"><span class="lineno"> 5810</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> hi = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_filesz)</div>
<div class="line"><span class="lineno"> 5811</span>                    + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 5812</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; hi) {</div>
<div class="line"><span class="lineno"> 5813</span>                    xct_off_hi = hi;</div>
<div class="line"><span class="lineno"> 5814</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5815</span>                }</div>
<div class="line"><span class="lineno"> 5816</span>            }</div>
<div class="line"><span class="lineno"> 5817</span>        }</div>
<div class="line"><span class="lineno"> 5818</span> </div>
<div class="line"><span class="lineno"> 5819</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_ask_for(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(eho-&gt;e_shnum));</div>
<div class="line"><span class="lineno"> 5820</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(mb_ask_for, 0, mb_ask_for.getSize());</div>
<div class="line"><span class="lineno"> 5821</span>        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *<span class="keyword">const</span> ask_for = (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)mb_ask_for.getVoidPtr();</div>
<div class="line"><span class="lineno"> 5822</span> </div>
<div class="line"><span class="lineno"> 5823</span>        <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> mb_shdro(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>));</div>
<div class="line"><span class="lineno"> 5824</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *sh_out0 = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)mb_shdro.getVoidPtr();</div>
<div class="line"><span class="lineno"> 5825</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *sh_out = sh_out0;</div>
<div class="line"><span class="lineno"> 5826</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *sh_in = <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>;</div>
<div class="line"><span class="lineno"> 5827</span> </div>
<div class="line"><span class="lineno"> 5828</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(sh_out, 0, <span class="keyword">sizeof</span>(*sh_out));  <span class="comment">// blank sh_out[0]</span></div>
<div class="line"><span class="lineno"> 5829</span>        ++sh_in; ++sh_out; <span class="keywordtype">unsigned</span> n_sh_out = 1;</div>
<div class="line"><span class="lineno"> 5830</span> </div>
<div class="line"><span class="lineno"> 5831</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 1; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++j, ++sh_in) {</div>
<div class="line"><span class="lineno"> 5832</span>            <span class="keywordtype">char</span> <span class="keyword">const</span> *sh_name = &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>[<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_name)];</div>
<div class="line"><span class="lineno"> 5833</span>            (void)sh_name;  <span class="comment">// debugging</span></div>
<div class="line"><span class="lineno"> 5834</span>            <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_type);</div>
<div class="line"><span class="lineno"> 5835</span>            <span class="keywordtype">unsigned</span> sh_info = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_info);</div>
<div class="line"><span class="lineno"> 5836</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_flags   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_flags);</div>
<div class="line"><span class="lineno"> 5837</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_addr    = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_addr);</div>
<div class="line"><span class="lineno"> 5838</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_offset  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 5839</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> sh_size    = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_in-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 5840</span>            <span class="keywordflow">if</span> (ask_for[j]) { <span class="comment">// Some previous _Shdr requested  me</span></div>
<div class="line"><span class="lineno"> 5841</span>                <span class="comment">// Tell them my new index</span></div>
<div class="line"><span class="lineno"> 5842</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;sh_out0[ask_for[j]].sh_info, n_sh_out);  <span class="comment">// sh_info vs st_shndx</span></div>
<div class="line"><span class="lineno"> 5843</span>            }</div>
<div class="line"><span class="lineno"> 5844</span>            <span class="keywordflow">if</span> (sh_info &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) { <span class="comment">// wild sh_info abounds!</span></div>
<div class="line"><span class="lineno"> 5845</span>                ask_for[sh_info] = j;  <span class="comment">// Enter my request, if any</span></div>
<div class="line"><span class="lineno"> 5846</span>            }</div>
<div class="line"><span class="lineno"> 5847</span>            <span class="keywordflow">if</span> (   (sh_offset &amp;&amp; sh_offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>)</div>
<div class="line"><span class="lineno"> 5848</span>                || (Elf64_Shdr::SHF_WRITE &amp; sh_flags)</div>
<div class="line"><span class="lineno"> 5849</span>                || (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>)</div>
<div class="line"><span class="lineno"> 5850</span>                || (<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> == sh_in)</div>
<div class="line"><span class="lineno"> 5851</span>                || (want_types_mask &amp; (1&lt;&lt;(0x1f &amp; sh_type)))</div>
<div class="line"><span class="lineno"> 5852</span>            ) {</div>
<div class="line"><span class="lineno"> 5853</span>                *sh_out = *sh_in;</div>
<div class="line"><span class="lineno"> 5854</span>                <span class="keywordflow">if</span> (sh_offset &gt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// may slide down: earlier compression</span></div>
<div class="line"><span class="lineno"> 5855</span>                    <span class="keywordflow">if</span> (sh_offset &gt;= xct_off_hi) { <span class="comment">// easy: so_slide down</span></div>
<div class="line"><span class="lineno"> 5856</span>                        <span class="keywordflow">if</span> (sh_out-&gt;sh_addr) <span class="comment">// change only if non-zero</span></div>
<div class="line"><span class="lineno"> 5857</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr,   <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_addr);</div>
<div class="line"><span class="lineno"> 5858</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 5859</span>                    }</div>
<div class="line"><span class="lineno"> 5860</span>                    <span class="keywordflow">else</span> { <span class="comment">// somewhere in compressed; try proportional (aligned)</span></div>
<div class="line"><span class="lineno"> 5861</span>                        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> slice = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + (~0xFu &amp; (unsigned)(</div>
<div class="line"><span class="lineno"> 5862</span>                             (sh_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) *</div>
<div class="line"><span class="lineno"> 5863</span>                            ((sh_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) / (<span class="keywordtype">float</span>)(xct_off_hi - <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>))));</div>
<div class="line"><span class="lineno"> 5864</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr,   slice);</div>
<div class="line"><span class="lineno"> 5865</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, slice);</div>
<div class="line"><span class="lineno"> 5866</span>                    }</div>
<div class="line"><span class="lineno"> 5867</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> max_sz = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sh_out-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 5868</span>                    <span class="keywordflow">if</span> (sh_size &gt; max_sz) { <span class="comment">// avoid complaint &quot;extends beyond EOF&quot;</span></div>
<div class="line"><span class="lineno"> 5869</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_size, max_sz);</div>
<div class="line"><span class="lineno"> 5870</span>                    }</div>
<div class="line"><span class="lineno"> 5871</span>                }</div>
<div class="line"><span class="lineno"> 5872</span>                <span class="keywordflow">if</span> (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) { <span class="comment">// changes Elf64_Ehdr itself</span></div>
<div class="line"><span class="lineno"> 5873</span>                    <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shstrndx, sh_out -</div>
<div class="line"><span class="lineno"> 5874</span>                        (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)mb_shdro.getVoidPtr());</div>
<div class="line"><span class="lineno"> 5875</span>                }</div>
<div class="line"><span class="lineno"> 5876</span>                <span class="keywordflow">if</span> (j == <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></div>
<div class="line"><span class="lineno"> 5877</span>                ||  <a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> == sh_in</div>
<div class="line"><span class="lineno"> 5878</span>                ||  (SHT_NOTE == sh_type &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_offset)</div>
<div class="line"><span class="lineno"> 5879</span>                ) { <span class="comment">// append a copy</span></div>
<div class="line"><span class="lineno"> 5880</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5881</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>((<a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>)sh_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5882</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>,  sh_size);</div>
<div class="line"><span class="lineno"> 5883</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sh_size);</div>
<div class="line"><span class="lineno"> 5884</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> +=    sh_size;</div>
<div class="line"><span class="lineno"> 5885</span>                } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5886</span>                <span class="keywordflow">if</span> (SHT_PROGBITS == sh_type) {</div>
<div class="line"><span class="lineno"> 5887</span>                    <span class="keywordflow">if</span> (sh_offset &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 5888</span>                    &amp;&amp;  0 == <a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.text&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> + <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;sh_in-&gt;sh_name)) ) {</div>
<div class="line"><span class="lineno"> 5889</span>                        <span class="comment">// .text was compressed (but perhaps omitting some leading</span></div>
<div class="line"><span class="lineno"> 5890</span>                        <span class="comment">// portion, if less than 4 PT_LOAD)</span></div>
<div class="line"><span class="lineno"> 5891</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_size, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_size);</div>
<div class="line"><span class="lineno"> 5892</span>                    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5893</span>                    <span class="keywordflow">if</span> (0 == sh_in-&gt;sh_addr) { <span class="comment">// .gnu_debuglink etc</span></div>
<div class="line"><span class="lineno"> 5894</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno"> 5895</span>                    }</div>
<div class="line"><span class="lineno"> 5896</span>                }</div>
<div class="line"><span class="lineno"> 5897</span>                <span class="comment">// Exploration for updating Shdrs from Dynamic, to pacify Android.</span></div>
<div class="line"><span class="lineno"> 5898</span>                <span class="comment">// Motivated by --force-pie with an input shared library;</span></div>
<div class="line"><span class="lineno"> 5899</span>                <span class="comment">// see https://github.com/upx/upx/issues/694</span></div>
<div class="line"><span class="lineno"> 5900</span>                <span class="comment">// But then realized that the pointed-to regions typically were</span></div>
<div class="line"><span class="lineno"> 5901</span>                <span class="comment">// just above Elfhdrs (overlay_offset), so the data would be</span></div>
<div class="line"><span class="lineno"> 5902</span>                <span class="comment">// incorrect because occupied by compressed PT_LOADS.</span></div>
<div class="line"><span class="lineno"> 5903</span>                <span class="comment">// But don&#39;t lose the code, so comment-out via &quot;if (0)&quot;.</span></div>
<div class="line"><span class="lineno"> 5904</span>                <span class="keywordflow">if</span> (0) <span class="keywordflow">switch</span>(sh_type) { <span class="comment">// start {Shdr, Dynamic} pairs</span></div>
<div class="line"><span class="lineno"> 5905</span>                <span class="keywordflow">case</span> SHT_DYNSYM: {</div>
<div class="line"><span class="lineno"> 5906</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_SYMTAB));</div>
<div class="line"><span class="lineno"> 5907</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5908</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5909</span>                <span class="keywordflow">case</span> SHT_STRTAB: {</div>
<div class="line"><span class="lineno"> 5910</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> != j) {</div>
<div class="line"><span class="lineno"> 5911</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_STRTAB));</div>
<div class="line"><span class="lineno"> 5912</span>                        sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5913</span>                    }</div>
<div class="line"><span class="lineno"> 5914</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5915</span>                <span class="keywordflow">case</span> SHT_GNU_versym: {</div>
<div class="line"><span class="lineno"> 5916</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERSYM));</div>
<div class="line"><span class="lineno"> 5917</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5918</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5919</span>                <span class="keywordflow">case</span> SHT_GNU_verneed: {</div>
<div class="line"><span class="lineno"> 5920</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_VERNEED));</div>
<div class="line"><span class="lineno"> 5921</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5922</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5923</span>                <span class="keywordflow">case</span> SHT_GNU_HASH: {</div>
<div class="line"><span class="lineno"> 5924</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_GNU_HASH));</div>
<div class="line"><span class="lineno"> 5925</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5926</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5927</span>                <span class="keywordflow">case</span> SHT_HASH: {</div>
<div class="line"><span class="lineno"> 5928</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_HASH));</div>
<div class="line"><span class="lineno"> 5929</span>                    sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5930</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5931</span>                <span class="keywordflow">case</span> SHT_RELA: {</div>
<div class="line"><span class="lineno"> 5932</span>                    <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rela.dyn&quot;</span>, sh_name)) {</div>
<div class="line"><span class="lineno"> 5933</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_RELA));</div>
<div class="line"><span class="lineno"> 5934</span>                        sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5935</span>                    }</div>
<div class="line"><span class="lineno"> 5936</span>                    <span class="keywordflow">if</span> (0==<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rela.plt&quot;</span>, sh_name)) {</div>
<div class="line"><span class="lineno"> 5937</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sh_out-&gt;sh_addr, <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_JMPREL));</div>
<div class="line"><span class="lineno"> 5938</span>                        sh_out-&gt;sh_offset = sh_out-&gt;sh_addr;</div>
<div class="line"><span class="lineno"> 5939</span>                    }</div>
<div class="line"><span class="lineno"> 5940</span>                } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5941</span>                } <span class="comment">// end {Shdr, Dynamic} pairs</span></div>
<div class="line"><span class="lineno"> 5942</span>                ++sh_out; ++n_sh_out;</div>
<div class="line"><span class="lineno"> 5943</span>            }</div>
<div class="line"><span class="lineno"> 5944</span>        }</div>
<div class="line"><span class="lineno"> 5945</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5946</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5947</span>        <span class="keywordtype">unsigned</span> len = (<span class="keywordtype">char</span> *)sh_out - (<span class="keywordtype">char</span> *)mb_shdro.getVoidPtr();</div>
<div class="line"><span class="lineno"> 5948</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shnum, len / <span class="keyword">sizeof</span>(*sh_out));</div>
<div class="line"><span class="lineno"> 5949</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 5950</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(mb_shdro, len);</div>
<div class="line"><span class="lineno"> 5951</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 5952</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5953</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(*eho));</div>
<div class="line"><span class="lineno"> 5954</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 5955</span>    }</div>
<div class="line"><span class="lineno"> 5956</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>) {</div>
<div class="line"><span class="lineno"> 5957</span>        <span class="comment">// Forward just ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 5958</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> shdr_aa[3];</div>
<div class="line"><span class="lineno"> 5959</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> attr_len = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 5960</span>        <span class="keywordtype">char</span> <span class="keyword">const</span> str_aa[] = <span class="stringliteral">&quot;\x00&quot;</span> <span class="stringliteral">&quot;.shstrtab\x00&quot;</span> <span class="stringliteral">&quot;.ARM.attributes\x00&quot;</span>;</div>
<div class="line"><span class="lineno"> 5961</span> </div>
<div class="line"><span class="lineno"> 5962</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(shdr_aa, 0, <span class="keyword">sizeof</span> shdr_aa);</div>
<div class="line"><span class="lineno"> 5963</span>            <span class="comment">// shstrtab</span></div>
<div class="line"><span class="lineno"> 5964</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_name, 1);</div>
<div class="line"><span class="lineno"> 5965</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[1].sh_type, Elf64_Shdr::SHT_STRTAB);</div>
<div class="line"><span class="lineno"> 5966</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[1].sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5967</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[1].sh_size, <span class="keyword">sizeof</span>(str_aa));</div>
<div class="line"><span class="lineno"> 5968</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[1].sh_addralign, 1);</div>
<div class="line"><span class="lineno"> 5969</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(str_aa, <span class="keyword">sizeof</span>(str_aa)); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(str_aa);</div>
<div class="line"><span class="lineno"> 5970</span> </div>
<div class="line"><span class="lineno"> 5971</span>            <span class="comment">// ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 5972</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_name, 11);</div>
<div class="line"><span class="lineno"> 5973</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;shdr_aa[2].sh_type, Elf64_Shdr::SHT_ARM_ATTRIBUTES);</div>
<div class="line"><span class="lineno"> 5974</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[2].sh_offset, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5975</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[2].sh_size, attr_len);</div>
<div class="line"><span class="lineno"> 5976</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr_aa[2].sh_addralign, 1);</div>
<div class="line"><span class="lineno"> 5977</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>-&gt;sh_offset)], attr_len);</div>
<div class="line"><span class="lineno"> 5978</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += attr_len);</div>
<div class="line"><span class="lineno"> 5979</span> </div>
<div class="line"><span class="lineno"> 5980</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shnum, 3);</div>
<div class="line"><span class="lineno"> 5981</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 5982</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5983</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;e_shstrndx, 1);</div>
<div class="line"><span class="lineno"> 5984</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(shdr_aa, <span class="keyword">sizeof</span>(shdr_aa));</div>
<div class="line"><span class="lineno"> 5985</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(shdr_aa);</div>
<div class="line"><span class="lineno"> 5986</span> </div>
<div class="line"><span class="lineno"> 5987</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5988</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(*eho));</div>
<div class="line"><span class="lineno"> 5989</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 5990</span>    }</div>
<div class="line"><span class="lineno"> 5991</span>    penalty = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - penalty;</div>
<div class="line"><span class="lineno"> 5992</span>    <a class="code hl_function" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info</a>(<span class="stringliteral">&quot;Android penalty = %d bytes&quot;</span>, penalty);</div>
<div class="line"><span class="lineno"> 5993</span>    <span class="keywordflow">return</span> penalty;</div>
<div class="line"><span class="lineno"> 5994</span>}</div>
<div class="ttc" id="aclassInputFile_html_ae6797787eefa57fdc7191461a47109f6"><div class="ttname"><a href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read</a></div><div class="ttdeci">int read(SPAN_P(void) buf, upx_int64_t blen)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00190">file.cpp:190</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a6dcc27c7627119f073cf47775984fcad"><div class="ttname"><a href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite</a></div><div class="ttdeci">void rewrite(SPAN_P(const void) buf, int len)</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00314">file.cpp:314</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a8be817665d0219026ebd50acdd3700af"><div class="ttname"><a href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a></div><div class="ttdeci">upx_off_t so_slide</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00102">p_lx_elf.h:102</a></div></div>
<div class="ttc" id="aclassPacker_html_a860499fa0849a7c7a7c4d43ee084f76e"><div class="ttname"><a href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16</a></div><div class="ttdeci">void set_te16(void *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00264">packer.h:264</a></div></div>
<div class="ttc" id="aclassPacker_html_a95d40264330fe966e66718440b450ec8"><div class="ttname"><a href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a></div><div class="ttdeci">MemBuffer ibuf</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00321">packer.h:321</a></div></div>
<div class="ttc" id="aconf_8h_html_a7e40dc9a8b2c00d7675df0cd2bd7c91e"><div class="ttname"><a href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a></div><div class="ttdeci">long long upx_off_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00199">conf.h:199</a></div></div>
<div class="ttc" id="alinux_8h_html_ad2a2e6c114780c3071efd24f16c7f7d8"><div class="ttname"><a href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a></div><div class="ttdeci">#define SEEK_END</div><div class="ttdef"><b>Definition:</b> <a href="linux_8h_source.html#l00111">linux.h:111</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a7b01bc9a5d719e0ece76d9b8dd822dde"><div class="ttname"><a href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov cx endm macro M_shld_diax_8_bxcx mov di mov bl mov ah mov al xor al mov bx endm macro M_shld_8_bp h l mov word ptr[bp+h] mov word ptr[bp+l] M_shld_8 mov word ptr[bp+h]</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00292">lzma_m.h:292</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">Elf64_Ehdr::e_shentsize</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f">fpad8()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a">info()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph" id="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_cgraph">
<area shape="rect" title=" " alt="" coords="5,607,184,647"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="241,56,392,96"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="645,70,775,95"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="287,311,346,337"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="457,361,587,386"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="252,614,381,639"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="241,663,392,689"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="232,713,401,738"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="293,762,340,787"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="279,835,355,861"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="653,513,767,538"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="245,361,388,386"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="463,753,581,778"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="458,702,586,727"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="253,885,381,910"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="253,934,381,959"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="253,983,381,1009"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="283,1057,350,1082"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="449,5,595,45"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="1017,171,1160,197"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1435,374,1573,399"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="643,259,777,285"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1645,702,1776,727"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="849,398,938,423"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1044,478,1133,503"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="665,361,755,386"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1226,222,1353,247"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="829,273,958,298"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1411,249,1597,274"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1683,249,1739,274"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1026,273,1151,298"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1216,323,1363,349"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1477,323,1531,349"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1434,511,1574,537"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1009,403,1168,443"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1230,450,1349,475"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="652,803,768,829"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="865,854,922,879"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="825,702,961,727"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph" id="aclassPackLinuxElf64_acc61917c51c71bfcb0f9af20ba7714d6_icgraph">
<area shape="rect" title=" " alt="" coords="220,5,399,45"/>
<area shape="rect" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6" title=" " alt="" coords="5,13,172,38"/>
</map>
</div>

</div>
</div>
<a id="a18903ac12b1370cdf82daef90aa27717" name="a18903ac12b1370cdf82daef90aa27717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18903ac12b1370cdf82daef90aa27717">&#9670;&#160;</a></span>generateElfHdr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::generateElfHdr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void const *&#160;</td>
          <td class="paramname"><em>proto</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>brka</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a378dd6608963beeae5bb6393ef4b23d5">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03743">3743</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3748</span>{</div>
<div class="line"><span class="lineno"> 3749</span>    cprElfHdr2 *<span class="keyword">const</span> h2 = (cprElfHdr2 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>;</div>
<div class="line"><span class="lineno"> 3750</span>    cprElfHdr3 *<span class="keyword">const</span> h3 = (cprElfHdr3 *)(<span class="keywordtype">void</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>;</div>
<div class="line"><span class="lineno"> 3751</span>    h3-&gt;ehdr =         ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;ehdr;</div>
<div class="line"><span class="lineno"> 3752</span>    h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>] = ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;phdr[1];  <span class="comment">// .data; .p_align</span></div>
<div class="line"><span class="lineno"> 3753</span>    h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>] = ((cprElfHdr3 <span class="keyword">const</span> *)proto)-&gt;phdr[0];  <span class="comment">// .text</span></div>
<div class="line"><span class="lineno"> 3754</span> </div>
<div class="line"><span class="lineno"> 3755</span>    h3-&gt;ehdr.e_type = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>;  <span class="comment">// ET_EXEC vs ET_DYN (gcc -pie -fPIC)</span></div>
<div class="line"><span class="lineno"> 3756</span>    h3-&gt;ehdr.e_ident[Elf64_Ehdr::EI_OSABI] = <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>;</div>
<div class="line"><span class="lineno"> 3757</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ELFOSABI_LINUX == <a class="code hl_variable" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">ei_osabi</a>  <span class="comment">// proper</span></div>
<div class="line"><span class="lineno"> 3758</span>    &amp;&amp;  Elf64_Ehdr::ELFOSABI_NONE  == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_OSABI]  <span class="comment">// sloppy</span></div>
<div class="line"><span class="lineno"> 3759</span>    ) { <span class="comment">// propagate sloppiness so that decompression does not complain</span></div>
<div class="line"><span class="lineno"> 3760</span>        h3-&gt;ehdr.e_ident[Elf64_Ehdr::EI_OSABI] = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_OSABI];</div>
<div class="line"><span class="lineno"> 3761</span>    }</div>
<div class="line"><span class="lineno"> 3762</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>)) {</div>
<div class="line"><span class="lineno"> 3763</span>        h3-&gt;ehdr.e_flags = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a>;  <span class="comment">// &quot;0x1, abiv1&quot; vs &quot;0x2, abiv2&quot;</span></div>
<div class="line"><span class="lineno"> 3764</span>    }</div>
<div class="line"><span class="lineno"> 3765</span> </div>
<div class="line"><span class="lineno"> 3766</span>    assert(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;h2-&gt;ehdr.e_phoff)     == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 3767</span>    assert(<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_ehsize)    == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));</div>
<div class="line"><span class="lineno"> 3768</span>    assert(<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;h2-&gt;ehdr.e_phentsize) == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 3769</span> </div>
<div class="line"><span class="lineno"> 3770</span>    h2-&gt;ehdr.e_shoff = 0;</div>
<div class="line"><span class="lineno"> 3771</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a>) {</div>
<div class="line"><span class="lineno"> 3772</span>        <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h2-&gt;ehdr.e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 3773</span>        h2-&gt;ehdr.e_shnum = <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a>;</div>
<div class="line"><span class="lineno"> 3774</span>        h2-&gt;ehdr.e_shstrndx = <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a> - 1;</div>
<div class="line"><span class="lineno"> 3775</span>    }</div>
<div class="line"><span class="lineno"> 3776</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3777</span>        h2-&gt;ehdr.e_shentsize = 0;</div>
<div class="line"><span class="lineno"> 3778</span>        h2-&gt;ehdr.e_shnum = 0;</div>
<div class="line"><span class="lineno"> 3779</span>        h2-&gt;ehdr.e_shstrndx = 0;</div>
<div class="line"><span class="lineno"> 3780</span>    }</div>
<div class="line"><span class="lineno"> 3781</span> </div>
<div class="line"><span class="lineno"> 3782</span>    <span class="keywordtype">unsigned</span> phnum_o = 2 + <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>;  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 3783</span>    <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;h2-&gt;ehdr.e_phnum, phnum_o);</div>
<div class="line"><span class="lineno"> 3784</span> </div>
<div class="line"><span class="lineno"> 3785</span>    <span class="comment">// Info for OS kernel to set the brk()</span></div>
<div class="line"><span class="lineno"> 3786</span>    <span class="keywordflow">if</span> (brka) {</div>
<div class="line"><span class="lineno"> 3787</span>        <span class="comment">// linux-2.6.14 binfmt_elf.c: SIGKILL if (0==.p_memsz) on a page boundary</span></div>
<div class="line"><span class="lineno"> 3788</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> lo_va_user(~(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)0);  <span class="comment">// infinity</span></div>
<div class="line"><span class="lineno"> 3789</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j= <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ) {</div>
<div class="line"><span class="lineno"> 3790</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[j].p_type)) {</div>
<div class="line"><span class="lineno"> 3791</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[j].p_vaddr);</div>
<div class="line"><span class="lineno"> 3792</span>                lo_va_user = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(lo_va_user, vaddr);</div>
<div class="line"><span class="lineno"> 3793</span>            }</div>
<div class="line"><span class="lineno"> 3794</span>        }</div>
<div class="line"><span class="lineno"> 3795</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(                 &amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr, lo_va_user);</div>
<div class="line"><span class="lineno"> 3796</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_paddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 3797</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 3798</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_paddr = h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno"> 3799</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_type, <a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>);  <span class="comment">// be sure</span></div>
<div class="line"><span class="lineno"> 3800</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_offset = 0;</div>
<div class="line"><span class="lineno"> 3801</span>        h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz = 0;</div>
<div class="line"><span class="lineno"> 3802</span>        <span class="comment">// .p_memsz = brka;  temporary until sz_pack2</span></div>
<div class="line"><span class="lineno"> 3803</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_memsz, brka - lo_va_user);</div>
<div class="line"><span class="lineno"> 3804</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, Elf64_Phdr::PF_R | Elf64_Phdr::PF_W);</div>
<div class="line"><span class="lineno"> 3805</span>    }</div>
<div class="line"><span class="lineno"> 3806</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 3807</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h3-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_align, <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a>);</div>
<div class="line"><span class="lineno"> 3808</span>    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags, ~Elf64_Phdr::PF_W &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_flags));</div>
<div class="line"><span class="lineno"> 3809</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(h2, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + 2* <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 3810</span> </div>
<div class="line"><span class="lineno"> 3811</span>    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> zero_pad = 0;</div>
<div class="line"><span class="lineno"> 3812</span>    <span class="keywordtype">unsigned</span> uva0 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 3813</span>    <span class="keywordtype">unsigned</span> off_o = 0;</div>
<div class="line"><span class="lineno"> 3814</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> phase = 0; phase &lt; 2; ++phase) { <span class="comment">// 0: Phdrs;  1: bodies</span></div>
<div class="line"><span class="lineno"> 3815</span>        off_o = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>);</div>
<div class="line"><span class="lineno"> 3816</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>; ++j) {</div>
<div class="line"><span class="lineno"> 3817</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phtmp = *<a class="code hl_variable" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>[j];</div>
<div class="line"><span class="lineno"> 3818</span>            phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a> = phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a> = 0;</div>
<div class="line"><span class="lineno"> 3819</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> off_i = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 3820</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> align = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>);</div>
<div class="line"><span class="lineno"> 3821</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 3822</span>            <span class="keywordtype">unsigned</span> pad = 0;</div>
<div class="line"><span class="lineno"> 3823</span>            <span class="keywordflow">if</span> (filesz &amp;&amp; align &amp;&amp; <a class="code hl_function" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2</a>(align)) {</div>
<div class="line"><span class="lineno"> 3824</span>                <span class="keywordtype">unsigned</span> alm1 = -1 + <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(8u, (<span class="keywordtype">unsigned</span>)align);</div>
<div class="line"><span class="lineno"> 3825</span>                pad = alm1 &amp; (0u - off_o);</div>
<div class="line"><span class="lineno"> 3826</span>                off_o += pad;</div>
<div class="line"><span class="lineno"> 3827</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>, off_o + uva0); phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">p_paddr</a> = phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>;</div>
<div class="line"><span class="lineno"> 3828</span>            }</div>
<div class="line"><span class="lineno"> 3829</span>            <span class="keywordflow">if</span> (0==phase) {</div>
<div class="line"><span class="lineno"> 3830</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phtmp.<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>, (filesz ? off_o : 0));</div>
<div class="line"><span class="lineno"> 3831</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;phtmp, <span class="keyword">sizeof</span>(phtmp));  <span class="comment">// Phdr</span></div>
<div class="line"><span class="lineno"> 3832</span>            }</div>
<div class="line"><span class="lineno"> 3833</span>            <span class="keywordflow">if</span> (1==phase) {</div>
<div class="line"><span class="lineno"> 3834</span>                <span class="keywordflow">if</span> (pad) fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;zero_pad, pad);</div>
<div class="line"><span class="lineno"> 3835</span>                <span class="keywordflow">if</span> (filesz) fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[off_i], filesz);  <span class="comment">// body</span></div>
<div class="line"><span class="lineno"> 3836</span>            }</div>
<div class="line"><span class="lineno"> 3837</span>            off_o += filesz;</div>
<div class="line"><span class="lineno"> 3838</span>        }</div>
<div class="line"><span class="lineno"> 3839</span>    }</div>
<div class="line"><span class="lineno"> 3840</span>    off_o = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, off_o);</div>
<div class="line"><span class="lineno"> 3841</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a> = off_o - (<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 3842</span>    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;h2-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz, off_o);</div>
<div class="line"><span class="lineno"> 3843</span> </div>
<div class="line"><span class="lineno"> 3844</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + phnum_o * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) + <a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>;</div>
<div class="line"><span class="lineno"> 3845</span>    <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>);</div>
<div class="line"><span class="lineno"> 3846</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">o_binfo</a>        = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>) + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structp__info.html">p_info</a>);</div>
<div class="line"><span class="lineno"> 3847</span> </div>
<div class="line"><span class="lineno"> 3848</span>    <a class="code hl_struct" href="structl__info.html">l_info</a> linfo2; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;linfo2, 0, <span class="keyword">sizeof</span>(linfo2));</div>
<div class="line"><span class="lineno"> 3849</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;linfo2, <span class="keyword">sizeof</span>(linfo2));</div>
<div class="line"><span class="lineno"> 3850</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a9448025599860ae8d5773f15c09d73a4"><div class="ttname"><a href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">PackLinuxElf64::elfout</a></div><div class="ttdeci">cprElfHdr4 elfout</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00437">p_lx_elf.h:437</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a1a02a5314fbdff34469cfa4b59ddde10"><div class="ttname"><a href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a></div><div class="ttdeci">int o_elf_shnum</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00129">p_lx_elf.h:129</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a371519bdb05124340b9d78e067bee1e0"><div class="ttname"><a href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">PackLinuxElf::o_binfo</a></div><div class="ttdeci">unsigned o_binfo</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00101">p_lx_elf.h:101</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a80989e5fdaa51b0650d6f5d66eaf3766"><div class="ttname"><a href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a></div><div class="ttdeci">unsigned page_size</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00096">p_lx_elf.h:96</a></div></div>
<div class="ttc" id="aclassPackUnix_html_aa3e227135d766557eb3e012e610d72a0"><div class="ttname"><a href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a></div><div class="ttdeci">unsigned overlay_offset</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00096">p_unix.h:96</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a961610ff2ac229f29f7d03d3a2ccc084"><div class="ttname"><a href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a></div><div class="ttdeci">static off_t fpad4(OutputFile *fo, unsigned pos)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00099">p_lx_elf.cpp:99</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b"><div class="ttname"><a href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a></div><div class="ttdeci">@ C_BASE</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00509">p_lx_elf.cpp:508</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5"><div class="ttname"><a href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a></div><div class="ttdeci">@ C_TEXT</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00510">p_lx_elf.cpp:509</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a6c07667c1adfd724637d66535c3ffed0"><div class="ttname"><a href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a></div><div class="ttdeci">unsigned char e_ident[EI_NIDENT]</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00207">bsd.h:207</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_adecc8b3641e23794f39c78f15ab8c809"><div class="ttname"><a href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a></div><div class="ttdeci">Elf64_Half e_machine</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00209">bsd.h:209</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_ae6ea9e821472d35e7d2c446fa79bdc3a"><div class="ttname"><a href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a></div><div class="ttdeci">Elf64_Word e_flags</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00214">bsd.h:214</a></div></div>
<div class="ttc" id="astructElf64__Phdr_html_aa89a4b1835998c8866e821d777a2f879"><div class="ttname"><a href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a></div><div class="ttdeci">Elf64_Xword p_align</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00244">bsd.h:244</a></div></div>
<div class="ttc" id="astructp__info_html"><div class="ttname"><a href="structp__info.html">p_info</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00340">bsd.h:341</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf.html#ad930777406ea601d200de0ab59de88d6">PackLinuxElf::ei_osabi</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf">is_pow2()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>, <a class="el" href="classPackLinuxElf.html#a371519bdb05124340b9d78e067bee1e0">PackLinuxElf::o_binfo</a>, <a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a83f4adb032fc307f5af79bdee5ef692d">Elf64_Phdr::p_paddr</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf64.html#ac4fe837eb5fd3cff1d6b76758ab9a58c">phdrx</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>, and <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd::pack1()</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm::pack1()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle::pack1()</a>, and <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc::pack1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph" id="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_cgraph">
<area shape="rect" title=" " alt="" coords="5,337,192,377"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="275,119,334,145"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="423,170,554,195"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="240,221,369,246"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="240,270,369,295"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="240,319,369,345"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="267,369,342,394"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="267,442,343,467"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="241,491,369,517"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="241,541,369,566"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="241,590,369,615"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="417,57,560,82"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1394,97,1531,122"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="608,195,743,221"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1604,119,1735,145"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="811,270,900,295"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="811,321,900,346"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="631,94,720,119"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1185,245,1311,270"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="791,145,920,170"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1369,245,1556,270"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1641,245,1697,270"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="985,145,1110,170"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1175,195,1321,221"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1435,146,1490,171"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1393,195,1533,221"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="968,260,1127,300"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1189,309,1307,334"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph" id="aclassPackLinuxElf64_a18903ac12b1370cdf82daef90aa27717_icgraph">
<area shape="rect" title=" " alt="" coords="211,101,397,141"/>
<area shape="rect" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533" title=" " alt="" coords="5,5,163,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8" title=" " alt="" coords="7,69,161,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53" title=" " alt="" coords="7,133,161,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb" title=" " alt="" coords="9,197,159,237"/>
</map>
</div>

</div>
</div>
<a id="a0587b38413f853b20625a28bf2a369e8" name="a0587b38413f853b20625a28bf2a369e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0587b38413f853b20625a28bf2a369e8">&#9670;&#160;</a></span>get_dynsym_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char const  * PackLinuxElf64::get_dynsym_name </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>symnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02391">2391</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2392</span>{</div>
<div class="line"><span class="lineno"> 2393</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a> &lt;= symnum) {</div>
<div class="line"><span class="lineno"> 2394</span>        (void)relnum;</div>
<div class="line"><span class="lineno"> 2395</span>        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 2396</span>    }</div>
<div class="line"><span class="lineno"> 2397</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name</a>(<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[symnum].st_name), symnum);</div>
<div class="line"><span class="lineno"> 2398</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a4cc33d310cb391da2166a1dd3857ee4d"><div class="ttname"><a href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a></div><div class="ttdeci">unsigned symnum_max</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00087">p_lx_elf.h:87</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c">get_str_name()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, and <a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1()</a>, and <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph" id="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,155,75"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="203,5,352,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="213,70,342,95"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="400,13,519,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph" id="aclassPackLinuxElf64_a0587b38413f853b20625a28bf2a369e8_icgraph">
<area shape="rect" title=" " alt="" coords="928,39,1077,79"/>
<area shape="rect" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3" title=" " alt="" coords="495,5,685,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="735,67,880,107"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,17,187,43"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,67,687,107"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,43,440,68"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,93,445,133"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,157,444,197"/>
</map>
</div>

</div>
</div>
<a id="acd825cbaf5a768993a7f0b90a24c7a4c" name="acd825cbaf5a768993a7f0b90a24c7a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd825cbaf5a768993a7f0b90a24c7a4c">&#9670;&#160;</a></span>get_str_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char const  * PackLinuxElf64::get_str_name </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>st_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>symnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l02381">2381</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2382</span>{</div>
<div class="line"><span class="lineno"> 2383</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> &lt;= st_name) {</div>
<div class="line"><span class="lineno"> 2384</span>        <span class="keywordtype">char</span> msg[70]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 2385</span>            <span class="stringliteral">&quot;bad .st_name %#x in DT_SYMTAB[%d]&quot;</span>, st_name, symnum);</div>
<div class="line"><span class="lineno"> 2386</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 2387</span>    }</div>
<div class="line"><span class="lineno"> 2388</span>    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a>[st_name];</div>
<div class="line"><span class="lineno"> 2389</span>}</div>
<div class="ttc" id="aclassPackLinuxElf_html_a4c581148f2345d127c21f0ba5a33a656"><div class="ttname"><a href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a></div><div class="ttdeci">unsigned strtab_max</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00088">p_lx_elf.h:88</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS()</a>, <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, and <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph" id="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,45"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="203,13,321,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph" id="aclassPackLinuxElf64_acd825cbaf5a768993a7f0b90a24c7a4c_icgraph">
<area shape="rect" title=" " alt="" coords="1152,136,1301,176"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="929,77,1104,102"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="735,152,881,192"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="942,193,1091,233"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="735,5,881,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="736,69,880,109"/>
<area shape="rect" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092" title=" " alt="" coords="507,13,673,38"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="518,65,662,105"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,53,427,78"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,152,687,192"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,102,440,127"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,152,445,192"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,216,444,256"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,191,187,217"/>
<area shape="rect" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3" title=" " alt="" coords="495,249,685,274"/>
</map>
</div>

</div>
</div>
<a id="ac405aa11c3c356e93dc38f2365701466" name="ac405aa11c3c356e93dc38f2365701466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac405aa11c3c356e93dc38f2365701466">&#9670;&#160;</a></span>getbrk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf64::getbrk </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> *&#160;</td>
          <td class="paramname"><em>phdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>e_phnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l03434">3434</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3435</span>{</div>
<div class="line"><span class="lineno"> 3436</span>    <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> brka = 0;</div>
<div class="line"><span class="lineno"> 3437</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; nph; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 3438</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 3439</span>            <a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>);</div>
<div class="line"><span class="lineno"> 3440</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> &gt; brka)</div>
<div class="line"><span class="lineno"> 3441</span>                brka = <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 3442</span>        }</div>
<div class="line"><span class="lineno"> 3443</span>    }</div>
<div class="line"><span class="lineno"> 3444</span>    <span class="keywordflow">return</span> brka;</div>
<div class="line"><span class="lineno"> 3445</span>}</div>
<div class="ttc" id="absd_8h_html_af83497edef361523a95b06deda0b4c2d"><div class="ttname"><a href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a></div><div class="ttdeci">long off_t</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00073">bsd.h:73</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_af71ddeb3e6a1edbdfadd8f044c60fa66"><div class="ttname"><a href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a></div><div class="ttdeci">const C&lt; U &gt; &amp; b</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00080">xspan_fwd.h:80</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, and <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd::pack1()</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm::pack1()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle::pack1()</a>, <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc::pack1()</a>, and <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph" id="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,176,56"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="224,5,353,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="224,55,353,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph" id="aclassPackLinuxElf64_ac405aa11c3c356e93dc38f2365701466_icgraph">
<area shape="rect" title=" " alt="" coords="220,141,391,166"/>
<area shape="rect" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533" title=" " alt="" coords="10,5,167,45"/>
<area shape="rect" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8" title=" " alt="" coords="11,69,166,109"/>
<area shape="rect" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53" title=" " alt="" coords="11,133,166,173"/>
<area shape="rect" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb" title=" " alt="" coords="13,197,164,237"/>
<area shape="rect" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562" title=" " alt="" coords="5,262,172,287"/>
</map>
</div>

</div>
</div>
<a id="a34544f047b9808c7416a3a3666a7d6bb" name="a34544f047b9808c7416a3a3666a7d6bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34544f047b9808c7416a3a3666a7d6bb">&#9670;&#160;</a></span>invert_pt_dynamic()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::invert_pt_dynamic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *&#160;</td>
          <td class="paramname"><em>dynp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>dt_filesz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07945">7945</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7946</span>{</div>
<div class="line"><span class="lineno"> 7947</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_NULL]) {</div>
<div class="line"><span class="lineno"> 7948</span>        <span class="keywordflow">return</span>;  <span class="comment">// not 1st time; do not change upx_dt_init</span></div>
<div class="line"><span class="lineno"> 7949</span>    }</div>
<div class="line"><span class="lineno"> 7950</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> <span class="keyword">const</span> *<span class="keyword">const</span> dynp0 = dynp;</div>
<div class="line"><span class="lineno"> 7951</span>    <span class="keywordtype">unsigned</span> ndx = 0;</div>
<div class="line"><span class="lineno"> 7952</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> limit = headway / <span class="keyword">sizeof</span>(*dynp);</div>
<div class="line"><span class="lineno"> 7953</span>    <span class="keywordflow">if</span> (dynp)</div>
<div class="line"><span class="lineno"> 7954</span>    <span class="keywordflow">for</span> (; ; ++ndx, ++dynp) {</div>
<div class="line"><span class="lineno"> 7955</span>        <span class="keywordflow">if</span> (limit &lt;= ndx) {</div>
<div class="line"><span class="lineno"> 7956</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;DT_NULL not found&quot;</span>);</div>
<div class="line"><span class="lineno"> 7957</span>        }</div>
<div class="line"><span class="lineno"> 7958</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> d_tag = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 7959</span>        <span class="keywordflow">if</span> (d_tag&gt;&gt;32) { <span class="comment">// outrageous</span></div>
<div class="line"><span class="lineno"> 7960</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad Elf64_Dyn[%d].d_tag %#lx&quot;</span>,</div>
<div class="line"><span class="lineno"> 7961</span>                ndx, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)d_tag);</div>
<div class="line"><span class="lineno"> 7962</span>        }</div>
<div class="line"><span class="lineno"> 7963</span>        <span class="keywordflow">if</span> (d_tag &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) {</div>
<div class="line"><span class="lineno"> 7964</span>            <span class="keywordflow">if</span> (Elf64_Dyn::DT_NEEDED != d_tag</div>
<div class="line"><span class="lineno"> 7965</span>            &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag]</div>
<div class="line"><span class="lineno"> 7966</span>            &amp;&amp;    <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp-&gt;d_val)</div>
<div class="line"><span class="lineno"> 7967</span>               != <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag]].d_val)) {</div>
<div class="line"><span class="lineno"> 7968</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;duplicate DT_%#x: [%#x] [%#x]&quot;</span>,</div>
<div class="line"><span class="lineno"> 7969</span>                    (<span class="keywordtype">unsigned</span>)d_tag, -1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag], ndx);</div>
<div class="line"><span class="lineno"> 7970</span>            }</div>
<div class="line"><span class="lineno"> 7971</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[d_tag] = 1+ ndx;</div>
<div class="line"><span class="lineno"> 7972</span>        }</div>
<div class="line"><span class="lineno"> 7973</span>        <span class="keywordflow">if</span> (Elf64_Dyn::DT_NULL == d_tag) {</div>
<div class="line"><span class="lineno"> 7974</span>            <span class="keywordflow">break</span>;  <span class="comment">// check here so that dt_table[DT_NULL] is set</span></div>
<div class="line"><span class="lineno"> 7975</span>        }</div>
<div class="line"><span class="lineno"> 7976</span>    }</div>
<div class="line"><span class="lineno"> 7977</span>    <a class="code hl_function" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets</a>(dynp0);</div>
<div class="line"><span class="lineno"> 7978</span> </div>
<div class="line"><span class="lineno"> 7979</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = 0;</div>
<div class="line"><span class="lineno"> 7980</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_INIT])          <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_INIT;</div>
<div class="line"><span class="lineno"> 7981</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_PREINIT_ARRAY]) <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_PREINIT_ARRAY;</div>
<div class="line"><span class="lineno"> 7982</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_INIT_ARRAY])    <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> = Elf64_Dyn::DT_INIT_ARRAY;</div>
<div class="line"><span class="lineno"> 7983</span> </div>
<div class="line"><span class="lineno"> 7984</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> z_str = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_STRSZ];</div>
<div class="line"><span class="lineno"> 7985</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> = !z_str ? 0 : <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ z_str].d_val);</div>
<div class="line"><span class="lineno"> 7986</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> z_tab = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_STRTAB];</div>
<div class="line"><span class="lineno"> 7987</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> tmp1 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ z_tab].d_val);</div>
<div class="line"><span class="lineno"> 7988</span>    <span class="keywordflow">if</span> (tmp1 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) {</div>
<div class="line"><span class="lineno"> 7989</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_STRTAB %#x&quot;</span>, tmp1);</div>
<div class="line"><span class="lineno"> 7990</span>    }</div>
<div class="line"><span class="lineno"> 7991</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> strtab_beg = !z_tab ? 0 : <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(tmp1);</div>
<div class="line"><span class="lineno"> 7992</span> </div>
<div class="line"><span class="lineno"> 7993</span>    <span class="keywordflow">if</span> (!z_str || !z_tab</div>
<div class="line"><span class="lineno"> 7994</span>    || (this-&gt;<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - strtab_beg) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a>  <span class="comment">// strtab overlaps EOF</span></div>
<div class="line"><span class="lineno"> 7995</span>        <span class="comment">// last string in table must have terminating NUL</span></div>
<div class="line"><span class="lineno"> 7996</span>    ||  <span class="charliteral">&#39;\0&#39;</span> != ((<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>())[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a> + strtab_beg]</div>
<div class="line"><span class="lineno"> 7997</span>    ) {</div>
<div class="line"><span class="lineno"> 7998</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_STRSZ %#x&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">strtab_max</a>);</div>
<div class="line"><span class="lineno"> 7999</span>    }</div>
<div class="line"><span class="lineno"> 8000</span> </div>
<div class="line"><span class="lineno"> 8001</span>    <span class="comment">// Find end of DT_SYMTAB</span></div>
<div class="line"><span class="lineno"> 8002</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> tmp2 = <a class="code hl_function" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a>(Elf64_Dyn::DT_SYMTAB,</div>
<div class="line"><span class="lineno"> 8003</span>        Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 8004</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">symnum_max</a> = (~0u == tmp2) ? 0 : tmp1 / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>);</div>
<div class="line"><span class="lineno"> 8005</span> </div>
<div class="line"><span class="lineno"> 8006</span>    <span class="keywordtype">unsigned</span> v_sym = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_SYMTAB];</div>
<div class="line"><span class="lineno"> 8007</span>    <span class="keywordflow">if</span> (v_sym) {</div>
<div class="line"><span class="lineno"> 8008</span>        v_sym = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ v_sym].d_val));</div>
<div class="line"><span class="lineno"> 8009</span>    }</div>
<div class="line"><span class="lineno"> 8010</span> </div>
<div class="line"><span class="lineno"> 8011</span>    <span class="keywordtype">unsigned</span> v_hsh = <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[Elf64_Dyn::DT_HASH];</div>
<div class="line"><span class="lineno"> 8012</span>    <span class="keywordflow">if</span> (v_hsh) {</div>
<div class="line"><span class="lineno"> 8013</span>        v_hsh = <a class="code hl_function" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ v_hsh].d_val));</div>
<div class="line"><span class="lineno"> 8014</span>    }</div>
<div class="line"><span class="lineno"> 8015</span>    <span class="keywordflow">if</span> (v_hsh &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) {</div>
<div class="line"><span class="lineno"> 8016</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 8017</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>) {</div>
<div class="line"><span class="lineno"> 8018</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH %#x&quot;</span>, v_hsh);</div>
<div class="line"><span class="lineno"> 8019</span>        }</div>
<div class="line"><span class="lineno"> 8020</span>        <span class="comment">// Find end of DT_HASH</span></div>
<div class="line"><span class="lineno"> 8021</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)(<a class="code hl_function" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a>(</div>
<div class="line"><span class="lineno"> 8022</span>            Elf64_Dyn::DT_HASH, Elf64_Shdr::SHT_HASH) + (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>);</div>
<div class="line"><span class="lineno"> 8023</span> </div>
<div class="line"><span class="lineno"> 8024</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> nbucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8025</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> buckets = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>[2];</div>
<div class="line"><span class="lineno"> 8026</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *<span class="keyword">const</span> chains = &amp;buckets[nbucket]; (void)chains;</div>
<div class="line"><span class="lineno"> 8027</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - ((<span class="keywordtype">char</span> <span class="keyword">const</span> *)buckets - (<span class="keywordtype">char</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>))</div>
<div class="line"><span class="lineno"> 8028</span>                &lt;= <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*nbucket ) {</div>
<div class="line"><span class="lineno"> 8029</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad nbucket %#x\n&quot;</span>, nbucket);</div>
<div class="line"><span class="lineno"> 8030</span>        }</div>
<div class="line"><span class="lineno"> 8031</span> </div>
<div class="line"><span class="lineno"> 8032</span>        <span class="keywordflow">if</span> ((<span class="keywordtype">unsigned</span>)(<a class="code hl_variable" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a> - buckets) &lt; nbucket</div>
<div class="line"><span class="lineno"> 8033</span>        || !v_sym || <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt;= v_sym</div>
<div class="line"><span class="lineno"> 8034</span>        || ((v_hsh &lt; v_sym) &amp;&amp; (v_sym - v_hsh) &lt; <span class="keyword">sizeof</span>(*buckets)*(2+ nbucket))</div>
<div class="line"><span class="lineno"> 8035</span>        ) {</div>
<div class="line"><span class="lineno"> 8036</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH nbucket=%#x  len=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 8037</span>                nbucket, (v_sym - v_hsh));</div>
<div class="line"><span class="lineno"> 8038</span>        }</div>
<div class="line"><span class="lineno"> 8039</span>        <span class="keywordtype">unsigned</span> chmax = 0;</div>
<div class="line"><span class="lineno"> 8040</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j= 0; j &lt; nbucket; ++j) {</div>
<div class="line"><span class="lineno"> 8041</span>            <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno"> 8042</span>            <span class="keywordflow">if</span> (chmax &lt; x) {</div>
<div class="line"><span class="lineno"> 8043</span>                chmax = x;</div>
<div class="line"><span class="lineno"> 8044</span>            }</div>
<div class="line"><span class="lineno"> 8045</span>        }</div>
<div class="line"><span class="lineno"> 8046</span>        <span class="keywordflow">if</span> ((v_hsh &lt; v_sym) &amp;&amp; (v_sym - v_hsh) &lt;</div>
<div class="line"><span class="lineno"> 8047</span>                (<span class="keyword">sizeof</span>(*buckets)*(2+ nbucket) + <span class="keyword">sizeof</span>(*chains)*(1+ chmax))) {</div>
<div class="line"><span class="lineno"> 8048</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_HASH nbucket=%#x  len=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 8049</span>                nbucket, (v_sym - v_hsh));</div>
<div class="line"><span class="lineno"> 8050</span>        }</div>
<div class="line"><span class="lineno"> 8051</span>    }</div>
<div class="line"><span class="lineno"> 8052</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> v_gsh = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 8053</span>    <span class="keywordflow">if</span> (v_gsh &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) {</div>
<div class="line"><span class="lineno"> 8054</span>        <span class="comment">// Not similar to DT_HASH because DT_GNU_HASH is not small (0x6ffffef5).</span></div>
<div class="line"><span class="lineno"> 8055</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 8056</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>) {</div>
<div class="line"><span class="lineno"> 8057</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH %#x&quot;</span>, v_gsh);</div>
<div class="line"><span class="lineno"> 8058</span>        }</div>
<div class="line"><span class="lineno"> 8059</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a> = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)(<a class="code hl_function" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size</a>(</div>
<div class="line"><span class="lineno"> 8060</span>            Elf64_Dyn::DT_GNU_HASH, Elf64_Shdr::SHT_GNU_HASH) + (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>);</div>
<div class="line"><span class="lineno"> 8061</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bucket = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[0]);</div>
<div class="line"><span class="lineno"> 8062</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> symbias  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[1]);</div>
<div class="line"><span class="lineno"> 8063</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> n_bitmask = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[2]);</div>
<div class="line"><span class="lineno"> 8064</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> gnu_shift = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[3]);</div>
<div class="line"><span class="lineno"> 8065</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *<span class="keyword">const</span> bitmask = (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>[4];</div>
<div class="line"><span class="lineno"> 8066</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> buckets = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)&amp;bitmask[n_bitmask];</div>
<div class="line"><span class="lineno"> 8067</span>        <span class="keywordtype">unsigned</span>     <span class="keyword">const</span> *<span class="keyword">const</span> hasharr = &amp;buckets[n_bucket]; (void)hasharr;</div>
<div class="line"><span class="lineno"> 8068</span>        <span class="keywordflow">if</span> (!n_bucket || (1u&lt;&lt;31) &lt;= n_bucket  <span class="comment">/* fie on fuzzers */</span></div>
<div class="line"><span class="lineno"> 8069</span>        || (unsigned)(<a class="code hl_variable" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a> - buckets) &lt; n_bucket</div>
<div class="line"><span class="lineno"> 8070</span>        || (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) &lt;= (<span class="keywordtype">void</span> <span class="keyword">const</span> *)hasharr) {</div>
<div class="line"><span class="lineno"> 8071</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad n_bucket %#x\n&quot;</span>, n_bucket);</div>
<div class="line"><span class="lineno"> 8072</span>        }</div>
<div class="line"><span class="lineno"> 8073</span>        <span class="comment">// It would be better to detect zeroes shifted into low 6 bits of:</span></div>
<div class="line"><span class="lineno"> 8074</span>        <span class="comment">//    (077 &amp; (hash_32 &gt;&gt; gnu_shift))</span></div>
<div class="line"><span class="lineno"> 8075</span>        <span class="comment">// but compilers can be stupid.</span></div>
<div class="line"><span class="lineno"> 8076</span>        <span class="keywordflow">if</span> (31 &lt; gnu_shift) {</div>
<div class="line"><span class="lineno"> 8077</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad gnu_shift %#x&quot;</span>, gnu_shift);</div>
<div class="line"><span class="lineno"> 8078</span>        }</div>
<div class="line"><span class="lineno"> 8079</span>        <span class="comment">// unsigned const *const gashend = &amp;hasharr[n_bucket];</span></div>
<div class="line"><span class="lineno"> 8080</span>        <span class="comment">// minimum, except:</span></div>
<div class="line"><span class="lineno"> 8081</span>        <span class="comment">// Rust and Android trim unused zeroes from high end of hasharr[]</span></div>
<div class="line"><span class="lineno"> 8082</span>        <span class="keywordtype">unsigned</span> bmax = 0;</div>
<div class="line"><span class="lineno"> 8083</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j= 0; j &lt; n_bucket; ++j) {</div>
<div class="line"><span class="lineno"> 8084</span>            <span class="keywordtype">unsigned</span> bj = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;buckets[j]);</div>
<div class="line"><span class="lineno"> 8085</span>            <span class="keywordflow">if</span> (bj) {</div>
<div class="line"><span class="lineno"> 8086</span>                <span class="keywordflow">if</span> (bj &lt; symbias) {</div>
<div class="line"><span class="lineno"> 8087</span>                    <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH bucket[%d] &lt; symbias{%#x}\n&quot;</span>,</div>
<div class="line"><span class="lineno"> 8088</span>                            bj, symbias);</div>
<div class="line"><span class="lineno"> 8089</span>                }</div>
<div class="line"><span class="lineno"> 8090</span>                <span class="keywordflow">if</span> (bmax &lt; bj) {</div>
<div class="line"><span class="lineno"> 8091</span>                    bmax = bj;</div>
<div class="line"><span class="lineno"> 8092</span>                }</div>
<div class="line"><span class="lineno"> 8093</span>            }</div>
<div class="line"><span class="lineno"> 8094</span>        }</div>
<div class="line"><span class="lineno"> 8095</span>        <span class="keywordflow">if</span> (1==n_bucket  &amp;&amp; 0==buckets[0]</div>
<div class="line"><span class="lineno"> 8096</span>        &amp;&amp;  1==n_bitmask &amp;&amp; 0==bitmask[0]) {</div>
<div class="line"><span class="lineno"> 8097</span>            <span class="comment">// 2021-09-11 Rust on RaspberryPi apparently uses this to minimize space.</span></div>
<div class="line"><span class="lineno"> 8098</span>            <span class="comment">// But then the DT_GNU_HASH symbol lookup algorithm always fails?</span></div>
<div class="line"><span class="lineno"> 8099</span>            <span class="comment">// https://github.com/upx/upx/issues/525</span></div>
<div class="line"><span class="lineno"> 8100</span>        } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8101</span>        <span class="keywordflow">if</span> (bmax) {</div>
<div class="line"><span class="lineno"> 8102</span>            <span class="keywordflow">if</span> ((1+ bmax) &lt; symbias) {</div>
<div class="line"><span class="lineno"> 8103</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH (1+ max_bucket)=%#x &lt; symbias=%#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 8104</span>                    1+ bmax, symbias);</div>
<div class="line"><span class="lineno"> 8105</span>            }</div>
<div class="line"><span class="lineno"> 8106</span>            bmax -= symbias;</div>
<div class="line"><span class="lineno"> 8107</span>        }</div>
<div class="line"><span class="lineno"> 8108</span> </div>
<div class="line"><span class="lineno"> 8109</span>        <span class="keywordtype">unsigned</span> r = 0;</div>
<div class="line"><span class="lineno"> 8110</span>        <span class="keywordflow">if</span> (!n_bucket || !n_bitmask || !v_sym</div>
<div class="line"><span class="lineno"> 8111</span>        || (r=1, ((-1+ n_bitmask) &amp; n_bitmask))  <span class="comment">// not a power of 2</span></div>
<div class="line"><span class="lineno"> 8112</span>        || (r=2, (8*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>) &lt;= gnu_shift))  <span class="comment">// shifted result always == 0</span></div>
<div class="line"><span class="lineno"> 8113</span>        || (r=3, (n_bucket&gt;&gt;30))  <span class="comment">// fie on fuzzers</span></div>
<div class="line"><span class="lineno"> 8114</span>        || (r=4, (n_bitmask&gt;&gt;30))</div>
<div class="line"><span class="lineno"> 8115</span>        || (r=5, ((<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))</div>
<div class="line"><span class="lineno"> 8116</span>                &lt;= ((<span class="keyword">sizeof</span>(*bitmask)/<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>))*n_bitmask + 2*n_bucket)))  <span class="comment">// FIXME: weak</span></div>
<div class="line"><span class="lineno"> 8117</span>        || (r=6, ((v_gsh &lt; v_sym) &amp;&amp; (v_sym - v_gsh) &lt; (<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)*4  <span class="comment">// headers</span></div>
<div class="line"><span class="lineno"> 8118</span>                + <span class="keyword">sizeof</span>(*bitmask)*n_bitmask  <span class="comment">// bitmask</span></div>
<div class="line"><span class="lineno"> 8119</span>                + <span class="keyword">sizeof</span>(*buckets)*n_bucket  <span class="comment">// buckets</span></div>
<div class="line"><span class="lineno"> 8120</span>                + <span class="keyword">sizeof</span>(*hasharr)*(!bmax ? 0 : (1+ bmax))  <span class="comment">// hasharr</span></div>
<div class="line"><span class="lineno"> 8121</span>            )) )</div>
<div class="line"><span class="lineno"> 8122</span>        ) {</div>
<div class="line"><span class="lineno"> 8123</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad DT_GNU_HASH n_bucket=%#x  n_bitmask=%#x  len=%#lx  r=%d&quot;</span>,</div>
<div class="line"><span class="lineno"> 8124</span>                n_bucket, n_bitmask, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)(v_sym - v_gsh), r);</div>
<div class="line"><span class="lineno"> 8125</span>        }</div>
<div class="line"><span class="lineno"> 8126</span>    }</div>
<div class="line"><span class="lineno"> 8127</span>    <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a>);  <span class="comment">// who omitted this?</span></div>
<div class="line"><span class="lineno"> 8128</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a></div>
<div class="line"><span class="lineno"> 8129</span>    &amp;&amp;  !(0==<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; 0==<a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>) ) {</div>
<div class="line"><span class="lineno"> 8130</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad .e_shstrndx %d &gt;= .e_shnum %d&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">e_shstrndx</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 8131</span>    }</div>
<div class="line"><span class="lineno"> 8132</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab5c99e9dc4cb9e94309dfb49b13ff09d"><div class="ttname"><a href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">PackLinuxElf64::elf_find_table_size</a></div><div class="ttdeci">unsigned elf_find_table_size(unsigned dt_type, unsigned sh_type)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07917">p_lx_elf.cpp:7917</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_acbc068ab20eb6f313fc0abbda76c62a4"><div class="ttname"><a href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">PackLinuxElf64::sort_DT64_offsets</a></div><div class="ttdeci">void sort_DT64_offsets(Elf64_Dyn const *const dynp0)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l07865">p_lx_elf.cpp:7865</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf.html#afcc48dc344bb8340e9691a43d45f8458">PackLinuxElf::e_shstrndx</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackLinuxElf64.html#ad626f92218bc4ac19501c91a513ae75c">gashend</a>, <a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf64.html#a1a367c1ee6e43cb116f980f9046a0fce">hashend</a>, <a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, <a class="el" href="classPackLinuxElf.html#a4c581148f2345d127c21f0ba5a33a656">PackLinuxElf::strtab_max</a>, <a class="el" href="classPackLinuxElf.html#a4cc33d310cb391da2166a1dd3857ee4d">PackLinuxElf::symnum_max</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph" id="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_cgraph">
<area shape="rect" title=" " alt="" coords="5,379,172,419"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="224,124,369,164"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="945,269,1075,294"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="421,408,612,448"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="703,345,832,370"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="951,841,1069,866"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="224,347,369,387"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="441,179,592,219"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="683,646,852,671"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="232,737,361,762"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="220,672,373,712"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="695,179,840,219"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="444,472,589,512"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="444,344,589,384"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="441,536,593,576"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="730,547,805,573"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="692,597,843,622"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="450,1039,583,1065"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="449,929,584,954"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="455,803,579,829"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="723,891,812,917"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="972,1062,1048,1087"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="725,990,809,1015"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="727,1194,808,1219"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="660,1039,875,1065"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1145,1067,1300,1093"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="935,1191,1085,1231"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="1147,1145,1298,1185"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="1147,1209,1298,1249"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="708,941,827,966"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="923,979,1097,1005"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1181,1005,1264,1030"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1153,955,1293,981"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1348,997,1499,1037"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1547,965,1697,1005"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1547,1029,1697,1069"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph" id="aclassPackLinuxElf64_a34544f047b9808c7416a3a3666a7d6bb_icgraph">
<area shape="rect" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="aa0c2c8ef98d3669846a7f666f6833698" name="aa0c2c8ef98d3669846a7f666f6833698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c2c8ef98d3669846a7f666f6833698">&#9670;&#160;</a></span>is_LOAD64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::is_LOAD64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdr</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00271">271</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  272</span>{</div>
<div class="line"><span class="lineno">  273</span>    <span class="comment">// (1+ PT_LOPROC) can confuse!</span></div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;p_type);</div>
<div class="line"><span class="lineno">  275</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, and <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_cgraph" id="aclassPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,45"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="192,13,321,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_icgraph" id="aclassPackLinuxElf64_aa0c2c8ef98d3669846a7f666f6833698_icgraph">
<area shape="rect" title=" " alt="" coords="457,27,596,67"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="228,5,409,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="247,55,391,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,63,180,88"/>
</map>
</div>

</div>
</div>
<a id="a39227a27d84b3a9beeef257f95b00215" name="a39227a27d84b3a9beeef257f95b00215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39227a27d84b3a9beeef257f95b00215">&#9670;&#160;</a></span>pack1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::pack1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#af01b0f8403997790f28a72329e7b28f6">PackLinuxElf</a>.</p>

<p>Reimplemented in <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle</a>, and <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l04740">4740</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4741</span>{</div>
<div class="line"><span class="lineno"> 4742</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4743</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>));</div>
<div class="line"><span class="lineno"> 4744</span>    assert(<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> == <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>));  <span class="comment">// checked by canPack()</span></div>
<div class="line"><span class="lineno"> 4745</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">e_phentsize</a>);</div>
<div class="line"><span class="lineno"> 4746</span> </div>
<div class="line"><span class="lineno"> 4747</span><span class="comment">// We compress separate pieces (usually each PT_LOAD, plus the gaps in the file</span></div>
<div class="line"><span class="lineno"> 4748</span><span class="comment">// that are not covered by any PT_LOAD), but currently at run time there can be</span></div>
<div class="line"><span class="lineno"> 4749</span><span class="comment">// only one decompressor method.</span></div>
<div class="line"><span class="lineno"> 4750</span><span class="comment">// Therefore we must plan ahead because Packer::compressWithFilters tries</span></div>
<div class="line"><span class="lineno"> 4751</span><span class="comment">// to find the smallest result among the available methods, for one piece only.</span></div>
<div class="line"><span class="lineno"> 4752</span><span class="comment">// In the future we may allow more than one decompression method at run time.</span></div>
<div class="line"><span class="lineno"> 4753</span><span class="comment">// For now we must choose only one, and force PackUnix::packExtent</span></div>
<div class="line"><span class="lineno"> 4754</span><span class="comment">// (==&gt; compressWithFilters) to use it.</span></div>
<div class="line"><span class="lineno"> 4755</span>    <span class="keywordtype">int</span> nfilters = 0;</div>
<div class="line"><span class="lineno"> 4756</span>    {</div>
<div class="line"><span class="lineno"> 4757</span>        <span class="keywordtype">int</span> <span class="keyword">const</span> *fp = <a class="code hl_function" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">getFilters</a>();</div>
<div class="line"><span class="lineno"> 4758</span>        <span class="keywordflow">while</span> (<a class="code hl_define" href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a> != *fp++) {</div>
<div class="line"><span class="lineno"> 4759</span>            ++nfilters;</div>
<div class="line"><span class="lineno"> 4760</span>        }</div>
<div class="line"><span class="lineno"> 4761</span>    }</div>
<div class="line"><span class="lineno"> 4762</span>    {</div>
<div class="line"><span class="lineno"> 4763</span>        <span class="keywordtype">int</span> npieces = 1;  <span class="comment">// tail after highest PT_LOAD</span></div>
<div class="line"><span class="lineno"> 4764</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 4765</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 4766</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 4767</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span>  flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>);</div>
<div class="line"><span class="lineno"> 4768</span>                <span class="keywordtype">unsigned</span>       offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4769</span>                <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 4770</span>                  <span class="comment">// new-style shlib: PT_LOAD[0] has symbol table</span></div>
<div class="line"><span class="lineno"> 4771</span>                  <span class="comment">// which must not be compressed, but also lacks PF_X</span></div>
<div class="line"><span class="lineno"> 4772</span>                ||    (Elf64_Phdr::PF_X &amp; flags)</div>
<div class="line"><span class="lineno"> 4773</span>                  <span class="comment">// Read-only, non-first PT_LOAD is _assumed_ to be compressible</span></div>
<div class="line"><span class="lineno"> 4774</span>                ||  (!(Elf64_Phdr::PF_W &amp; flags) &amp;&amp; 0!=offset))</div>
<div class="line"><span class="lineno"> 4775</span>                {</div>
<div class="line"><span class="lineno"> 4776</span>                    ++npieces;  <span class="comment">// will attempt compression of this PT_LOAD</span></div>
<div class="line"><span class="lineno"> 4777</span>                }</div>
<div class="line"><span class="lineno"> 4778</span>            }</div>
<div class="line"><span class="lineno"> 4779</span>        }</div>
<div class="line"><span class="lineno"> 4780</span>        uip-&gt;ui_total_passes += npieces;</div>
<div class="line"><span class="lineno"> 4781</span>    }</div>
<div class="line"><span class="lineno"> 4782</span>    <span class="keywordtype">int</span> methods[256];</div>
<div class="line"><span class="lineno"> 4783</span>    <span class="keywordtype">unsigned</span> nmethods = <a class="code hl_function" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">prepareMethods</a>(methods, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a>, <a class="code hl_function" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">getCompressionMethods</a>(<a class="code hl_define" href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">level</a>));</div>
<div class="line"><span class="lineno"> 4784</span>    <span class="keywordflow">if</span> (1 &lt; nmethods) { <span class="comment">// Many are available, but we must choose only one</span></div>
<div class="line"><span class="lineno"> 4785</span>        uip-&gt;ui_total_passes += 1;  <span class="comment">// the batch for output</span></div>
<div class="line"><span class="lineno"> 4786</span>        uip-&gt;ui_total_passes *= nmethods * (1+ nfilters);  <span class="comment">// finding smallest total</span></div>
<div class="line"><span class="lineno"> 4787</span>        <a class="code hl_struct" href="structPackHeader.html">PackHeader</a> orig_ph = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>;</div>
<div class="line"><span class="lineno"> 4788</span>        <a class="code hl_class" href="classFilter.html">Filter</a> orig_ft = ft;</div>
<div class="line"><span class="lineno"> 4789</span>        <span class="keywordtype">unsigned</span> max_offset = 0;</div>
<div class="line"><span class="lineno"> 4790</span>        <span class="keywordtype">unsigned</span> sz_best= ~0u;</div>
<div class="line"><span class="lineno"> 4791</span>        <span class="keywordtype">int</span> method_best = 0;</div>
<div class="line"><span class="lineno"> 4792</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; nmethods; ++k) { <span class="comment">// FIXME: parallelize; cost: working space</span></div>
<div class="line"><span class="lineno"> 4793</span>            <span class="keywordtype">unsigned</span> sz_this = 0;</div>
<div class="line"><span class="lineno"> 4794</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 4795</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 4796</span>                <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 4797</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span>  flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>);</div>
<div class="line"><span class="lineno"> 4798</span>                    <span class="keywordtype">unsigned</span>       offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4799</span>                    <span class="keywordtype">unsigned</span>       filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 4800</span>                    max_offset = <a class="code hl_define" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>(max_offset, filesz + offset);</div>
<div class="line"><span class="lineno"> 4801</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 4802</span>                      <span class="comment">// new-style shlib: PT_LOAD[0] has symbol table</span></div>
<div class="line"><span class="lineno"> 4803</span>                      <span class="comment">// which must not be compressed, but also lacks PF_X</span></div>
<div class="line"><span class="lineno"> 4804</span>                    ||    (Elf64_Phdr::PF_X &amp; flags)</div>
<div class="line"><span class="lineno"> 4805</span>                      <span class="comment">// Read-only, non-first PT_LOAD is _assumed_ to be compressible</span></div>
<div class="line"><span class="lineno"> 4806</span>                    ||  (!(Elf64_Phdr::PF_W &amp; flags) &amp;&amp; 0!=offset))</div>
<div class="line"><span class="lineno"> 4807</span>                    {</div>
<div class="line"><span class="lineno"> 4808</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &amp;&amp; 0==offset) { <span class="comment">// old-style shlib</span></div>
<div class="line"><span class="lineno"> 4809</span>                            offset  = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 4810</span>                            filesz -= <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 4811</span>                        }</div>
<div class="line"><span class="lineno"> 4812</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4813</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 4814</span>                        ft = orig_ft;</div>
<div class="line"><span class="lineno"> 4815</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 4816</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(methods[k]);</div>
<div class="line"><span class="lineno"> 4817</span>                        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = filesz;</div>
<div class="line"><span class="lineno"> 4818</span>                        <a class="code hl_function" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a>(&amp;ft, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>, <a class="code hl_define" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, 10, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4819</span>                        sz_this += <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>;</div>
<div class="line"><span class="lineno"> 4820</span>                    }</div>
<div class="line"><span class="lineno"> 4821</span>                }</div>
<div class="line"><span class="lineno"> 4822</span>            }</div>
<div class="line"><span class="lineno"> 4823</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_tail = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> - max_offset;  <span class="comment">// debuginfo, etc.</span></div>
<div class="line"><span class="lineno"> 4824</span>            <span class="keywordflow">if</span> (sz_tail) {</div>
<div class="line"><span class="lineno"> 4825</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(max_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4826</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sz_tail);</div>
<div class="line"><span class="lineno"> 4827</span>                ft = orig_ft;</div>
<div class="line"><span class="lineno"> 4828</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 4829</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(methods[k]);</div>
<div class="line"><span class="lineno"> 4830</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = sz_tail;</div>
<div class="line"><span class="lineno"> 4831</span>                <a class="code hl_function" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">compressWithFilters</a>(&amp;ft, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>, <a class="code hl_define" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, 10, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4832</span>                sz_this += <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>;</div>
<div class="line"><span class="lineno"> 4833</span>            }</div>
<div class="line"><span class="lineno"> 4834</span>            <span class="comment">// FIXME: loader size also depends on method</span></div>
<div class="line"><span class="lineno"> 4835</span>            <span class="keywordflow">if</span> (sz_best &gt; sz_this) {</div>
<div class="line"><span class="lineno"> 4836</span>                sz_best = sz_this;</div>
<div class="line"><span class="lineno"> 4837</span>                method_best = methods[k];</div>
<div class="line"><span class="lineno"> 4838</span>            }</div>
<div class="line"><span class="lineno"> 4839</span>        }</div>
<div class="line"><span class="lineno"> 4840</span>        ft = orig_ft;</div>
<div class="line"><span class="lineno"> 4841</span>        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a> = orig_ph;</div>
<div class="line"><span class="lineno"> 4842</span>        <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">method</a> = <a class="code hl_function" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a>(method_best);</div>
<div class="line"><span class="lineno"> 4843</span>    }</div>
<div class="line"><span class="lineno"> 4844</span> </div>
<div class="line"><span class="lineno"> 4845</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 4846</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 4847</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno"> 4848</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a4fc1f5c0094105f552b3b1604ea749d7">PT_GNU_STACK64</a> == type || <a class="code hl_define" href="p__lx__elf_8cpp.html#a9d1efbaf998aaa325cd289fb22c29f2c">PT_NOTE64</a> == type) {</div>
<div class="line"><span class="lineno"> 4849</span>            <a class="code hl_function" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx</a>(phdr);  <span class="comment">// PT_GNU_STACK64, PT_NOTE64</span></div>
<div class="line"><span class="lineno"> 4850</span>        }</div>
<div class="line"><span class="lineno"> 4851</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == type) {</div>
<div class="line"><span class="lineno"> 4852</span>            <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>) &gt;&gt; <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4853</span>            <span class="keywordflow">while</span> (x&gt;&gt;=1) {</div>
<div class="line"><span class="lineno"> 4854</span>                ++<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4855</span>            }</div>
<div class="line"><span class="lineno"> 4856</span>        }</div>
<div class="line"><span class="lineno"> 4857</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a4fc59c9f0258b54971a12f49f939d6cd">PT_GNU_RELRO64</a> == type</div>
<div class="line"><span class="lineno"> 4858</span>        &amp;&amp;  16 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>) {</div>
<div class="line"><span class="lineno"> 4859</span>            <span class="comment">// x86* allows 4K, 2M, 1G</span></div>
<div class="line"><span class="lineno"> 4860</span>            <span class="comment">// arm32 and arm64 both allow 4K, 16K, 64K; Apple Silicon uses 16K</span></div>
<div class="line"><span class="lineno"> 4861</span>            <span class="comment">// Oracle 5.4.17-2136.314.6.2.el8uek.aarch64 demands 64K</span></div>
<div class="line"><span class="lineno"> 4862</span>            <span class="comment">// PowerPC and PowerPC64 has 4K, 64K, 1M (?), 16M (?)</span></div>
<div class="line"><span class="lineno"> 4863</span>            <span class="comment">// MIPS  allows any power of 2 from 4K through 64K</span></div>
<div class="line"><span class="lineno"> 4864</span> </div>
<div class="line"><span class="lineno"> 4865</span>            <span class="comment">// If 64K &lt; .p_align then we assume that 4K is also accepted.</span></div>
<div class="line"><span class="lineno"> 4866</span>            <span class="comment">// .p_align can be like 2M, which is a huge over-estimate.</span></div>
<div class="line"><span class="lineno"> 4867</span>            <span class="comment">// RELRO ends on a page boundary: usually close to actual page_size</span></div>
<div class="line"><span class="lineno"> 4868</span>            <span class="keywordtype">unsigned</span> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 4869</span>            <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 4870</span>            <span class="keywordflow">if</span> (!(0xfff &amp; (filesz + offset))) { <span class="comment">// a 4KiB boundary</span></div>
<div class="line"><span class="lineno"> 4871</span>                <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a> = 12;</div>
<div class="line"><span class="lineno"> 4872</span>                <span class="keywordflow">while</span> (!(~(~0u &lt;&lt; <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>) &amp; (filesz + offset))) {</div>
<div class="line"><span class="lineno"> 4873</span>                    ++<a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 4874</span>                }</div>
<div class="line"><span class="lineno"> 4875</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a> = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>, -1+ <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>);</div>
<div class="line"><span class="lineno"> 4876</span>            }</div>
<div class="line"><span class="lineno"> 4877</span>        }</div>
<div class="line"><span class="lineno"> 4878</span>    }</div>
<div class="line"><span class="lineno"> 4879</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">page_size</a> =  1u  &lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4880</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a> = ~0ull&lt;&lt;<a class="code hl_variable" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">lg2_page</a>;</div>
<div class="line"><span class="lineno"> 4881</span> </div>
<div class="line"><span class="lineno"> 4882</span>    <a class="code hl_variable" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">progid</a> = 0;  <span class="comment">// getRandomId();  not useful, so do not clutter</span></div>
<div class="line"><span class="lineno"> 4883</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a>;</div>
<div class="line"><span class="lineno"> 4884</span> </div>
<div class="line"><span class="lineno"> 4885</span>    <span class="comment">// only execute if option present</span></div>
<div class="line"><span class="lineno"> 4886</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.preserve_build_id) {</div>
<div class="line"><span class="lineno"> 4887</span>        <span class="comment">// set this so we can use elf_find_section_name</span></div>
<div class="line"><span class="lineno"> 4888</span>        <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 4889</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>) {</div>
<div class="line"><span class="lineno"> 4890</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4891</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 4892</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 4893</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4894</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno"> 4895</span>        }</div>
<div class="line"><span class="lineno"> 4896</span>        <span class="comment">//set the shstrtab</span></div>
<div class="line"><span class="lineno"> 4897</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a>)];</div>
<div class="line"><span class="lineno"> 4898</span> </div>
<div class="line"><span class="lineno"> 4899</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 4900</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(sh_size); <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a> = (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 4901</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4902</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>-&gt;sh_offset,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4903</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">mb_shstrtab</a>, sh_size);</div>
<div class="line"><span class="lineno"> 4904</span> </div>
<div class="line"><span class="lineno"> 4905</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> <span class="keyword">const</span> *buildid = <a class="code hl_function" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name</a>(<span class="stringliteral">&quot;.note.gnu.build-id&quot;</span>);</div>
<div class="line"><span class="lineno"> 4906</span>        <span class="keywordflow">if</span> (buildid) {</div>
<div class="line"><span class="lineno"> 4907</span>            <span class="keywordtype">unsigned</span> bid_sh_size = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;buildid-&gt;sh_size);  <span class="comment">// UPX_RSIZE_MAX_MEM protects us</span></div>
<div class="line"><span class="lineno"> 4908</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(bid_sh_size);</div>
<div class="line"><span class="lineno"> 4909</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>.<a class="code hl_function" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">clear</a>();</div>
<div class="line"><span class="lineno"> 4910</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4911</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(buildid-&gt;sh_offset,<a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 4912</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>((<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>, bid_sh_size);</div>
<div class="line"><span class="lineno"> 4913</span> </div>
<div class="line"><span class="lineno"> 4914</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">o_elf_shnum</a> = 3;</div>
<div class="line"><span class="lineno"> 4915</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>,0,<span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>));</div>
<div class="line"><span class="lineno"> 4916</span> </div>
<div class="line"><span class="lineno"> 4917</span>            <span class="comment">//setup the build-id</span></div>
<div class="line"><span class="lineno"> 4918</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1], buildid, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1]));</div>
<div class="line"><span class="lineno"> 4919</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1].sh_name, 1);</div>
<div class="line"><span class="lineno"> 4920</span> </div>
<div class="line"><span class="lineno"> 4921</span>            <span class="comment">//setup the shstrtab</span></div>
<div class="line"><span class="lineno"> 4922</span>            <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2], <a class="code hl_variable" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2]));</div>
<div class="line"><span class="lineno"> 4923</span>            <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_name, 20);</div>
<div class="line"><span class="lineno"> 4924</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_size, 29); <span class="comment">//size of our static shstrtab; UPX_RSIZE_MAX_MEM</span></div>
<div class="line"><span class="lineno"> 4925</span>        }</div>
<div class="line"><span class="lineno"> 4926</span>    }</div>
<div class="line"><span class="lineno"> 4927</span>}</div>
<div class="ttc" id="aclassFilter_html"><div class="ttname"><a href="classFilter.html">Filter</a></div><div class="ttdoc">A filter is a reversible operation that modifies a given block of memory.</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00047">filter.h:47</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_a440e8db9c9010226d9778185f66529f5"><div class="ttname"><a href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc</a></div><div class="ttdeci">void alloc(upx_uint64_t bytes) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8cpp_source.html#l00170">membuffer.cpp:170</a></div></div>
<div class="ttc" id="aclassMemBuffer_html_acea3f3781a8c941186b5777f13691c8c"><div class="ttname"><a href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear</a></div><div class="ttdeci">forceinline void clear(unsigned off, unsigned len) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00212">membuffer.h:212</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a19a154b135064ce4e1a6e58ba23d9e50"><div class="ttname"><a href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">PackLinuxElf64::elf_find_section_name</a></div><div class="ttdeci">Elf64_Shdr const * elf_find_section_name(char const *) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02323">p_lx_elf.cpp:2323</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_aae6931a0bd5d2fca80befbd24a574c3e"><div class="ttname"><a href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">PackLinuxElf64::shdrout</a></div><div class="ttdeci">cprElfShdr3 shdrout</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00443">p_lx_elf.h:443</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_abd6eb82fa691109eb7fa267d6c8570f6"><div class="ttname"><a href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">PackLinuxElf64::add_phdrx</a></div><div class="ttdeci">void add_phdrx(Elf64_Phdr const *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01013">p_lx_elf.cpp:1013</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a4036b37656b78e0053108ad8f9a17ef8"><div class="ttname"><a href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a></div><div class="ttdeci">MemBuffer buildid_data</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00126">p_lx_elf.h:126</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a55541b4f9e0f8f1fe16cb785b093ab1c"><div class="ttname"><a href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a></div><div class="ttdeci">MemBuffer mb_shdr</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00084">p_lx_elf.h:84</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a622b799334a48cb6634e790f2566248a"><div class="ttname"><a href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">PackLinuxElf::getCompressionMethods</a></div><div class="ttdeci">virtual const int * getCompressionMethods(int method, int level) const override</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01133">p_lx_elf.cpp:1133</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a76c2a145b6739ad4cd1035af406a821a"><div class="ttname"><a href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">PackLinuxElf::mb_shstrtab</a></div><div class="ttdeci">MemBuffer mb_shstrtab</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00123">p_lx_elf.h:123</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ab3ca408b94c072437e9e96a3b4e3ab1f"><div class="ttname"><a href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a></div><div class="ttdeci">unsigned sz_phdrs</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00091">p_lx_elf.h:91</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73"><div class="ttname"><a href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a></div><div class="ttdeci">@ OVERHEAD</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00135">p_unix.h:135</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a4e6db1e979cfd371114262e2887980ee"><div class="ttname"><a href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">PackUnix::progid</a></div><div class="ttdeci">unsigned progid</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00095">p_unix.h:95</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a6bbbfbba5b4b2b33de9d7801bd58b2cb"><div class="ttname"><a href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">PackUnix::getFilters</a></div><div class="ttdeci">virtual const int * getFilters() const override</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00052">p_unix.h:52</a></div></div>
<div class="ttc" id="aclassPacker_html_a476d801b02376434abccfd4b84e057fe"><div class="ttname"><a href="classPacker.html#a476d801b02376434abccfd4b84e057fe">Packer::prepareMethods</a></div><div class="ttdeci">int prepareMethods(int *methods, int ph_method, const int *all_methods) const</div><div class="ttdoc">void Packer::compressWithFilters(): Try compression with several methods and filters,...</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00907">packer.cpp:907</a></div></div>
<div class="ttc" id="aclassPacker_html_ad0ae5b698e68d64585e5be87a256f675"><div class="ttname"><a href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters</a></div><div class="ttdeci">void compressWithFilters(Filter *ft, const unsigned overlap_range, const upx_compress_config_t *cconf, int filter_strategy=0, bool inhibit_compression_check=false)</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l01210">packer.cpp:1210</a></div></div>
<div class="ttc" id="aconf_8h_html_a273ac851b4231e7ae380d36191040548"><div class="ttname"><a href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a></div><div class="ttdeci">#define M_ALL</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00604">conf.h:604</a></div></div>
<div class="ttc" id="aconf_8h_html_a28c3ab53e0d5633976245bf127fe9a40"><div class="ttname"><a href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a></div><div class="ttdeci">#define NULL_cconf</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00720">conf.h:720</a></div></div>
<div class="ttc" id="aconf_8h_html_a75519eeb326c3b15b3059db3f3098881"><div class="ttname"><a href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a></div><div class="ttdeci">#define FT_END</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00620">conf.h:620</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4fc1f5c0094105f552b3b1604ea749d7"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4fc1f5c0094105f552b3b1604ea749d7">PT_GNU_STACK64</a></div><div class="ttdeci">#define PT_GNU_STACK64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00058">p_lx_elf.cpp:58</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4fc59c9f0258b54971a12f49f939d6cd"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4fc59c9f0258b54971a12f49f939d6cd">PT_GNU_RELRO64</a></div><div class="ttdeci">#define PT_GNU_RELRO64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00060">p_lx_elf.cpp:60</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a9d1efbaf998aaa325cd289fb22c29f2c"><div class="ttname"><a href="p__lx__elf_8cpp.html#a9d1efbaf998aaa325cd289fb22c29f2c">PT_NOTE64</a></div><div class="ttdeci">#define PT_NOTE64</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00056">p_lx_elf.cpp:56</a></div></div>
<div class="ttc" id="apackhead_8cpp_html_ae33d5198af6a4110c9533bb4fdccffe6"><div class="ttname"><a href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method</a></div><div class="ttdeci">int ph_force_method(int method) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00295">packhead.cpp:295</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a317679f1ef5e41e0717e95670c6a1d24"><div class="ttname"><a href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a></div><div class="ttdeci">Elf64_Half e_shnum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00219">bsd.h:219</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_ab5aefb7a14b9cf2eafcbaf0664852369"><div class="ttname"><a href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a></div><div class="ttdeci">Elf64_Half e_phentsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00216">bsd.h:216</a></div></div>
<div class="ttc" id="astructPackHeader_html"><div class="ttname"><a href="structPackHeader.html">PackHeader</a></div><div class="ttdoc">PackHeader also see stub/src/include/header.S.</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00037">packhead.h:37</a></div></div>
<div class="ttc" id="astructPackHeader_html_a1115672eeb2a2bb05760ce5c7fc0b5cf"><div class="ttname"><a href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a></div><div class="ttdeci">unsigned u_len</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00054">packhead.h:54</a></div></div>
<div class="ttc" id="astructPackHeader_html_a19b4cdc8a27935b591bcb85cb5ec3e9d"><div class="ttname"><a href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">PackHeader::level</a></div><div class="ttdeci">int level</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00053">packhead.h:53</a></div></div>
<div class="ttc" id="astructPackHeader_html_a448fca0da6280454a321894c7eb29e79"><div class="ttname"><a href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a></div><div class="ttdeci">unsigned c_len</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00055">packhead.h:55</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear()</a>, <a class="el" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675">Packer::compressWithFilters()</a>, <a class="el" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="conf_8h.html#a75519eeb326c3b15b3059db3f3098881">FT_END</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a">PackLinuxElf::getCompressionMethods()</a>, <a class="el" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb">PackUnix::getFilters()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="structPackHeader.html#a19b4cdc8a27935b591bcb85cb5ec3e9d">PackHeader::level</a>, <a class="el" href="classPackLinuxElf.html#a8cd64335916d77771c6dd2f5b71e9a77">PackLinuxElf::lg2_page</a>, <a class="el" href="conf_8h.html#a273ac851b4231e7ae380d36191040548">M_ALL</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="classPackLinuxElf.html#a76c2a145b6739ad4cd1035af406a821a">PackLinuxElf::mb_shstrtab</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structPackHeader.html#af1d11217d186dee6524ad3ab35768b0a">PackHeader::method</a>, <a class="el" href="conf_8h.html#a28c3ab53e0d5633976245bf127fe9a40">NULL_cconf</a>, <a class="el" href="classPackLinuxElf.html#a1a02a5314fbdff34469cfa4b59ddde10">PackLinuxElf::o_elf_shnum</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>, <a class="el" href="classPackLinuxElf.html#a80989e5fdaa51b0650d6f5d66eaf3766">PackLinuxElf::page_size</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6">ph_force_method()</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPacker.html#a476d801b02376434abccfd4b84e057fe">Packer::prepareMethods()</a>, <a class="el" href="classPackUnix.html#a4e6db1e979cfd371114262e2887980ee">PackUnix::progid</a>, <a class="el" href="p__lx__elf_8cpp.html#a4fc59c9f0258b54971a12f49f939d6cd">PT_GNU_RELRO64</a>, <a class="el" href="p__lx__elf_8cpp.html#a4fc1f5c0094105f552b3b1604ea749d7">PT_GNU_STACK64</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="p__lx__elf_8cpp.html#a9d1efbaf998aaa325cd289fb22c29f2c">PT_NOTE64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf64.html#af723e5e6c9919f309a40134658df5a4d">sec_strndx</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="conf_8h.html#aafadbc56bd61f1a892099d70ff71b6e4">UPX_MAX</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph" id="aclassPackLinuxElf64_a39227a27d84b3a9beeef257f95b00215_cgraph">
<area shape="rect" title=" " alt="" coords="5,755,172,781"/>
<area shape="rect" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6" title=" " alt="" coords="1027,421,1179,461"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="532,246,665,271"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="829,321,905,346"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="261,358,396,383"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="226,483,431,509"/>
<area shape="rect" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50" title=" " alt="" coords="253,533,404,573"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="534,610,663,635"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="264,649,393,674"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="264,698,393,723"/>
<area shape="rect" href="classPackLinuxElf.html#a622b799334a48cb6634e790f2566248a" title=" " alt="" coords="220,748,437,788"/>
<area shape="rect" href="classPackUnix.html#a6bbbfbba5b4b2b33de9d7801bd58b2cb" title=" " alt="" coords="253,813,404,838"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="244,862,413,887"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="289,935,368,961"/>
<area shape="rect" href="packhead_8cpp.html#ae33d5198af6a4110c9533bb4fdccffe6" title=" " alt="" coords="261,985,396,1010"/>
<area shape="rect" href="classPacker.html#a476d801b02376434abccfd4b84e057fe" title="void Packer::compressWithFilters(): Try compression with several methods and filters,..." alt="" coords="509,750,688,775"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="267,1135,390,1161"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="270,1086,387,1111"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="265,1185,393,1210"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="265,1234,393,1259"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1248,486,1367,511"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1059,886,1148,911"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="825,579,909,605"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="827,45,908,70"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="760,146,975,171"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="1026,123,1181,149"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1028,37,1179,77"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="1232,5,1383,45"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="1232,69,1383,109"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="539,358,658,383"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="780,195,955,221"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="1062,195,1145,221"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1033,835,1173,861"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1232,188,1383,228"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1431,188,1581,228"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="565,561,632,586"/>
<area shape="rect" href="classPacker.html#ac91d266e1612ca6108035e22fe8b1203" title=" " alt="" coords="485,685,712,725"/>
<area shape="rect" href="classPacker.html#a4a969f788c3bad61abe0eec73fca0f0c" title="compression method util" alt="" coords="767,721,967,761"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="796,786,939,811"/>
<area shape="rect" href="util_8cpp.html#aa6941e20228b3e1dc459a36773b99633" title=" " alt="" coords="826,671,909,697"/>
<area shape="rect" href="packhead_8cpp.html#a99fd3f5cbc734f9863205a1e892ea48c" title="ph method util" alt="" coords="1023,786,1184,811"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="541,1135,656,1161"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="524,1086,673,1111"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="802,986,933,1011"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="823,1161,912,1186"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="799,1035,936,1061"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1024,1045,1183,1085"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="541,961,657,986"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="839,937,896,962"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="799,887,935,913"/>
</map>
</div>

</div>
</div>
<a id="ae4c3d3d66cd14ea19fc44d0f90274092" name="ae4c3d3d66cd14ea19fc44d0f90274092"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4c3d3d66cd14ea19fc44d0f90274092">&#9670;&#160;</a></span>pack2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int PackLinuxElf64::pack2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a619d0ed2f97d37150ed5b1437c67b6f1">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l05248">5248</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5249</span>{</div>
<div class="line"><span class="lineno"> 5250</span>    Extent x;</div>
<div class="line"><span class="lineno"> 5251</span>    <span class="keywordtype">unsigned</span> k;</div>
<div class="line"><span class="lineno"> 5252</span>    <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = (!!<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.android_shlib) &lt;&lt; 1;  <span class="comment">// bit 1; see is_shlib</span></div>
<div class="line"><span class="lineno"> 5253</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> is_shlib = (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) | <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>;</div>
<div class="line"><span class="lineno"> 5254</span>    <span class="keywordtype">unsigned</span> pre_xct_top = 0;  <span class="comment">// offset of end of PT_LOAD _before_ xct_off</span></div>
<div class="line"><span class="lineno"> 5255</span> </div>
<div class="line"><span class="lineno"> 5256</span>    <span class="comment">// count passes, set ptload vars</span></div>
<div class="line"><span class="lineno"> 5257</span>    uip-&gt;ui_total_passes = 0;</div>
<div class="line"><span class="lineno"> 5258</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno"> 5259</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_type)) {</div>
<div class="line"><span class="lineno"> 5260</span>            <span class="keywordflow">if</span> (!is_shlib) {</div>
<div class="line"><span class="lineno"> 5261</span>                uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5262</span>            }</div>
<div class="line"><span class="lineno"> 5263</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5264</span>                <span class="keywordtype">unsigned</span> p_flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_flags);</div>
<div class="line"><span class="lineno"> 5265</span>                <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_offset);</div>
<div class="line"><span class="lineno"> 5266</span>                <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5267</span>                <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset) &lt; p_filesz) { <span class="comment">// PT_LOAD covers xct_off</span></div>
<div class="line"><span class="lineno"> 5268</span>                    <span class="keywordflow">if</span> (!pre_xct_top &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> != p_offset) {</div>
<div class="line"><span class="lineno"> 5269</span>                        pre_xct_top = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5270</span>                    }</div>
<div class="line"><span class="lineno"> 5271</span>                }</div>
<div class="line"><span class="lineno"> 5272</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p_offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// candidate for pre_xct_top</span></div>
<div class="line"><span class="lineno"> 5273</span>                    <span class="keywordtype">unsigned</span> top = p_filesz + p_offset;</div>
<div class="line"><span class="lineno"> 5274</span>                    <span class="keywordflow">if</span> (pre_xct_top &lt; top) {</div>
<div class="line"><span class="lineno"> 5275</span>                        pre_xct_top = top;</div>
<div class="line"><span class="lineno"> 5276</span>                    }</div>
<div class="line"><span class="lineno"> 5277</span>                }</div>
<div class="line"><span class="lineno"> 5278</span>                <span class="keywordflow">if</span> (Elf64_Phdr::PF_W &amp; p_flags) {</div>
<div class="line"><span class="lineno"> 5279</span>                    <span class="comment">// rtld might write, so cannot compress</span></div>
<div class="line"><span class="lineno"> 5280</span>                }</div>
<div class="line"><span class="lineno"> 5281</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5282</span>                    <span class="comment">// First PT_LOAD (partial) only if has instructions</span></div>
<div class="line"><span class="lineno"> 5283</span>                    <span class="keywordflow">if</span> (k || <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; p_filesz) {</div>
<div class="line"><span class="lineno"> 5284</span>                        uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5285</span>                    }</div>
<div class="line"><span class="lineno"> 5286</span>                }</div>
<div class="line"><span class="lineno"> 5287</span>            }</div>
<div class="line"><span class="lineno"> 5288</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>)) {</div>
<div class="line"><span class="lineno"> 5289</span>                uip-&gt;ui_total_passes++;</div>
<div class="line"><span class="lineno"> 5290</span>            }</div>
<div class="line"><span class="lineno"> 5291</span>        }</div>
<div class="line"><span class="lineno"> 5292</span>    }</div>
<div class="line"><span class="lineno"> 5293</span> </div>
<div class="line"><span class="lineno"> 5294</span>    <span class="comment">// compress extents</span></div>
<div class="line"><span class="lineno"> 5295</span>    <span class="keywordtype">unsigned</span> hdr_u_len = <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a>;</div>
<div class="line"><span class="lineno"> 5296</span> </div>
<div class="line"><span class="lineno"> 5297</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> =  0;</div>
<div class="line"><span class="lineno"> 5298</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = 0;</div>
<div class="line"><span class="lineno"> 5299</span>    uip-&gt;ui_pass = 0;</div>
<div class="line"><span class="lineno"> 5300</span>    ft.<a class="code hl_variable" href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">addvalue</a> = 0;</div>
<div class="line"><span class="lineno"> 5301</span> </div>
<div class="line"><span class="lineno"> 5302</span>    <span class="keywordflow">if</span> (is_shlib) { <span class="comment">// prepare to alter Phdrs and Shdrs</span></div>
<div class="line"><span class="lineno"> 5303</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_function" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> + (!<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a></div>
<div class="line"><span class="lineno"> 5304</span>            ? 0</div>
<div class="line"><span class="lineno"> 5305</span>            : <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>))));</div>
<div class="line"><span class="lineno"> 5306</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// android omits Shdr here</span></div>
<div class="line"><span class="lineno"> 5307</span>    }</div>
<div class="line"><span class="lineno"> 5308</span>    <span class="keywordtype">unsigned</span> nk_f = 0; <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> xsz_f = 0;</div>
<div class="line"><span class="lineno"> 5309</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k)</div>
<div class="line"><span class="lineno"> 5310</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_type)</div>
<div class="line"><span class="lineno"> 5311</span>    &amp;&amp;  Elf64_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_flags)) {</div>
<div class="line"><span class="lineno"> 5312</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> xsz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno"> 5313</span>        <span class="keywordflow">if</span> (xsz_f &lt; xsz) {</div>
<div class="line"><span class="lineno"> 5314</span>            xsz_f = xsz;</div>
<div class="line"><span class="lineno"> 5315</span>            nk_f = k;</div>
<div class="line"><span class="lineno"> 5316</span>        }</div>
<div class="line"><span class="lineno"> 5317</span>    }</div>
<div class="line"><span class="lineno"> 5318</span>    <span class="keywordtype">int</span> nx = 0;</div>
<div class="line"><span class="lineno"> 5319</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k)</div>
<div class="line"><span class="lineno"> 5320</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_type)) {</div>
<div class="line"><span class="lineno"> 5321</span>        <span class="keywordflow">if</span> (ft.<a class="code hl_variable" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">id</a> &lt; 0x40) {</div>
<div class="line"><span class="lineno"> 5322</span>            <span class="comment">// FIXME: ??    ft.addvalue = phdri[k].p_vaddr;</span></div>
<div class="line"><span class="lineno"> 5323</span>        }</div>
<div class="line"><span class="lineno"> 5324</span>        <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_offset);  <span class="comment">// UPX_RSIZE_MAX_MEM</span></div>
<div class="line"><span class="lineno"> 5325</span>        <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);  <span class="comment">// UPX_RSIZE_MAX_MEM</span></div>
<div class="line"><span class="lineno"> 5326</span>        x.offset = p_offset;</div>
<div class="line"><span class="lineno"> 5327</span>        x.size   = p_filesz;</div>
<div class="line"><span class="lineno"> 5328</span>        <span class="keywordflow">if</span> (is_shlib) {</div>
<div class="line"><span class="lineno"> 5329</span>            <span class="keywordflow">if</span> (x.offset &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// perhaps compressible: PT_LOAD[0] or PT_LOAD[1]</span></div>
<div class="line"><span class="lineno"> 5330</span>                <span class="comment">// Bytes below xct_off belong to rtld, so must be literal.</span></div>
<div class="line"><span class="lineno"> 5331</span>                <span class="comment">// Note that asl_pack2_Shdrs() copies up to xct_off, then adds extra info</span></div>
<div class="line"><span class="lineno"> 5332</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) { <span class="comment">// Copy up to xct_off, then add 2nd copy of Shdrs</span></div>
<div class="line"><span class="lineno"> 5333</span>                    <a class="code hl_function" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs</a>(fo, pre_xct_top);</div>
<div class="line"><span class="lineno"> 5334</span>                }</div>
<div class="line"><span class="lineno"> 5335</span>                <span class="keywordflow">else</span> { <span class="comment">// Just copy up to xct_off</span></div>
<div class="line"><span class="lineno"> 5336</span>                    x.size = <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(uintmax_t(x.size), uintmax_t(0ull + <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - x.offset));</div>
<div class="line"><span class="lineno"> 5337</span>                    <span class="keywordflow">if</span> (0) { <span class="comment">// DEBUG paranoia</span></div>
<div class="line"><span class="lineno"> 5338</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(x.offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5339</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, x.size);</div>
<div class="line"><span class="lineno"> 5340</span>                        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5341</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *fip = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 5342</span>                        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> *ibp = (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 5343</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; x.size&gt;&gt;2; ++j) {</div>
<div class="line"><span class="lineno"> 5344</span>                            <span class="keywordflow">if</span> (fip[j] != ibp[j]) {</div>
<div class="line"><span class="lineno"> 5345</span>                                printf(<span class="stringliteral">&quot;[%#x]: file_image %#x  ibuf %#x\n&quot;</span>, j, fip[j], ibp[j]);</div>
<div class="line"><span class="lineno"> 5346</span>                            }</div>
<div class="line"><span class="lineno"> 5347</span>                        }</div>
<div class="line"><span class="lineno"> 5348</span>                    }</div>
<div class="line"><span class="lineno"> 5349</span> </div>
<div class="line"><span class="lineno"> 5350</span>                    <span class="comment">// FIXME: adler2 ?</span></div>
<div class="line"><span class="lineno"> 5351</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(x.offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5352</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[x.offset], x.size);</div>
<div class="line"><span class="lineno"> 5353</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += x.size;</div>
<div class="line"><span class="lineno"> 5354</span>                    <span class="comment">// Keep the input side in sync</span></div>
<div class="line"><span class="lineno"> 5355</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>  += x.size;</div>
<div class="line"><span class="lineno"> 5356</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(x.size + x.offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 5357</span>                }</div>
<div class="line"><span class="lineno"> 5358</span>                <span class="keywordflow">if</span> (hdr_u_len) { <span class="comment">// first time</span></div>
<div class="line"><span class="lineno"> 5359</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 5360</span> </div>
<div class="line"><span class="lineno"> 5361</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#abf70c0a5d8293e74153673a988cd61a4">l_checksum</a> = 0;  <span class="comment">// preliminary</span></div>
<div class="line"><span class="lineno"> 5362</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a> = <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>;</div>
<div class="line"><span class="lineno"> 5363</span>                    <a class="code hl_function" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1">set_le16</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_lsize</a>, <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);  <span class="comment">// preliminary (0)</span></div>
<div class="line"><span class="lineno"> 5364</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#a5dce623f92874cf890dc2f1d89f7c722">l_version</a> = (<span class="keywordtype">unsigned</span> char)<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">version</a>;</div>
<div class="line"><span class="lineno"> 5365</span>                    <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#a86eb402570f0f7c31f1ffcf001f4e0b7">l_format</a> =  (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">format</a>;</div>
<div class="line"><span class="lineno"> 5366</span>                    <a class="code hl_variable" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 5367</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 5368</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 5369</span> </div>
<div class="line"><span class="lineno"> 5370</span>                    <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 5371</span> </div>
<div class="line"><span class="lineno"> 5372</span>                    <a class="code hl_struct" href="structp__info.html">p_info</a> hbuf;</div>
<div class="line"><span class="lineno"> 5373</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a673ef061863e733588f4b12a7938d009">p_progid</a>, 0);</div>
<div class="line"><span class="lineno"> 5374</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_filesize</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 5375</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_blocksize</a>, <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>);</div>
<div class="line"><span class="lineno"> 5376</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;hbuf, <span class="keyword">sizeof</span>(hbuf));</div>
<div class="line"><span class="lineno"> 5377</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <span class="keyword">sizeof</span>(hbuf);</div>
<div class="line"><span class="lineno"> 5378</span> </div>
<div class="line"><span class="lineno"> 5379</span>                    x.offset = 0;  <span class="comment">// save for decompress to restore original Elf headers</span></div>
<div class="line"><span class="lineno"> 5380</span>                    x.size = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5381</span>                    <span class="keywordtype">unsigned</span> in_size = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5382</span>                    <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, <span class="keyword">nullptr</span>, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5383</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> -= in_size;</div>
<div class="line"><span class="lineno"> 5384</span> </div>
<div class="line"><span class="lineno"> 5385</span>                    x.offset = p_offset + hdr_u_len;</div>
<div class="line"><span class="lineno"> 5386</span>                    x.size   = p_filesz - hdr_u_len;</div>
<div class="line"><span class="lineno"> 5387</span> </div>
<div class="line"><span class="lineno"> 5388</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = k + (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5389</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>, Elf64_Phdr::PF_X | <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>));</div>
<div class="line"><span class="lineno"> 5390</span>                    hdr_u_len = 0;  <span class="comment">// no longer the first time</span></div>
<div class="line"><span class="lineno"> 5391</span>                }</div>
<div class="line"><span class="lineno"> 5392</span>                <span class="comment">// The remainder above xct_off in first compressible PT_LOAD</span></div>
<div class="line"><span class="lineno"> 5393</span>                <span class="keywordflow">if</span> (         p_filesz &gt;= (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset)) {</div>
<div class="line"><span class="lineno"> 5394</span>                    x.size = p_filesz -  (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - p_offset);</div>
<div class="line"><span class="lineno"> 5395</span>                    x.offset = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 5396</span>                    <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5397</span>                }</div>
<div class="line"><span class="lineno"> 5398</span>            }</div>
<div class="line"><span class="lineno"> 5399</span>            <span class="keywordflow">else</span> { <span class="comment">// definitely compressible unless writeable</span></div>
<div class="line"><span class="lineno"> 5400</span>                <span class="keywordflow">if</span> (!(Elf64_Phdr::PF_W &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_flags))) {</div>
<div class="line"><span class="lineno"> 5401</span>                    <span class="comment">// Read-only PT_LOAD, assume not written by relocations.</span></div>
<div class="line"><span class="lineno"> 5402</span>                    <span class="comment">// Also assume not the source for R_*_COPY relocation,</span></div>
<div class="line"><span class="lineno"> 5403</span>                    <span class="comment">// therefore compress it.</span></div>
<div class="line"><span class="lineno"> 5404</span>                    <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, &amp;ft, fo, 0, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5405</span>                    <span class="comment">// De-compressing will re-create it, but otherwise ignore it.</span></div>
<div class="line"><span class="lineno"> 5406</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdro = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>[0]);</div>
<div class="line"><span class="lineno"> 5407</span>                    <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdro[k].p_type, Elf64_Phdr::PT_NULL);</div>
<div class="line"><span class="lineno"> 5408</span>                }</div>
<div class="line"><span class="lineno"> 5409</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5410</span>                    <span class="comment">// Read-write PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 5411</span>                    <span class="comment">// rtld might relocate, so we cannot compress.</span></div>
<div class="line"><span class="lineno"> 5412</span>                    <span class="comment">// (Could compress if not relocated; complicates run-time.)</span></div>
<div class="line"><span class="lineno"> 5413</span>                    <span class="comment">// Postpone writing until &quot;slide&quot;, but account for its size.</span></div>
<div class="line"><span class="lineno"> 5414</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> +=  x.size;</div>
<div class="line"><span class="lineno"> 5415</span>                }</div>
<div class="line"><span class="lineno"> 5416</span>            }</div>
<div class="line"><span class="lineno"> 5417</span>        }</div>
<div class="line"><span class="lineno"> 5418</span>        <span class="keywordflow">else</span>  <span class="comment">// main program, not shared library</span></div>
<div class="line"><span class="lineno"> 5419</span>        <span class="keywordflow">if</span> (hdr_u_len &lt;= (<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)x.size) {</div>
<div class="line"><span class="lineno"> 5420</span>            <span class="keywordflow">if</span> (0 == nx) { <span class="comment">// 1st PT_LOAD64 must cover Ehdr at 0==p_offset</span></div>
<div class="line"><span class="lineno"> 5421</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> delta = hdr_u_len;</div>
<div class="line"><span class="lineno"> 5422</span>                <span class="keywordflow">if</span> (ft.<a class="code hl_variable" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">id</a> &lt; 0x40) {</div>
<div class="line"><span class="lineno"> 5423</span>                    <span class="comment">// FIXME: ??     ft.addvalue += asl_delta;</span></div>
<div class="line"><span class="lineno"> 5424</span>                }</div>
<div class="line"><span class="lineno"> 5425</span>                <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)delta == x.size) { <span class="comment">// PT_LOAD[0] with ElfXX.Ehdr only</span></div>
<div class="line"><span class="lineno"> 5426</span>                    <span class="comment">// QBE backend - http://c9x.me/compile/</span></div>
<div class="line"><span class="lineno"> 5427</span>                    hdr_u_len = 0;  <span class="comment">// no fiddling necessary!</span></div>
<div class="line"><span class="lineno"> 5428</span>                    <span class="comment">// &amp;ft arg to packExtent will be zero because (k != nk_f)</span></div>
<div class="line"><span class="lineno"> 5429</span>                }</div>
<div class="line"><span class="lineno"> 5430</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5431</span>                    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += delta - hdr_u_len;</div>
<div class="line"><span class="lineno"> 5432</span>                    x.offset += delta;</div>
<div class="line"><span class="lineno"> 5433</span>                    x.size   -= delta;</div>
<div class="line"><span class="lineno"> 5434</span>                }</div>
<div class="line"><span class="lineno"> 5435</span>            }</div>
<div class="line"><span class="lineno"> 5436</span>            <span class="comment">// compressWithFilters() always assumes a &quot;loader&quot;, so would</span></div>
<div class="line"><span class="lineno"> 5437</span>            <span class="comment">// throw NotCompressible for small .data Extents, which PowerPC</span></div>
<div class="line"><span class="lineno"> 5438</span>            <span class="comment">// sometimes marks as PF_X anyway.  So filter only first segment.</span></div>
<div class="line"><span class="lineno"> 5439</span>            <span class="keywordflow">if</span> (k == nk_f || !is_shlib) {</div>
<div class="line"><span class="lineno"> 5440</span>                <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x,</div>
<div class="line"><span class="lineno"> 5441</span>                    (k==nk_f ? &amp;ft : <span class="keyword">nullptr</span> ), fo, hdr_u_len, 0, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5442</span>            }</div>
<div class="line"><span class="lineno"> 5443</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5444</span>                <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5445</span>            }</div>
<div class="line"><span class="lineno"> 5446</span>            hdr_u_len = 0;</div>
<div class="line"><span class="lineno"> 5447</span>        }</div>
<div class="line"><span class="lineno"> 5448</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5449</span>                <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += x.size;</div>
<div class="line"><span class="lineno"> 5450</span>        }</div>
<div class="line"><span class="lineno"> 5451</span>        ++nx;</div>
<div class="line"><span class="lineno"> 5452</span>    }</div>
<div class="line"><span class="lineno"> 5453</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">sz_pack2a</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);  <span class="comment">// MATCH01</span></div>
<div class="line"><span class="lineno"> 5454</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 5455</span> </div>
<div class="line"><span class="lineno"> 5456</span>    <span class="comment">// Accounting only; ::pack3 will do the compression and output</span></div>
<div class="line"><span class="lineno"> 5457</span>    <span class="keywordflow">for</span> (k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno"> 5458</span>        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += <a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 5459</span>    }</div>
<div class="line"><span class="lineno"> 5460</span> </div>
<div class="line"><span class="lineno"> 5461</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> != (<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>)</div>
<div class="line"><span class="lineno"> 5462</span>        <a class="code hl_function" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a>();</div>
<div class="line"><span class="lineno"> 5463</span> </div>
<div class="line"><span class="lineno"> 5464</span>    <span class="keywordflow">return</span> 0;  <span class="comment">// omit end-of-compression bhdr for now</span></div>
<div class="line"><span class="lineno"> 5465</span>}</div>
<div class="ttc" id="abele_8h_html_ad88deaac7f8abe77334fa9f1efc73fa1"><div class="ttname"><a href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1">set_le16</a></div><div class="ttdeci">REQUIRE_XE16 bele_constexpr void set_le16(XE16 *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00344">bele.h:344</a></div></div>
<div class="ttc" id="aclassFilter_html_a2f300af4994c93ee536e9002b315b1ea"><div class="ttname"><a href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">Filter::addvalue</a></div><div class="ttdeci">unsigned addvalue</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00071">filter.h:71</a></div></div>
<div class="ttc" id="aclassFilter_html_aac773bd22bdb2ba33014b5d58405d19f"><div class="ttname"><a href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">Filter::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> <a href="filter_8h_source.html#l00086">filter.h:86</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6c77e1df704fbb16e2d048937bdb0663"><div class="ttname"><a href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">PackLinuxElf64::find_LOAD_gap</a></div><div class="ttdeci">virtual unsigned find_LOAD_gap(Elf64_Phdr const *const phdri, unsigned const k, unsigned const e_phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05212">p_lx_elf.cpp:5212</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a6eefcbb2a42d861b12d2c309d93771b8"><div class="ttname"><a href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">PackLinuxElf64::asl_pack2_Shdrs</a></div><div class="ttdeci">virtual void asl_pack2_Shdrs(OutputFile *, unsigned pre_xct_top)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l04173">p_lx_elf.cpp:4173</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a888f94bd6a90f535ea5567e3f8b39ccc"><div class="ttname"><a href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a></div><div class="ttdeci">unsigned linfo_off</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00110">p_lx_elf.h:110</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ae86e3eeb56091063ef73bbcab2c1262a"><div class="ttname"><a href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">PackLinuxElf::sz_pack2a</a></div><div class="ttdeci">unsigned sz_pack2a</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00094">p_lx_elf.h:94</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_af8b16212a7cce313d106777dc6c198af"><div class="ttname"><a href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a></div><div class="ttdeci">unsigned is_asl</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00098">p_lx_elf.h:98</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a8a994baf32174356ff73af67ad5d15ba"><div class="ttname"><a href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a></div><div class="ttdeci">struct l_info linfo</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00132">p_unix.h:132</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a914345298d86f797a6c960ca80afdeb7"><div class="ttname"><a href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a></div><div class="ttdeci">int lsize</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00099">p_unix.h:99</a></div></div>
<div class="ttc" id="aclassPackUnix_html_ad3f398fa4a3b34fd79f441e3069f78b1"><div class="ttname"><a href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent</a></div><div class="ttdeci">virtual void packExtent(const Extent &amp;x, Filter *, OutputFile *, unsigned hdr_len=0, unsigned b_extra=0, bool inhibit_compression_check=false)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00331">p_unix.cpp:331</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_ab8961782cfe1b9b4f96796b45672f762"><div class="ttname"><a href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a></div><div class="ttdeci">void throwEOFException(const char *msg, int e)</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00140">except.cpp:140</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a7236f968e16474ded809aa6b9f98452a"><div class="ttname"><a href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a></div><div class="ttdeci">static unsigned up4(unsigned x)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00077">p_lx_elf.cpp:77</a></div></div>
<div class="ttc" id="astructPackHeader_html_aafa1c316f2be9a01d43d36a5aa5473bf"><div class="ttname"><a href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">PackHeader::format</a></div><div class="ttdeci">int format</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00051">packhead.h:51</a></div></div>
<div class="ttc" id="astructPackHeader_html_ae01f8532b828892b503c900efe3b7f6f"><div class="ttname"><a href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a></div><div class="ttdeci">int version</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00050">packhead.h:50</a></div></div>
<div class="ttc" id="astructl__info_html_a5dce623f92874cf890dc2f1d89f7c722"><div class="ttname"><a href="structl__info.html#a5dce623f92874cf890dc2f1d89f7c722">l_info::l_version</a></div><div class="ttdeci">uint8_t l_version</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00336">bsd.h:336</a></div></div>
<div class="ttc" id="astructl__info_html_a86eb402570f0f7c31f1ffcf001f4e0b7"><div class="ttname"><a href="structl__info.html#a86eb402570f0f7c31f1ffcf001f4e0b7">l_info::l_format</a></div><div class="ttdeci">uint8_t l_format</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00337">bsd.h:337</a></div></div>
<div class="ttc" id="astructl__info_html_aa0149de209589df53c7af51a2fb2eba6"><div class="ttname"><a href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a></div><div class="ttdeci">uint32_t l_magic</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00334">bsd.h:334</a></div></div>
<div class="ttc" id="astructl__info_html_aa0f743c0ef6a36494c5ad64218a6a86f"><div class="ttname"><a href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a></div><div class="ttdeci">uint16_t l_lsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00335">bsd.h:335</a></div></div>
<div class="ttc" id="astructl__info_html_abf70c0a5d8293e74153673a988cd61a4"><div class="ttname"><a href="structl__info.html#abf70c0a5d8293e74153673a988cd61a4">l_info::l_checksum</a></div><div class="ttdeci">uint32_t l_checksum</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00333">bsd.h:333</a></div></div>
<div class="ttc" id="astructp__info_html_a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0"><div class="ttname"><a href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a></div><div class="ttdeci">uint32_t p_filesize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00343">bsd.h:343</a></div></div>
<div class="ttc" id="astructp__info_html_a461ce9b60cfbb8fa0faab3b7e404c702"><div class="ttname"><a href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a></div><div class="ttdeci">uint32_t p_blocksize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00344">bsd.h:344</a></div></div>
<div class="ttc" id="astructp__info_html_a673ef061863e733588f4b12a7938d009"><div class="ttname"><a href="structp__info.html#a673ef061863e733588f4b12a7938d009">p_info::p_progid</a></div><div class="ttdeci">uint32_t p_progid</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00342">bsd.h:342</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classFilter.html#a2f300af4994c93ee536e9002b315b1ea">Filter::addvalue</a>, <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="structPackHeader.html#aafa1c316f2be9a01d43d36a5aa5473bf">PackHeader::format</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classFilter.html#aac773bd22bdb2ba33014b5d58405d19f">Filter::id</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="structl__info.html#abf70c0a5d8293e74153673a988cd61a4">l_info::l_checksum</a>, <a class="el" href="structl__info.html#a86eb402570f0f7c31f1ffcf001f4e0b7">l_info::l_format</a>, <a class="el" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a>, <a class="el" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a>, <a class="el" href="structl__info.html#a5dce623f92874cf890dc2f1d89f7c722">l_info::l_version</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a>, <a class="el" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structp__info.html#a673ef061863e733588f4b12a7938d009">p_info::p_progid</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1">set_le16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#ae86e3eeb56091063ef73bbcab2c1262a">PackLinuxElf::sz_pack2a</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="classPackLinuxElf64.html#a689b9c7fa3bd70c22d9703fbcc288819">sz_phdrx</a>, <a class="el" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, <a class="el" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859">up8()</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph" id="aclassPackLinuxElf64_ae4c3d3d66cd14ea19fc44d0f90274092_cgraph">
<area shape="rect" title=" " alt="" coords="5,991,172,1016"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="771,1760,904,1786"/>
<area shape="rect" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8" title=" " alt="" coords="231,533,378,573"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="773,240,902,266"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="773,124,902,150"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="772,742,903,767"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="537,967,615,992"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="512,842,640,867"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a5487e5169059653e4841e5aa6fe72859" title=" " alt="" coords="553,691,599,716"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="500,61,652,101"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="547,792,605,818"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="220,1067,389,1092"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="223,1432,386,1458"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="515,1118,637,1143"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="763,1143,912,1168"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="517,1068,635,1094"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="512,1862,640,1887"/>
<area shape="rect" href="bele_8h.html#ad88deaac7f8abe77334fa9f1efc73fa1" title=" " alt="" coords="266,1963,343,1988"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="281,2012,328,2038"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1223,892,1312,918"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="1029,1431,1105,1456"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="1025,1610,1109,1635"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="1027,1710,1108,1735"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="960,1660,1175,1686"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="990,1759,1145,1784"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1360,363,1479,388"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="489,439,663,464"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="481,176,671,216"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="547,642,605,667"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="511,291,641,316"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="512,340,640,366"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="505,390,647,415"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="766,791,909,816"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="999,843,1136,868"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="1000,742,1135,767"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1002,942,1133,967"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="999,892,1135,918"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="779,943,895,968"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="997,1358,1137,1383"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="457,1760,695,1786"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="509,1610,643,1635"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="766,1459,909,1484"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="786,1711,889,1736"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="779,1508,895,1534"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="473,1358,679,1383"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="493,1407,659,1432"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="437,1711,715,1736"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="482,1269,670,1309"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="780,992,895,1018"/>
<area shape="rect" href="bele_8h.html#af742fab6657d96b869354c0155245023" title=" " alt="" coords="535,1963,617,1988"/>
</map>
</div>

</div>
</div>
<a id="a34abb7fc5a62a52800339d603f78f562" name="a34abb7fc5a62a52800339d603f78f562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34abb7fc5a62a52800339d603f78f562">&#9670;&#160;</a></span>pack3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a> PackLinuxElf64::pack3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l00707">707</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  708</span>{</div>
<div class="line"><span class="lineno">  709</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a>) {</div>
<div class="line"><span class="lineno">  710</span>        <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>) + (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> : <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno">  711</span>    }</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">super::pack3</a>(fo, ft);  <span class="comment">// loader follows compressed PT_LOADs</span></div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &amp;&amp; Elf64_Dyn::DT_INIT != <a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a>) { <span class="comment">// patch user_init_rp</span></div>
<div class="line"><span class="lineno">  715</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>((<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0], <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  716</span>        <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> rela(*(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> <span class="keyword">const</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>);</div>
<div class="line"><span class="lineno">  717</span>        <span class="comment">//u64_t r_info = get_te64(&amp;((Elf64_Rela const *)user_init_rp)-&gt;r_info);</span></div>
<div class="line"><span class="lineno">  718</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a> r_type = (Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_AARCH64_RELATIVE</div>
<div class="line"><span class="lineno">  719</span>                     : (Elf64_Ehdr::EM_X86_64  == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_X86_64_RELATIVE</div>
<div class="line"><span class="lineno">  720</span>                     : (Elf64_Ehdr::EM_PPC64   == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) ? R_PPC64_RELATIVE</div>
<div class="line"><span class="lineno">  721</span>                     : 0;</div>
<div class="line"><span class="lineno">  722</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela.r_info, ELF64_R_INFO(0 <span class="comment">/*ELF64_R_SYM(r_info)*/</span>, r_type));</div>
<div class="line"><span class="lineno">  723</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela.r_addend, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a>);  <span class="comment">// entry to decompressor</span></div>
<div class="line"><span class="lineno">  724</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;rela, <span class="keyword">sizeof</span>(rela));</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno">  727</span>    }</div>
<div class="line"><span class="lineno">  728</span>    <span class="comment">// NOTE: PackLinuxElf::pack3  adjusted xct_off for the extra page</span></div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="comment">// Then compressed gaps (including debuginfo.)</span></div>
<div class="line"><span class="lineno">  731</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++k) {</div>
<div class="line"><span class="lineno">  732</span>        Extent x;</div>
<div class="line"><span class="lineno">  733</span>        x.size = <a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, k, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  734</span>        <span class="keywordflow">if</span> (x.size) {</div>
<div class="line"><span class="lineno">  735</span>            x.offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_offset) +</div>
<div class="line"><span class="lineno">  736</span>                       <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[k].p_filesz);</div>
<div class="line"><span class="lineno">  737</span>            <a class="code hl_function" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">packExtent</a>(x, <span class="keyword">nullptr</span>, fo);</div>
<div class="line"><span class="lineno">  738</span>        }</div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span>    <span class="comment">// write block end marker (uncompressed size 0)</span></div>
<div class="line"><span class="lineno">  741</span>    <a class="code hl_struct" href="structb__info.html">b_info</a> hdr; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;hdr, 0, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno">  742</span>    <a class="code hl_function" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a>(&amp;hdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>, <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>);</div>
<div class="line"><span class="lineno">  743</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;hdr, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno">  744</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// not shared library</span></div>
<div class="line"><span class="lineno">  747</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_align, ((<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>)0) - <a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>);</div>
<div class="line"><span class="lineno">  748</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_paddr = <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr;</div>
<div class="line"><span class="lineno">  749</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_offset = 0;</div>
<div class="line"><span class="lineno">  750</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> abrk = <a class="code hl_function" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  751</span>        <span class="comment">// vbase handles ET_EXEC.  FIXME: pre-linking?</span></div>
<div class="line"><span class="lineno">  752</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> vbase = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_vaddr);</div>
<div class="line"><span class="lineno">  753</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_filesz, 0x1000);  <span class="comment">// Linux kernel SIGSEGV if (0==.p_filesz)</span></div>
<div class="line"><span class="lineno">  754</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_memsz, abrk - vbase);</div>
<div class="line"><span class="lineno">  755</span>        <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>].p_flags, Elf64_Phdr::PF_W|Elf64_Phdr::PF_R);</div>
<div class="line"><span class="lineno">  756</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  757</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz,  <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  758</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr, abrk= (<a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a> &amp; (~<a class="code hl_variable" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a> + abrk)));</div>
<div class="line"><span class="lineno">  759</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_paddr = <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr;</div>
<div class="line"><span class="lineno">  760</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry, abrk + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry) - vbase);</div>
<div class="line"><span class="lineno">  761</span>    }</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// shared library</span></div>
<div class="line"><span class="lineno">  763</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> cpr_entry = (Elf64_Ehdr::EM_ARM==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a>;  <span class="comment">// Thumb mode</span></div>
<div class="line"><span class="lineno">  764</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a>], cpr_entry);  <span class="comment">// set the hook</span></div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a>) { <span class="comment">// decompressor needs hint for DT_INIT_ARRAY</span></div>
<div class="line"><span class="lineno">  767</span>            <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dynp = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)<a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(Elf64_Dyn::DT_NULL);</div>
<div class="line"><span class="lineno">  768</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dynp-&gt;d_val, (<span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">user_init_rp</a> - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0]);</div>
<div class="line"><span class="lineno">  769</span>        }</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *<span class="keyword">const</span> phdr0 = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno">  772</span>                <span class="stringliteral">&quot;bad e_phoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno">  773</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdr = phdr0;</div>
<div class="line"><span class="lineno">  774</span>        <a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a> off = fo-&gt;<a class="code hl_function" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">st_size</a>();  <span class="comment">// 64 bits</span></div>
<div class="line"><span class="lineno">  775</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> = 0;</div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) {</div>
<div class="line"><span class="lineno">  777</span>            <span class="comment">// p_vaddr and p_paddr do not change!</span></div>
<div class="line"><span class="lineno">  778</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> len  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno">  779</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> <span class="keyword">const</span> ioff = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[j].p_offset);  <span class="comment">// without asl_delta</span></div>
<div class="line"><span class="lineno">  780</span>            <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>       align= <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>);</div>
<div class="line"><span class="lineno">  781</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno">  782</span>            <span class="keywordflow">if</span> (Elf64_Phdr::PT_INTERP==type) {</div>
<div class="line"><span class="lineno">  783</span>                <span class="comment">// Rotate to highest position, so it can be lopped</span></div>
<div class="line"><span class="lineno">  784</span>                <span class="comment">// by decrementing e_phnum.</span></div>
<div class="line"><span class="lineno">  785</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, phdr, <span class="keyword">sizeof</span>(*phdr));  <span class="comment">// extract</span></div>
<div class="line"><span class="lineno">  786</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove</a>(phdr, 1+phdr, (<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - (1+ j))*<span class="keyword">sizeof</span>(*phdr));  <span class="comment">// overlapping</span></div>
<div class="line"><span class="lineno">  787</span>                <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(&amp;phdr[<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> - (1+ j)], (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <span class="keyword">sizeof</span>(*phdr));  <span class="comment">// to top</span></div>
<div class="line"><span class="lineno">  788</span>                --phdr; --<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>;</div>
<div class="line"><span class="lineno">  789</span>                <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  790</span>                <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;((<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>)-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  791</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  792</span>            }</div>
<div class="line"><span class="lineno">  793</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> == type) {</div>
<div class="line"><span class="lineno">  794</span>                <span class="keywordflow">if</span> (!ioff) { <span class="comment">// first PT_LOAD must contain everything written so far</span></div>
<div class="line"><span class="lineno">  795</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);  <span class="comment">// is this correct?</span></div>
<div class="line"><span class="lineno">  796</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>,  <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno">  797</span>                }</div>
<div class="line"><span class="lineno">  798</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - ioff) &lt; len) { <span class="comment">// Change length of compressed PT_LOAD.</span></div>
<div class="line"><span class="lineno">  799</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - ioff);  <span class="comment">// FIXME  (sz_pack2 + lsize - ioff) ?</span></div>
<div class="line"><span class="lineno">  800</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">p_memsz</a>,  <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> - ioff);</div>
<div class="line"><span class="lineno">  801</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// MIPS puts PT_DYNAMIC here</span></div>
<div class="line"><span class="lineno">  802</span>                        <span class="comment">// Allow for DT_INIT in a new [stolen] slot</span></div>
<div class="line"><span class="lineno">  803</span>                        <span class="keywordtype">unsigned</span> off2 = <a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> - <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>);</div>
<div class="line"><span class="lineno">  804</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off2, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  805</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[off2], 2*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a>));</div>
<div class="line"><span class="lineno">  806</span>                    }</div>
<div class="line"><span class="lineno">  807</span>                }</div>
<div class="line"><span class="lineno">  808</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; ioff) { <span class="comment">// Slide subsequent PT_LOAD.</span></div>
<div class="line"><span class="lineno">  809</span>                    <span class="keywordflow">if</span> ((1u&lt;&lt;12) &lt; align</div>
<div class="line"><span class="lineno">  810</span>                    &amp;&amp;  Elf64_Ehdr::EM_X86_64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>  <span class="comment">// FIXME: other $ARCH ?</span></div>
<div class="line"><span class="lineno">  811</span>                    ) {</div>
<div class="line"><span class="lineno">  812</span>                        align = 1u&lt;&lt;12;</div>
<div class="line"><span class="lineno">  813</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">p_align</a>, align);</div>
<div class="line"><span class="lineno">  814</span>                    }</div>
<div class="line"><span class="lineno">  815</span>                    off = <a class="code hl_function" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a>(fo, (-1 + align) &amp; (ioff - off));</div>
<div class="line"><span class="lineno">  816</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>) {</div>
<div class="line"><span class="lineno">  817</span>                        <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> = off - ((<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0) + ioff);</div>
<div class="line"><span class="lineno">  818</span>                        <span class="comment">//asl_slide_Shdrs();</span></div>
<div class="line"><span class="lineno">  819</span>                    }</div>
<div class="line"><span class="lineno">  820</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>, off);</div>
<div class="line"><span class="lineno">  821</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  822</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[ioff], len);</div>
<div class="line"><span class="lineno">  823</span>                    off += len;</div>
<div class="line"><span class="lineno">  824</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = off;</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>                    <span class="keywordflow">if</span> ((<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> - ioff) &lt; len) {</div>
<div class="line"><span class="lineno">  827</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">user_init_off</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  828</span>                        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> word = cpr_entry;</div>
<div class="line"><span class="lineno">  829</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;word, cpr_entry);</div>
<div class="line"><span class="lineno">  830</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;word, <span class="keyword">sizeof</span>(word));</div>
<div class="line"><span class="lineno">  831</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno">  832</span>                    }</div>
<div class="line"><span class="lineno">  833</span>                }</div>
<div class="line"><span class="lineno">  834</span>                <span class="keywordflow">continue</span>;  <span class="comment">// all done with this PT_LOAD</span></div>
<div class="line"><span class="lineno">  835</span>            }</div>
<div class="line"><span class="lineno">  836</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; ioff) {</div>
<div class="line"><span class="lineno">  837</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0) + ioff);</div>
<div class="line"><span class="lineno">  838</span>            }</div>
<div class="line"><span class="lineno">  839</span>        }  <span class="comment">// end each Phdr</span></div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> || <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) { <span class="comment">// must update Shdr.sh_offset for so_slide</span></div>
<div class="line"><span class="lineno">  842</span>            <span class="comment">// Update {DYNAMIC}.sh_offset by so_slide.</span></div>
<div class="line"><span class="lineno">  843</span>            <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *shdr = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(  <span class="comment">// FIXME: use shdri ?</span></div>
<div class="line"><span class="lineno">  844</span>                    <span class="stringliteral">&quot;bad e_shoff&quot;</span>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> - (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0), <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));</div>
<div class="line"><span class="lineno">  845</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>; ++shdr, ++j) {</div>
<div class="line"><span class="lineno">  846</span>                <span class="keywordtype">unsigned</span> sh_type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_type);</div>
<div class="line"><span class="lineno">  847</span>                <span class="keywordtype">unsigned</span> sh_flags = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_flags);  <span class="comment">// all SHF_ are 32-bit anyway</span></div>
<div class="line"><span class="lineno">  848</span>                <span class="keywordtype">unsigned</span> sh_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset); <span class="comment">// already asl_delta</span></div>
<div class="line"><span class="lineno">  849</span>                <span class="keywordflow">if</span> (Elf64_Shdr::SHF_ALLOC &amp; sh_flags</div>
<div class="line"><span class="lineno">  850</span>                &amp;&amp;  Elf64_Shdr::SHF_WRITE &amp; sh_flags</div>
<div class="line"><span class="lineno">  851</span>                &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_offset) {</div>
<div class="line"><span class="lineno">  852</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a> + sh_offset);</div>
<div class="line"><span class="lineno">  853</span>                }</div>
<div class="line"><span class="lineno">  854</span>                <span class="keywordflow">if</span> (Elf64_Shdr::SHT_RELA == sh_type</div>
<div class="line"><span class="lineno">  855</span>                &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>  <span class="comment">// FIXME: does this apply to SHT_RELA ?</span></div>
<div class="line"><span class="lineno">  856</span>                &amp;&amp;  !<a class="code hl_function" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp</a>(<span class="stringliteral">&quot;.rel.plt&quot;</span>, <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;shdr-&gt;sh_name) + <a class="code hl_variable" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">shstrtab</a>)) {</div>
<div class="line"><span class="lineno">  857</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> va = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_PLTGOT) - (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0);</div>
<div class="line"><span class="lineno">  858</span>                    <span class="comment">// Now use the old Phdrs (phdri)</span></div>
<div class="line"><span class="lineno">  859</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phva;</div>
<div class="line"><span class="lineno">  860</span>                    phva = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(va, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  861</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> old_off = (va - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>))</div>
<div class="line"><span class="lineno">  862</span>                        + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>                    <span class="comment">// Now use the new Phdrs (phdr0)</span></div>
<div class="line"><span class="lineno">  865</span>                    va += (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> ? <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> : 0);</div>
<div class="line"><span class="lineno">  866</span>                    phva = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(va, phdr0, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno">  867</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> new_off = (va - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>))</div>
<div class="line"><span class="lineno">  868</span>                        + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phva-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>                    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>) {</div>
<div class="line"><span class="lineno">  871</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(new_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  872</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[old_off], <a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a> * 8);</div>
<div class="line"><span class="lineno">  873</span>                    }</div>
<div class="line"><span class="lineno">  874</span>                }</div>
<div class="line"><span class="lineno">  875</span>                <span class="keywordflow">if</span> (j &amp;&amp; shdr-&gt;sh_addr == 0</div>
<div class="line"><span class="lineno">  876</span>                &amp;&amp;  (<span class="keywordtype">unsigned</span>)<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) { <span class="comment">// UPX_RSIZE_MAX_MEM protects us</span></div>
<div class="line"><span class="lineno">  877</span>                    <span class="comment">// Try to be nice by sliding; but still fails if compressed.</span></div>
<div class="line"><span class="lineno">  878</span>                    <span class="comment">// So don&#39;t do it unless appending plain text of shstrtab.</span></div>
<div class="line"><span class="lineno">  879</span>                    <span class="keywordtype">unsigned</span> sh_off = (unsigned)<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;shdr-&gt;sh_offset);  <span class="comment">// UPX_RSIZE_MAX_MEM protects us</span></div>
<div class="line"><span class="lineno">  880</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; sh_off) {</div>
<div class="line"><span class="lineno">  881</span>                        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;shdr-&gt;sh_offset, sh_off + <a class="code hl_variable" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">so_slide</a>);</div>
<div class="line"><span class="lineno">  882</span>                    }</div>
<div class="line"><span class="lineno">  883</span>                }</div>
<div class="line"><span class="lineno">  884</span>            }</div>
<div class="line"><span class="lineno">  885</span>            <span class="comment">// Maybe: append plain text of shstrtab strings?</span></div>
<div class="line"><span class="lineno">  886</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno">  887</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>) {</div>
<div class="line"><span class="lineno">  888</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;((<a class="code hl_struct" href="structElf32__Ehdr.html">Elf32_Ehdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>())-&gt;e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno">  889</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno">  890</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*shdr));</div>
<div class="line"><span class="lineno">  891</span>                    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(*shdr);</div>
<div class="line"><span class="lineno">  892</span>                }</div>
<div class="line"><span class="lineno">  893</span>            }</div>
<div class="line"><span class="lineno">  894</span>        }</div>
<div class="line"><span class="lineno">  895</span>        <span class="keywordflow">else</span> { <span class="comment">// output has no Shdr</span></div>
<div class="line"><span class="lineno">  896</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">e_shnum</a> = 0;</div>
<div class="line"><span class="lineno">  897</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a> = 0;</div>
<div class="line"><span class="lineno">  898</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">e_shstrndx</a> = 0;</div>
<div class="line"><span class="lineno">  899</span>        }</div>
<div class="line"><span class="lineno">  900</span>    }</div>
<div class="line"><span class="lineno">  901</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno">  902</span>}</div>
<div class="ttc" id="abele_8h_html_ab07367b17d1a80bb3cd4eeb48b4fdde5"><div class="ttname"><a href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr void set_le32(XE32 *p, unsigned v) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00346">bele.h:346</a></div></div>
<div class="ttc" id="aclassOutputFile_html_a05fb6e81deb6d535c8192cfbb1eb5732"><div class="ttname"><a href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">OutputFile::st_size</a></div><div class="ttdeci">virtual upx_off_t st_size() const override</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00303">file.cpp:303</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ac405aa11c3c356e93dc38f2365701466"><div class="ttname"><a href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">PackLinuxElf64::getbrk</a></div><div class="ttdeci">virtual off_t getbrk(const Elf64_Phdr *phdr, int e_phnum) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l03434">p_lx_elf.cpp:3434</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a3409fd940ae9b30dc51e68f69e0160f6"><div class="ttname"><a href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf::pack3</a></div><div class="ttdeci">virtual off_t pack3(OutputFile *, Filter &amp;) override=0</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00383">p_lx_elf.cpp:383</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a99ee39bcba2a438ad1728c8332356ce2"><div class="ttname"><a href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a></div><div class="ttdeci">unsigned sz_pack2</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00093">p_lx_elf.h:93</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a13631338bc966bdceaf740dfd8082dd5"><div class="ttname"><a href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN</a></div><div class="ttdeci">static off_t fpadN(OutputFile *fo, unsigned len)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00089">p_lx_elf.cpp:89</a></div></div>
<div class="ttc" id="astructElf32__Ehdr_html"><div class="ttname"><a href="structElf32__Ehdr.html">Elf32_Ehdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00187">bsd.h:188</a></div></div>
<div class="ttc" id="astructb__info_html_a29bbf0f18e0c39a8f826067d7ed80602"><div class="ttname"><a href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a></div><div class="ttdeci">uint32_t sz_cpr</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00324">bsd.h:324</a></div></div>
<div class="ttc" id="axspan__fwd_8h_html_a8012d8687b040cb0d6a7ad890856cf49"><div class="ttname"><a href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove</a></div><div class="ttdeci">void * memmove(C&lt; T &gt; a, const void *b, size_t n)</div><div class="ttdef"><b>Definition:</b> <a href="xspan__fwd_8h_source.html#l00117">xspan_fwd.h:117</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fcea933a8e32da91a1d5efb7cd842ac7427b">C_BASE</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#ae8289d7705794be744876f6246242b9b">Elf64_Ehdr::e_shstrndx</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5">fpadN()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466">getbrk()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49">memmove()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="structPackUnix_1_1Extent.html#af1480dd29548549680df8648b6683e26">PackUnix::Extent::offset</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#aa89a4b1835998c8866e821d777a2f879">Elf64_Phdr::p_align</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#a55fae01175fc4e3f1c23e52b14459235">Elf64_Phdr::p_memsz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6">PackLinuxElf::pack3()</a>, <a class="el" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1">PackUnix::packExtent()</a>, <a class="el" href="classPackLinuxElf64.html#acf726e188c8c471755ee3f00cf7c4226">page_mask</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32()</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#a193d50a7694d9bbdd607514c4fe691ab">PackLinuxElf::shstrtab</a>, <a class="el" href="structPackUnix_1_1Extent.html#a53190d36659a81e14c218e0610947a02">PackUnix::Extent::size</a>, <a class="el" href="classPackLinuxElf.html#a8be817665d0219026ebd50acdd3700af">PackLinuxElf::so_slide</a>, <a class="el" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732">OutputFile::st_size()</a>, <a class="el" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf">strcmp()</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="classPackLinuxElf.html#a59a59994ceb7e3d20444f07a08cd1cfe">PackLinuxElf::user_init_off</a>, <a class="el" href="classPackLinuxElf.html#a8c8e26f797ec69a6c183c8b15fcd4f53">PackLinuxElf::user_init_rp</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph" id="aclassPackLinuxElf64_a34abb7fc5a62a52800339d603f78f562_cgraph">
<area shape="rect" title=" " alt="" coords="5,939,172,965"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="505,16,650,56"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="775,182,904,207"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="233,189,378,229"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="513,283,642,309"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="230,73,381,113"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="229,371,381,411"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="548,586,607,611"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="768,537,911,562"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="774,787,905,813"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a13631338bc966bdceaf740dfd8082dd5" title=" " alt="" coords="547,537,608,562"/>
<area shape="rect" href="classPackLinuxElf64.html#ac405aa11c3c356e93dc38f2365701466" title=" " alt="" coords="220,270,391,295"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="221,2159,390,2185"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="538,1166,617,1191"/>
<area shape="rect" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49" title=" " alt="" coords="793,1126,886,1151"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="995,2007,1071,2033"/>
<area shape="rect" href="classPackLinuxElf.html#a3409fd940ae9b30dc51e68f69e0160f6" title=" " alt="" coords="230,838,381,863"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="513,939,641,965"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="513,1041,641,1066"/>
<area shape="rect" href="classPackUnix.html#ad3f398fa4a3b34fd79f441e3069f78b1" title=" " alt="" coords="224,1557,387,1582"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="234,990,377,1015"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="513,1381,641,1406"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="801,2109,878,2134"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="241,2209,369,2234"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="272,2282,339,2307"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="234,2331,377,2357"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="540,182,615,207"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="518,385,637,410"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="964,975,1101,1001"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="772,586,907,611"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="513,789,642,814"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="764,953,915,978"/>
<area shape="rect" href="classPackUnix.html#a573f3c8c4c540f51c2a7b168535d4741" title=" " alt="" coords="513,838,642,863"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="554,687,601,713"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="773,2007,906,2033"/>
<area shape="rect" href="classMemBuffer.html#aa7fca1d24644887e92e728c1d3f3785f" title=" " alt="" coords="458,1957,697,1982"/>
<area shape="rect" href="classPacker.html#add5cc1c8eff3bbc8aaf7ec0cf03cb82e" title="compress &#45; wrap call to low&#45;level upx_compress()" alt="" coords="510,1582,645,1607"/>
<area shape="rect" href="packhead_8cpp.html#a772d316c45ac4858f5cffa5f842fff49" title=" " alt="" coords="768,1531,911,1557"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="963,1531,1103,1557"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="788,1682,891,1707"/>
<area shape="rect" href="compress_8cpp.html#a503ce434d639fefff3eee167b8bc5b64" title=" " alt="" coords="781,1633,897,1658"/>
<area shape="rect" href="classPacker.html#ad0ae5b698e68d64585e5be87a256f675" title=" " alt="" coords="475,1809,680,1834"/>
<area shape="rect" href="classPackUnix.html#a362bc5d4016b05a3e36f20f364950602" title=" " alt="" coords="494,1858,661,1883"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="516,1907,639,1933"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="519,1331,636,1357"/>
<area shape="rect" href="classPacker.html#ae0b134c6d419c733cb3283f4403a6f78" title="overlapping decompression" alt="" coords="439,1430,716,1455"/>
<area shape="rect" href="classPacker.html#a98836d189865b8496d759334c6257608" title=" " alt="" coords="483,1267,671,1307"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="992,2082,1073,2107"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="781,1331,897,1357"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="965,1357,1101,1382"/>
</map>
</div>

</div>
</div>
<a id="afc239684c1874f0a29ee97eca4e8d4d6" name="afc239684c1874f0a29ee97eca4e8d4d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc239684c1874f0a29ee97eca4e8d4d6">&#9670;&#160;</a></span>pack4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::pack4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFilter.html">Filter</a> &amp;&#160;</td>
          <td class="paramname"><em>ft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06074">6074</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6075</span>{</div>
<div class="line"><span class="lineno"> 6076</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 6077</span>        <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 6078</span>    }</div>
<div class="line"><span class="lineno"> 6079</span> </div>
<div class="line"><span class="lineno"> 6080</span>    cprElfHdr4 *eho = !<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a></div>
<div class="line"><span class="lineno"> 6081</span>            ? &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>  <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 6082</span>            : (cprElfHdr4 *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();  <span class="comment">// shlib</span></div>
<div class="line"><span class="lineno"> 6083</span>    <span class="keywordtype">unsigned</span> penalty = <a class="code hl_function" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs</a>(fo, &amp;eho-&gt;ehdr); (void)penalty;</div>
<div class="line"><span class="lineno"> 6084</span> </div>
<div class="line"><span class="lineno"> 6085</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;o_unix.preserve_build_id) { <span class="comment">// FIXME: co-ordinate with forward_Shdrs</span></div>
<div class="line"><span class="lineno"> 6086</span>        <span class="comment">// calc e_shoff here and write shdrout, then o_shstrtab</span></div>
<div class="line"><span class="lineno"> 6087</span>        <span class="comment">//NOTE: these are pushed last to ensure nothing is stepped on</span></div>
<div class="line"><span class="lineno"> 6088</span>        <span class="comment">//for the UPX structure.</span></div>
<div class="line"><span class="lineno"> 6089</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = <a class="code hl_function" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4</a>(fo, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6090</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;ehdr.e_shoff, <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6091</span> </div>
<div class="line"><span class="lineno"> 6092</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize = <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>);</div>
<div class="line"><span class="lineno"> 6093</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize1 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1].sh_size);</div>
<div class="line"><span class="lineno"> 6094</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ssize2 = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_size);</div>
<div class="line"><span class="lineno"> 6095</span> </div>
<div class="line"><span class="lineno"> 6096</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[2].sh_offset,          ssize + <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6097</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>.shdr[1].sh_offset, ssize2 + ssize + <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>);</div>
<div class="line"><span class="lineno"> 6098</span> </div>
<div class="line"><span class="lineno"> 6099</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>, ssize); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize;</div>
<div class="line"><span class="lineno"> 6100</span> </div>
<div class="line"><span class="lineno"> 6101</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">o_shstrtab</a>, ssize2); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize2;</div>
<div class="line"><span class="lineno"> 6102</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">buildid_data</a>, ssize1); <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += ssize1;</div>
<div class="line"><span class="lineno"> 6103</span>    }</div>
<div class="line"><span class="lineno"> 6104</span> </div>
<div class="line"><span class="lineno"> 6105</span>    <span class="comment">// ph.u_len and ph.c_len are leftover from earliest days when there was</span></div>
<div class="line"><span class="lineno"> 6106</span>    <span class="comment">// only one compressed extent.  Use a good analogy for multiple extents.</span></div>
<div class="line"><span class="lineno"> 6107</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;</div>
<div class="line"><span class="lineno"> 6108</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 6109</span>    <a class="code hl_function" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">super::pack4</a>(fo, ft);  <span class="comment">// write PackHeader and overlay_offset</span></div>
<div class="line"><span class="lineno"> 6110</span> </div>
<div class="line"><span class="lineno"> 6111</span>    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6112</span>    <span class="keywordflow">if</span> (0!=<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {  <span class="comment">// shared library</span></div>
<div class="line"><span class="lineno"> 6113</span>        { <span class="comment">// Shouldn&#39;t this special case be handled earlier?</span></div>
<div class="line"><span class="lineno"> 6114</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 6115</span>                <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *phdro = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(&amp;eho-&gt;phdr);</div>
<div class="line"><span class="lineno"> 6116</span>                <a class="code hl_function" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">set_te32</a>(&amp;phdro-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>, Elf64_Phdr::PF_X | <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdro-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>));</div>
<div class="line"><span class="lineno"> 6117</span>            }</div>
<div class="line"><span class="lineno"> 6118</span>        }</div>
<div class="line"><span class="lineno"> 6119</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a> &amp;&amp; !<a class="code hl_variable" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">saved_opt_android_shlib</a>) {</div>
<div class="line"><span class="lineno"> 6120</span>            <span class="comment">// Make it abundantly clear that there are no Elf64_Shdr in this shlib</span></div>
<div class="line"><span class="lineno"> 6121</span>            eho-&gt;ehdr.e_shoff = 0;</div>
<div class="line"><span class="lineno"> 6122</span>            <a class="code hl_function" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">set_te16</a>(&amp;eho-&gt;ehdr.e_shentsize, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>));  <span class="comment">// Android bug: cannot use 0</span></div>
<div class="line"><span class="lineno"> 6123</span>            eho-&gt;ehdr.e_shnum = 0;</div>
<div class="line"><span class="lineno"> 6124</span>            eho-&gt;ehdr.e_shstrndx = 0;</div>
<div class="line"><span class="lineno"> 6125</span>        }</div>
<div class="line"><span class="lineno"> 6126</span> </div>
<div class="line"><span class="lineno"> 6127</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(eho, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>) + <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(*<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>));</div>
<div class="line"><span class="lineno"> 6128</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">linfo_off</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6129</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));  <span class="comment">// new info: l_checksum, l_size</span></div>
<div class="line"><span class="lineno"> 6130</span> </div>
<div class="line"><span class="lineno"> 6131</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a>) { <span class="comment">// FIXME Does this apply to 64-bit, too?</span></div>
<div class="line"><span class="lineno"> 6132</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> tmp = <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 6133</span>            tmp |= (Elf64_Ehdr::EM_ARM==<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);  <span class="comment">// THUMB mode; no-op for 64-bit</span></div>
<div class="line"><span class="lineno"> 6134</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;tmp, tmp);</div>
<div class="line"><span class="lineno"> 6135</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_function" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>-&gt;st_value, <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6136</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;tmp, <span class="keyword">sizeof</span>(tmp));</div>
<div class="line"><span class="lineno"> 6137</span>        }</div>
<div class="line"><span class="lineno"> 6138</span>    }</div>
<div class="line"><span class="lineno"> 6139</span>    <span class="keywordflow">else</span> { <span class="comment">// not shlib</span></div>
<div class="line"><span class="lineno"> 6140</span>        <span class="comment">// Cannot pre-round .p_memsz.  If .p_filesz &lt; .p_memsz, then kernel</span></div>
<div class="line"><span class="lineno"> 6141</span>        <span class="comment">// tries to make .bss, which requires PF_W.</span></div>
<div class="line"><span class="lineno"> 6142</span>        <span class="comment">// But strict SELinux (or PaX, grSecurity) disallows PF_W with PF_X.</span></div>
<div class="line"><span class="lineno"> 6143</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz, <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>);</div>
<div class="line"><span class="lineno"> 6144</span>                  eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_memsz = eho-&gt;phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_filesz;</div>
<div class="line"><span class="lineno"> 6145</span> </div>
<div class="line"><span class="lineno"> 6146</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6147</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;eho-&gt;ehdr, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + 2* <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));  <span class="comment">// C_BASE, C_TEXT</span></div>
<div class="line"><span class="lineno"> 6148</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6149</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 6150</span>    }</div>
<div class="line"><span class="lineno"> 6151</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_acc61917c51c71bfcb0f9af20ba7714d6"><div class="ttname"><a href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">PackLinuxElf64::forward_Shdrs</a></div><div class="ttdeci">virtual unsigned forward_Shdrs(OutputFile *fo, Elf64_Ehdr *ehdro)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l05776">p_lx_elf.cpp:5776</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a539c946c8c36fa509670ec9948ccb1fc"><div class="ttname"><a href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a></div><div class="ttdeci">upx_uint64_t jni_onload_va</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00105">p_lx_elf.h:105</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a793632661a0af5efd197304078be1ed0"><div class="ttname"><a href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">PackLinuxElf::o_shstrtab</a></div><div class="ttdeci">static const unsigned char o_shstrtab[]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00130">p_lx_elf.h:130</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a7d92de9aedc1747be87ef5968952838c"><div class="ttname"><a href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix::pack4</a></div><div class="ttdeci">virtual void pack4(OutputFile *, Filter &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00274">p_unix.cpp:274</a></div></div>
<div class="ttc" id="autil_8cpp_html_a49db04c61486d695f7f04b44ac2201c0"><div class="ttname"><a href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a></div><div class="ttdeci">unsigned ptr_udiff_bytes(const void *a, const void *b) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00126">util.cpp:126</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a4036b37656b78e0053108ad8f9a17ef8">PackLinuxElf::buildid_data</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084">fpad4()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>, <a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#a888f94bd6a90f535ea5567e3f8b39ccc">PackLinuxElf::linfo_off</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="classPackLinuxElf.html#a793632661a0af5efd197304078be1ed0">PackLinuxElf::o_shstrtab</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c">PackUnix::pack4()</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackUnix.html#a8ab714a14f4ff2f120107dfc08b2a3a5">PackUnix::saved_opt_android_shlib</a>, <a class="el" href="classPackLinuxElf64.html#a98d5fb25525360d037499ea920927602">sec_arm_attr</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e">Packer::set_te16()</a>, <a class="el" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382">Packer::set_te32()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf64.html#aae6931a0bd5d2fca80befbd24a574c3e">shdrout</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph" id="aclassPackLinuxElf64_afc239684c1874f0a29ee97eca4e8d4d6_cgraph">
<area shape="rect" title=" " alt="" coords="5,540,172,566"/>
<area shape="rect" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6" title=" " alt="" coords="220,533,399,573"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="979,155,1109,180"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="722,459,853,484"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="482,78,611,103"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="462,127,631,152"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="475,342,618,367"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="483,915,611,940"/>
<area shape="rect" href="classPacker.html#a860499fa0849a7c7a7c4d43ee084f76e" title=" " alt="" coords="483,816,611,842"/>
<area shape="rect" href="classPacker.html#af9cad2c8624ee68213d01eb606be0382" title=" " alt="" coords="483,964,611,990"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="483,866,611,891"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a961610ff2ac229f29f7d03d3a2ccc084" title=" " alt="" coords="517,292,576,318"/>
<area shape="rect" href="classPackUnix.html#a7d92de9aedc1747be87ef5968952838c" title=" " alt="" coords="245,990,374,1015"/>
<area shape="rect" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0" title=" " alt="" coords="1213,1290,1332,1315"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="471,177,622,217"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae67031a5cdb8843f862b05500cb6984f" title=" " alt="" coords="517,490,576,515"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="471,391,622,416"/>
<area shape="rect" href="conf_8h.html#af1fdeecf9ad80f9618354edc154be54a" title=" " alt="" coords="523,440,570,466"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="749,990,825,1015"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="730,715,845,740"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="488,591,605,616"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="513,664,580,690"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="715,177,860,217"/>
<area shape="rect" href="classOutputFile.html#a05fb6e81deb6d535c8192cfbb1eb5732" title=" " alt="" coords="716,292,859,318"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1396,474,1533,499"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="977,384,1111,410"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1228,636,1317,662"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="979,738,1109,763"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1228,788,1317,814"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="999,434,1089,459"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1209,384,1336,410"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="1208,434,1337,459"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1385,676,1544,716"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1618,939,1737,964"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="729,864,845,890"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="1015,890,1073,915"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="976,939,1112,964"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1395,1059,1535,1084"/>
<area shape="rect" href="classPackUnix.html#aced1a9bb3fee3c231bfc90051224a6dd" title=" " alt="" coords="447,1066,647,1091"/>
<area shape="rect" href="classPacker.html#af51db683baf7d75a65f48429b77db475" title="patch util for loader" alt="" coords="971,1091,1117,1116"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="928,1040,1160,1066"/>
<area shape="rect" href="classPacker.html#ad1f9499f529513c9d26fc647968dfe7e" title=" " alt="" coords="695,1142,880,1167"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="1234,1240,1311,1266"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1249,1191,1297,1216"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="1209,1142,1337,1167"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1395,939,1534,964"/>
<area shape="rect" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156" title=" " alt="" coords="1003,1192,1085,1218"/>
<area shape="rect" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225" title="ptr util" alt="" coords="1409,1271,1520,1296"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="1592,1246,1763,1271"/>
<area shape="rect" href="util_8h.html#a38df66b3eff123e66d6b92ceb76eb4c3" title=" " alt="" coords="1629,1295,1726,1320"/>
</map>
</div>

</div>
</div>
<a id="a426e7f90fc3af416c18a3deb0571e4b1" name="a426e7f90fc3af416c18a3deb0571e4b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426e7f90fc3af416c18a3deb0571e4b1">&#9670;&#160;</a></span>packed_struct() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr1&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00413">413</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  413</span>                              {</div>
<div class="line"><span class="lineno">  414</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  415</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[1];</div>
<div class="line"><span class="lineno">  416</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  417</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a95e05ec4a8acf7cac11023b7a57aad85" name="a95e05ec4a8acf7cac11023b7a57aad85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e05ec4a8acf7cac11023b7a57aad85">&#9670;&#160;</a></span>packed_struct() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr2&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00419">419</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  419</span>                              {</div>
<div class="line"><span class="lineno">  420</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  421</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[2];</div>
<div class="line"><span class="lineno">  422</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  423</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a5c753db61a98f514bc1b083069692374" name="a5c753db61a98f514bc1b083069692374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c753db61a98f514bc1b083069692374">&#9670;&#160;</a></span>packed_struct() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr3&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00425">425</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  425</span>                              {</div>
<div class="line"><span class="lineno">  426</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  427</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[3];</div>
<div class="line"><span class="lineno">  428</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  429</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="a36103546d5ed97790537a6f7c6f0e02b" name="a36103546d5ed97790537a6f7c6f0e02b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36103546d5ed97790537a6f7c6f0e02b">&#9670;&#160;</a></span>packed_struct() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfHdr4&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00431">431</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  431</span>                              {</div>
<div class="line"><span class="lineno">  432</span>        <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> ehdr;</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> phdr[4];</div>
<div class="line"><span class="lineno">  434</span>        <a class="code hl_struct" href="structl__info.html">l_info</a> <a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno">  435</span>    };</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>.</p>

</div>
</div>
<a id="aec3f937f49c167ed74510c02a5afe10a" name="aec3f937f49c167ed74510c02a5afe10a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec3f937f49c167ed74510c02a5afe10a">&#9670;&#160;</a></span>packed_struct() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PackLinuxElf64::packed_struct </td>
          <td>(</td>
          <td class="paramtype">cprElfShdr3&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00439">439</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  439</span>                               {</div>
<div class="line"><span class="lineno">  440</span>        <a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> shdr[3];</div>
<div class="line"><span class="lineno">  441</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c2bb372c567334edd586f78224bc956" name="a8c2bb372c567334edd586f78224bc956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c2bb372c567334edd586f78224bc956">&#9670;&#160;</a></span>PackLinuxElf64help1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::PackLinuxElf64help1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInputFile.html">InputFile</a> *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01023">1023</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1024</span>{</div>
<div class="line"><span class="lineno"> 1025</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>  = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>);</div>
<div class="line"><span class="lineno"> 1026</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 1027</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 1028</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> e_phentsize = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">e_phentsize</a>);</div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>((<span class="keywordtype">char</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <span class="stringliteral">&quot;\x7f\x45\x4c\x46&quot;</span>, 4)  <span class="comment">// &quot;\177ELF&quot;</span></div>
<div class="line"><span class="lineno"> 1030</span>    || <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_CLASS]!=Elf64_Ehdr::ELFCLASS64</div>
<div class="line"><span class="lineno"> 1031</span>    || <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) != e_phentsize</div>
<div class="line"><span class="lineno"> 1032</span>    || (Elf64_Ehdr::ELFDATA2MSB == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno"> 1033</span>            &amp;&amp; &amp;<a class="code hl_variable" href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a> != <a class="code hl_variable" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a>)</div>
<div class="line"><span class="lineno"> 1034</span>    || (Elf64_Ehdr::ELFDATA2LSB == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[Elf64_Ehdr::EI_DATA]</div>
<div class="line"><span class="lineno"> 1035</span>            &amp;&amp; &amp;<a class="code hl_variable" href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a> != <a class="code hl_variable" href="classPacker.html#a18d294254872108f1373a26ccabbd821">bele</a>)) {</div>
<div class="line"><span class="lineno"> 1036</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> = 0;</div>
<div class="line"><span class="lineno"> 1037</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = 0;</div>
<div class="line"><span class="lineno"> 1038</span>        <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = 0;</div>
<div class="line"><span class="lineno"> 1039</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1040</span>    }</div>
<div class="line"><span class="lineno"> 1041</span>    <span class="keywordflow">if</span> (0==<a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>) <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;0==e_phnum&quot;</span>);</div>
<div class="line"><span class="lineno"> 1042</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adc7d13d5c0e0eb4b62f0f898f03b2e66">e_phoff</a>);</div>
<div class="line"><span class="lineno"> 1043</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> last_Phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>);</div>
<div class="line"><span class="lineno"> 1044</span>    <span class="keywordflow">if</span> (last_Phdr &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>  <span class="comment">// wrap-around</span></div>
<div class="line"><span class="lineno"> 1045</span>    ||  <a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>)  <span class="comment">// must be contiguous</span></div>
<div class="line"><span class="lineno"> 1046</span>    ||  (<span class="keywordtype">unsigned</span> long)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; last_Phdr) {</div>
<div class="line"><span class="lineno"> 1047</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_phoff %p&quot;</span>, (<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>);</div>
<div class="line"><span class="lineno"> 1048</span>    }</div>
<div class="line"><span class="lineno"> 1049</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 1050</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> last_Shdr = <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>);</div>
<div class="line"><span class="lineno"> 1051</span>    <span class="keywordflow">if</span> (last_Shdr &lt; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>  <span class="comment">// wrap-around</span></div>
<div class="line"><span class="lineno"> 1052</span>    ||  (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &lt; last_Phdr)</div>
<div class="line"><span class="lineno"> 1053</span>    ||  (<span class="keywordtype">unsigned</span> long)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt; last_Shdr) {</div>
<div class="line"><span class="lineno"> 1054</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd == <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>) {</div>
<div class="line"><span class="lineno"> 1055</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_shoff %p&quot;</span>, (<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 1056</span>        }</div>
<div class="line"><span class="lineno"> 1057</span>    }</div>
<div class="line"><span class="lineno"> 1058</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a> * e_phentsize;</div>
<div class="line"><span class="lineno"> 1059</span>    <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a> = <a class="code hl_variable" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">sz_phdrs</a> + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) +</div>
<div class="line"><span class="lineno"> 1060</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf32__Phdr.html">Elf32_Phdr</a>);  <span class="comment">// phdrx bodies later: ::generateElfHdr</span></div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>    <span class="keywordflow">if</span> (f &amp;&amp; Elf64_Ehdr::ET_DYN!=<a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno"> 1063</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;  <span class="comment">// (sz_phdrs + e_phoff) except --preserve-build-id</span></div>
<div class="line"><span class="lineno"> 1064</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, len);</div>
<div class="line"><span class="lineno"> 1065</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1066</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, len);</div>
<div class="line"><span class="lineno"> 1067</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>= (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>       *)(<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 1068</span>    }</div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">if</span> (f &amp;&amp; Elf64_Ehdr::ET_DYN==<a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a>) {</div>
<div class="line"><span class="lineno"> 1070</span>        <span class="comment">// The DT_SYMTAB has no designated length.  Read the whole file.</span></div>
<div class="line"><span class="lineno"> 1071</span>        <a class="code hl_function" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 1072</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1073</span>        f-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>, <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>);</div>
<div class="line"><span class="lineno"> 1074</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>= (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= (unsigned)<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>) ? nullptr : (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);  <span class="comment">// do not free() !!</span></div>
<div class="line"><span class="lineno"> 1075</span>        <span class="keywordflow">if</span> (!(<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd == <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &lt; (<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() == 0)) {</div>
<div class="line"><span class="lineno"> 1076</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1077</span>        }</div>
<div class="line"><span class="lineno"> 1078</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">e_shentsize</a>) {</div>
<div class="line"><span class="lineno"> 1079</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 1080</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 1081</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 1082</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 1083</span>        }</div>
<div class="line"><span class="lineno"> 1084</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1085</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 1086</span>        }</div>
<div class="line"><span class="lineno"> 1087</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 1088</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 1089</span>            <span class="keywordtype">unsigned</span> t = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_link);</div>
<div class="line"><span class="lineno"> 1090</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a> &lt;= t)</div>
<div class="line"><span class="lineno"> 1091</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad dynsym-&gt;sh_link&quot;</span>);</div>
<div class="line"><span class="lineno"> 1092</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a> = &amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>[t];</div>
<div class="line"><span class="lineno"> 1093</span>        }</div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr= <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 1096</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; --j&gt;=0; ++phdr)</div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordflow">if</span> (Elf64_Phdr::PT_DYNAMIC==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 1098</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic</a>(phdr);</div>
<div class="line"><span class="lineno"> 1099</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>= (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(offset + <a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>);</div>
<div class="line"><span class="lineno"> 1100</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>,</div>
<div class="line"><span class="lineno"> 1101</span>                <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>), <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> - offset));</div>
<div class="line"><span class="lineno"> 1102</span>        }</div>
<div class="line"><span class="lineno"> 1103</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 1104</span>            <a class="code hl_function" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load</a>(phdr);</div>
<div class="line"><span class="lineno"> 1105</span>        }</div>
<div class="line"><span class="lineno"> 1106</span>        <span class="comment">// elf_find_dynamic() returns 0 if 0==dynseg.</span></div>
<div class="line"><span class="lineno"> 1107</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> =          (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 1108</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> <span class="comment">/*const*/</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_SYMTAB);</div>
<div class="line"><span class="lineno"> 1109</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> =     (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_GNU_HASH);</div>
<div class="line"><span class="lineno"> 1110</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a> =     (<span class="keywordtype">unsigned</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_HASH);</div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keywordflow">if</span> (3&amp; ((<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a> | (<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a> | (<a class="code hl_typedef" href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a>)<a class="code hl_variable" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>)) {</div>
<div class="line"><span class="lineno"> 1112</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;unaligned DT_SYMTAB, DT_GNU_HASH, or DT_HASH/n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1113</span>        }</div>
<div class="line"><span class="lineno"> 1114</span>        <a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup</a>(<span class="stringliteral">&quot;JNI_OnLoad&quot;</span>);</div>
<div class="line"><span class="lineno"> 1115</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>) {</div>
<div class="line"><span class="lineno"> 1116</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>-&gt;st_value);</div>
<div class="line"><span class="lineno"> 1117</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">jni_onload_va</a> = 0;  <span class="comment">// FIXME not understood; need example</span></div>
<div class="line"><span class="lineno"> 1118</span>        }</div>
<div class="line"><span class="lineno"> 1119</span>    }</div>
<div class="line"><span class="lineno"> 1120</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a02d0e91095e3b2cdfbc913e7bc25abf8"><div class="ttname"><a href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">PackLinuxElf64::elf_lookup</a></div><div class="ttdeci">virtual Elf64_Sym const * elf_lookup(char const *) const</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l08242">p_lx_elf.cpp:8242</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_aaf175264167b93a8ce865a34937584e6"><div class="ttname"><a href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a></div><div class="ttdeci">unsigned e_type</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00078">p_lx_elf.h:78</a></div></div>
<div class="ttc" id="aclassPacker_html_a18d294254872108f1373a26ccabbd821"><div class="ttname"><a href="classPacker.html#a18d294254872108f1373a26ccabbd821">Packer::bele</a></div><div class="ttdeci">const N_BELE_RTP::AbstractPolicy * bele</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00314">packer.h:314</a></div></div>
<div class="ttc" id="aconf_8h_html_a0290c1b714a32ca216f00e6446342dd8"><div class="ttname"><a href="conf_8h.html#a0290c1b714a32ca216f00e6446342dd8">upx_uintptr_t</a></div><div class="ttdeci">acc_uintptr_t upx_uintptr_t</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00172">conf.h:172</a></div></div>
<div class="ttc" id="anamespaceN__BELE__RTP_html_a800eaf3ed4e72268ac7ac7a800df07cd"><div class="ttname"><a href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a></div><div class="ttdeci">const LEPolicy le_policy</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00782">util.cpp:782</a></div></div>
<div class="ttc" id="anamespaceN__BELE__RTP_html_af72fe6f323f96796c843a2e019005de6"><div class="ttname"><a href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a></div><div class="ttdeci">const BEPolicy be_policy</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00781">util.cpp:781</a></div></div>
<div class="ttc" id="aoptions_8h_html_a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86"><div class="ttname"><a href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a></div><div class="ttdeci">@ CMD_COMPRESS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00046">options.h:46</a></div></div>
<div class="ttc" id="astructElf32__Phdr_html"><div class="ttname"><a href="structElf32__Phdr.html">Elf32_Phdr</a></div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00223">bsd.h:224</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a078af1eaf7681f9d85ff545b6c7aa9c5"><div class="ttname"><a href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">Elf64_Ehdr::e_shentsize</a></div><div class="ttdeci">Elf64_Half e_shentsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00218">bsd.h:218</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_adc7d13d5c0e0eb4b62f0f898f03b2e66"><div class="ttname"><a href="structElf64__Ehdr.html#adc7d13d5c0e0eb4b62f0f898f03b2e66">Elf64_Ehdr::e_phoff</a></div><div class="ttdeci">Elf64_Off e_phoff</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00212">bsd.h:212</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4">alloc_file_image()</a>, <a class="el" href="namespaceN__BELE__RTP.html#af72fe6f323f96796c843a2e019005de6">N_BELE_RTP::be_policy</a>, <a class="el" href="classPacker.html#a18d294254872108f1373a26ccabbd821">Packer::bele</a>, <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load()</a>, <a class="el" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="structElf64__Ehdr.html#ab5aefb7a14b9cf2eafcbaf0664852369">Elf64_Ehdr::e_phentsize</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="structElf64__Ehdr.html#adc7d13d5c0e0eb4b62f0f898f03b2e66">Elf64_Ehdr::e_phoff</a>, <a class="el" href="structElf64__Ehdr.html#a078af1eaf7681f9d85ff545b6c7aa9c5">Elf64_Ehdr::e_shentsize</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="structElf64__Ehdr.html#a317679f1ef5e41e0717e95670c6a1d24">Elf64_Ehdr::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackLinuxElf64.html#af841cae6e65e727111a3e5bc134135c0">gashtab</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf64.html#a9d14a83cf8a4300cf26946d4c16f8421">hashtab</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#afb6babf0e9aac66eec1cdfe3c0fb6247">jni_onload_sym</a>, <a class="el" href="classPackLinuxElf.html#a539c946c8c36fa509670ec9948ccb1fc">PackLinuxElf::jni_onload_va</a>, <a class="el" href="namespaceN__BELE__RTP.html#a800eaf3ed4e72268ac7ac7a800df07cd">N_BELE_RTP::le_policy</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="classPackLinuxElf64.html#ad07514aa5c9db6acc6b2bdad24113943">n_phdrx</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classPackLinuxElf64.html#a4e8c011204377d30ff0f1283c7eca923">sec_dynstr</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classPackLinuxElf.html#ab3ca408b94c072437e9e96a3b4e3ab1f">PackLinuxElf::sz_phdrs</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>, <a class="el" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732">PackLinuxElf64Be::PackLinuxElf64Be()</a>, and <a class="el" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268">PackLinuxElf64Le::PackLinuxElf64Le()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph" id="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_cgraph">
<area shape="rect" title=" " alt="" coords="5,1053,199,1093"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="691,175,825,200"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1180,784,1299,809"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a34f9d3637288371175e78109dfbabef4" title=" " alt="" coords="474,251,602,276"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="933,327,1084,352"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="924,1612,1093,1637"/>
<area shape="rect" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014" title=" " alt="" coords="925,957,1092,997"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1175,1695,1304,1720"/>
<area shape="rect" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6" title=" " alt="" coords="925,805,1092,845"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="465,1935,611,1975"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="944,1180,1073,1205"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="685,1173,831,1213"/>
<area shape="rect" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8" title=" " alt="" coords="465,738,611,778"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="473,1136,603,1161"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="247,1605,413,1645"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="288,1960,372,1985"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="269,2203,391,2228"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="271,2324,389,2349"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="261,561,399,587"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="964,755,1053,780"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="971,128,1047,153"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="967,177,1051,203"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="968,227,1049,252"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="901,276,1116,301"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="931,55,1086,80"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1164,219,1315,259"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="673,276,843,301"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="734,65,782,91"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="963,5,1054,31"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="936,1821,1081,1861"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="663,1935,853,1975"/>
<area shape="rect" href="classPackLinuxElf.html#a9cdb0429d3e2faba00ef2d67b2c628c0" title=" " alt="" coords="675,644,841,669"/>
<area shape="rect" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8" title=" " alt="" coords="683,529,833,569"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="934,529,1083,569"/>
<area shape="rect" href="classPackLinuxElf.html#a504fe912dd96ebfcd443b89dd425317f" title=" " alt="" coords="671,745,845,771"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="725,819,791,844"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="465,1605,611,1645"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="683,1719,833,1759"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="461,1433,615,1473"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="685,1541,831,1581"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="682,1605,834,1645"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="691,1491,825,1516"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="696,1389,820,1415"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="481,2252,595,2277"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="463,2203,613,2228"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="693,2276,823,2301"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="713,2227,803,2252"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="689,2375,827,2400"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="480,2324,596,2349"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="729,2325,787,2351"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph" id="aclassPackLinuxElf64_a8c2bb372c567334edd586f78224bc956_icgraph">
<area shape="rect" title=" " alt="" coords="493,55,687,95"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,5,440,31"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,55,445,95"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,119,444,159"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
</map>
</div>

</div>
</div>
<a id="ae5e7655b7e6bff51e5d2d9f8e203a4e3" name="ae5e7655b7e6bff51e5d2d9f8e203a4e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e7655b7e6bff51e5d2d9f8e203a4e3">&#9670;&#160;</a></span>patchLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::patchLoader </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackUnix.html#ac4b328c80b7172751702a447aed1afb2">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01200">1200</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1201</span>{</div>
<div class="line"><span class="lineno"> 1202</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acbc068ab20eb6f313fc0abbda76c62a4" name="acbc068ab20eb6f313fc0abbda76c62a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc068ab20eb6f313fc0abbda76c62a4">&#9670;&#160;</a></span>sort_DT64_offsets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::sort_DT64_offsets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> const *const&#160;</td>
          <td class="paramname"><em>dynp0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07865">7865</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7866</span>{</div>
<div class="line"><span class="lineno"> 7867</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>) * <span class="keyword">sizeof</span>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>)/<span class="keyword">sizeof</span>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>[0]));</div>
<div class="line"><span class="lineno"> 7868</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">clear</a>();</div>
<div class="line"><span class="lineno"> 7869</span>    <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a> = (<span class="keywordtype">unsigned</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">mb_dt_offsets</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 7870</span>    <span class="keywordtype">unsigned</span> n_off = 0, k;</div>
<div class="line"><span class="lineno"> 7871</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; ((k = <a class="code hl_variable" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>[j]),  k); ++j) {</div>
<div class="line"><span class="lineno"> 7872</span>        <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off] = 0;  <span class="comment">// default to &quot;not found&quot;</span></div>
<div class="line"><span class="lineno"> 7873</span>        <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> rva = 0;</div>
<div class="line"><span class="lineno"> 7874</span>        <span class="keywordflow">if</span> (k &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">DT_NUM</a>) { <span class="comment">// in range of easy table</span></div>
<div class="line"><span class="lineno"> 7875</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[k]) {</div>
<div class="line"><span class="lineno"> 7876</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 7877</span>            }</div>
<div class="line"><span class="lineno"> 7878</span>            rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynp0[-1+ <a class="code hl_variable" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">dt_table</a>[k]].d_val);</div>
<div class="line"><span class="lineno"> 7879</span>        }</div>
<div class="line"><span class="lineno"> 7880</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>) { <span class="comment">// why is this guard necessary?</span></div>
<div class="line"><span class="lineno"> 7881</span>            rva = <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(k);  <span class="comment">// zero if not found</span></div>
<div class="line"><span class="lineno"> 7882</span>        }</div>
<div class="line"><span class="lineno"> 7883</span>        <span class="keywordflow">if</span> (!rva) { <span class="comment">// not present in input</span></div>
<div class="line"><span class="lineno"> 7884</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 7885</span>        }</div>
<div class="line"><span class="lineno"> 7886</span>        <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> phdr = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(rva, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7887</span>        <span class="keywordflow">if</span> (!phdr) {</div>
<div class="line"><span class="lineno"> 7888</span>            <span class="keywordtype">char</span> msg[60]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad DT_{%#x} = %#llx (no Phdr)&quot;</span>,</div>
<div class="line"><span class="lineno"> 7889</span>                k, rva);</div>
<div class="line"><span class="lineno"> 7890</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7891</span>        }</div>
<div class="line"><span class="lineno"> 7892</span>        <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off] = (rva - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>)) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7893</span> </div>
<div class="line"><span class="lineno"> 7894</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &lt;= <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off]) {</div>
<div class="line"><span class="lineno"> 7895</span>            <span class="keywordtype">char</span> msg[60]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;bad DT_{%#x} = %#x (beyond EOF)&quot;</span>,</div>
<div class="line"><span class="lineno"> 7896</span>                k, <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off]);</div>
<div class="line"><span class="lineno"> 7897</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(msg);</div>
<div class="line"><span class="lineno"> 7898</span>        }</div>
<div class="line"><span class="lineno"> 7899</span>        n_off += !!<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off];</div>
<div class="line"><span class="lineno"> 7900</span>    }</div>
<div class="line"><span class="lineno"> 7901</span>    <a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[n_off++] = <a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>;  <span class="comment">// sentinel</span></div>
<div class="line"><span class="lineno"> 7902</span>    <a class="code hl_define" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>(<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>, n_off, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">dt_offsets</a>[0]), <a class="code hl_function" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned</a>);</div>
<div class="line"><span class="lineno"> 7903</span>}</div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a153fe8a7e59d11eee850dcf7aac446dd"><div class="ttname"><a href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned</a></div><div class="ttdeci">static int __acc_cdecl_qsort qcmp_unsigned(void const *const aa, void const *const bb)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01999">p_lx_elf.cpp:1999</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_a4b2bd0c0bbfe083032e496ebbb7ad5f9"><div class="ttname"><a href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a></div><div class="ttdeci">static unsigned const dt_keys[]</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l01982">p_lx_elf.cpp:1982</a></div></div>
<div class="ttc" id="autil_8h_html_afafc04a977e45706ac9f76ed6122ee54"><div class="ttname"><a href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a></div><div class="ttdeci">#define upx_qsort</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00205">util.h:205</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c">MemBuffer::clear()</a>, <a class="el" href="p__lx__elf_8cpp.html#a4b2bd0c0bbfe083032e496ebbb7ad5f9">dt_keys</a>, <a class="el" href="classPackLinuxElf.html#a7515af27403f7b035c02bc0f92dee48c">PackLinuxElf::DT_NUM</a>, <a class="el" href="classPackLinuxElf.html#acbe0a4831f0aafe74de573ca657ea430">PackLinuxElf::dt_offsets</a>, <a class="el" href="classPackLinuxElf.html#a93d9de72bcb60bbea6757e0d44e5e296">PackLinuxElf::dt_table</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf.html#a834063e926d1118a24f23a8106edcd4e">PackLinuxElf::mb_dt_offsets</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd">qcmp_unsigned()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph" id="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_cgraph">
<area shape="rect" title=" " alt="" coords="5,460,159,500"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="225,227,358,252"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="715,27,833,52"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="224,127,359,152"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="219,513,364,553"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="709,514,839,539"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="216,428,367,468"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="207,694,376,719"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="229,743,353,768"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="487,27,576,52"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="736,170,812,195"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="489,278,573,303"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="491,327,572,352"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="424,126,639,151"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="909,172,1064,198"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="699,320,849,360"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="911,352,1062,392"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="911,288,1062,328"/>
<area shape="rect" href="classMemBuffer.html#a067c4f5e676fb7a775ed97f03b8dc7e4" title=" " alt="" coords="472,76,591,102"/>
<area shape="rect" href="classMemBuffer.html#afe5a8e344706fc176dde5c69983dc2e3" title=" " alt="" coords="687,90,861,115"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="945,115,1028,140"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="917,66,1057,91"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="1112,108,1263,148"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="1311,76,1461,116"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="1311,140,1461,180"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="467,492,596,518"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="494,542,569,567"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="459,428,604,468"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph" id="aclassPackLinuxElf64_acbc068ab20eb6f313fc0abbda76c62a4_icgraph">
<area shape="rect" title=" " alt="" coords="949,81,1103,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="735,81,901,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2" title=" " alt="" coords="5,5,187,31"/>
<area shape="rect" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956" title=" " alt="" coords="493,81,687,121"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="518,173,662,213"/>
<area shape="rect" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae" title="Generic Unix canUnpack()." alt="" coords="240,31,440,56"/>
<area shape="rect" href="classPackLinuxElf64Be.html#a5e93d25085824663e48351d020b5f732" title=" " alt="" coords="235,81,445,121"/>
<area shape="rect" href="classPackLinuxElf64Le.html#a3751950623fd4e95ac1b579097184268" title=" " alt="" coords="236,145,444,185"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="253,209,427,235"/>
</map>
</div>

</div>
</div>
<a id="ab19e5a4000bc5cc063dee2a31db657e9" name="ab19e5a4000bc5cc063dee2a31db657e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab19e5a4000bc5cc063dee2a31db657e9">&#9670;&#160;</a></span>un_asl_dynsym()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::un_asl_dynsym </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>orig_file_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06284">6284</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6288</span>{</div>
<div class="line"><span class="lineno"> 6289</span>    <span class="comment">// un-Relocate dynsym (DT_SYMTAB) which is below xct_off</span></div>
<div class="line"><span class="lineno"> 6290</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> = (<span class="keywordtype">char</span> <span class="keyword">const</span> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_STRTAB);</div>
<div class="line"><span class="lineno"> 6291</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a> = <a class="code hl_function" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type</a>(Elf64_Shdr::SHT_DYNSYM);</div>
<div class="line"><span class="lineno"> 6292</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">dynstr</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>) {</div>
<div class="line"><span class="lineno"> 6293</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> off_dynsym = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_offset);</div>
<div class="line"><span class="lineno"> 6294</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> sz_dynsym  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>-&gt;sh_size);</div>
<div class="line"><span class="lineno"> 6295</span>        <span class="keywordflow">if</span> (orig_file_size &lt; sz_dynsym</div>
<div class="line"><span class="lineno"> 6296</span>        ||  orig_file_size &lt; off_dynsym</div>
<div class="line"><span class="lineno"> 6297</span>        || (orig_file_size - off_dynsym) &lt; sz_dynsym) {</div>
<div class="line"><span class="lineno"> 6298</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad SHT_DYNSYM&quot;</span>);</div>
<div class="line"><span class="lineno"> 6299</span>        }</div>
<div class="line"><span class="lineno"> 6300</span>        <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *<span class="keyword">const</span> sym0 = (<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 6301</span>            <span class="stringliteral">&quot;bad dynsym&quot;</span>, off_dynsym, sz_dynsym);</div>
<div class="line"><span class="lineno"> 6302</span>        <a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> *sym = sym0;</div>
<div class="line"><span class="lineno"> 6303</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = sz_dynsym / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>); --j&gt;=0; ++sym) {</div>
<div class="line"><span class="lineno"> 6304</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> symval = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;sym-&gt;st_value);</div>
<div class="line"><span class="lineno"> 6305</span>            <span class="keywordtype">unsigned</span> symsec = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;sym-&gt;st_shndx);</div>
<div class="line"><span class="lineno"> 6306</span>            <span class="keywordflow">if</span> (Elf64_Sym::SHN_UNDEF != symsec</div>
<div class="line"><span class="lineno"> 6307</span>            &amp;&amp;  Elf64_Sym::SHN_ABS   != symsec</div>
<div class="line"><span class="lineno"> 6308</span>            &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 6309</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;sym-&gt;st_value, symval - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6310</span>            }</div>
<div class="line"><span class="lineno"> 6311</span>            <span class="keywordflow">if</span> (Elf64_Sym::SHN_ABS == symsec &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= symval) {</div>
<div class="line"><span class="lineno"> 6312</span>                <a class="code hl_function" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS</a>(sym, 0ul - (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)<a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6313</span>            }</div>
<div class="line"><span class="lineno"> 6314</span>        }</div>
<div class="line"><span class="lineno"> 6315</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6316</span>            <span class="keywordtype">unsigned</span> pos = fo-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6317</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(off_dynsym, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6318</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(sym0, sz_dynsym);</div>
<div class="line"><span class="lineno"> 6319</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6320</span>        }</div>
<div class="line"><span class="lineno"> 6321</span>    }</div>
<div class="line"><span class="lineno"> 6322</span>}</div>
<div class="ttc" id="aclassFileBase_html_ac5cf6444d65c14d76b14ae420dd50eff"><div class="ttname"><a href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell</a></div><div class="ttdeci">upx_off_t tell() const</div><div class="ttdef"><b>Definition:</b> <a href="file_8cpp_source.html#l00151">file.cpp:151</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4">adjABS()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf.html#a6ec71c63b3b76a8847d2a5989c2f3fbb">PackLinuxElf::dynstr</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classPackLinuxElf64.html#a6d6524ff7018c3899073535eb33f4920">sec_dynsym</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph" id="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_cgraph">
<area shape="rect" title=" " alt="" coords="5,375,149,415"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="399,95,573,121"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="197,375,343,415"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="634,270,763,295"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="413,145,559,185"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="205,325,335,350"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="199,554,341,579"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="422,675,550,701"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="206,489,334,514"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="199,439,341,465"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="645,954,752,979"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1023,43,1162,69"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="816,123,965,163"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="634,169,763,194"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="665,67,732,93"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1234,259,1353,285"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="413,375,559,415"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="391,209,581,249"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="421,563,551,589"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="631,573,766,598"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1649,903,1780,929"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1439,675,1577,701"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="846,422,935,447"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1048,473,1137,498"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="654,523,743,549"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1230,523,1357,549"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="826,574,955,599"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1415,550,1601,575"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1687,550,1743,575"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1030,574,1155,599"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1220,625,1367,650"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1481,625,1535,650"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1438,777,1578,802"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1013,348,1172,388"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="823,675,959,701"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="641,827,757,853"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="862,929,919,954"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="397,439,575,465"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="629,371,768,397"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="817,349,964,374"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="1069,413,1117,438"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="1248,413,1339,438"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="1445,413,1571,438"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph" id="aclassPackLinuxElf64_ab19e5a4000bc5cc063dee2a31db657e9_icgraph">
<area shape="rect" title=" " alt="" coords="420,5,564,45"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a03c843122a8d3e44da9fe458643c2589" name="a03c843122a8d3e44da9fe458643c2589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c843122a8d3e44da9fe458643c2589">&#9670;&#160;</a></span>un_DT_INIT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::un_DT_INIT </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>old_dtinit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>phdro</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const *&#160;</td>
          <td class="paramname"><em>dynhdr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06967">6967</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6973</span>{</div>
<div class="line"><span class="lineno"> 6974</span>    <span class="comment">// DT_INIT must be restored.</span></div>
<div class="line"><span class="lineno"> 6975</span>    <span class="comment">// If android_shlib, then the asl_delta relocations must be un-done.</span></div>
<div class="line"><span class="lineno"> 6976</span>    <span class="keywordtype">unsigned</span> n_plt = 0;</div>
<div class="line"><span class="lineno"> 6977</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_pltrelsz(0), dt_jmprel(0), dt_pltgot(0);</div>
<div class="line"><span class="lineno"> 6978</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dt_relasz(0), dt_rela(0);</div>
<div class="line"><span class="lineno"> 6979</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> dyn_len = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynhdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 6980</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> dyn_off = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dynhdr-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 6981</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> &lt; (dyn_len + dyn_off)) {</div>
<div class="line"><span class="lineno"> 6982</span>        <span class="keywordtype">char</span> msg[50]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 6983</span>                <span class="stringliteral">&quot;bad PT_DYNAMIC .p_filesz %#lx&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">unsigned</span>)dyn_len);</div>
<div class="line"><span class="lineno"> 6984</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 6985</span>    }</div>
<div class="line"><span class="lineno"> 6986</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(dyn_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6987</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, dyn_len);</div>
<div class="line"><span class="lineno"> 6988</span>    <a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *dyn = (<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)(<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>;</div>
<div class="line"><span class="lineno"> 6989</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a> = dyn; <a class="code hl_function" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>,</div>
<div class="line"><span class="lineno"> 6990</span>        <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(dyn_len, <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> - dyn_off));</div>
<div class="line"><span class="lineno"> 6991</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j2= 0; j2 &lt; dyn_len; ++dyn, j2 += <span class="keyword">sizeof</span>(*dyn)) {</div>
<div class="line"><span class="lineno"> 6992</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> tag = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_tag);</div>
<div class="line"><span class="lineno"> 6993</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>       val = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;dyn-&gt;d_val);</div>
<div class="line"><span class="lineno"> 6994</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) <span class="keywordflow">switch</span> (tag) {</div>
<div class="line"><span class="lineno"> 6995</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_RELASZ:   { dt_relasz   = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6996</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_RELA:     { dt_rela     = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6997</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_JMPREL:   { dt_jmprel   = val; } <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6998</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_PLTRELSZ: { dt_pltrelsz = val;</div>
<div class="line"><span class="lineno"> 6999</span>            n_plt = dt_pltrelsz / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a>);</div>
<div class="line"><span class="lineno"> 7000</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 7001</span>                n_plt += 3;  <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 7002</span>            }</div>
<div class="line"><span class="lineno"> 7003</span>        };  <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7004</span> </div>
<div class="line"><span class="lineno"> 7005</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_PLTGOT:   { <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> = dt_pltgot = val; (void)dt_pltgot;}</div>
<div class="line"><span class="lineno"> 7006</span>        <span class="comment">// FALL THROUGH</span></div>
<div class="line"><span class="lineno"> 7007</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_PREINIT_ARRAY:</div>
<div class="line"><span class="lineno"> 7008</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_INIT_ARRAY:</div>
<div class="line"><span class="lineno"> 7009</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_FINI_ARRAY:</div>
<div class="line"><span class="lineno"> 7010</span>        <span class="keywordflow">case</span> Elf64_Dyn::DT_FINI: <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 7011</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dyn-&gt;d_val, val - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 7012</span>        }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7013</span>        } <span class="comment">// end switch() on tag when is_asl</span></div>
<div class="line"><span class="lineno"> 7014</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">upx_dt_init</a> == tag) { <span class="comment">// the easy case</span></div>
<div class="line"><span class="lineno"> 7015</span>            <span class="keywordflow">if</span> (Elf64_Dyn::DT_INIT == tag) {</div>
<div class="line"><span class="lineno"> 7016</span>                <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;dyn-&gt;d_val, old_dtinit);</div>
<div class="line"><span class="lineno"> 7017</span>                <span class="keywordflow">if</span> (!old_dtinit) { <span class="comment">// compressor took the slot</span></div>
<div class="line"><span class="lineno"> 7018</span>                    dyn-&gt;d_tag = Elf64_Dyn::DT_NULL;</div>
<div class="line"><span class="lineno"> 7019</span>                    dyn-&gt;d_val = 0;</div>
<div class="line"><span class="lineno"> 7020</span>                }</div>
<div class="line"><span class="lineno"> 7021</span>            }</div>
<div class="line"><span class="lineno"> 7022</span>            <span class="comment">// Apparently the hard case is common for some Android IDEs.</span></div>
<div class="line"><span class="lineno"> 7023</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf32_Dyn::DT_INIT_ARRAY    == tag</div>
<div class="line"><span class="lineno"> 7024</span>            ||       Elf64_Dyn::DT_PREINIT_ARRAY == tag) {</div>
<div class="line"><span class="lineno"> 7025</span>                <span class="comment">// &#39;val&#39; is the RVA of the first slot, which is the slot that</span></div>
<div class="line"><span class="lineno"> 7026</span>                <span class="comment">// the compressor changed to be the entry to the run-time stub.</span></div>
<div class="line"><span class="lineno"> 7027</span>                <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rp = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_function" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic</a>(Elf64_Dyn::DT_NULL);</div>
<div class="line"><span class="lineno"> 7028</span>                ((<a class="code hl_typedef" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a> *)<a class="code hl_function" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr</a>(Elf64_Dyn::DT_NULL))-&gt;d_val = 0;</div>
<div class="line"><span class="lineno"> 7029</span>                <span class="keywordflow">if</span> (rp) {</div>
<div class="line"><span class="lineno"> 7030</span>                    <span class="comment">// Compressor saved the original *rp in dynsym[0]</span></div>
<div class="line"><span class="lineno"> 7031</span>                    <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rp_unc = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>[0];  <span class="comment">// pointer</span></div>
<div class="line"><span class="lineno"> 7032</span>                    rp-&gt;r_info = rp_unc-&gt;r_info;  <span class="comment">// restore original r_info; r_offset not touched</span></div>
<div class="line"><span class="lineno"> 7033</span>                    rp-&gt;r_addend = rp_unc-&gt;r_addend;</div>
<div class="line"><span class="lineno"> 7034</span> </div>
<div class="line"><span class="lineno"> 7035</span>                    <span class="keywordtype">unsigned</span> e_entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>);</div>
<div class="line"><span class="lineno"> 7036</span>                    <span class="keywordtype">unsigned</span> init_rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[e_entry - 3*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span>)]);</div>
<div class="line"><span class="lineno"> 7037</span>                    <span class="keywordtype">unsigned</span> arr_rva = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp_unc-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 7038</span>                    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_function" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va</a>(arr_rva, phdro, <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7039</span>                    <span class="keywordtype">unsigned</span> arr_off = (arr_rva - <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>)) + <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7040</span> </div>
<div class="line"><span class="lineno"> 7041</span>                    <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(rp_unc, 0, <span class="keyword">sizeof</span>(*rp_unc));</div>
<div class="line"><span class="lineno"> 7042</span>                    <span class="keywordflow">if</span> (fo)  {</div>
<div class="line"><span class="lineno"> 7043</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(<a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_SYMTAB), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7044</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rp_unc, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>));  <span class="comment">// clear dynsym[0]</span></div>
<div class="line"><span class="lineno"> 7045</span> </div>
<div class="line"><span class="lineno"> 7046</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>((<span class="keywordtype">char</span> *)rp - (<span class="keywordtype">char</span> *)&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[0], <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7047</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rp, <span class="keyword">sizeof</span>(*rp));  <span class="comment">// restore original *rp</span></div>
<div class="line"><span class="lineno"> 7048</span>                    }</div>
<div class="line"><span class="lineno"> 7049</span> </div>
<div class="line"><span class="lineno"> 7050</span>                    <span class="comment">// Set arr[0] to the first user init routine.</span></div>
<div class="line"><span class="lineno"> 7051</span>                    <span class="comment">// Elf64_Rela overwrites anyway, so this is a redundancy</span></div>
<div class="line"><span class="lineno"> 7052</span>                    <span class="comment">// or a Don&#39;t Care.</span></div>
<div class="line"><span class="lineno"> 7053</span>                    <span class="keywordtype">unsigned</span> r_info = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rp-&gt;r_info);</div>
<div class="line"><span class="lineno"> 7054</span>                    <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 7055</span>                    <a class="code hl_typedef" href="p__lx__elf_8h.html#add593f4cfdc5ddcbd94ea2638b7a96e7">u64_t</a> word;</div>
<div class="line"><span class="lineno"> 7056</span>                    <span class="keywordflow">if</span> (Elf64_Ehdr::EM_ARM64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 7057</span>                        <span class="keywordflow">if</span> (R_AARCH64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 7058</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;word, init_rva);  <span class="comment">// old_dtinit ?</span></div>
<div class="line"><span class="lineno"> 7059</span>                        }</div>
<div class="line"><span class="lineno"> 7060</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_AARCH64_ABS64 == r_type) {</div>
<div class="line"><span class="lineno"> 7061</span>                            word = 0;</div>
<div class="line"><span class="lineno"> 7062</span>                        }</div>
<div class="line"><span class="lineno"> 7063</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7064</span>                            <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;unknown relocation: %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 7065</span>                                r_type);</div>
<div class="line"><span class="lineno"> 7066</span>                            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7067</span>                        }</div>
<div class="line"><span class="lineno"> 7068</span>                    }</div>
<div class="line"><span class="lineno"> 7069</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Elf64_Ehdr::EM_AMD64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 7070</span>                        <span class="keywordflow">if</span> (R_X86_64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 7071</span>                            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;word, init_rva);</div>
<div class="line"><span class="lineno"> 7072</span>                        }</div>
<div class="line"><span class="lineno"> 7073</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (R_X86_64_64 == r_type) {</div>
<div class="line"><span class="lineno"> 7074</span>                            word = 0;</div>
<div class="line"><span class="lineno"> 7075</span>                        }</div>
<div class="line"><span class="lineno"> 7076</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7077</span>                            <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg), <span class="stringliteral">&quot;unknown relocation: %#x&quot;</span>,</div>
<div class="line"><span class="lineno"> 7078</span>                                r_type);</div>
<div class="line"><span class="lineno"> 7079</span>                            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7080</span>                        }</div>
<div class="line"><span class="lineno"> 7081</span>                    }</div>
<div class="line"><span class="lineno"> 7082</span>                    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7083</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(arr_off, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7084</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(&amp;word, <span class="keyword">sizeof</span>(word));</div>
<div class="line"><span class="lineno"> 7085</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(0, <a class="code hl_define" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>);</div>
<div class="line"><span class="lineno"> 7086</span>                    }</div>
<div class="line"><span class="lineno"> 7087</span>                }</div>
<div class="line"><span class="lineno"> 7088</span>            }</div>
<div class="line"><span class="lineno"> 7089</span>        }</div>
<div class="line"><span class="lineno"> 7090</span>    }</div>
<div class="line"><span class="lineno"> 7091</span>    <span class="keywordflow">if</span> (fo) { <span class="comment">// Write updated dt_*.val</span></div>
<div class="line"><span class="lineno"> 7092</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dyn_offo = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdro[dynhdr - <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>].p_offset);</div>
<div class="line"><span class="lineno"> 7093</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(dyn_offo, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7094</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, dyn_len);</div>
<div class="line"><span class="lineno"> 7095</span>    }</div>
<div class="line"><span class="lineno"> 7096</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 7097</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);</div>
<div class="line"><span class="lineno"> 7098</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7099</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">read</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>, <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>);  <span class="comment">// contains relocation tables</span></div>
<div class="line"><span class="lineno"> 7100</span>        <span class="keywordflow">if</span> (dt_relasz &amp;&amp; dt_rela) {</div>
<div class="line"><span class="lineno"> 7101</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *<span class="keyword">const</span> rela0 = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 7102</span>                <span class="stringliteral">&quot;bad Rela offset&quot;</span>, dt_rela, dt_relasz);</div>
<div class="line"><span class="lineno"> 7103</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64</a>(dt_rela, rela0, dt_relasz, old_dtinit, fo);</div>
<div class="line"><span class="lineno"> 7104</span>        }</div>
<div class="line"><span class="lineno"> 7105</span>        <span class="keywordflow">if</span> (dt_pltrelsz &amp;&amp; dt_jmprel) { <span class="comment">// FIXME:  overlap w/ DT_REL ?</span></div>
<div class="line"><span class="lineno"> 7106</span>            <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *<span class="keyword">const</span> jmp0 = (<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>.<a class="code hl_function" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">subref</a>(</div>
<div class="line"><span class="lineno"> 7107</span>                <span class="stringliteral">&quot;bad Jmprel offset&quot;</span>, dt_jmprel, dt_pltrelsz);</div>
<div class="line"><span class="lineno"> 7108</span>            <a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>));</div>
<div class="line"><span class="lineno"> 7109</span>            <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 7110</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">is_LOAD64</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7111</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7112</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7113</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> - vaddr;</div>
<div class="line"><span class="lineno"> 7114</span>                <span class="keywordflow">if</span> (d &lt; filesz) {</div>
<div class="line"><span class="lineno"> 7115</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7116</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(d + offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7117</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>, n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>));</div>
<div class="line"><span class="lineno"> 7118</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7119</span>                }</div>
<div class="line"><span class="lineno"> 7120</span>            }</div>
<div class="line"><span class="lineno"> 7121</span>            <a class="code hl_function" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64</a>(dt_jmprel, jmp0, dt_pltrelsz, old_dtinit, fo);</div>
<div class="line"><span class="lineno"> 7122</span> </div>
<div class="line"><span class="lineno"> 7123</span>            <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> o_ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">lowmem</a>;</div>
<div class="line"><span class="lineno"> 7124</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> o_phnum = o_ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>;</div>
<div class="line"><span class="lineno"> 7125</span>            phdr = phdro;</div>
<div class="line"><span class="lineno"> 7126</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; o_phnum; ++j, ++phdr) <span class="keywordflow">if</span> (<a class="code hl_function" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">is_LOAD64</a>(phdr)) {</div>
<div class="line"><span class="lineno"> 7127</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7128</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7129</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> d = <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a> - vaddr - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 7130</span>                <span class="keywordflow">if</span> (d &lt; filesz) {</div>
<div class="line"><span class="lineno"> 7131</span>                    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7132</span>                    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 7133</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(d + offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7134</span>                        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>, n_plt * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>));</div>
<div class="line"><span class="lineno"> 7135</span>                    }</div>
<div class="line"><span class="lineno"> 7136</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7137</span>                }</div>
<div class="line"><span class="lineno"> 7138</span>            }</div>
<div class="line"><span class="lineno"> 7139</span>        }</div>
<div class="line"><span class="lineno"> 7140</span>        <span class="comment">// Modified relocation tables are re-written by unRela64</span></div>
<div class="line"><span class="lineno"> 7141</span>    }</div>
<div class="line"><span class="lineno"> 7142</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_a3b7d0324926f0404e61dc997833544f7"><div class="ttname"><a href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">PackLinuxElf64::unRela64</a></div><div class="ttdeci">virtual void unRela64(upx_uint64_t dt_rela, Elf64_Rela *rela0, unsigned relasz, upx_uint64_t const old_dtinit, OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06219">p_lx_elf.cpp:6219</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_ab0f4c33a259ca5c14cdc2384285e274f"><div class="ttname"><a href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a></div><div class="ttdeci">MemBuffer jump_slots</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00125">p_lx_elf.h:125</a></div></div>
<div class="ttc" id="ap__elf_8h_html_a5a26c3fc1d8625558cdce93d5a53c6de"><div class="ttname"><a href="p__elf_8h.html#a5a26c3fc1d8625558cdce93d5a53c6de">Elf32_Rel</a></div><div class="ttdeci">ElfClass_Host32::Rel Elf32_Rel</div><div class="ttdef"><b>Definition:</b> <a href="p__elf_8h_source.html#l00369">p_elf.h:369</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf64.html#a53f97eabbbe04201c83cd03c9103ce88">dynseg</a>, <a class="el" href="classPackLinuxElf64.html#ad4f613581a3950b9df0a33e1dee728e9">dynsym</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4">elf_find_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287">elf_find_Phdr_for_va()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698">is_LOAD64()</a>, <a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a>, <a class="el" href="classPackLinuxElf.html#a29e8bd1f64f0d8583676289f7329eb31">PackLinuxElf::lowmem</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6">InputFile::read()</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="linux_8h.html#ad2a2e6c114780c3071efd24f16c7f7d8">SEEK_END</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be">MemBuffer::subref()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64()</a>, <a class="el" href="classPackLinuxElf.html#a5789e03712ad5c821ed718be76cb006a">PackLinuxElf::upx_dt_init</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph" id="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_cgraph">
<area shape="rect" title=" " alt="" coords="5,1314,149,1354"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="665,268,798,293"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="944,96,1020,121"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="439,422,584,462"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="909,495,1055,535"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="1148,636,1277,661"/>
<area shape="rect" href="classPackLinuxElf64.html#ac7458e15967252113c7b45332b973287" title=" " alt="" coords="659,963,804,1003"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="656,596,807,636"/>
<area shape="rect" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb" title=" " alt="" coords="209,800,375,840"/>
<area shape="rect" href="classPackLinuxElf64.html#aa0c2c8ef98d3669846a7f666f6833698" title=" " alt="" coords="223,1227,361,1267"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="674,1814,789,1840"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="450,1510,573,1536"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="440,1862,583,1888"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="453,1761,570,1786"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="447,1712,575,1737"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="447,1662,575,1688"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="221,2013,363,2038"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1356,2044,1495,2069"/>
<area shape="rect" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7" title=" " alt="" coords="197,1568,387,1593"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1168,1710,1257,1736"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="940,293,1024,318"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="941,145,1023,170"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="875,194,1089,220"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="905,244,1059,269"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1563,1710,1681,1736"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="1137,138,1288,178"/>
<area shape="rect" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9" title=" " alt="" coords="636,532,827,572"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="917,1034,1047,1060"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a0a26281ee961fe926e04c93f395d76cf" title=" " alt="" coords="945,970,1019,996"/>
<area shape="rect" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d" title=" " alt="" coords="439,923,584,963"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="897,1330,1067,1356"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="447,644,576,669"/>
<area shape="rect" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4" title=" " alt="" coords="435,800,588,840"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="659,1027,804,1067"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b4cfbd2d81ab91d393764f41c48ad44" title=" " alt="" coords="655,1294,807,1334"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="907,1513,1057,1538"/>
<area shape="rect" href="classMemBuffer.html#acea3f3781a8c941186b5777f13691c8c" title=" " alt="" coords="664,762,799,788"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a153fe8a7e59d11eee850dcf7aac446dd" title=" " alt="" coords="669,812,793,837"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="917,1736,1047,1761"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1168,1912,1257,1937"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="913,1686,1051,1712"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1346,1834,1505,1874"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="657,1510,806,1536"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="666,1913,797,1938"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="915,1988,1049,2013"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="937,1938,1027,1964"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="673,1713,789,1738"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="914,1637,1050,1662"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="912,1588,1052,1613"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="1336,1994,1515,2020"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph" id="aclassPackLinuxElf64_a03c843122a8d3e44da9fe458643c2589_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="ad2c315a3286632db9c874ca7a65bb69d" name="ad2c315a3286632db9c874ca7a65bb69d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2c315a3286632db9c874ca7a65bb69d">&#9670;&#160;</a></span>un_shlib_1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::un_shlib_1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *const&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classMemBuffer.html">MemBuffer</a> &amp;&#160;</td>
          <td class="paramname"><em>o_elfhdrs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>c_adler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>u_adler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned const&#160;</td>
          <td class="paramname"><em>orig_file_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06388">6388</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6395</span>{</div>
<div class="line"><span class="lineno"> 6396</span>    <span class="comment">// xct_off [input side] was set by ::unpack when is_shlib</span></div>
<div class="line"><span class="lineno"> 6397</span>    <span class="comment">// yct_off [output side] set here unless is_asl in next &#39;if&#39; block</span></div>
<div class="line"><span class="lineno"> 6398</span>    <span class="keywordtype">unsigned</span> yct_off = <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>;</div>
<div class="line"><span class="lineno"> 6399</span> </div>
<div class="line"><span class="lineno"> 6400</span>    <span class="comment">// Below xct_off is not compressed (for benefit of rtld.)</span></div>
<div class="line"><span class="lineno"> 6401</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(0, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6402</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>, <a class="code hl_variable" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">file_size_u32</a>));</div>
<div class="line"><span class="lineno"> 6403</span> </div>
<div class="line"><span class="lineno"> 6404</span>    <span class="comment">// Determine if the extra page with copy of _Shdrs was spliced in.</span></div>
<div class="line"><span class="lineno"> 6405</span>    <span class="comment">// This used to be the result of --android-shlib.</span></div>
<div class="line"><span class="lineno"> 6406</span>    <span class="comment">// But in 2023-02 the forwarding of ARM_ATTRIBUTES (by appending)</span></div>
<div class="line"><span class="lineno"> 6407</span>    <span class="comment">// takes care of this, so the 5th word before e_entry does not</span></div>
<div class="line"><span class="lineno"> 6408</span>    <span class="comment">// have the low bit 1, so is_asl should not be set.</span></div>
<div class="line"><span class="lineno"> 6409</span>    <span class="comment">// However, .so that were compressed before 2023-03</span></div>
<div class="line"><span class="lineno"> 6410</span>    <span class="comment">// may be marked.</span></div>
<div class="line"><span class="lineno"> 6411</span>    <a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">e_shoff</a>);</div>
<div class="line"><span class="lineno"> 6412</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> &amp;&amp; <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a></div>
<div class="line"><span class="lineno"> 6413</span>            <span class="comment">// +36: (sizeof(PackHeader) + sizeof(overlay_offset))</span></div>
<div class="line"><span class="lineno"> 6414</span>            <span class="comment">//    after Shdrs for ARM_ATTRIBUTES</span></div>
<div class="line"><span class="lineno"> 6415</span>    &amp;&amp;  (((<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a> + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>) + 36) &lt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a>)</div>
<div class="line"><span class="lineno"> 6416</span>    ) { <span class="comment">// possible --android-shlib</span></div>
<div class="line"><span class="lineno"> 6417</span>        <span class="keywordtype">unsigned</span> x = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">file_image</a>[<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>) - (1+ 4)*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)]);</div>
<div class="line"><span class="lineno"> 6418</span>        <span class="keywordflow">if</span> (1 &amp; x) { <span class="comment">// the clincher</span></div>
<div class="line"><span class="lineno"> 6419</span>            <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = 1;</div>
<div class="line"><span class="lineno"> 6420</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6421</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(   <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 6422</span>            <a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a> = (<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> *)<a class="code hl_variable" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">mb_shdr</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 6423</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>) * <a class="code hl_variable" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">e_shnum</a>);</div>
<div class="line"><span class="lineno"> 6424</span>            yct_off = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>-&gt;sh_offset);  <span class="comment">// for the output file (de-compressed)</span></div>
<div class="line"><span class="lineno"> 6425</span>            <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a> + yct_off;  <span class="comment">// for the input file (compressed)</span></div>
<div class="line"><span class="lineno"> 6426</span>        }</div>
<div class="line"><span class="lineno"> 6427</span>    }</div>
<div class="line"><span class="lineno"> 6428</span> </div>
<div class="line"><span class="lineno"> 6429</span>    <span class="comment">// Decompress first Extent.  Old style covers [0, xct_off)</span></div>
<div class="line"><span class="lineno"> 6430</span>    <span class="comment">// which includes rtld constant data and eXecutable app code below DT_INIT.</span></div>
<div class="line"><span class="lineno"> 6431</span>    <span class="comment">// In old style, the first compressed Extent is redundant</span></div>
<div class="line"><span class="lineno"> 6432</span>    <span class="comment">// except for the compressed original Elf headers.</span></div>
<div class="line"><span class="lineno"> 6433</span>    <span class="comment">// New style covers just Elf headers: the rest below xct_off is</span></div>
<div class="line"><span class="lineno"> 6434</span>    <span class="comment">// rtld constant data: DT_*HASH, DT_SYMTAB, DT_STRTAB, etc.</span></div>
<div class="line"><span class="lineno"> 6435</span>    <span class="comment">// New style puts eXecutable app code in second PT_LOAD</span></div>
<div class="line"><span class="lineno"> 6436</span>    <span class="comment">// in order to mark Elf headers and rtld data as non-eXecutable.</span></div>
<div class="line"><span class="lineno"> 6437</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6438</span>    <span class="keyword">struct </span>{</div>
<div class="line"><span class="lineno"> 6439</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structl__info.html">l_info</a> l;</div>
<div class="line"><span class="lineno"> 6440</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structp__info.html">p_info</a> p;</div>
<div class="line"><span class="lineno"> 6441</span>        <span class="keyword">struct </span><a class="code hl_struct" href="structb__info.html">b_info</a> <a class="code hl_variable" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>;</div>
<div class="line"><span class="lineno"> 6442</span>    } hdr;</div>
<div class="line"><span class="lineno"> 6443</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;hdr, <span class="keyword">sizeof</span>(hdr));</div>
<div class="line"><span class="lineno"> 6444</span>    <span class="keywordflow">if</span> (hdr.l.l_magic != <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a></div>
<div class="line"><span class="lineno"> 6445</span>    ||  <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;hdr.l.l_lsize) != (<span class="keywordtype">unsigned</span>)<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a></div>
<div class="line"><span class="lineno"> 6446</span>    ||  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hdr.p.p_filesize) != <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">u_file_size</a></div>
<div class="line"><span class="lineno"> 6447</span>    ||  <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hdr.b.sz_unc) &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>  <span class="comment">// peek: 1st b_info covers Elf headers</span></div>
<div class="line"><span class="lineno"> 6448</span>    ) {</div>
<div class="line"><span class="lineno"> 6449</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;corrupt l_info/p_info/b_info&quot;</span>);</div>
<div class="line"><span class="lineno"> 6450</span>    }</div>
<div class="line"><span class="lineno"> 6451</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(-(<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code hl_struct" href="structb__info.html">b_info</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>); <span class="comment">// hdr.b_info was a peek</span></div>
<div class="line"><span class="lineno"> 6452</span> </div>
<div class="line"><span class="lineno"> 6453</span><span class="comment">// The default layout for a shared library created by binutils-2.29</span></div>
<div class="line"><span class="lineno"> 6454</span><span class="comment">// (Fedora 28; 2018) has two PT_LOAD: permissions r-x and rw-.</span></div>
<div class="line"><span class="lineno"> 6455</span><span class="comment">// xct_off (the lowest address of executable instructions;</span></div>
<div class="line"><span class="lineno"> 6456</span><span class="comment">// the highest address of read-only data used by rtld (ld-linux))</span></div>
<div class="line"><span class="lineno"> 6457</span><span class="comment">// will be somewhere in the first PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 6458</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6459</span><span class="comment">// The default layout for a shared library created by binutils-2.31</span></div>
<div class="line"><span class="lineno"> 6460</span><span class="comment">// (Fedora 29; 2018) has four PT_LOAD: permissions r--, r-x, r--, rw-.</span></div>
<div class="line"><span class="lineno"> 6461</span><span class="comment">// xct_off will be the base of the second [r-x] PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 6462</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6463</span><span class="comment">// Bytes below xct_off cannot be compressed because they are used</span></div>
<div class="line"><span class="lineno"> 6464</span><span class="comment">// by rtld *before* the UPX run-time de-compression stub gets control</span></div>
<div class="line"><span class="lineno"> 6465</span><span class="comment">// via DT_INIT. Bytes in a Writeable PT_LOAD cannot be compressed</span></div>
<div class="line"><span class="lineno"> 6466</span><span class="comment">// because they may be relocated by rtld, again before stub execution.</span></div>
<div class="line"><span class="lineno"> 6467</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6468</span><span class="comment">// We need to know which layout of PT_LOAD. It seems risky to steal</span></div>
<div class="line"><span class="lineno"> 6469</span><span class="comment">// bits in the input ElfXX_Ehdr or ElfXX_Phdr, so we decompress</span></div>
<div class="line"><span class="lineno"> 6470</span><span class="comment">// the first compressed block.  For an old-style shared library</span></div>
<div class="line"><span class="lineno"> 6471</span><span class="comment">// the first compressed block covers [0, xct_off) which is redundant</span></div>
<div class="line"><span class="lineno"> 6472</span><span class="comment">// with the interval [sz_elf_hdrs, xct_off) because those bytes</span></div>
<div class="line"><span class="lineno"> 6473</span><span class="comment">// must be present for use by rtl  (So that is a large inefficiency.)</span></div>
<div class="line"><span class="lineno"> 6474</span><span class="comment">// Fortunately p_info.p_blocksize fits in ibuf, and unpackExtent</span></div>
<div class="line"><span class="lineno"> 6475</span><span class="comment">// will just decompress it all.  For new style, the first compressed</span></div>
<div class="line"><span class="lineno"> 6476</span><span class="comment">// block covers [0, sz_elf_hdrs).</span></div>
<div class="line"><span class="lineno"> 6477</span> </div>
<div class="line"><span class="lineno"> 6478</span>    <span class="comment">// Peek: unpack into ibuf, but do not write</span></div>
<div class="line"><span class="lineno"> 6479</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_block1 = <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>, <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno"> 6480</span>        c_adler, u_adler, <span class="keyword">false</span>, -1);</div>
<div class="line"><span class="lineno"> 6481</span>    <span class="keywordflow">if</span> (sz_block1 &lt; <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) {</div>
<div class="line"><span class="lineno"> 6482</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;corrupt b_info&quot;</span>);</div>
<div class="line"><span class="lineno"> 6483</span>    }</div>
<div class="line"><span class="lineno"> 6484</span>    <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(o_elfhdrs, <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>); <span class="comment">// save de-compressed Elf headers</span></div>
<div class="line"><span class="lineno"> 6485</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> ehdro = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)o_elfhdrs;</div>
<div class="line"><span class="lineno"> 6486</span>    <span class="keywordflow">if</span> (ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>   !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a></div>
<div class="line"><span class="lineno"> 6487</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a></div>
<div class="line"><span class="lineno"> 6488</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a></div>
<div class="line"><span class="lineno"> 6489</span>        <span class="comment">// less strict for EM_PPC64 to workaround earlier bug</span></div>
<div class="line"><span class="lineno"> 6490</span>    ||  !( ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a>==<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a></div>
<div class="line"><span class="lineno"> 6491</span>        || Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>))</div>
<div class="line"><span class="lineno"> 6492</span>    ||  ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a> !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a></div>
<div class="line"><span class="lineno"> 6493</span>        <span class="comment">// check EI_MAG[0-3], EI_CLASS, EI_DATA, EI_VERSION</span></div>
<div class="line"><span class="lineno"> 6494</span>    ||  <a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(ehdro-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, Elf64_Ehdr::EI_OSABI)) {</div>
<div class="line"><span class="lineno"> 6495</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;ElfXX_Ehdr corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 6496</span>    }</div>
<div class="line"><span class="lineno"> 6497</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6498</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, sz_block1);</div>
<div class="line"><span class="lineno"> 6499</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = sz_block1;</div>
<div class="line"><span class="lineno"> 6500</span>    }</div>
<div class="line"><span class="lineno"> 6501</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *o_phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *)(1+ ehdro);</div>
<div class="line"><span class="lineno"> 6502</span>    <span class="comment">// Handle compressed PT_LOADs (must not have PF_W)</span></div>
<div class="line"><span class="lineno"> 6503</span>    <span class="keywordtype">unsigned</span> not_first_LOAD = 0;</div>
<div class="line"><span class="lineno"> 6504</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++o_phdr) {</div>
<div class="line"><span class="lineno"> 6505</span>        <span class="keywordtype">unsigned</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>);</div>
<div class="line"><span class="lineno"> 6506</span>        <span class="keywordtype">unsigned</span> flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>);</div>
<div class="line"><span class="lineno"> 6507</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> != type || Elf64_Phdr::PF_W &amp; flags) {</div>
<div class="line"><span class="lineno"> 6508</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 6509</span>        }</div>
<div class="line"><span class="lineno"> 6510</span>        <span class="keywordtype">unsigned</span> p_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6511</span>        <span class="keywordtype">unsigned</span> p_filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 6512</span>        <span class="keywordtype">unsigned</span> wanted = p_filesz;</div>
<div class="line"><span class="lineno"> 6513</span>        <span class="keywordflow">if</span> (!not_first_LOAD++) { <span class="comment">// first PT_LOAD</span></div>
<div class="line"><span class="lineno"> 6514</span>            wanted -= sz_block1;</div>
<div class="line"><span class="lineno"> 6515</span>            <span class="keywordflow">if</span> (sz_block1 &gt;  <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) { <span class="comment">// old style</span></div>
<div class="line"><span class="lineno"> 6516</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6517</span>                    <a class="code hl_function" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym</a>(orig_file_size, fo);</div>
<div class="line"><span class="lineno"> 6518</span>                }</div>
<div class="line"><span class="lineno"> 6519</span>                p_offset += sz_block1;</div>
<div class="line"><span class="lineno"> 6520</span>            }</div>
<div class="line"><span class="lineno"> 6521</span>            <span class="keywordflow">if</span> (sz_block1 == <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>) { <span class="comment">// new style</span></div>
<div class="line"><span class="lineno"> 6522</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> len = (yct_off ? yct_off : <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) - <a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>;</div>
<div class="line"><span class="lineno"> 6523</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> ipos = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6524</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6525</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>], len);</div>
<div class="line"><span class="lineno"> 6526</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a>) {</div>
<div class="line"><span class="lineno"> 6527</span>                    <a class="code hl_function" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym</a>(orig_file_size, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 6528</span>                }</div>
<div class="line"><span class="lineno"> 6529</span>                <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6530</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(&amp;<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>], len);</div>
<div class="line"><span class="lineno"> 6531</span>                }</div>
<div class="line"><span class="lineno"> 6532</span>                <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> += len;</div>
<div class="line"><span class="lineno"> 6533</span> </div>
<div class="line"><span class="lineno"> 6534</span><span class="comment">// github-issue629: (overlay_offset = 0xa500), so initially (xct_off = 0xa494).</span></div>
<div class="line"><span class="lineno"> 6535</span><span class="comment">// But &quot;yct_off = get_te64(&amp;shdri-&gt;sh_offset)&quot; so if _Shdrs are aligned (??)</span></div>
<div class="line"><span class="lineno"> 6536</span><span class="comment">// then (0x10500 == (xct_off = asl_delta + yct_off)), and we read+write</span></div>
<div class="line"><span class="lineno"> 6537</span><span class="comment">// more than we need.</span></div>
<div class="line"><span class="lineno"> 6538</span><span class="comment">// So assume the excess just lives there, or is overwritten later by seek+write.</span></div>
<div class="line"><span class="lineno"> 6539</span>                <span class="keywordflow">if</span> (wanted &lt; len) { <span class="comment">// FIXME: why does this happen?</span></div>
<div class="line"><span class="lineno"> 6540</span>                    wanted = 0;</div>
<div class="line"><span class="lineno"> 6541</span>                }</div>
<div class="line"><span class="lineno"> 6542</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6543</span>                    wanted -= len;</div>
<div class="line"><span class="lineno"> 6544</span>                }</div>
<div class="line"><span class="lineno"> 6545</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(ipos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6546</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> == p_filesz) {</div>
<div class="line"><span class="lineno"> 6547</span>                    <span class="keywordflow">continue</span>;   <span class="comment">// already entirely re-generated</span></div>
<div class="line"><span class="lineno"> 6548</span>                }</div>
<div class="line"><span class="lineno"> 6549</span>                p_offset = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 6550</span>            }</div>
<div class="line"><span class="lineno"> 6551</span>        }</div>
<div class="line"><span class="lineno"> 6552</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6553</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(p_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6554</span>        }</div>
<div class="line"><span class="lineno"> 6555</span>        <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(wanted, fo, c_adler, u_adler, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 6556</span>    }</div>
<div class="line"><span class="lineno"> 6557</span>    <a class="code hl_function" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);</div>
<div class="line"><span class="lineno"> 6558</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">tell</a>();</div>
<div class="line"><span class="lineno"> 6559</span> </div>
<div class="line"><span class="lineno"> 6560</span>    <span class="comment">// Handle PT_LOAD with PF_W: writeable, so not compressed.  &quot;Slide&quot;</span></div>
<div class="line"><span class="lineno"> 6561</span>    o_phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *)(1+ ehdro);</div>
<div class="line"><span class="lineno"> 6562</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *i_phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 6563</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; <a class="code hl_variable" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">e_phnum</a>; ++j, ++o_phdr, ++i_phdr) {</div>
<div class="line"><span class="lineno"> 6564</span>        <span class="keywordtype">unsigned</span> type = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_type);</div>
<div class="line"><span class="lineno"> 6565</span>        <span class="keywordtype">unsigned</span> flags = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;o_phdr-&gt;p_flags);</div>
<div class="line"><span class="lineno"> 6566</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a> != type || !(Elf64_Phdr::PF_W &amp; flags)) {</div>
<div class="line"><span class="lineno"> 6567</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 6568</span>        }</div>
<div class="line"><span class="lineno"> 6569</span>        <span class="keywordtype">unsigned</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;p_filesz);</div>
<div class="line"><span class="lineno"> 6570</span>        <span class="keywordtype">unsigned</span> o_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;o_phdr-&gt;p_offset);</div>
<div class="line"><span class="lineno"> 6571</span>        <span class="keywordtype">unsigned</span> i_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;i_phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 6572</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(i_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6573</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 6574</span>        <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> += filesz;</div>
<div class="line"><span class="lineno"> 6575</span>        <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6576</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(o_offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6577</span>            fo-&gt;<a class="code hl_function" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">write</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, filesz);</div>
<div class="line"><span class="lineno"> 6578</span>        }</div>
<div class="line"><span class="lineno"> 6579</span>        <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = filesz + o_offset;  <span class="comment">// high-water mark</span></div>
<div class="line"><span class="lineno"> 6580</span>    }</div>
<div class="line"><span class="lineno"> 6581</span> </div>
<div class="line"><span class="lineno"> 6582</span>    <span class="comment">// Gaps between PT_LOAD will be handled by ::unpack()</span></div>
<div class="line"><span class="lineno"> 6583</span> </div>
<div class="line"><span class="lineno"> 6584</span>    <span class="comment">// position fi at loader offset</span></div>
<div class="line"><span class="lineno"> 6585</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6586</span>}</div>
<div class="ttc" id="aclassPackLinuxElf64_html_ab19e5a4000bc5cc063dee2a31db657e9"><div class="ttname"><a href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">PackLinuxElf64::un_asl_dynsym</a></div><div class="ttdeci">virtual void un_asl_dynsym(unsigned orig_file_size, OutputFile *)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06284">p_lx_elf.cpp:6284</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a4920cc3ff82dcbc60f2a87fdd276d025"><div class="ttname"><a href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a></div><div class="ttdeci">unsigned loader_offset</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00111">p_lx_elf.h:111</a></div></div>
<div class="ttc" id="aclassPackUnix_html_ab16d64e1b95f1dcf5f128665b83660f6"><div class="ttname"><a href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent</a></div><div class="ttdeci">virtual unsigned unpackExtent(unsigned wanted, OutputFile *fo, unsigned &amp;c_adler, unsigned &amp;u_adler, bool first_PF_X, int is_rewrite=false)</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8cpp_source.html#l00470">p_unix.cpp:470</a></div></div>
<div class="ttc" id="aclassPackerBase_html_a4ccd780b4c08de5d2868a0ffbcf1f6f3"><div class="ttname"><a href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a></div><div class="ttdeci">const upx_uint32_t file_size_u32</div><div class="ttdef"><b>Definition:</b> <a href="packer_8h_source.html#l00094">packer.h:94</a></div></div>
<div class="ttc" id="ap__lx__elf_8cpp_html_ae2f3660cdb0ae37f901276a8f136e6a9"><div class="ttname"><a href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a></div><div class="ttdeci">static unsigned funpad4(InputFile *fi)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l00131">p_lx_elf.cpp:131</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a3855471cf08a9e4cd4b898e9a1e11fa4"><div class="ttname"><a href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a></div><div class="ttdeci">Elf64_Word e_version</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00210">bsd.h:210</a></div></div>
<div class="ttc" id="astructElf64__Ehdr_html_a404b7e3566d912b0382cacea17475e92"><div class="ttname"><a href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a></div><div class="ttdeci">Elf64_Half e_ehsize</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00215">bsd.h:215</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="xspan__fwd_8h.html#af71ddeb3e6a1edbdfadd8f044c60fa66">b</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="classPackLinuxElf.html#a3b0f5122457c7d42172531d3cb116f00">PackLinuxElf::e_phnum</a>, <a class="el" href="classPackLinuxElf.html#aaca43f8d44f554de5f8129732f291f2d">PackLinuxElf::e_shnum</a>, <a class="el" href="classPackLinuxElf64.html#a0e16265acea35917d1e57a65fb5ffc70">e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a63fca3f9b273e5fd4d190d9cb7fba9b0">Elf64_Ehdr::e_shoff</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackLinuxElf.html#ad4e3d4f8dd219c66f8a2d78e20ca5df4">PackLinuxElf::file_image</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="classPackerBase.html#a4ccd780b4c08de5d2868a0ffbcf1f6f3">PackerBase::file_size_u32</a>, <a class="el" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="classPackLinuxElf.html#a55541b4f9e0f8f1fe16cb785b093ab1c">PackLinuxElf::mb_shdr</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPackLinuxElf64.html#a43aff2a214341cb27a7f07ec997e443d">shdri</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff">FileBase::tell()</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#ae3a40ba7325ebc8b86301bc9e7c5d3d6">PackHeader::u_file_size</a>, <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>, <a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent()</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="classOutputFile.html#aa8beb793956b90404c940c5821936718">OutputFile::write()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph" id="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_cgraph">
<area shape="rect" title=" " alt="" coords="5,1080,149,1120"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="220,862,353,887"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9" title=" " alt="" coords="249,112,324,138"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="473,112,590,138"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="709,184,815,210"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="467,1591,596,1616"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="697,1212,827,1238"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="697,1534,827,1559"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="202,1654,371,1679"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="245,1727,329,1752"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="247,1800,326,1826"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="470,162,593,187"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="467,1062,595,1087"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="462,1111,601,1136"/>
<area shape="rect" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9" title=" " alt="" coords="215,1290,359,1330"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="697,636,827,662"/>
<area shape="rect" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6" title=" " alt="" coords="197,484,376,510"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1103,786,1193,811"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="493,711,569,736"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="720,586,804,611"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="491,960,572,986"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="424,812,639,838"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="454,862,609,887"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1271,1111,1389,1136"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="687,896,837,936"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="704,384,820,410"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="887,384,1024,410"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="890,434,1021,459"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="927,208,984,234"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="887,686,1023,711"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="885,483,1025,508"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="705,335,819,360"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="687,286,837,311"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="1103,560,1193,586"/>
<area shape="rect" href="classPackLinuxElf64.html#a6b85151ad06f0b457773686f047903f4" title=" " alt="" coords="444,1327,619,1352"/>
<area shape="rect" href="classPackLinuxElf64.html#ad1befccbbdde5d8977b9d2e5883507d4" title=" " alt="" coords="459,1526,604,1566"/>
<area shape="rect" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b" title=" " alt="" coords="459,1262,604,1302"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="460,911,603,936"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="467,1376,595,1402"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="460,1426,603,1451"/>
<area shape="rect" href="classPackLinuxElf64.html#acd825cbaf5a768993a7f0b90a24c7a4c" title=" " alt="" coords="1073,1208,1223,1248"/>
<area shape="rect" href="snprintf_8h.html#a674a04e474d5db68cb6272b9d46940cf" title=" " alt="" coords="729,1338,795,1363"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="888,636,1023,662"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="911,735,1000,760"/>
<area shape="rect" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29" title="decompress" alt="" coords="456,211,607,236"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="456,260,607,286"/>
<area shape="rect" href="classFilter.html#a9ebf9984c147460e8e734225354023df" title=" " alt="" coords="489,310,573,335"/>
<area shape="rect" href="xspan__fwd_8h.html#a8012d8687b040cb0d6a7ad890856cf49" title=" " alt="" coords="485,383,578,408"/>
<area shape="rect" href="classFilter.html#a34aee2c034f2a84b0b8af53287066c1a" title=" " alt="" coords="477,484,586,510"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="711,434,813,459"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph" id="aclassPackLinuxElf64_ad2c315a3286632db9c874ca7a65bb69d_icgraph">
<area shape="rect" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="a4b789474661dc2f8e40182aae29ee479" name="a4b789474661dc2f8e40182aae29ee479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b789474661dc2f8e40182aae29ee479">&#9670;&#160;</a></span>unpack()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::unpack </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generic Unix <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack().">unpack()</a>. </p>
<p>This code looks much like the one in stub/l_linux.c See notes there. </p>

<p>Reimplemented from <a class="el" href="classPackLinuxElf.html#a0d45a89448e9776719f57f84b11f828c">PackLinuxElf</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l07144">7144</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 7145</span>{</div>
<div class="line"><span class="lineno"> 7146</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a> != <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>)) {<span class="comment">// Phdrs not contiguous with Ehdr</span></div>
<div class="line"><span class="lineno"> 7147</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad e_phoff&quot;</span>);</div>
<div class="line"><span class="lineno"> 7148</span>    }</div>
<div class="line"><span class="lineno"> 7149</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> c_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7150</span>    <span class="keywordtype">unsigned</span> u_phnum = 0;</div>
<div class="line"><span class="lineno"> 7151</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> old_dtinit = 0;</div>
<div class="line"><span class="lineno"> 7152</span> </div>
<div class="line"><span class="lineno"> 7153</span>    <span class="keywordflow">if</span> (Elf64_Ehdr::ET_EXEC == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>)) {</div>
<div class="line"><span class="lineno"> 7154</span><span class="comment">// 40fddf17153ee3db73a04ff1bf288b91676138d6 2001-02-01 ph.version 11; b_info 12 bytes</span></div>
<div class="line"><span class="lineno"> 7155</span><span class="comment">// df9db96bd1c013c07da1d7ec740021d588ab2815 2001-01-17 ph.version 11; no b_info (==&gt; 8 bytes)</span></div>
<div class="line"><span class="lineno"> 7156</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">version</a> &lt;= 11</div>
<div class="line"><span class="lineno"> 7157</span>        &amp;&amp;  <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>) &lt; 0x401180</div>
<div class="line"><span class="lineno"> 7158</span>        &amp;&amp;  <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>)==Elf64_Ehdr::EM_X86_64) {</div>
<div class="line"><span class="lineno"> 7159</span>            <span class="comment">// old style, 8-byte b_info:</span></div>
<div class="line"><span class="lineno"> 7160</span>            <span class="comment">// sizeof(b_info.sz_unc) + sizeof(b_info.sz_cpr);</span></div>
<div class="line"><span class="lineno"> 7161</span>            <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> = 2*<span class="keyword">sizeof</span>(unsigned);</div>
<div class="line"><span class="lineno"> 7162</span>        }</div>
<div class="line"><span class="lineno"> 7163</span>    }</div>
<div class="line"><span class="lineno"> 7164</span> </div>
<div class="line"><span class="lineno"> 7165</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7166</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 7167</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> != <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a>)) {</div>
<div class="line"><span class="lineno"> 7168</span>        <a class="code hl_struct" href="structLE32.html">NE32</a> <span class="keyword">const</span> *<span class="keyword">const</span> lp = (<a class="code hl_struct" href="structLE32.html">NE32</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>;</div>
<div class="line"><span class="lineno"> 7169</span>        <span class="comment">// Workaround for bug of extra linfo by some asl_pack2_Shdrs().</span></div>
<div class="line"><span class="lineno"> 7170</span>        <span class="keywordflow">if</span> (0==lp[0] &amp;&amp; 0==lp[1] &amp;&amp; 0==lp[2]) { <span class="comment">// looks like blank extra</span></div>
<div class="line"><span class="lineno"> 7171</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>));</div>
<div class="line"><span class="lineno"> 7172</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a> == <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_magic</a>)) {</div>
<div class="line"><span class="lineno"> 7173</span>                <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> += <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>);</div>
<div class="line"><span class="lineno"> 7174</span>            }</div>
<div class="line"><span class="lineno"> 7175</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7176</span>                <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;l_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7177</span>            }</div>
<div class="line"><span class="lineno"> 7178</span>        }</div>
<div class="line"><span class="lineno"> 7179</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7180</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;l_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7181</span>        }</div>
<div class="line"><span class="lineno"> 7182</span>    }</div>
<div class="line"><span class="lineno"> 7183</span>    <a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a> = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">linfo</a>.<a class="code hl_variable" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_lsize</a>);</div>
<div class="line"><span class="lineno"> 7184</span>    <a class="code hl_struct" href="structp__info.html">p_info</a> hbuf;  <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;hbuf, <span class="keyword">sizeof</span>(hbuf));</div>
<div class="line"><span class="lineno"> 7185</span>    <span class="keywordtype">unsigned</span> orig_file_size = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_filesize</a>);</div>
<div class="line"><span class="lineno"> 7186</span>    <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;hbuf.<a class="code hl_variable" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_blocksize</a>);</div>
<div class="line"><span class="lineno"> 7187</span>    <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="p__lx__elf_8h.html#a68e5abb5d6e413b99c6e37512b057090">u32_t</a>)<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a> &gt; orig_file_size || <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> &gt; orig_file_size</div>
<div class="line"><span class="lineno"> 7188</span>        || !<a class="code hl_function" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid</a>(1, <a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a>, <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>))</div>
<div class="line"><span class="lineno"> 7189</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;p_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7190</span> </div>
<div class="line"><span class="lineno"> 7191</span>    <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">blocksize</a> + <a class="code hl_enumvalue" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">OVERHEAD</a>);</div>
<div class="line"><span class="lineno"> 7192</span>    <a class="code hl_struct" href="structb__info.html">b_info</a> bhdr; <a class="code hl_function" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset</a>(&amp;bhdr, 0, <span class="keyword">sizeof</span>(bhdr));</div>
<div class="line"><span class="lineno"> 7193</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 7194</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7195</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7196</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> &gt; <a class="code hl_variable" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">file_size_u</a> || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> == 0 || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> == 0</div>
<div class="line"><span class="lineno"> 7197</span>    ||  <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> &gt; orig_file_size)</div>
<div class="line"><span class="lineno"> 7198</span>        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;b_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7199</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">filter_cto</a> = bhdr.<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7200</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a> = bhdr.<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;  <span class="comment">// FIXME if multiple de-compressors</span></div>
<div class="line"><span class="lineno"> 7201</span> </div>
<div class="line"><span class="lineno"> 7202</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> u(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a>);</div>
<div class="line"><span class="lineno"> 7203</span>    <a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *<span class="keyword">const</span> ehdr = (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)&amp;u[0];</div>
<div class="line"><span class="lineno"> 7204</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *phdr = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno"> 7205</span>    <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a> = 0;</div>
<div class="line"><span class="lineno"> 7206</span>    <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> = 0;</div>
<div class="line"><span class="lineno"> 7207</span>    <span class="keywordtype">unsigned</span> c_adler = <a class="code hl_function" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><span class="lineno"> 7208</span>    <span class="keywordtype">unsigned</span> u_adler = <a class="code hl_function" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a>(<span class="keyword">nullptr</span>, 0);</div>
<div class="line"><span class="lineno"> 7209</span> </div>
<div class="line"><span class="lineno"> 7210</span>    <span class="keywordtype">unsigned</span> is_shlib = 0;</div>
<div class="line"><span class="lineno"> 7211</span>    <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = 0;</div>
<div class="line"><span class="lineno"> 7212</span>    <a class="code hl_class" href="classMemBuffer.html">MemBuffer</a> o_elfhdrs;</div>
<div class="line"><span class="lineno"> 7213</span>    <a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *<span class="keyword">const</span> dynhdr = <a class="code hl_function" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">elf_find_ptype</a>(Elf64_Phdr::PT_DYNAMIC, <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, c_phnum);</div>
<div class="line"><span class="lineno"> 7214</span>    <span class="comment">// dynseg was set by PackLinuxElf64help1</span></div>
<div class="line"><span class="lineno"> 7215</span>    <span class="keywordflow">if</span> (dynhdr &amp;&amp; !(Elf64_Dyn::DF_1_PIE &amp; <a class="code hl_function" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic</a>(Elf64_Dyn::DT_FLAGS_1))) {</div>
<div class="line"><span class="lineno"> 7216</span>        <span class="comment">// Packed shlib? (ET_DYN without -fPIE)</span></div>
<div class="line"><span class="lineno"> 7217</span>        is_shlib = 1;</div>
<div class="line"><span class="lineno"> 7218</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> = <a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a> - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structl__info.html">l_info</a>);</div>
<div class="line"><span class="lineno"> 7219</span>        u_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7220</span>        o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<a class="code hl_variable" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">sz_elf_hdrs</a>);</div>
<div class="line"><span class="lineno"> 7221</span>        <a class="code hl_function" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1</a>(fo, o_elfhdrs, c_adler, u_adler, orig_file_size);</div>
<div class="line"><span class="lineno"> 7222</span>        *ehdr = <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>;</div>
<div class="line"><span class="lineno"> 7223</span>    }</div>
<div class="line"><span class="lineno"> 7224</span>    <span class="keywordflow">else</span> { <span class="comment">// main executable</span></div>
<div class="line"><span class="lineno"> 7225</span>        <span class="comment">// Uncompress Ehdr and Phdrs: info for control of unpacking</span></div>
<div class="line"><span class="lineno"> 7226</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() &lt; <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>)</div>
<div class="line"><span class="lineno"> 7227</span>            <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 7228</span> </div>
<div class="line"><span class="lineno"> 7229</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>);</div>
<div class="line"><span class="lineno"> 7230</span>        <span class="comment">// &quot;clickhouse&quot; ET_EXEC for amd64 has 0x200000 &lt;= .e_entry</span></div>
<div class="line"><span class="lineno"> 7231</span>        <span class="comment">// instead of 0x400000 that we checked earlier.</span></div>
<div class="line"><span class="lineno"> 7232</span>        <span class="keywordflow">if</span> (8 == <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a></div>
<div class="line"><span class="lineno"> 7233</span>        &amp;&amp;  Elf64_Ehdr::EM_X86_64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a></div>
<div class="line"><span class="lineno"> 7234</span>        &amp;&amp;  Elf64_Ehdr::ET_EXEC   == <a class="code hl_variable" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">e_type</a></div>
<div class="line"><span class="lineno"> 7235</span>        &amp;&amp;  <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> &lt;= <a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a></div>
<div class="line"><span class="lineno"> 7236</span>        ) {</div>
<div class="line"><span class="lineno"> 7237</span>            <span class="keywordtype">unsigned</span> b_method = <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[0];</div>
<div class="line"><span class="lineno"> 7238</span>            <span class="keywordtype">unsigned</span> b_extra  = <a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>[3];</div>
<div class="line"><span class="lineno"> 7239</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="conf_8h.html#a514747381652f1e72fd56d91a406c6e2">M_ZSTD</a> &gt;= b_method &amp;&amp; 0 == b_extra) {</div>
<div class="line"><span class="lineno"> 7240</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>( -(<a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a>)(<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> + <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7241</span>                <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> = 12;</div>
<div class="line"><span class="lineno"> 7242</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 7243</span>                <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">filter_cto</a> = bhdr.<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7244</span>                <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a> = bhdr.<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;  <span class="comment">// FIXME if multiple de-compressors</span></div>
<div class="line"><span class="lineno"> 7245</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>);</div>
<div class="line"><span class="lineno"> 7246</span>            }</div>
<div class="line"><span class="lineno"> 7247</span>        }</div>
<div class="line"><span class="lineno"> 7248</span>        <a class="code hl_function" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">decompress</a>(<a class="code hl_variable" href="classPacker.html#a95d40264330fe966e66718440b450ec8">ibuf</a>, (<a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> *)ehdr, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 7249</span>        <span class="keywordflow">if</span> (ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a>   !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">e_type</a></div>
<div class="line"><span class="lineno"> 7250</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a></div>
<div class="line"><span class="lineno"> 7251</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a>!=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">e_version</a></div>
<div class="line"><span class="lineno"> 7252</span>            <span class="comment">// less strict for EM_PPC64 to workaround earlier bug</span></div>
<div class="line"><span class="lineno"> 7253</span>        ||  !( ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a>==<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">e_flags</a></div>
<div class="line"><span class="lineno"> 7254</span>            || Elf64_Ehdr::EM_PPC64 == <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">e_machine</a>))</div>
<div class="line"><span class="lineno"> 7255</span>        ||  ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a> !=<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">e_ehsize</a></div>
<div class="line"><span class="lineno"> 7256</span>            <span class="comment">// check EI_MAG[0-3], EI_CLASS, EI_DATA, EI_VERSION</span></div>
<div class="line"><span class="lineno"> 7257</span>        ||  <a class="code hl_function" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp</a>(ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>, Elf64_Ehdr::EI_OSABI)) {</div>
<div class="line"><span class="lineno"> 7258</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;ElfXX_Ehdr corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7259</span>        }</div>
<div class="line"><span class="lineno"> 7260</span>        <span class="comment">// Rewind: prepare for data phase</span></div>
<div class="line"><span class="lineno"> 7261</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(- (<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>) (<a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a> + <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a>), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7262</span> </div>
<div class="line"><span class="lineno"> 7263</span>        u_phnum = <a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;ehdr-&gt;<a class="code hl_variable" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">e_phnum</a>);</div>
<div class="line"><span class="lineno"> 7264</span>        <span class="keywordflow">if</span> ((<a class="code hl_function" href="namespaceupx.html#a79bf3f180bc97aea86be54634b455c77">umin</a>(<a class="code hl_variable" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>, <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a>) - <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>))/<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>) &lt; u_phnum) {</div>
<div class="line"><span class="lineno"> 7265</span>            <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;bad compressed e_phnum&quot;</span>);</div>
<div class="line"><span class="lineno"> 7266</span>        }</div>
<div class="line"><span class="lineno"> 7267</span>        o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">alloc</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a>) + u_phnum * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a>));</div>
<div class="line"><span class="lineno"> 7268</span>        <a class="code hl_function" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy</a>(o_elfhdrs, ehdr, o_elfhdrs.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>());</div>
<div class="line"><span class="lineno"> 7269</span> </div>
<div class="line"><span class="lineno"> 7270</span>        <span class="comment">// Decompress each PT_LOAD.</span></div>
<div class="line"><span class="lineno"> 7271</span>        <span class="keywordtype">bool</span> first_PF_X = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7272</span>        phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *) (<span class="keywordtype">void</span> *) (1+ ehdr);  <span class="comment">// uncompressed</span></div>
<div class="line"><span class="lineno"> 7273</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; u_phnum; ++phdr, ++j) {</div>
<div class="line"><span class="lineno"> 7274</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 7275</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7276</span>                <span class="keywordtype">unsigned</span> <span class="keyword">const</span> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7277</span>                <span class="keywordflow">if</span> (fo)</div>
<div class="line"><span class="lineno"> 7278</span>                    fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(offset, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7279</span>                <span class="keywordflow">if</span> (Elf64_Phdr::PF_X &amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">p_flags</a>)) {</div>
<div class="line"><span class="lineno"> 7280</span>                    <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(filesz, fo,</div>
<div class="line"><span class="lineno"> 7281</span>                        c_adler, u_adler, first_PF_X);</div>
<div class="line"><span class="lineno"> 7282</span>                    first_PF_X = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7283</span>                }</div>
<div class="line"><span class="lineno"> 7284</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7285</span>                    <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(filesz, fo,</div>
<div class="line"><span class="lineno"> 7286</span>                        c_adler, u_adler, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 7287</span>                }</div>
<div class="line"><span class="lineno"> 7288</span>            }</div>
<div class="line"><span class="lineno"> 7289</span>        }</div>
<div class="line"><span class="lineno"> 7290</span>    }</div>
<div class="line"><span class="lineno"> 7291</span> </div>
<div class="line"><span class="lineno"> 7292</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> e_entry = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">e_entry</a>);</div>
<div class="line"><span class="lineno"> 7293</span>    <span class="keywordtype">unsigned</span> off_entry = 0;</div>
<div class="line"><span class="lineno"> 7294</span>    phdr = <a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>;</div>
<div class="line"><span class="lineno"> 7295</span>    <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = 0;</div>
<div class="line"><span class="lineno"> 7296</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j=0; j &lt; c_phnum; ++j, ++phdr) {</div>
<div class="line"><span class="lineno"> 7297</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">p_type</a>)) {</div>
<div class="line"><span class="lineno"> 7298</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>);</div>
<div class="line"><span class="lineno"> 7299</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> vaddr  = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">p_vaddr</a>);</div>
<div class="line"><span class="lineno"> 7300</span>            <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> filesz = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr-&gt;<a class="code hl_variable" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">p_filesz</a>);</div>
<div class="line"><span class="lineno"> 7301</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a>) {</div>
<div class="line"><span class="lineno"> 7302</span>                <a class="code hl_variable" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">load_va</a> = vaddr;</div>
<div class="line"><span class="lineno"> 7303</span>            }</div>
<div class="line"><span class="lineno"> 7304</span>            <span class="keywordflow">if</span> ((e_entry - vaddr) &lt; filesz) {</div>
<div class="line"><span class="lineno"> 7305</span>                off_entry = (e_entry - vaddr) + offset;</div>
<div class="line"><span class="lineno"> 7306</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7307</span>            }</div>
<div class="line"><span class="lineno"> 7308</span>        }</div>
<div class="line"><span class="lineno"> 7309</span>    }</div>
<div class="line"><span class="lineno"> 7310</span>    <span class="keywordtype">unsigned</span> d_info[6];</div>
<div class="line"><span class="lineno"> 7311</span>    <span class="keywordtype">unsigned</span> sz_d_info = <span class="keyword">sizeof</span>(d_info);</div>
<div class="line"><span class="lineno"> 7312</span>    <span class="keywordflow">if</span> (!is_shlib) {</div>
<div class="line"><span class="lineno"> 7313</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0].p_flags) &amp; Elf64_Phdr::PF_X) {</div>
<div class="line"><span class="lineno"> 7314</span>            <span class="comment">// Old style, such as upx-3.91 thru upx-3.95</span></div>
<div class="line"><span class="lineno"> 7315</span>            <span class="keywordflow">switch</span> (this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 7316</span>                <span class="keywordflow">default</span>: {</div>
<div class="line"><span class="lineno"> 7317</span>                    <span class="keywordtype">char</span> msg[40]; <a class="code hl_define" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>(msg, <span class="keyword">sizeof</span>(msg),</div>
<div class="line"><span class="lineno"> 7318</span>                        <span class="stringliteral">&quot;Unknown architecture %d&quot;</span>, this-&gt;<a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>);</div>
<div class="line"><span class="lineno"> 7319</span>                    <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(msg);</div>
<div class="line"><span class="lineno"> 7320</span>                }; <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7321</span>                <span class="keywordflow">case</span> Elf64_Ehdr::EM_AARCH64: sz_d_info = 4 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7322</span>                <span class="keywordflow">case</span> Elf64_Ehdr::EM_PPC64:   sz_d_info = 3 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7323</span>                <span class="keywordflow">case</span> Elf64_Ehdr::EM_X86_64:  sz_d_info = 2 * <span class="keyword">sizeof</span>(unsigned); <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7324</span>            }</div>
<div class="line"><span class="lineno"> 7325</span>        }</div>
<div class="line"><span class="lineno"> 7326</span>        <a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a> = off_entry - sz_d_info;</div>
<div class="line"><span class="lineno"> 7327</span>    }</div>
<div class="line"><span class="lineno"> 7328</span> </div>
<div class="line"><span class="lineno"> 7329</span>    <span class="keywordflow">if</span> (0x1000==<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0].p_filesz)  <span class="comment">// detect C_BASE style</span></div>
<div class="line"><span class="lineno"> 7330</span>    &amp;&amp;  0==<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_offset)</div>
<div class="line"><span class="lineno"> 7331</span>    &amp;&amp;  0==<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[0].p_offset)</div>
<div class="line"><span class="lineno"> 7332</span>    &amp;&amp;     <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_filesz) == <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_memsz)) {</div>
<div class="line"><span class="lineno"> 7333</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>[1].p_memsz)), <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);  <span class="comment">// past the loader</span></div>
<div class="line"><span class="lineno"> 7334</span>    }</div>
<div class="line"><span class="lineno"> 7335</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_shlib</div>
<div class="line"><span class="lineno"> 7336</span>    ||  (off_entry + <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a>) + <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_function" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">getPackHeaderSize</a>() + <span class="keyword">sizeof</span>(<a class="code hl_variable" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">overlay_offset</a>))</div>
<div class="line"><span class="lineno"> 7337</span>            &lt; <a class="code hl_function" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4</a>(<a class="code hl_variable" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">file_size</a>)) {</div>
<div class="line"><span class="lineno"> 7338</span>        <span class="comment">// Loader is not at end; skip past it.</span></div>
<div class="line"><span class="lineno"> 7339</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>) {</div>
<div class="line"><span class="lineno"> 7340</span>            <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">loader_offset</a>, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7341</span>        }</div>
<div class="line"><span class="lineno"> 7342</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7343</span>            <a class="code hl_function" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4</a>(<a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>);  <span class="comment">// MATCH01</span></div>
<div class="line"><span class="lineno"> 7344</span>        }</div>
<div class="line"><span class="lineno"> 7345</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(d_info, sz_d_info);</div>
<div class="line"><span class="lineno"> 7346</span>        <span class="keywordflow">if</span> (is_shlib &amp;&amp; 0==old_dtinit) {</div>
<div class="line"><span class="lineno"> 7347</span>            old_dtinit = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;d_info[2 + (0==d_info[0])]);</div>
<div class="line"><span class="lineno"> 7348</span>            <a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> = 1u&amp; <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;d_info[0 + (0==d_info[0])]);</div>
<div class="line"><span class="lineno"> 7349</span>        }</div>
<div class="line"><span class="lineno"> 7350</span>        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(<a class="code hl_variable" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">lsize</a> - sz_d_info, <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7351</span>    }</div>
<div class="line"><span class="lineno"> 7352</span> </div>
<div class="line"><span class="lineno"> 7353</span>    <span class="comment">// The gaps between PT_LOAD and after last PT_LOAD</span></div>
<div class="line"><span class="lineno"> 7354</span>    phdr = (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> <span class="keyword">const</span> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> <span class="keyword">const</span> *)(<span class="keywordtype">void</span> <span class="keyword">const</span> *)o_elfhdrs);</div>
<div class="line"><span class="lineno"> 7355</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> hi_offset(0);</div>
<div class="line"><span class="lineno"> 7356</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; u_phnum; ++j) {</div>
<div class="line"><span class="lineno"> 7357</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>==phdr[j].p_type</div>
<div class="line"><span class="lineno"> 7358</span>        &amp;&amp;  hi_offset &lt; phdr[j].p_offset)</div>
<div class="line"><span class="lineno"> 7359</span>            hi_offset = phdr[j].<a class="code hl_variable" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">p_offset</a>;</div>
<div class="line"><span class="lineno"> 7360</span>    }</div>
<div class="line"><span class="lineno"> 7361</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; u_phnum; ++j) {</div>
<div class="line"><span class="lineno"> 7362</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> = <a class="code hl_function" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap</a>(phdr, j, u_phnum);</div>
<div class="line"><span class="lineno"> 7363</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>) {</div>
<div class="line"><span class="lineno"> 7364</span>            <span class="keywordtype">unsigned</span> <span class="keyword">const</span> where = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_offset) +</div>
<div class="line"><span class="lineno"> 7365</span>                                   <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;phdr[j].p_filesz);</div>
<div class="line"><span class="lineno"> 7366</span>            <span class="keywordflow">if</span> (fo)</div>
<div class="line"><span class="lineno"> 7367</span>                fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(where, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7368</span>            { <span class="comment">// Recover from some piracy [also serves as error tolerance :-) ]</span></div>
<div class="line"><span class="lineno"> 7369</span>              <span class="comment">// Getting past the loader is problematic, due to unintended</span></div>
<div class="line"><span class="lineno"> 7370</span>              <span class="comment">// variances between released versions:</span></div>
<div class="line"><span class="lineno"> 7371</span>              <span class="comment">//   l_info.l_lsize might be rounded up by 8 instead of by 4, and</span></div>
<div class="line"><span class="lineno"> 7372</span>              <span class="comment">//   sz_d_info might have changed.</span></div>
<div class="line"><span class="lineno"> 7373</span>                <a class="code hl_struct" href="structb__info.html">b_info</a> b_peek, *bp = &amp;b_peek;</div>
<div class="line"><span class="lineno"> 7374</span>                <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(bp, <span class="keyword">sizeof</span>(b_peek));</div>
<div class="line"><span class="lineno"> 7375</span>                <a class="code hl_typedef" href="conf_8h.html#a7e40dc9a8b2c00d7675df0cd2bd7c91e">upx_off_t</a> pos = <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(-(<a class="code hl_typedef" href="bsd_8h.html#af83497edef361523a95b06deda0b4c2d">off_t</a>)<span class="keyword">sizeof</span>(b_peek), <a class="code hl_define" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>);</div>
<div class="line"><span class="lineno"> 7376</span>                <span class="keywordtype">unsigned</span> sz_unc = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7377</span>                <span class="keywordtype">unsigned</span> sz_cpr = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7378</span>                <span class="keywordtype">unsigned</span> word3  = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>);</div>
<div class="line"><span class="lineno"> 7379</span>                <span class="keywordtype">unsigned</span> method = bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>;</div>
<div class="line"><span class="lineno"> 7380</span>                <span class="keywordtype">unsigned</span> ftid = bp-&gt;<a class="code hl_variable" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_ftid</a>;</div>
<div class="line"><span class="lineno"> 7381</span>                <span class="keywordtype">unsigned</span> cto8 = bp-&gt;<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7382</span>                <span class="keywordflow">if</span> (!( ((sz_cpr == sz_unc) &amp;&amp; (0 == word3) &amp;&amp; (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> == sz_unc)) <span class="comment">// incompressible literal</span></div>
<div class="line"><span class="lineno"> 7383</span>                    || ((sz_cpr &lt;  sz_unc) &amp;&amp; (method == <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a>) &amp;&amp; (0 == ftid) &amp;&amp; (0 == cto8)))</div>
<div class="line"><span class="lineno"> 7384</span>                ) {</div>
<div class="line"><span class="lineno"> 7385</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode++;</div>
<div class="line"><span class="lineno"> 7386</span>                    <a class="code hl_function" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a>(<span class="stringliteral">&quot;bad b_info at %#zx&quot;</span>, (<span class="keywordtype">size_t</span>)pos);</div>
<div class="line"><span class="lineno"> 7387</span>                    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> N_PEEK(16 * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)), H_PEEK(N_PEEK &gt;&gt; 1);</div>
<div class="line"><span class="lineno"> 7388</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> peek_arr[N_PEEK];</div>
<div class="line"><span class="lineno"> 7389</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos - H_PEEK, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7390</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(peek_arr, <span class="keyword">sizeof</span>(peek_arr));</div>
<div class="line"><span class="lineno"> 7391</span>                    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7392</span>                    <span class="keywordtype">bool</span> <span class="keyword">const</span> is_be = ELFDATA2MSB == <a class="code hl_variable" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>.<a class="code hl_variable" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">e_ident</a>[EI_DATA];</div>
<div class="line"><span class="lineno"> 7393</span>                    <span class="keywordflow">if</span> (is_be) {</div>
<div class="line"><span class="lineno"> 7394</span>                        <span class="comment">// Does the right thing for sz_unc and sz_cpr,</span></div>
<div class="line"><span class="lineno"> 7395</span>                        <span class="comment">// but swaps b_method and b_extra.  Need find_be32() :-)</span></div>
<div class="line"><span class="lineno"> 7396</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; N_PEEK; k += <span class="keyword">sizeof</span>(int)) {</div>
<div class="line"><span class="lineno"> 7397</span>                            <a class="code hl_function" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32</a>(&amp;peek_arr[k], <a class="code hl_function" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32</a>(&amp;peek_arr[k]));</div>
<div class="line"><span class="lineno"> 7398</span>                        }</div>
<div class="line"><span class="lineno"> 7399</span>                    }</div>
<div class="line"><span class="lineno"> 7400</span>                    <span class="keywordtype">int</span> boff = <a class="code hl_function" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32</a>(peek_arr, <span class="keyword">sizeof</span>(peek_arr), <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>);</div>
<div class="line"><span class="lineno"> 7401</span>                    <span class="keywordflow">if</span> (boff &lt; 0</div>
<div class="line"><span class="lineno"> 7402</span>                    || <span class="keyword">sizeof</span>(peek_arr) &lt; (boff + <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structb__info.html">b_info</a>))) {</div>
<div class="line"><span class="lineno"> 7403</span>                        <a class="code hl_function" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack</a>(<span class="stringliteral">&quot;b_info corrupted&quot;</span>);</div>
<div class="line"><span class="lineno"> 7404</span>                    }</div>
<div class="line"><span class="lineno"> 7405</span>                    bp = (<a class="code hl_struct" href="structb__info.html">b_info</a> *)(<span class="keywordtype">void</span> *)&amp;peek_arr[boff];</div>
<div class="line"><span class="lineno"> 7406</span> </div>
<div class="line"><span class="lineno"> 7407</span>                    sz_unc = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7408</span>                    sz_cpr = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7409</span>                    word3  = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>);</div>
<div class="line"><span class="lineno"> 7410</span>                    ftid = bp-&gt;<a class="code hl_variable" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_ftid</a>;</div>
<div class="line"><span class="lineno"> 7411</span>                    cto8 = bp-&gt;<a class="code hl_variable" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_cto8</a>;</div>
<div class="line"><span class="lineno"> 7412</span>                    <span class="keywordflow">if</span> (0 &lt;= boff  <span class="comment">// found</span></div>
<div class="line"><span class="lineno"> 7413</span>                    &amp;&amp; ( ((sz_cpr == sz_unc) &amp;&amp; (0 == word3) &amp;&amp; (<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> == sz_unc)) <span class="comment">// incompressible literal</span></div>
<div class="line"><span class="lineno"> 7414</span>                      || ((sz_cpr &lt;  sz_unc) &amp;&amp; (0 == ftid) &amp;&amp; (0 == cto8)</div>
<div class="line"><span class="lineno"> 7415</span>                          &amp;&amp; ((is_be ? bp-&gt;b_extra : bp-&gt;<a class="code hl_variable" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_method</a>) == <a class="code hl_variable" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">prev_method</a>)) )</div>
<div class="line"><span class="lineno"> 7416</span>                    ) {</div>
<div class="line"><span class="lineno"> 7417</span>                        pos -= H_PEEK;</div>
<div class="line"><span class="lineno"> 7418</span>                        pos += boff;</div>
<div class="line"><span class="lineno"> 7419</span>                        <a class="code hl_function" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a>(<span class="stringliteral">&quot;... recovery at %#zx&quot;</span>, (<span class="keywordtype">size_t</span>)pos);</div>
<div class="line"><span class="lineno"> 7420</span>                        <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">seek</a>(pos, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 7421</span>                    }</div>
<div class="line"><span class="lineno"> 7422</span>                    <a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;info_mode--;</div>
<div class="line"><span class="lineno"> 7423</span>                }</div>
<div class="line"><span class="lineno"> 7424</span>            }</div>
<div class="line"><span class="lineno"> 7425</span>            <a class="code hl_function" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">unpackExtent</a>(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>, fo,</div>
<div class="line"><span class="lineno"> 7426</span>                c_adler, u_adler, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 7427</span>                is_shlib &amp;&amp; ((phdr[j].p_offset != hi_offset)));</div>
<div class="line"><span class="lineno"> 7428</span>                <span class="comment">// FIXME: should not depend on is_shlib ?</span></div>
<div class="line"><span class="lineno"> 7429</span>        }</div>
<div class="line"><span class="lineno"> 7430</span>    }</div>
<div class="line"><span class="lineno"> 7431</span> </div>
<div class="line"><span class="lineno"> 7432</span>    <span class="comment">// check for end-of-file</span></div>
<div class="line"><span class="lineno"> 7433</span>    <a class="code hl_variable" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">fi</a>-&gt;<a class="code hl_function" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">readx</a>(&amp;bhdr, <a class="code hl_variable" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">szb_info</a>);</div>
<div class="line"><span class="lineno"> 7434</span>    <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_unc = <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_function" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">get_te32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">sz_unc</a>);</div>
<div class="line"><span class="lineno"> 7435</span> </div>
<div class="line"><span class="lineno"> 7436</span>    <span class="keywordflow">if</span> (sz_unc == 0) { <span class="comment">// uncompressed size 0 -&gt; EOF</span></div>
<div class="line"><span class="lineno"> 7437</span>        <span class="comment">// note: magic is always stored le32</span></div>
<div class="line"><span class="lineno"> 7438</span>        <span class="keywordtype">unsigned</span> <span class="keyword">const</span> sz_cpr = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(&amp;bhdr.<a class="code hl_variable" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">sz_cpr</a>);</div>
<div class="line"><span class="lineno"> 7439</span>        <span class="keywordflow">if</span> (sz_cpr != <a class="code hl_define" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>)  <span class="comment">// sz_cpr must be h-&gt;magic</span></div>
<div class="line"><span class="lineno"> 7440</span>            <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 7441</span>    }</div>
<div class="line"><span class="lineno"> 7442</span>    <span class="keywordflow">else</span> { <span class="comment">// extra bytes after end?</span></div>
<div class="line"><span class="lineno"> 7443</span>        <a class="code hl_function" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a>();</div>
<div class="line"><span class="lineno"> 7444</span>    }</div>
<div class="line"><span class="lineno"> 7445</span> </div>
<div class="line"><span class="lineno"> 7446</span>    <span class="keywordflow">if</span> (is_shlib) {</div>
<div class="line"><span class="lineno"> 7447</span>        <a class="code hl_function" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT</a>(old_dtinit, (<a class="code hl_struct" href="structElf64__Phdr.html">Elf64_Phdr</a> *)(1+ (<a class="code hl_struct" href="structElf64__Ehdr.html">Elf64_Ehdr</a> *)(<span class="keywordtype">void</span> *)o_elfhdrs), dynhdr, fo);</div>
<div class="line"><span class="lineno"> 7448</span>    }</div>
<div class="line"><span class="lineno"> 7449</span> </div>
<div class="line"><span class="lineno"> 7450</span>    <span class="comment">// update header with totals</span></div>
<div class="line"><span class="lineno"> 7451</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">c_len</a> = <a class="code hl_variable" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">total_in</a>;</div>
<div class="line"><span class="lineno"> 7452</span>    <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">u_len</a> = <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a>;</div>
<div class="line"><span class="lineno"> 7453</span> </div>
<div class="line"><span class="lineno"> 7454</span>    <span class="comment">// all bytes must be written</span></div>
<div class="line"><span class="lineno"> 7455</span>    <span class="keywordflow">if</span> (fo &amp;&amp; <a class="code hl_variable" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">total_out</a> != orig_file_size)</div>
<div class="line"><span class="lineno"> 7456</span>        <a class="code hl_function" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException</a>();</div>
<div class="line"><span class="lineno"> 7457</span> </div>
<div class="line"><span class="lineno"> 7458</span>    <span class="comment">// finally test the checksums</span></div>
<div class="line"><span class="lineno"> 7459</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">c_adler</a> != c_adler || <a class="code hl_variable" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">ph</a>.<a class="code hl_variable" href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">u_adler</a> != u_adler)</div>
<div class="line"><span class="lineno"> 7460</span>        <a class="code hl_function" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError</a>();</div>
<div class="line"><span class="lineno"> 7461</span>}</div>
<div class="ttc" id="abele_8h_html_a16e4a11a30290f102ab4d44df1e0547d"><div class="ttname"><a href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_be32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00315">bele.h:315</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_a03c843122a8d3e44da9fe458643c2589"><div class="ttname"><a href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">PackLinuxElf64::un_DT_INIT</a></div><div class="ttdeci">virtual void un_DT_INIT(unsigned old_dtinit, Elf64_Phdr const *phdro, Elf64_Phdr const *dynhdr, OutputFile *fo)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06967">p_lx_elf.cpp:6967</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_ad2c315a3286632db9c874ca7a65bb69d"><div class="ttname"><a href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">PackLinuxElf64::un_shlib_1</a></div><div class="ttdeci">virtual void un_shlib_1(OutputFile *const fo, MemBuffer &amp;o_elfhdrs, unsigned &amp;c_adler, unsigned &amp;u_adler, unsigned const orig_file_size)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l06388">p_lx_elf.cpp:6388</a></div></div>
<div class="ttc" id="aclassPackLinuxElf64_html_af746b688a3b13d3bf0895095ae5c3212"><div class="ttname"><a href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">PackLinuxElf64::elf_find_ptype</a></div><div class="ttdeci">Elf64_Phdr const * elf_find_ptype(unsigned type, Elf64_Phdr const *phdr0, unsigned phnum)</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8cpp_source.html#l02289">p_lx_elf.cpp:2289</a></div></div>
<div class="ttc" id="aclassPackLinuxElf_html_a691359a24fbf2963d4ac5f625dd0299c"><div class="ttname"><a href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">PackLinuxElf::prev_method</a></div><div class="ttdeci">unsigned char prev_method</div><div class="ttdef"><b>Definition:</b> <a href="p__lx__elf_8h_source.html#l00117">p_lx_elf.h:117</a></div></div>
<div class="ttc" id="aclassPackUnix_html_a05a8d9222b7627fa48786c128340b0c0"><div class="ttname"><a href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">PackUnix::szb_info</a></div><div class="ttdeci">unsigned szb_info</div><div class="ttdef"><b>Definition:</b> <a href="p__unix_8h_source.html#l00105">p_unix.h:105</a></div></div>
<div class="ttc" id="aclassPacker_html_ab53d9fc8308aa5467d38425ad3673b29"><div class="ttname"><a href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">Packer::decompress</a></div><div class="ttdeci">void decompress(SPAN_P(const byte) in, SPAN_P(byte) out, bool verify_checksum=true, Filter *ft=nullptr)</div><div class="ttdoc">decompress</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00305">packer.cpp:305</a></div></div>
<div class="ttc" id="acompress_8cpp_html_ac78c1624c94e1e6b82fc6d9882285671"><div class="ttname"><a href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32</a></div><div class="ttdeci">unsigned upx_adler32(const void *buf, unsigned len, unsigned adler)</div><div class="ttdef"><b>Definition:</b> <a href="compress_8cpp_source.html#l00035">compress.cpp:35</a></div></div>
<div class="ttc" id="aconf_8h_html_a514747381652f1e72fd56d91a406c6e2"><div class="ttname"><a href="conf_8h.html#a514747381652f1e72fd56d91a406c6e2">M_ZSTD</a></div><div class="ttdeci">#define M_ZSTD</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00601">conf.h:601</a></div></div>
<div class="ttc" id="aconf_8h_html_ad8f1b4770ed40d94738e95587f35d75e"><div class="ttname"><a href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning</a></div><div class="ttdeci">void void void infoWarning(const char *format,...) attribute_format(1</div></div>
<div class="ttc" id="aexcept_8cpp_html_a3b79341230572b77353447647a3cd498"><div class="ttname"><a href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation</a></div><div class="ttdeci">void throwCompressedDataViolation()</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00122">except.cpp:122</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a75193d7ea3127c37580a384eca372630"><div class="ttname"><a href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError</a></div><div class="ttdeci">void throwChecksumError()</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00120">except.cpp:120</a></div></div>
<div class="ttc" id="astructLE32_html"><div class="ttname"><a href="structLE32.html">LE32</a></div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00756">bele.h:756</a></div></div>
<div class="ttc" id="astructPackHeader_html_a4b3ba8dce6c3cc4eb44a412fd743125c"><div class="ttname"><a href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">PackHeader::u_adler</a></div><div class="ttdeci">unsigned u_adler</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00056">packhead.h:56</a></div></div>
<div class="ttc" id="astructPackHeader_html_abe9892837b086ae9e9d52c06e4ccffdb"><div class="ttname"><a href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">PackHeader::getPackHeaderSize</a></div><div class="ttdeci">int getPackHeaderSize() const</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8cpp_source.html#l00070">packhead.cpp:70</a></div></div>
<div class="ttc" id="astructPackHeader_html_af3810d94cc6ec509ce906269114169f9"><div class="ttname"><a href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">PackHeader::filter_cto</a></div><div class="ttdeci">int filter_cto</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00060">packhead.h:60</a></div></div>
<div class="ttc" id="astructPackHeader_html_af8203b5d7f51a8fb27e917c9d571087b"><div class="ttname"><a href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">PackHeader::c_adler</a></div><div class="ttdeci">unsigned c_adler</div><div class="ttdef"><b>Definition:</b> <a href="packhead_8h_source.html#l00057">packhead.h:57</a></div></div>
<div class="ttc" id="astructb__info_html_a420b07fc7e6c56d5f59a6b169dfc1b6f"><div class="ttname"><a href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_info::b_cto8</a></div><div class="ttdeci">unsigned char b_cto8</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00327">bsd.h:327</a></div></div>
<div class="ttc" id="astructb__info_html_ab0002ff09884ac6ed5137f678d9ca865"><div class="ttname"><a href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a></div><div class="ttdeci">unsigned char b_method</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00325">bsd.h:325</a></div></div>
<div class="ttc" id="astructb__info_html_add96d538b23e18c8ab3223c184fd7960"><div class="ttname"><a href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a></div><div class="ttdeci">uint32_t sz_unc</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00323">bsd.h:323</a></div></div>
<div class="ttc" id="astructb__info_html_ae26f59906590a2fff73341fe397993d2"><div class="ttname"><a href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_info::b_ftid</a></div><div class="ttdeci">unsigned char b_ftid</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00326">bsd.h:326</a></div></div>
<div class="ttc" id="autil_8cpp_html_aa692c787bee35bf08628018de7aa42d1"><div class="ttname"><a href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid</a></div><div class="ttdeci">bool mem_size_valid(upx_uint64_t element_size, upx_uint64_t n, upx_uint64_t extra1, upx_uint64_t extra2) noexcept</div><div class="ttdoc">upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma...</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00056">util.cpp:56</a></div></div>
<div class="ttc" id="autil_8cpp_html_aca065128666a7d8af5864a1fc875c156"><div class="ttname"><a href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32</a></div><div class="ttdeci">int find_le32(const void *b, int blen, unsigned what) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00709">util.cpp:709</a></div></div>
<div class="ttc" id="axspan__impl__common_8h_html_a60304b65bf89363bcc3165d3cde67f86"><div class="ttname"><a href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="xspan__impl__common_8h_source.html#l00460">xspan_impl_common.h:460</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5">MemBuffer::alloc()</a>, <a class="el" href="structb__info.html#a420b07fc7e6c56d5f59a6b169dfc1b6f">b_info::b_cto8</a>, <a class="el" href="structb__info.html#ae26f59906590a2fff73341fe397993d2">b_info::b_ftid</a>, <a class="el" href="structb__info.html#ab0002ff09884ac6ed5137f678d9ca865">b_info::b_method</a>, <a class="el" href="classPackUnix.html#a3408c180ca78a03f0c06da6c8c25dc34">PackUnix::blocksize</a>, <a class="el" href="structPackHeader.html#af8203b5d7f51a8fb27e917c9d571087b">PackHeader::c_adler</a>, <a class="el" href="structPackHeader.html#a448fca0da6280454a321894c7eb29e79">PackHeader::c_len</a>, <a class="el" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29">Packer::decompress()</a>, <a class="el" href="structElf64__Ehdr.html#a404b7e3566d912b0382cacea17475e92">Elf64_Ehdr::e_ehsize</a>, <a class="el" href="structElf64__Ehdr.html#a943c7d038a3cc3c1115e84b4cd19966d">Elf64_Ehdr::e_entry</a>, <a class="el" href="structElf64__Ehdr.html#ae6ea9e821472d35e7d2c446fa79bdc3a">Elf64_Ehdr::e_flags</a>, <a class="el" href="structElf64__Ehdr.html#a6c07667c1adfd724637d66535c3ffed0">Elf64_Ehdr::e_ident</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#adecc8b3641e23794f39c78f15ab8c809">Elf64_Ehdr::e_machine</a>, <a class="el" href="structElf64__Ehdr.html#af13bac5685d725c2ba9930c1176f3082">Elf64_Ehdr::e_phnum</a>, <a class="el" href="classPackLinuxElf64.html#a0d71085c7179ef591535acdc5347e2dd">e_phoff</a>, <a class="el" href="classPackLinuxElf.html#aaf175264167b93a8ce865a34937584e6">PackLinuxElf::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a031210e6571dad798c4ed66b85631d58">Elf64_Ehdr::e_type</a>, <a class="el" href="structElf64__Ehdr.html#a3855471cf08a9e4cd4b898e9a1e11fa4">Elf64_Ehdr::e_version</a>, <a class="el" href="classPackLinuxElf64.html#ad10baff449a3519d7386cf0519374a15">ehdri</a>, <a class="el" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212">elf_find_ptype()</a>, <a class="el" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22">elf_unsigned_dynamic()</a>, <a class="el" href="classPackerBase.html#a0306ca7a6b44bd2b88bda7eefa46d49b">PackerBase::fi</a>, <a class="el" href="classPackerBase.html#ace3319e7b055b7328edc18f48dba58db">PackerBase::file_size</a>, <a class="el" href="classPackerBase.html#ac91973d9b4ba31e291970a8a058f6b07">PackerBase::file_size_u</a>, <a class="el" href="structPackHeader.html#af3810d94cc6ec509ce906269114169f9">PackHeader::filter_cto</a>, <a class="el" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156">find_le32()</a>, <a class="el" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663">find_LOAD_gap()</a>, <a class="el" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9">funpad4()</a>, <a class="el" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d">get_be32()</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01">Packer::get_te32()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb">PackHeader::getPackHeaderSize()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classPacker.html#a95d40264330fe966e66718440b450ec8">Packer::ibuf</a>, <a class="el" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e">infoWarning()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="structl__info.html#aa0f743c0ef6a36494c5ad64218a6a86f">l_info::l_lsize</a>, <a class="el" href="structl__info.html#aa0149de209589df53c7af51a2fb2eba6">l_info::l_magic</a>, <a class="el" href="classPackUnix.html#a8a994baf32174356ff73af67ad5d15ba">PackUnix::linfo</a>, <a class="el" href="classPackLinuxElf.html#aa692858672c20488c367295681b28422">PackLinuxElf::load_va</a>, <a class="el" href="classPackLinuxElf.html#a4920cc3ff82dcbc60f2a87fdd276d025">PackLinuxElf::loader_offset</a>, <a class="el" href="classPackUnix.html#a914345298d86f797a6c960ca80afdeb7">PackUnix::lsize</a>, <a class="el" href="conf_8h.html#a514747381652f1e72fd56d91a406c6e2">M_ZSTD</a>, <a class="el" href="p__lx__elf_8cpp.html#a5c15cec3b8e2056be6bf0b188bae4f82">MAX_ELF_HDR_64</a>, <a class="el" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1">mem_size_valid()</a>, <a class="el" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350">memcmp()</a>, <a class="el" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d">memcpy()</a>, <a class="el" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c">memset()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="classPackUnix.html#a1f6547d32f13116f4f888f8f359cdbefa9c7d919a961d9dd49460cbebeb4f9b73">PackUnix::OVERHEAD</a>, <a class="el" href="classPackUnix.html#aa3e227135d766557eb3e012e610d72a0">PackUnix::overlay_offset</a>, <a class="el" href="structp__info.html#a461ce9b60cfbb8fa0faab3b7e404c702">p_info::p_blocksize</a>, <a class="el" href="structp__info.html#a3e64e0c2a5d0c4ddb7ddbd6aab7c1bb0">p_info::p_filesize</a>, <a class="el" href="structElf64__Phdr.html#af50e5756da2acda5ccb02ebaa3367092">Elf64_Phdr::p_filesz</a>, <a class="el" href="structElf64__Phdr.html#ab96e7784733c2192a76d5a42897cb38b">Elf64_Phdr::p_flags</a>, <a class="el" href="structElf64__Phdr.html#aa2d51fb4517ded0c74903f8d0c9abea7">Elf64_Phdr::p_offset</a>, <a class="el" href="structElf64__Phdr.html#aee6ec430eaaf8b8faf82ae6397282cb3">Elf64_Phdr::p_type</a>, <a class="el" href="structElf64__Phdr.html#a5c69879e1229b175020ff011af46fcb9">Elf64_Phdr::p_vaddr</a>, <a class="el" href="classPackerBase.html#a01f3c918e5ce5b4de630d11c703cec05">PackerBase::ph</a>, <a class="el" href="classPackLinuxElf64.html#aa11131540dea71d341de36cf39325c17">phdri</a>, <a class="el" href="classPackLinuxElf.html#a691359a24fbf2963d4ac5f625dd0299c">PackLinuxElf::prev_method</a>, <a class="el" href="p__lx__elf_8cpp.html#a487f2c5bedc799066863f22832798bd8">PT_LOAD64</a>, <a class="el" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232">InputFile::readx()</a>, <a class="el" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9">InputFile::seek()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a4c8d0b76b470ba65a43ca46a88320f39">SEEK_CUR</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5">set_le32()</a>, <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size()</a>, <a class="el" href="snprintf_8h.html#aa367b75c5aed883fef5befbdf04835a4">snprintf</a>, <a class="el" href="structb__info.html#a29bbf0f18e0c39a8f826067d7ed80602">b_info::sz_cpr</a>, <a class="el" href="classPackLinuxElf.html#ac334df9f0f0666906d1b49d1d45be792">PackLinuxElf::sz_elf_hdrs</a>, <a class="el" href="structb__info.html#add96d538b23e18c8ab3223c184fd7960">b_info::sz_unc</a>, <a class="el" href="classPackUnix.html#a05a8d9222b7627fa48786c128340b0c0">PackUnix::szb_info</a>, <a class="el" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3">throwCantUnpack()</a>, <a class="el" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630">throwChecksumError()</a>, <a class="el" href="except_8cpp.html#a3b79341230572b77353447647a3cd498">throwCompressedDataViolation()</a>, <a class="el" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762">throwEOFException()</a>, <a class="el" href="classPackUnix.html#a614b94da58152b4585040e30a72a0de3">PackUnix::total_in</a>, <a class="el" href="classPackUnix.html#aeb3e459ee90ee28853a76401b8145123">PackUnix::total_out</a>, <a class="el" href="structPackHeader.html#a4b3ba8dce6c3cc4eb44a412fd743125c">PackHeader::u_adler</a>, <a class="el" href="structPackHeader.html#a1115672eeb2a2bb05760ce5c7fc0b5cf">PackHeader::u_len</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>, <a class="el" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6">PackUnix::unpackExtent()</a>, <a class="el" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a">up4()</a>, <a class="el" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671">upx_adler32()</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, <a class="el" href="conf_8h.html#a2ce9aaa3ef74889b5352e4a6025db5bc">UPX_MAGIC_LE32</a>, <a class="el" href="structPackHeader.html#ae01f8532b828892b503c900efe3b7f6f">PackHeader::version</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph" id="aclassPackLinuxElf64_a4b789474661dc2f8e40182aae29ee479_cgraph">
<area shape="rect" title="Generic Unix unpack()." alt="" coords="5,1425,180,1450"/>
<area shape="rect" href="classMemBuffer.html#a440e8db9c9010226d9778185f66529f5" title=" " alt="" coords="444,426,577,451"/>
<area shape="rect" href="xspan__fwd_8h.html#a4ffffab0dc6ead4a09af1dba0b85f71c" title=" " alt="" coords="687,701,763,726"/>
<area shape="rect" href="classPacker.html#ab53d9fc8308aa5467d38425ad3673b29" title="decompress" alt="" coords="650,1475,801,1501"/>
<area shape="rect" href="except_8cpp.html#aeec259360ad810df576d7012b3f054f3" title="decompression" alt="" coords="1176,1067,1315,1093"/>
<area shape="rect" href="except_8cpp.html#a75193d7ea3127c37580a384eca372630" title=" " alt="" coords="1166,1605,1325,1630"/>
<area shape="rect" href="except_8cpp.html#a3b79341230572b77353447647a3cd498" title=" " alt="" coords="1131,1734,1360,1759"/>
<area shape="rect" href="compress_8cpp.html#ac78c1624c94e1e6b82fc6d9882285671" title=" " alt="" coords="1194,1475,1297,1501"/>
<area shape="rect" href="classPackLinuxElf64.html#af746b688a3b13d3bf0895095ae5c3212" title=" " alt="" coords="228,1728,373,1768"/>
<area shape="rect" href="classPacker.html#a47a54fc63360923941cec0aa6060ae01" title=" " alt="" coords="661,1678,790,1703"/>
<area shape="rect" href="classPackLinuxElf64.html#a4204f3ad0b4eff8655e10f62ac640a22" title=" " alt="" coords="435,679,586,719"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="902,841,1031,866"/>
<area shape="rect" href="util_8cpp.html#aca065128666a7d8af5864a1fc875c156" title=" " alt="" coords="260,1374,341,1399"/>
<area shape="rect" href="xspan__fwd_8h.html#a1a9f236758b0df388ddf70ed0e05e350" title=" " alt="" coords="683,1598,767,1623"/>
<area shape="rect" href="bele_8h.html#ab07367b17d1a80bb3cd4eeb48b4fdde5" title=" " alt="" coords="472,895,549,921"/>
<area shape="rect" href="classPackLinuxElf64.html#a6c77e1df704fbb16e2d048937bdb0663" title=" " alt="" coords="435,1779,587,1819"/>
<area shape="rect" href="p__lx__elf_8cpp.html#ae2f3660cdb0ae37f901276a8f136e6a9" title=" " alt="" coords="473,174,548,199"/>
<area shape="rect" href="classInputFile.html#aa76b4db751f0d4ad6c47e93fa676d4a9" title=" " alt="" coords="667,71,784,97"/>
<area shape="rect" href="bele_8h.html#a16e4a11a30290f102ab4d44df1e0547d" title=" " alt="" coords="259,2046,342,2071"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="261,2095,340,2121"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="446,1301,575,1326"/>
<area shape="rect" href="structPackHeader.html#abe9892837b086ae9e9d52c06e4ccffdb" title=" " alt="" coords="851,22,1083,47"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="650,1525,801,1550"/>
<area shape="rect" href="conf_8h.html#ad8f1b4770ed40d94738e95587f35d75e" title=" " alt="" coords="251,2145,351,2170"/>
<area shape="rect" href="util_8cpp.html#aa692c787bee35bf08628018de7aa42d1" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="237,2194,365,2219"/>
<area shape="rect" href="xspan__fwd_8h.html#a9cf3296ee41855b4ced7b3bdfcaf8e5d" title=" " alt="" coords="471,1374,550,1399"/>
<area shape="rect" href="classInputFile.html#a6fad8c9902f939edfcb0e48ee8379232" title=" " alt="" coords="664,1061,787,1086"/>
<area shape="rect" href="except_8cpp.html#ab8961782cfe1b9b4f96796b45672f762" title=" " alt="" coords="892,1231,1041,1257"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="447,223,575,249"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="277,2243,325,2269"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="229,476,373,516"/>
<area shape="rect" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d" title=" " alt="" coords="229,1011,373,1051"/>
<area shape="rect" href="classPackUnix.html#ab16d64e1b95f1dcf5f128665b83660f6" title=" " alt="" coords="421,1149,600,1174"/>
<area shape="rect" href="p__lx__elf_8cpp.html#a7236f968e16474ded809aa6b9f98452a" title=" " alt="" coords="277,2293,324,2318"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1408,299,1497,325"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="683,475,767,501"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="685,627,766,653"/>
<area shape="rect" href="except_8cpp.html#aeb9d9ec181d4be714e0df2daca9282e4" title=" " alt="" coords="1138,1313,1353,1338"/>
<area shape="rect" href="membuffer_8cpp.html#ad685ec5d5046285ebbbceba6f869f3b5" title="bool use_simple_mcheck()" alt="" coords="648,426,803,451"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1545,1067,1664,1093"/>
<area shape="rect" href="packhead_8cpp.html#a9bc7fbed8b0117cf25aae706dff178cb" title="ph decompress util" alt="" coords="905,1475,1029,1501"/>
<area shape="rect" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5" title=" " alt="" coords="653,751,798,791"/>
<area shape="rect" href="util_8cpp.html#a579960b01d469d1969571dcf757871bc" title="find and mem_replace util" alt="" coords="487,1526,534,1551"/>
<area shape="rect" href="classFileBase.html#ac5cf6444d65c14d76b14ae420dd50eff" title=" " alt="" coords="672,223,779,249"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="909,71,1025,97"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1177,222,1314,247"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="1177,173,1313,198"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1175,47,1315,73"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="469,2071,552,2097"/>
<area shape="rect" href="classInputFile.html#ae6797787eefa57fdc7191461a47109f6" title=" " alt="" coords="909,274,1024,299"/>
</map>
</div>

</div>
</div>
<a id="a3b7d0324926f0404e61dc997833544f7" name="a3b7d0324926f0404e61dc997833544f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7d0324926f0404e61dc997833544f7">&#9670;&#160;</a></span>unRela64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::unRela64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a>&#160;</td>
          <td class="paramname"><em>dt_rela</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *&#160;</td>
          <td class="paramname"><em>rela0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relasz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> const&#160;</td>
          <td class="paramname"><em>old_dtinit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l06219">6219</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 6226</span>{</div>
<div class="line"><span class="lineno"> 6227</span>    <a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a> *rela = rela0;</div>
<div class="line"><span class="lineno"> 6228</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = relasz / <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="p__elf_8h.html#abbe4299005772efa79a79dc90ccbfc0e">Elf64_Rela</a>); --k &gt;= 0; ++rela) {</div>
<div class="line"><span class="lineno"> 6229</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_addend = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_addend);</div>
<div class="line"><span class="lineno"> 6230</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_addend) {</div>
<div class="line"><span class="lineno"> 6231</span>            r_addend -= <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>;</div>
<div class="line"><span class="lineno"> 6232</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_addend, r_addend);</div>
<div class="line"><span class="lineno"> 6233</span>        }</div>
<div class="line"><span class="lineno"> 6234</span> </div>
<div class="line"><span class="lineno"> 6235</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_offset = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_offset);</div>
<div class="line"><span class="lineno"> 6236</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= r_offset) {</div>
<div class="line"><span class="lineno"> 6237</span>            <span class="comment">//r_offset -= asl_delta;  // keep compressed value vs plt_va</span></div>
<div class="line"><span class="lineno"> 6238</span>            <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;rela-&gt;r_offset, r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);  <span class="comment">// uncompressed value</span></div>
<div class="line"><span class="lineno"> 6239</span>        }</div>
<div class="line"><span class="lineno"> 6240</span> </div>
<div class="line"><span class="lineno"> 6241</span>        <span class="comment">// ElfXX_Rela (used only on 64-bit) ignores the contents of memory</span></div>
<div class="line"><span class="lineno"> 6242</span>        <span class="comment">// at the target designated by r_offset.  The target is completely</span></div>
<div class="line"><span class="lineno"> 6243</span>        <span class="comment">// overwritten by (r_addend + f_reloc(r_info)).</span></div>
<div class="line"><span class="lineno"> 6244</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 6245</span>        <span class="comment">// Nevertheless, the existing targets of .rela.plt in the .got</span></div>
<div class="line"><span class="lineno"> 6246</span>        <span class="comment">// seem to have values that matter to somebody. So restore original</span></div>
<div class="line"><span class="lineno"> 6247</span>        <span class="comment">// values when is_asl.</span></div>
<div class="line"><span class="lineno"> 6248</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> r_info   = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;rela-&gt;r_info);</div>
<div class="line"><span class="lineno"> 6249</span>        <span class="keywordtype">unsigned</span> r_type = ELF64_R_TYPE(r_info);</div>
<div class="line"><span class="lineno"> 6250</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">is_asl</a> &amp;&amp; Elf64_Ehdr::EM_AARCH64 == <a class="code hl_variable" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">e_machine</a>) {</div>
<div class="line"><span class="lineno"> 6251</span>            <span class="keywordflow">if</span> (R_AARCH64_RELATIVE == r_type) {</div>
<div class="line"><span class="lineno"> 6252</span><span class="preprocessor">#if 0  </span><span class="comment">//{ FIXME</span></div>
<div class="line"><span class="lineno"> 6253</span>                <span class="keywordflow">if</span> (old_dtinit == r_addend) {</div>
<div class="line"><span class="lineno"> 6254</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;ptload1[r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a>], r_addend);</div>
<div class="line"><span class="lineno"> 6255</span>                }</div>
<div class="line"><span class="lineno"> 6256</span><span class="preprocessor">#endif  </span><span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 6257</span>            }</div>
<div class="line"><span class="lineno"> 6258</span>            <span class="keywordflow">if</span> (R_AARCH64_JUMP_SLOT == r_type) {</div>
<div class="line"><span class="lineno"> 6259</span>                ++<a class="code hl_variable" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>;</div>
<div class="line"><span class="lineno"> 6260</span>                <span class="comment">// .rela.plt contains offset of the &quot;first time&quot; target</span></div>
<div class="line"><span class="lineno"> 6261</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">getSize</a>() &lt; (r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a>)) {</div>
<div class="line"><span class="lineno"> 6262</span>                    <a class="code hl_function" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError</a>(<span class="stringliteral">&quot;bad r_offset for jump_slots&quot;</span>);</div>
<div class="line"><span class="lineno"> 6263</span>                }</div>
<div class="line"><span class="lineno"> 6264</span>                <span class="comment">// really upx_uint64_t *, but clang makes it hard to say that</span></div>
<div class="line"><span class="lineno"> 6265</span>                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *slot = r_offset - <a class="code hl_variable" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">plt_va</a></div>
<div class="line"><span class="lineno"> 6266</span>                    + (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">jump_slots</a>.<a class="code hl_function" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">getVoidPtr</a>();</div>
<div class="line"><span class="lineno"> 6267</span>                <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> w = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(slot);</div>
<div class="line"><span class="lineno"> 6268</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a> &lt;= w) {</div>
<div class="line"><span class="lineno"> 6269</span>                    <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(slot, w - <a class="code hl_variable" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">asl_delta</a>);</div>
<div class="line"><span class="lineno"> 6270</span>                }</div>
<div class="line"><span class="lineno"> 6271</span>            }</div>
<div class="line"><span class="lineno"> 6272</span>        }</div>
<div class="line"><span class="lineno"> 6273</span>        <span class="comment">// FIXME: but what about old_dtinit?</span></div>
<div class="line"><span class="lineno"> 6274</span>        (void)old_dtinit;</div>
<div class="line"><span class="lineno"> 6275</span> </div>
<div class="line"><span class="lineno"> 6276</span>    }  <span class="comment">// end each RELA</span></div>
<div class="line"><span class="lineno"> 6277</span>    <span class="keywordflow">if</span> (fo) {</div>
<div class="line"><span class="lineno"> 6278</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">seek</a>(dt_rela, <a class="code hl_define" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>);</div>
<div class="line"><span class="lineno"> 6279</span>        fo-&gt;<a class="code hl_function" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">rewrite</a>(rela0, relasz);</div>
<div class="line"><span class="lineno"> 6280</span>    }</div>
<div class="line"><span class="lineno"> 6281</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPackLinuxElf.html#a14a0202c4a2a508fef4009ae120b44b8">PackLinuxElf::asl_delta</a>, <a class="el" href="classPackLinuxElf.html#accc257b84970a37def2e57221bf91c48">PackLinuxElf::e_machine</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a">MemBuffer::getSize()</a>, <a class="el" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2">MemBuffer::getVoidPtr()</a>, <a class="el" href="classPackLinuxElf.html#af8b16212a7cce313d106777dc6c198af">PackLinuxElf::is_asl</a>, <a class="el" href="classPackLinuxElf.html#ab0f4c33a259ca5c14cdc2384285e274f">PackLinuxElf::jump_slots</a>, <a class="el" href="classPackLinuxElf64.html#a847fd85f9cecd8abe44afd346f2ae168">n_jmp_slot</a>, <a class="el" href="classPackLinuxElf.html#aa2f1dfda6aea57348d0720fa78b782d0">PackLinuxElf::plt_va</a>, <a class="el" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad">OutputFile::rewrite()</a>, <a class="el" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4">OutputFile::seek()</a>, <a class="el" href="bsd_8h.html#a0d112bae8fd35be772185b6ec6bcbe64">SEEK_SET</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050">throwInternalError()</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph" id="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_cgraph">
<area shape="rect" title=" " alt="" coords="5,424,195,449"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="263,276,392,301"/>
<area shape="rect" href="classMemBuffer.html#a15705698799e612d2ed4b439837c649a" title=" " alt="" coords="252,325,403,351"/>
<area shape="rect" href="classMemBuffer.html#a50cf45756c991e8d65a6b90b8e6a5be2" title=" " alt="" coords="243,375,412,400"/>
<area shape="rect" href="classOutputFile.html#a6dcc27c7627119f073cf47775984fcad" title=" " alt="" coords="256,424,399,449"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="1430,424,1570,449"/>
<area shape="rect" href="classOutputFile.html#a8b1b934391e5d959387552e48a5fb4b4" title=" " alt="" coords="461,424,589,449"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="263,627,391,652"/>
<area shape="rect" href="classOutputFile.html#aa8beb793956b90404c940c5821936718" title=" " alt="" coords="460,145,591,171"/>
<area shape="rect" href="classOutputFile.html#a7efdb4c39ac6ba0dfbc4a512fcfc1331" title=" " alt="" coords="639,71,773,96"/>
<area shape="rect" href="classFileBase.html#a7ac53047ea0158b99c3c4fcedf579505" title=" " alt="" coords="1641,327,1772,352"/>
<area shape="rect" href="except_8cpp.html#a6b04d8d7658873fe2173bfbfed0a3b1b" title=" " alt="" coords="1431,109,1569,135"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="845,171,934,196"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="1040,225,1129,251"/>
<area shape="rect" href="conf_8h.html#a27ba2be54b8bb96f2c06736da293bca9" title=" " alt="" coords="661,120,751,145"/>
<area shape="rect" href="classFileBase.html#ad1760af00c23be3c3dd2f9eda2f0c10d" title=" " alt="" coords="1222,59,1349,84"/>
<area shape="rect" href="classOutputFile.html#af525d84fd970f061f7c38231892812e6" title=" " alt="" coords="825,97,954,123"/>
<area shape="rect" href="classFileBase.html#a46505d107430f708ce7b63f79c452b4d" title=" " alt="" coords="1407,60,1593,85"/>
<area shape="rect" href="bsd_8h.html#ae152484c890a24e4d9b4980e7b965be0" title=" " alt="" coords="1679,60,1735,85"/>
<area shape="rect" href="classInputFile.html#a78a66fc063b1267d37b2d1e02f20003e" title="InputFile." alt="" coords="1022,105,1147,131"/>
<area shape="rect" href="classFileBase.html#aaa2f266ecd4e53d494ea53c1d94dd2df" title=" " alt="" coords="1212,160,1359,185"/>
<area shape="rect" href="bsd_8h.html#aa8d4d8d536a0530d9109179453d5ae93" title=" " alt="" coords="1473,160,1527,185"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="1005,161,1164,201"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="1226,220,1345,245"/>
<area shape="rect" href="util_8h.html#a0d276ff04b9e9afee894e5e67ff3526d" title=" " alt="" coords="821,323,957,348"/>
<area shape="rect" href="classFileBase.html#a79cb685c1981c280797ddafc4ea9462d" title=" " alt="" coords="648,424,764,449"/>
<area shape="rect" href="linux_8h.html#a8bd74caed008a66808d92d57fa74d9f6" title=" " alt="" coords="861,475,918,500"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph.png" border="0" usemap="#aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph" id="aclassPackLinuxElf64_a3b7d0324926f0404e61dc997833544f7_icgraph">
<area shape="rect" title=" " alt="" coords="420,13,609,38"/>
<area shape="rect" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589" title=" " alt="" coords="228,5,372,45"/>
<area shape="rect" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479" title="Generic Unix unpack()." alt="" coords="5,13,180,38"/>
</map>
</div>

</div>
</div>
<a id="afdf1b9c1ce448039ac4eaec55de40c3e" name="afdf1b9c1ce448039ac4eaec55de40c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdf1b9c1ce448039ac4eaec55de40c3e">&#9670;&#160;</a></span>updateLoader()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PackLinuxElf64::updateLoader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classOutputFile.html">OutputFile</a> *&#160;</td>
          <td class="paramname"><em>fo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="classPackUnix.html#a2cee24303a1b5e7676c8d98acada2be0">PackUnix</a>.</p>

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8cpp_source.html#l01238">1238</a> of file <a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1239</span>{</div>
<div class="line"><span class="lineno"> 1240</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">xct_off</a>) {</div>
<div class="line"><span class="lineno"> 1241</span>        <span class="keywordflow">return</span>;  <span class="comment">// FIXME elfout has no values at all</span></div>
<div class="line"><span class="lineno"> 1242</span>    }</div>
<div class="line"><span class="lineno"> 1243</span>    <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> <span class="keyword">const</span> vbase = <a class="code hl_function" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">get_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.phdr[<a class="code hl_enumvalue" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>].p_vaddr);</div>
<div class="line"><span class="lineno"> 1244</span>    <span class="keywordtype">unsigned</span> start = linker-&gt;getSymbolOffset(<span class="stringliteral">&quot;_start&quot;</span>);</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">get_te16</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_machine)==Elf64_Ehdr::EM_PPC64</div>
<div class="line"><span class="lineno"> 1247</span>    &amp;&amp;  <a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_ident[Elf64_Ehdr::EI_DATA]==Elf64_Ehdr::ELFDATA2MSB) {</div>
<div class="line"><span class="lineno"> 1248</span>        <span class="keywordtype">unsigned</span> descr = linker-&gt;getSymbolOffset(<span class="stringliteral">&quot;entry_descr&quot;</span>);</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span>        <span class="comment">// External relocation of PPC64 function descriptor.</span></div>
<div class="line"><span class="lineno"> 1251</span>        <a class="code hl_typedef" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> dot_entry = start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase;</div>
<div class="line"><span class="lineno"> 1252</span>        <a class="code hl_define" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a> *p = <a class="code hl_function" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">getLoader</a>();</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;p[descr], dot_entry);</div>
<div class="line"><span class="lineno"> 1255</span>        <span class="comment">// Kernel 3.16.0 (2017-09-19) uses start, not descr</span></div>
<div class="line"><span class="lineno"> 1256</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry, start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase);</div>
<div class="line"><span class="lineno"> 1257</span>    }</div>
<div class="line"><span class="lineno"> 1258</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1259</span>        <a class="code hl_function" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">set_te64</a>(&amp;<a class="code hl_variable" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>.ehdr.e_entry, start + <a class="code hl_variable" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">sz_pack2</a> + vbase);</div>
<div class="line"><span class="lineno"> 1260</span>    }</div>
<div class="line"><span class="lineno"> 1261</span>}</div>
<div class="ttc" id="aclassPacker_html_a6e094d3b47373817a66457952f26dc70"><div class="ttname"><a href="classPacker.html#a6e094d3b47373817a66457952f26dc70">Packer::getLoader</a></div><div class="ttdeci">virtual byte * getLoader() const</div><div class="ttdef"><b>Definition:</b> <a href="packer_8cpp_source.html#l00799">packer.cpp:799</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="p__lx__elf_8cpp.html#aaf105ae5beaca1dee30ae54530691fceac6793354622210e4320fa27ecee600b5">C_TEXT</a>, <a class="el" href="classPackLinuxElf64.html#a9448025599860ae8d5773f15c09d73a4">elfout</a>, <a class="el" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5">Packer::get_te16()</a>, <a class="el" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451">Packer::get_te64()</a>, <a class="el" href="classPacker.html#a6e094d3b47373817a66457952f26dc70">Packer::getLoader()</a>, <a class="el" href="classPacker.html#a36ee35ba69e590153658a06d471c4184">Packer::set_te64()</a>, <a class="el" href="classPackLinuxElf.html#a99ee39bcba2a438ad1728c8332356ce2">PackLinuxElf::sz_pack2</a>, <a class="el" href="conf_8h.html#a28d10b43a6177d2d5f9b2e76d728d241">upx_byte</a>, and <a class="el" href="classPackLinuxElf.html#a3a8dc91b5f08ffdd31586e4d0c8ef2cb">PackLinuxElf::xct_off</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph.png" border="0" usemap="#aclassPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph" alt=""/></div>
<map name="aclassPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph" id="aclassPackLinuxElf64_afdf1b9c1ce448039ac4eaec55de40c3e_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,223,105"/>
<area shape="rect" href="classPacker.html#ad01e10cd32d88f80d316455b55bcb1a5" title=" " alt="" coords="275,5,404,31"/>
<area shape="rect" href="classPacker.html#ae85a3d8295d26480a18f0abea6912451" title=" " alt="" coords="275,55,404,80"/>
<area shape="rect" href="classPacker.html#a6e094d3b47373817a66457952f26dc70" title=" " alt="" coords="271,104,408,129"/>
<area shape="rect" href="classPacker.html#a36ee35ba69e590153658a06d471c4184" title=" " alt="" coords="275,153,403,179"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="496,80,544,105"/>
<area shape="rect" href="except_8cpp.html#a792215b47e9aba82450e3c1c6945eb32" title=" " alt="" coords="456,129,584,155"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="657,80,747,105"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="820,80,947,105"/>
<area shape="rect" href="except_8cpp.html#a57b532c382fd20e682bf0393b6d63050" title="other" alt="" coords="632,129,772,155"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a53f97eabbbe04201c83cd03c9103ce88" name="a53f97eabbbe04201c83cd03c9103ce88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53f97eabbbe04201c83cd03c9103ce88">&#9670;&#160;</a></span>dynseg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#aa76cda786f88d3847afd663e85ff85bc">Elf64_Dyn</a>* PackLinuxElf64::dynseg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00402">402</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a5fb0d975feeb7b1b02f9e4a22ab227ed">elf_has_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>

</div>
</div>
<a id="ad4f613581a3950b9df0a33e1dee728e9" name="ad4f613581a3950b9df0a33e1dee728e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f613581a3950b9df0a33e1dee728e9">&#9670;&#160;</a></span>dynsym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a>* PackLinuxElf64::dynsym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00405">405</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#af4b086d6062198ab02e25fcc4cd5a2c3">calls_crt1()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackLinuxElf64.html#a0587b38413f853b20625a28bf2a369e8">get_dynsym_name()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>.</p>

</div>
</div>
<a id="a0d71085c7179ef591535acdc5347e2dd" name="a0d71085c7179ef591535acdc5347e2dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d71085c7179ef591535acdc5347e2dd">&#9670;&#160;</a></span>e_phoff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::e_phoff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00396">396</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>

</div>
</div>
<a id="a0e16265acea35917d1e57a65fb5ffc70" name="a0e16265acea35917d1e57a65fb5ffc70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e16265acea35917d1e57a65fb5ffc70">&#9670;&#160;</a></span>e_shoff</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::e_shoff</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00397">397</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>.</p>

</div>
</div>
<a id="ad10baff449a3519d7386cf0519374a15" name="ad10baff449a3519d7386cf0519374a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad10baff449a3519d7386cf0519374a15">&#9670;&#160;</a></span>ehdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Ehdr.html">Elf64_Ehdr</a> PackLinuxElf64::ehdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00388">388</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a71bc2f0e1a1ec856b3f9a08b63add0ae">canUnpack()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, <a class="el" href="classPackLinuxElf64.html#afc05d6aa59c55c25d1faf101a5c557b7">PackLinuxElf64()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>

</div>
</div>
<a id="a9448025599860ae8d5773f15c09d73a4" name="a9448025599860ae8d5773f15c09d73a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9448025599860ae8d5773f15c09d73a4">&#9670;&#160;</a></span>elfout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cprElfHdr4 PackLinuxElf64::elfout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00437">437</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, and <a class="el" href="classPackLinuxElf64.html#afdf1b9c1ce448039ac4eaec55de40c3e">updateLoader()</a>.</p>

</div>
</div>
<a id="a898ffb3ab797ebed36d6f8e8e69848f0" name="a898ffb3ab797ebed36d6f8e8e69848f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a898ffb3ab797ebed36d6f8e8e69848f0">&#9670;&#160;</a></span>END_PHDRX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned const PackLinuxElf64::END_PHDRX = 5</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00392">392</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>.</p>

</div>
</div>
<a id="ad626f92218bc4ac19501c91a513ae75c" name="ad626f92218bc4ac19501c91a513ae75c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad626f92218bc4ac19501c91a513ae75c">&#9670;&#160;</a></span>gashend</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const * PackLinuxElf64::gashend</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00404">404</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, and <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>

</div>
</div>
<a id="af841cae6e65e727111a3e5bc134135c0" name="af841cae6e65e727111a3e5bc134135c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af841cae6e65e727111a3e5bc134135c0">&#9670;&#160;</a></span>gashtab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const* PackLinuxElf64::gashtab</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00404">404</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="a1a367c1ee6e43cb116f980f9046a0fce" name="a1a367c1ee6e43cb116f980f9046a0fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a367c1ee6e43cb116f980f9046a0fce">&#9670;&#160;</a></span>hashend</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const * PackLinuxElf64::hashend</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00403">403</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>.</p>

</div>
</div>
<a id="a9d14a83cf8a4300cf26946d4c16f8421" name="a9d14a83cf8a4300cf26946d4c16f8421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d14a83cf8a4300cf26946d4c16f8421">&#9670;&#160;</a></span>hashtab</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int const* PackLinuxElf64::hashtab</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00403">403</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a02d0e91095e3b2cdfbc913e7bc25abf8">elf_lookup()</a>, <a class="el" href="classPackLinuxElf64.html#a34544f047b9808c7416a3a3666a7d6bb">invert_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="afb6babf0e9aac66eec1cdfe3c0fb6247" name="afb6babf0e9aac66eec1cdfe3c0fb6247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb6babf0e9aac66eec1cdfe3c0fb6247">&#9670;&#160;</a></span>jni_onload_sym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a21e9cd6b9bcb032db9a6cda007013662">Elf64_Sym</a> const* PackLinuxElf64::jni_onload_sym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00406">406</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="a847fd85f9cecd8abe44afd346f2ae168" name="a847fd85f9cecd8abe44afd346f2ae168"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a847fd85f9cecd8abe44afd346f2ae168">&#9670;&#160;</a></span>n_jmp_slot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::n_jmp_slot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00399">399</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc05d6aa59c55c25d1faf101a5c557b7">PackLinuxElf64()</a>, and <a class="el" href="classPackLinuxElf64.html#a3b7d0324926f0404e61dc997833544f7">unRela64()</a>.</p>

</div>
</div>
<a id="ad07514aa5c9db6acc6b2bdad24113943" name="ad07514aa5c9db6acc6b2bdad24113943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07514aa5c9db6acc6b2bdad24113943">&#9670;&#160;</a></span>n_phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::n_phdrx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00394">394</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="acf726e188c8c471755ee3f00cf7c4226" name="acf726e188c8c471755ee3f00cf7c4226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf726e188c8c471755ee3f00cf7c4226">&#9670;&#160;</a></span>page_mask</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::page_mask</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00400">400</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, and <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>.</p>

</div>
</div>
<a id="aa11131540dea71d341de36cf39325c17" name="aa11131540dea71d341de36cf39325c17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa11131540dea71d341de36cf39325c17">&#9670;&#160;</a></span>phdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a>* PackLinuxElf64::phdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00389">389</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, <a class="el" href="classPackLinuxElf64.html#ae528cb01cbf686b624e2fffe159ad5b6">check_pt_load()</a>, <a class="el" href="classPackLinuxElf64.html#ab5c99e9dc4cb9e94309dfb49b13ff09d">elf_find_table_size()</a>, <a class="el" href="classPackLinuxElf64.html#a047a7534432a2a090049ba2eee67bfb9">elf_get_offset_from_address()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64amd.html#aed9da6648a4844cb569eb1932d7cb533">PackLinuxElf64amd::pack1()</a>, <a class="el" href="classPackLinuxElf64arm.html#ab7beaff630a9e95598b319c118bc2fe8">PackLinuxElf64arm::pack1()</a>, <a class="el" href="classPackLinuxElf64ppcle.html#a3e481c42289fbc8a0b6b595a50506e53">PackLinuxElf64ppcle::pack1()</a>, <a class="el" href="classPackLinuxElf64ppc.html#a5716922d9087096713a96aabfd975efb">PackLinuxElf64ppc::pack1()</a>, <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, <a class="el" href="classPackLinuxElf64.html#acbc068ab20eb6f313fc0abbda76c62a4">sort_DT64_offsets()</a>, <a class="el" href="classPackLinuxElf64.html#a03c843122a8d3e44da9fe458643c2589">un_DT_INIT()</a>, <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>, and <a class="el" href="classPackLinuxElf64.html#a4b789474661dc2f8e40182aae29ee479">unpack()</a>.</p>

</div>
</div>
<a id="ac4fe837eb5fd3cff1d6b76758ab9a58c" name="ac4fe837eb5fd3cff1d6b76758ab9a58c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4fe837eb5fd3cff1d6b76758ab9a58c">&#9670;&#160;</a></span>phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structElf64__Phdr.html">Elf64_Phdr</a> const* PackLinuxElf64::phdrx[<a class="el" href="classPackLinuxElf64.html#a898ffb3ab797ebed36d6f8e8e69848f0">END_PHDRX</a>]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00393">393</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#abd6eb82fa691109eb7fa267d6c8570f6">add_phdrx()</a>, and <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>.</p>

</div>
</div>
<a id="a98d5fb25525360d037499ea920927602" name="a98d5fb25525360d037499ea920927602"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98d5fb25525360d037499ea920927602">&#9670;&#160;</a></span>sec_arm_attr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::sec_arm_attr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00411">411</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, and <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>.</p>

</div>
</div>
<a id="a4e8c011204377d30ff0f1283c7eca923" name="a4e8c011204377d30ff0f1283c7eca923"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e8c011204377d30ff0f1283c7eca923">&#9670;&#160;</a></span>sec_dynstr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a> const* PackLinuxElf64::sec_dynstr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00410">410</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>.</p>

</div>
</div>
<a id="a6d6524ff7018c3899073535eb33f4920" name="a6d6524ff7018c3899073535eb33f4920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d6524ff7018c3899073535eb33f4920">&#9670;&#160;</a></span>sec_dynsym</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::sec_dynsym</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00409">409</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ab19e5a4000bc5cc063dee2a31db657e9">un_asl_dynsym()</a>.</p>

</div>
</div>
<a id="af723e5e6c9919f309a40134658df5a4d" name="af723e5e6c9919f309a40134658df5a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af723e5e6c9919f309a40134658df5a4d">&#9670;&#160;</a></span>sec_strndx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::sec_strndx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00408">408</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, and <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>.</p>

</div>
</div>
<a id="a43aff2a214341cb27a7f07ec997e443d" name="a43aff2a214341cb27a7f07ec997e443d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43aff2a214341cb27a7f07ec997e443d">&#9670;&#160;</a></span>shdri</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::shdri</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00390">390</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a3f8b3a6d6203c2a09d5058a18423fee2">canPack()</a>, <a class="el" href="classPackLinuxElf64.html#a19a154b135064ce4e1a6e58ba23d9e50">elf_find_section_name()</a>, <a class="el" href="classPackLinuxElf64.html#af80d289e1d9fe56882aa494f2afc0e9b">elf_find_section_type()</a>, <a class="el" href="classPackLinuxElf64.html#acc61917c51c71bfcb0f9af20ba7714d6">forward_Shdrs()</a>, <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, <a class="el" href="classPackLinuxElf64.html#a34abb7fc5a62a52800339d603f78f562">pack3()</a>, <a class="el" href="classPackLinuxElf64.html#a8c2bb372c567334edd586f78224bc956">PackLinuxElf64help1()</a>, and <a class="el" href="classPackLinuxElf64.html#ad2c315a3286632db9c874ca7a65bb69d">un_shlib_1()</a>.</p>

</div>
</div>
<a id="a923425254661af8d150e99087569da9f" name="a923425254661af8d150e99087569da9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923425254661af8d150e99087569da9f">&#9670;&#160;</a></span>shdro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="p__elf_8h.html#a7cc1da9f1c15c68a7204d1846d6533ed">Elf64_Shdr</a>* PackLinuxElf64::shdro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00391">391</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a6eefcbb2a42d861b12d2c309d93771b8">asl_pack2_Shdrs()</a>.</p>

</div>
</div>
<a id="aae6931a0bd5d2fca80befbd24a574c3e" name="aae6931a0bd5d2fca80befbd24a574c3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae6931a0bd5d2fca80befbd24a574c3e">&#9670;&#160;</a></span>shdrout</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">cprElfShdr3 PackLinuxElf64::shdrout</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00443">443</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a39227a27d84b3a9beeef257f95b00215">pack1()</a>, and <a class="el" href="classPackLinuxElf64.html#afc239684c1874f0a29ee97eca4e8d4d6">pack4()</a>.</p>

</div>
</div>
<a id="a9da32af4a0e9814653edd2d72c3e2dda" name="a9da32af4a0e9814653edd2d72c3e2dda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9da32af4a0e9814653edd2d72c3e2dda">&#9670;&#160;</a></span>sz_dynseg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a89d95f84118e61993a0a97429e8b8274">upx_uint64_t</a> PackLinuxElf64::sz_dynseg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00398">398</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a5d86b1c186506105d0a1143fd364c014">check_pt_dynamic()</a>, and <a class="el" href="classPackLinuxElf64.html#ab6a39ae989d67ccb9239bcff7750a6e5">elf_find_dynptr()</a>.</p>

</div>
</div>
<a id="a689b9c7fa3bd70c22d9703fbcc288819" name="a689b9c7fa3bd70c22d9703fbcc288819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a689b9c7fa3bd70c22d9703fbcc288819">&#9670;&#160;</a></span>sz_phdrx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PackLinuxElf64::sz_phdrx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="p__lx__elf_8h_source.html#l00395">395</a> of file <a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackLinuxElf64.html#a18903ac12b1370cdf82daef90aa27717">generateElfHdr()</a>, and <a class="el" href="classPackLinuxElf64.html#ae4c3d3d66cd14ea19fc44d0f90274092">pack2()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="p__lx__elf_8h_source.html">p_lx_elf.h</a></li>
<li>src/<a class="el" href="p__lx__elf_8cpp_source.html">p_lx_elf.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classPackLinuxElf64.html">PackLinuxElf64</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
