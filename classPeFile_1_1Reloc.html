<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: PeFile::Reloc Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classPeFile_1_1Reloc.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classPeFile_1_1Reloc-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PeFile::Reloc Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="pefile_8h_source.html">pefile.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PeFile::Reloc:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc__inherit__graph.png" border="0" usemap="#aPeFile_1_1Reloc_inherit__map" alt="Inheritance graph"/></div>
<map name="aPeFile_1_1Reloc_inherit__map" id="aPeFile_1_1Reloc_inherit__map">
<area shape="rect" title=" " alt="" coords="21,79,127,104"/>
<area shape="rect" href="classupx_1_1noncopyable.html" title=" " alt="" coords="5,5,143,31"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for PeFile::Reloc:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc__coll__graph.png" border="0" usemap="#aPeFile_1_1Reloc_coll__map" alt="Collaboration graph"/></div>
<map name="aPeFile_1_1Reloc_coll__map" id="aPeFile_1_1Reloc_coll__map">
<area shape="rect" title=" " alt="" coords="113,108,219,133"/>
<area shape="rect" href="classupx_1_1noncopyable.html" title=" " alt="" coords="5,13,143,38"/>
<area shape="rect" href="structPeFile_1_1Reloc_1_1RelocationBlock.html" title=" " alt="" coords="167,5,349,45"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPeFile_1_1Reloc_1_1BaseReloc.html">BaseReloc</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPeFile_1_1Reloc_1_1RelocationBlock.html">RelocationBlock</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a99276f56b47e03f78e458bb0f154823d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a99276f56b47e03f78e458bb0f154823d">Reloc</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *<a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, unsigned bytes)</td></tr>
<tr class="separator:a99276f56b47e03f78e458bb0f154823d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a302d80252926f940fd9563af4fcabc3a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a302d80252926f940fd9563af4fcabc3a">Reloc</a> (unsigned relocnum)</td></tr>
<tr class="separator:a302d80252926f940fd9563af4fcabc3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adad976bca6c32a9f92619dc3730f927b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#adad976bca6c32a9f92619dc3730f927b">~Reloc</a> () noexcept</td></tr>
<tr class="separator:adad976bca6c32a9f92619dc3730f927b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ac69f442e78ce8e5ed49d43f669b51"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#ab4ac69f442e78ce8e5ed49d43f669b51">next</a> (unsigned &amp;result_pos, unsigned &amp;result_reloc_type)</td></tr>
<tr class="separator:ab4ac69f442e78ce8e5ed49d43f669b51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e83b0eba96da31d037b5fa145f61ca7"><td class="memItemLeft" align="right" valign="top">const unsigned *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a5e83b0eba96da31d037b5fa145f61ca7">getcounts</a> () const</td></tr>
<tr class="separator:a5e83b0eba96da31d037b5fa145f61ca7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae55a92611a09de5774f440bd0d7d9af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#aae55a92611a09de5774f440bd0d7d9af">add_reloc</a> (unsigned pos, unsigned reloc_type)</td></tr>
<tr class="separator:aae55a92611a09de5774f440bd0d7d9af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac595521c698368cff9b950c3c50fc3b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#ac595521c698368cff9b950c3c50fc3b7">finish</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *(&amp;result_ptr), unsigned &amp;result_size)</td></tr>
<tr class="separator:ac595521c698368cff9b950c3c50fc3b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a62b1866ad6bbceaf3f3fd30fc0c13ae8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a62b1866ad6bbceaf3f3fd30fc0c13ae8">SPAN_0</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>) start_buf</td></tr>
<tr class="separator:a62b1866ad6bbceaf3f3fd30fc0c13ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d5a92fe95758c82bb2f026850e6bd1b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a2d5a92fe95758c82bb2f026850e6bd1b">readFromRelocationBlock</a> (<a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *)</td></tr>
<tr class="separator:a2d5a92fe95758c82bb2f026850e6bd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f3df8ae7a5feba1df21bd6076b08742"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a3f3df8ae7a5feba1df21bd6076b08742">initSpans</a> ()</td></tr>
<tr class="separator:a3f3df8ae7a5feba1df21bd6076b08742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classupx_1_1noncopyable"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classupx_1_1noncopyable')"><img src="closed.png" alt="-"/>&#160;Private Member Functions inherited from <a class="el" href="classupx_1_1noncopyable.html">upx::noncopyable</a></td></tr>
<tr class="memitem:a1b00fdba27d42b4c306a460328a974cf inherit pub_methods_classupx_1_1noncopyable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#adb97414df8177596c2b149cf5f588ac8">forceinline</a> constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupx_1_1noncopyable.html#a1b00fdba27d42b4c306a460328a974cf">noncopyable</a> () noexcept</td></tr>
<tr class="separator:a1b00fdba27d42b4c306a460328a974cf inherit pub_methods_classupx_1_1noncopyable"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a563f12ce10ad4abb7f1f5ef9572a1246 inherit pub_methods_classupx_1_1noncopyable"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#adb97414df8177596c2b149cf5f588ac8">forceinline</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classupx_1_1noncopyable.html#a563f12ce10ad4abb7f1f5ef9572a1246">~noncopyable</a> () noexcept=default</td></tr>
<tr class="separator:a563f12ce10ad4abb7f1f5ef9572a1246 inherit pub_methods_classupx_1_1noncopyable"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acea4d9cde6e95239086fbd2d56d2cf69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a> = nullptr</td></tr>
<tr class="separator:acea4d9cde6e95239086fbd2d56d2cf69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef4f860c18404d424cc1ea20bc304658"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> = 0</td></tr>
<tr class="separator:aef4f860c18404d424cc1ea20bc304658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3971fd1d95cb4ef9755b9d2ebba88153"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a> = false</td></tr>
<tr class="separator:a3971fd1d95cb4ef9755b9d2ebba88153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d72cec859fb7a0f61273022ed60080f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPeFile_1_1Reloc_1_1RelocationBlock.html">RelocationBlock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a></td></tr>
<tr class="separator:a6d72cec859fb7a0f61273022ed60080f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd39c068846140a9fc94caa2274a6b3e"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a> [16] = {}</td></tr>
<tr class="separator:abd39c068846140a9fc94caa2274a6b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00426">426</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a99276f56b47e03f78e458bb0f154823d" name="a99276f56b47e03f78e458bb0f154823d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99276f56b47e03f78e458bb0f154823d">&#9670;&#160;</a></span>Reloc() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PeFile::Reloc::Reloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>bytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00333">333</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  333</span>                                            {</div>
<div class="line"><span class="lineno">  334</span>    assert(<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;cmd == <a class="code hl_enumvalue" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>);</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> = <a class="code hl_function" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size</a>(1, bytes);</div>
<div class="line"><span class="lineno">  336</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a> = <a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>;</div>
<div class="line"><span class="lineno">  337</span>    <a class="code hl_function" href="classPeFile_1_1Reloc.html#a3f3df8ae7a5feba1df21bd6076b08742">initSpans</a>();</div>
<div class="line"><span class="lineno">  338</span>    <span class="comment">// fill counts</span></div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordtype">unsigned</span> pos, reloc_type;</div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">while</span> (<a class="code hl_function" href="classPeFile_1_1Reloc.html#ab4ac69f442e78ce8e5ed49d43f669b51">next</a>(pos, reloc_type))</div>
<div class="line"><span class="lineno">  341</span>        <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>[reloc_type]++;</div>
<div class="line"><span class="lineno">  342</span>}</div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_a3f3df8ae7a5feba1df21bd6076b08742"><div class="ttname"><a href="classPeFile_1_1Reloc.html#a3f3df8ae7a5feba1df21bd6076b08742">PeFile::Reloc::initSpans</a></div><div class="ttdeci">void initSpans()</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00351">pefile.cpp:351</a></div></div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_ab4ac69f442e78ce8e5ed49d43f669b51"><div class="ttname"><a href="classPeFile_1_1Reloc.html#ab4ac69f442e78ce8e5ed49d43f669b51">PeFile::Reloc::next</a></div><div class="ttdeci">bool next(unsigned &amp;result_pos, unsigned &amp;result_reloc_type)</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00400">pefile.cpp:400</a></div></div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_abd39c068846140a9fc94caa2274a6b3e"><div class="ttname"><a href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">PeFile::Reloc::counts</a></div><div class="ttdeci">unsigned counts[16]</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00447">pefile.h:447</a></div></div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_acea4d9cde6e95239086fbd2d56d2cf69"><div class="ttname"><a href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">PeFile::Reloc::start</a></div><div class="ttdeci">byte * start</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00428">pefile.h:428</a></div></div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_aef4f860c18404d424cc1ea20bc304658"><div class="ttname"><a href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">PeFile::Reloc::start_size_in_bytes</a></div><div class="ttdeci">unsigned start_size_in_bytes</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00429">pefile.h:429</a></div></div>
<div class="ttc" id="alzma__m_8h_html_a7b01bc9a5d719e0ece76d9b8dd822dde"><div class="ttname"><a href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov cx endm macro M_shld_diax_8_bxcx mov di mov bl mov ah mov al xor al mov bx endm macro M_shld_8_bp h l mov word ptr[bp+h] mov word ptr[bp+l] M_shld_8 mov word ptr[bp+h]</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00292">lzma_m.h:292</a></div></div>
<div class="ttc" id="aoptions_8cpp_html_a887b9edd7a68b4cde1de1f0d7ac1d6eb"><div class="ttname"><a href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a></div><div class="ttdeci">#define opt</div></div>
<div class="ttc" id="aoptions_8h_html_a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86"><div class="ttname"><a href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a></div><div class="ttdeci">@ CMD_COMPRESS</div><div class="ttdef"><b>Definition:</b> <a href="options_8h_source.html#l00046">options.h:46</a></div></div>
<div class="ttc" id="autil_8cpp_html_aa054bbcac51cef77258c20fa0321b320"><div class="ttname"><a href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size</a></div><div class="ttdeci">upx_rsize_t mem_size(upx_uint64_t element_size, upx_uint64_t n, upx_uint64_t extra1, upx_uint64_t extra2)</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00073">util.cpp:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="options_8h.html#a99fb83031ce9923c84392b4e92f956b5a87eabf5bdd0bf150006b8a1c9ca5ec86">CMD_COMPRESS</a>, <a class="el" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, and <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_a99276f56b47e03f78e458bb0f154823d_cgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_a99276f56b47e03f78e458bb0f154823d_cgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_a99276f56b47e03f78e458bb0f154823d_cgraph" id="aclassPeFile_1_1Reloc_a99276f56b47e03f78e458bb0f154823d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,31"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="203,5,292,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="340,5,459,31"/>
</map>
</div>

</div>
</div>
<a id="a302d80252926f940fd9563af4fcabc3a" name="a302d80252926f940fd9563af4fcabc3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a302d80252926f940fd9563af4fcabc3a">&#9670;&#160;</a></span>Reloc() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PeFile::Reloc::Reloc </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>relocnum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00344">344</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  344</span>                                    {</div>
<div class="line"><span class="lineno">  345</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> = <a class="code hl_function" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size</a>(<a class="code hl_variable" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, relocnum, <a class="code hl_variable" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>, 8192);</div>
<div class="line"><span class="lineno">  346</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a> = <span class="keyword">new</span> <span class="keywordtype">byte</span>[<a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a>]; <span class="comment">// =&gt; transfer ownership to oxrelocs[] in finish()</span></div>
<div class="line"><span class="lineno">  347</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  348</span>    <a class="code hl_function" href="classPeFile_1_1Reloc.html#a3f3df8ae7a5feba1df21bd6076b08742">initSpans</a>();</div>
<div class="line"><span class="lineno">  349</span>}</div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_a3971fd1d95cb4ef9755b9d2ebba88153"><div class="ttname"><a href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">PeFile::Reloc::start_did_alloc</a></div><div class="ttdeci">bool start_did_alloc</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00430">pefile.h:430</a></div></div>
<div class="ttc" id="apefile_8cpp_html_a075198df2195ebe0e36c5c8f10489da1"><div class="ttname"><a href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a></div><div class="ttdeci">static constexpr size_t RELOC_ENTRY_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00301">pefile.cpp:301</a></div></div>
<div class="ttc" id="apefile_8cpp_html_acc61339e653265009e880515f9909472"><div class="ttname"><a href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a></div><div class="ttdeci">static constexpr size_t RELOC_INPLACE_OFFSET</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00299">pefile.cpp:299</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size()</a>, <a class="el" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, and <a class="el" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_a302d80252926f940fd9563af4fcabc3a_cgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_a302d80252926f940fd9563af4fcabc3a_cgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_a302d80252926f940fd9563af4fcabc3a_cgraph" id="aclassPeFile_1_1Reloc_a302d80252926f940fd9563af4fcabc3a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,155,31"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="203,5,292,31"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="340,5,459,31"/>
</map>
</div>

</div>
</div>
<a id="adad976bca6c32a9f92619dc3730f927b" name="adad976bca6c32a9f92619dc3730f927b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adad976bca6c32a9f92619dc3730f927b">&#9670;&#160;</a></span>~Reloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PeFile::Reloc::~Reloc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00325">325</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  325</span>                             {</div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_define" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>(<span class="keyword">sizeof</span>(BaseReloc) == 8)</div>
<div class="line"><span class="lineno">  327</span>    <a class="code hl_define" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>(BaseReloc)</div>
<div class="line"><span class="lineno">  328</span>    if (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a>) <span class="comment">// don&#39;t leak memory on exceptions</span></div>
<div class="line"><span class="lineno">  329</span>        delete[] <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a>;</div>
<div class="line"><span class="lineno">  330</span>}</div>
<div class="ttc" id="aconf_8h_html_a20a79123be4e1110319dc90522f4b563"><div class="ttname"><a href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT_ALIGNED1(a)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00432">conf.h:432</a></div></div>
<div class="ttc" id="aconf_8h_html_a92f0ba69c0f889de4efac3dea2b0cc8a"><div class="ttname"><a href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a></div><div class="ttdeci">#define COMPILE_TIME_ASSERT(e)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00237">conf.h:237</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8h.html#a92f0ba69c0f889de4efac3dea2b0cc8a">COMPILE_TIME_ASSERT</a>, and <a class="el" href="conf_8h.html#a20a79123be4e1110319dc90522f4b563">COMPILE_TIME_ASSERT_ALIGNED1</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aae55a92611a09de5774f440bd0d7d9af" name="aae55a92611a09de5774f440bd0d7d9af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae55a92611a09de5774f440bd0d7d9af">&#9670;&#160;</a></span>add_reloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PeFile::Reloc::add_reloc </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>reloc_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00422">422</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  422</span>                                                             {</div>
<div class="line"><span class="lineno">  423</span>    assert(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a>);</div>
<div class="line"><span class="lineno">  424</span>    <span class="comment">// assert(reloc_type != IMAGE_REL_BASED_IGNORE);</span></div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">if</span> (reloc_type == <a class="code hl_enumvalue" href="classPeFile.html#a7de746815d41e6f494669bec5bb0f103abb445a70d0174ef143dee2f07173a53d">IMAGE_REL_BASED_IGNORE</a>)</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">auto</span> entry_ptr = start_buf + <a class="code hl_function" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size</a>(<a class="code hl_variable" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>[0], <a class="code hl_variable" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>);</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_function" href="pefile_8cpp.html#a6b76d4e58e19d5cd5c4516762e7eecf7">reloc_entry_encode</a>(entry_ptr, pos, reloc_type);</div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>[0] += 1;</div>
<div class="line"><span class="lineno">  430</span>}</div>
<div class="ttc" id="aclassPeFile_html_a7de746815d41e6f494669bec5bb0f103abb445a70d0174ef143dee2f07173a53d"><div class="ttname"><a href="classPeFile.html#a7de746815d41e6f494669bec5bb0f103abb445a70d0174ef143dee2f07173a53d">PeFile::IMAGE_REL_BASED_IGNORE</a></div><div class="ttdeci">@ IMAGE_REL_BASED_IGNORE</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00387">pefile.h:387</a></div></div>
<div class="ttc" id="apefile_8cpp_html_a6b76d4e58e19d5cd5c4516762e7eecf7"><div class="ttname"><a href="pefile_8cpp.html#a6b76d4e58e19d5cd5c4516762e7eecf7">reloc_entry_encode</a></div><div class="ttdeci">static void reloc_entry_encode(SPAN_P(byte) buf, unsigned pos, unsigned reloc_type)</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00302">pefile.cpp:302</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPeFile.html#a7de746815d41e6f494669bec5bb0f103abb445a70d0174ef143dee2f07173a53d">PeFile::IMAGE_REL_BASED_IGNORE</a>, <a class="el" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size()</a>, <a class="el" href="pefile_8cpp.html#a6b76d4e58e19d5cd5c4516762e7eecf7">reloc_entry_encode()</a>, <a class="el" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, and <a class="el" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPackW32PeI386.html#ada86f70df15bb544bde0660ef319ce6b">PackW32PeI386::addNewRelocations()</a>, <a class="el" href="classPackWinCeArm.html#a5904690b6d397a9ed3a1a9cdc9ba037f">PackWinCeArm::addNewRelocations()</a>, <a class="el" href="classPeFile.html#a30601c17a0f2fc5889f04fdaf721a71c">PeFile::processLoadConf()</a>, <a class="el" href="classPeFile.html#ac091b00cb7c3729316f3b3675e28cc2e">PeFile::processTls2()</a>, and <a class="el" href="classPeFile.html#acbeaaf1e9537f2bcf9573505c7b46461">PeFile::rebuildRelocs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_cgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_cgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_cgraph" id="aclassPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,143,63"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="221,5,310,31"/>
<area shape="rect" href="pefile_8cpp.html#a6b76d4e58e19d5cd5c4516762e7eecf7" title=" " alt="" coords="191,55,340,80"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="388,5,507,31"/>
<area shape="rect" href="bele_8h.html#a88b39f5ad68cb7521d33199c568d0e28" title=" " alt="" coords="407,55,488,80"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#ae808612ba905c120b5d6a291fcab7456" title=" " alt="" coords="555,47,705,87"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a5f2260565847259f85f7980dc1ab3236" title=" " alt="" coords="753,15,904,55"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a23c00bac605547ca04a20ec07fad711a" title=" " alt="" coords="753,79,904,119"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_icgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_icgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_icgraph" id="aclassPeFile_1_1Reloc_aae55a92611a09de5774f440bd0d7d9af_icgraph">
<area shape="rect" title=" " alt="" coords="488,97,625,137"/>
<area shape="rect" href="classPackW32PeI386.html#ada86f70df15bb544bde0660ef319ce6b" title=" " alt="" coords="177,5,440,31"/>
<area shape="rect" href="classPackWinCeArm.html#a5904690b6d397a9ed3a1a9cdc9ba037f" title=" " alt="" coords="179,55,438,80"/>
<area shape="rect" href="classPeFile.html#a30601c17a0f2fc5889f04fdaf721a71c" title=" " alt="" coords="219,104,399,129"/>
<area shape="rect" href="classPeFile.html#ac091b00cb7c3729316f3b3675e28cc2e" title=" " alt="" coords="235,153,382,179"/>
<area shape="rect" href="classPeFile.html#acbeaaf1e9537f2bcf9573505c7b46461" title="unpack" alt="" coords="230,203,387,228"/>
<area shape="rect" href="classPeFile.html#ad9fc5f9eff8c16e397552c1a0681b632" title="create UPX0 section" alt="" coords="13,104,121,129"/>
<area shape="rect" href="classPeFile.html#aa8d033dfaeb206c4235410f24b083df5" title="create UPX0 section" alt="" coords="5,203,129,228"/>
</map>
</div>

</div>
</div>
<a id="ac595521c698368cff9b950c3c50fc3b7" name="ac595521c698368cff9b950c3c50fc3b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac595521c698368cff9b950c3c50fc3b7">&#9670;&#160;</a></span>finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PeFile::Reloc::finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&amp;&#160;</td>
          <td class="paramname"><em>result_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>result_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00432">432</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>                                                                   {</div>
<div class="line"><span class="lineno">  433</span>    assert(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a>);</div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">// sort in-place relocs</span></div>
<div class="line"><span class="lineno">  435</span>    <a class="code hl_define" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>(</div>
<div class="line"><span class="lineno">  436</span>        <a class="code hl_function" href="membuffer_8h.html#a1717baab5552eaf123e584afe8141c7a">raw_index_bytes</a>(start_buf, <a class="code hl_variable" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>, <a class="code hl_function" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size</a>(<a class="code hl_variable" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>[0])),</div>
<div class="line"><span class="lineno">  437</span>        <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>[0], <a class="code hl_variable" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, <a class="code hl_function" href="pefile_8cpp.html#a651de538a65fcfd5a13b54287ecd8a6d">reloc_entry_compare</a>);</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>    <span class="keyword">auto</span> finish_block = [](<a class="code hl_define" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>(BaseReloc) rel) -&gt; <span class="keywordtype">byte</span> * {</div>
<div class="line"><span class="lineno">  440</span>        <span class="keywordtype">unsigned</span> sob = rel-&gt;size_of_block;</div>
<div class="line"><span class="lineno">  441</span>        assert(sob &gt;= 10 &amp;&amp; (sob &amp; 1) == 0);</div>
<div class="line"><span class="lineno">  442</span>        <span class="keyword">auto</span> end = <a class="code hl_define" href="xspan_8h.html#a1826f60b41ebe2a169eba6e5f6f16a42">SPAN_TYPE_CAST</a>(<span class="keywordtype">byte</span>, rel) + sob;</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordflow">while</span> ((sob &amp; 3) != 0) { <span class="comment">// UPX: we want align by 4 here</span></div>
<div class="line"><span class="lineno">  444</span>            *end++ = 0;          <span class="comment">// clear byte (i.e. write IMAGE_REL_BASED_IGNORE)</span></div>
<div class="line"><span class="lineno">  445</span>            sob += 1;</div>
<div class="line"><span class="lineno">  446</span>        }</div>
<div class="line"><span class="lineno">  447</span>        rel-&gt;size_of_block = sob;</div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751">raw_bytes</a>(end, 0);</div>
<div class="line"><span class="lineno">  449</span>    };</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_function" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#ad60ee6c44fa61d009f66c8c48e847dad">reset</a>();</div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordtype">unsigned</span> prev_pos = 0;</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordtype">unsigned</span> current_page = 0;</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ic = 0; ic &lt; <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>[0]; ic++) {</div>
<div class="line"><span class="lineno">  455</span>        <span class="keyword">const</span> <span class="keyword">auto</span> entry_ptr = start_buf + <a class="code hl_function" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size</a>(<a class="code hl_variable" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, ic, <a class="code hl_variable" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>);</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordtype">unsigned</span> pos, reloc_type;</div>
<div class="line"><span class="lineno">  457</span>        <a class="code hl_function" href="pefile_8cpp.html#a1af5035e3911d475c1d7e50ff46f7330">reloc_entry_decode</a>(entry_ptr, &amp;pos, &amp;reloc_type);</div>
<div class="line"><span class="lineno">  458</span>        <span class="keywordflow">if</span> (ic &gt; 0 &amp;&amp; pos == prev_pos) {</div>
<div class="line"><span class="lineno">  459</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="pefile_8cpp.html#a24ca95aa0001994cba9787266a6b0429">ALWAYS_CHECK_STRICT_RELOCS</a>)</div>
<div class="line"><span class="lineno">  460</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;duplicate relocs&quot;</span>);</div>
<div class="line"><span class="lineno">  461</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;force)</div>
<div class="line"><span class="lineno">  462</span>                <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;duplicate relocs (try --force)&quot;</span>);</div>
<div class="line"><span class="lineno">  463</span>        }</div>
<div class="line"><span class="lineno">  464</span>        prev_pos = pos;</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">if</span> (ic == 0 || pos - current_page &gt;= 0x1000) {</div>
<div class="line"><span class="lineno">  466</span>            current_page = pos &amp; ~0xfff; <span class="comment">// page start</span></div>
<div class="line"><span class="lineno">  467</span>            <span class="comment">// prepare next block for writing</span></div>
<div class="line"><span class="lineno">  468</span>            <span class="keywordtype">byte</span> *next_rb = (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel == <span class="keyword">nullptr</span>) ? <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a> : finish_block(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel);</div>
<div class="line"><span class="lineno">  469</span>            <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel = (BaseReloc *) next_rb;</div>
<div class="line"><span class="lineno">  470</span>            <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1 = (<a class="code hl_struct" href="structLE16.html">LE16</a> *) (next_rb + 8);</div>
<div class="line"><span class="lineno">  471</span>            <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel-&gt;virtual_address = current_page;</div>
<div class="line"><span class="lineno">  472</span>            <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel-&gt;size_of_block = 8;</div>
<div class="line"><span class="lineno">  473</span>        }</div>
<div class="line"><span class="lineno">  474</span>        <span class="comment">// check for in-place overflow</span></div>
<div class="line"><span class="lineno">  475</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225">ptr_diff_bytes</a>(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1, entry_ptr) &gt;= 0) {</div>
<div class="line"><span class="lineno">  476</span>            <span class="comment">// info: if this is indeed a valid file we must increase RELOC_INPLACE_OFFSET</span></div>
<div class="line"><span class="lineno">  477</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;too many inplace relocs&quot;</span>);</div>
<div class="line"><span class="lineno">  478</span>        }</div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">// write LE16 IMAGE_BASE_RELOCATION relocation</span></div>
<div class="line"><span class="lineno">  480</span>        *<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1++ = (reloc_type &lt;&lt; 12) | (pos &amp; 0xfff);</div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel-&gt;size_of_block += 2;</div>
<div class="line"><span class="lineno">  482</span>    }</div>
<div class="line"><span class="lineno">  483</span>    result_size = 0; <span class="comment">// result_size can be 0 in 64-bit mode</span></div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel != <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  485</span>        result_size = <a class="code hl_function" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a>(finish_block(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel), <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a>);</div>
<div class="line"><span class="lineno">  486</span>    assert((result_size &amp; 3) == 0);</div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">// transfer ownership</span></div>
<div class="line"><span class="lineno">  488</span>    assert(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a>);</div>
<div class="line"><span class="lineno">  489</span>    result_ptr = <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a>;</div>
<div class="line"><span class="lineno">  490</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  491</span><span class="preprocessor">#if DEBUG || 1 </span><span class="comment">// safety, as we are really finished</span></div>
<div class="line"><span class="lineno">  492</span>    <a class="code hl_function" href="util_8h.html#a1d64ae7c7bc6de45e39c612cb0b0e592">ptr_invalidate_and_poison</a>(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a>);</div>
<div class="line"><span class="lineno">  493</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> = 0;</div>
<div class="line"><span class="lineno">  494</span>    <a class="code hl_define" href="xspan_8h.html#a161507b18bd6b2dead3d3e69120105cd">SPAN_INVALIDATE</a>(start_buf);</div>
<div class="line"><span class="lineno">  495</span>    <a class="code hl_define" href="xspan_8h.html#a161507b18bd6b2dead3d3e69120105cd">SPAN_INVALIDATE</a>(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel);</div>
<div class="line"><span class="lineno">  496</span>    <a class="code hl_define" href="xspan_8h.html#a161507b18bd6b2dead3d3e69120105cd">SPAN_INVALIDATE</a>(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1);</div>
<div class="line"><span class="lineno">  497</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_variable" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#a75a61a50bbe9e894b3d216e0c43f224c">count</a> = 0xdeaddead;</div>
<div class="line"><span class="lineno">  498</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  499</span>}</div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_a6d72cec859fb7a0f61273022ed60080f"><div class="ttname"><a href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">PeFile::Reloc::rb</a></div><div class="ttdeci">RelocationBlock rb</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00444">pefile.h:444</a></div></div>
<div class="ttc" id="aexcept_8cpp_html_a388ab1f73d9ba5222a35cbdd67b396ff"><div class="ttname"><a href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a></div><div class="ttdeci">void throwCantPack(const char *msg)</div><div class="ttdoc">compression</div><div class="ttdef"><b>Definition:</b> <a href="except_8cpp_source.html#l00075">except.cpp:75</a></div></div>
<div class="ttc" id="amembuffer_8h_html_a1717baab5552eaf123e584afe8141c7a"><div class="ttname"><a href="membuffer_8h.html#a1717baab5552eaf123e584afe8141c7a">raw_index_bytes</a></div><div class="ttdeci">MemBufferBase&lt; T &gt;::pointer raw_index_bytes(const MemBufferBase&lt; T &gt; &amp;mbb, size_t index, size_t size_in_bytes)</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00154">membuffer.h:154</a></div></div>
<div class="ttc" id="amembuffer_8h_html_a8bc8e23a965fc63e336d6158814f5751"><div class="ttname"><a href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751">raw_bytes</a></div><div class="ttdeci">MemBufferBase&lt; T &gt;::pointer raw_bytes(const MemBufferBase&lt; T &gt; &amp;mbb, size_t size_in_bytes)</div><div class="ttdef"><b>Definition:</b> <a href="membuffer_8h_source.html#l00149">membuffer.h:149</a></div></div>
<div class="ttc" id="apefile_8cpp_html_a1af5035e3911d475c1d7e50ff46f7330"><div class="ttname"><a href="pefile_8cpp.html#a1af5035e3911d475c1d7e50ff46f7330">reloc_entry_decode</a></div><div class="ttdeci">static void reloc_entry_decode(SPAN_P(const byte) buf, unsigned *pos, unsigned *reloc_type)</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00308">pefile.cpp:308</a></div></div>
<div class="ttc" id="apefile_8cpp_html_a24ca95aa0001994cba9787266a6b0429"><div class="ttname"><a href="pefile_8cpp.html#a24ca95aa0001994cba9787266a6b0429">ALWAYS_CHECK_STRICT_RELOCS</a></div><div class="ttdeci">static constexpr bool ALWAYS_CHECK_STRICT_RELOCS</div><div class="ttdoc">relocation handling</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00290">pefile.cpp:290</a></div></div>
<div class="ttc" id="apefile_8cpp_html_a651de538a65fcfd5a13b54287ecd8a6d"><div class="ttname"><a href="pefile_8cpp.html#a651de538a65fcfd5a13b54287ecd8a6d">reloc_entry_compare</a></div><div class="ttdeci">static int __acc_cdecl_qsort reloc_entry_compare(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00313">pefile.cpp:313</a></div></div>
<div class="ttc" id="astructLE16_html"><div class="ttname"><a href="structLE16.html">LE16</a></div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00689">bele.h:689</a></div></div>
<div class="ttc" id="astructPeFile_1_1Reloc_1_1RelocationBlock_html_a75a61a50bbe9e894b3d216e0c43f224c"><div class="ttname"><a href="structPeFile_1_1Reloc_1_1RelocationBlock.html#a75a61a50bbe9e894b3d216e0c43f224c">PeFile::Reloc::RelocationBlock::count</a></div><div class="ttdeci">unsigned count</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8h_source.html#l00441">pefile.h:441</a></div></div>
<div class="ttc" id="astructPeFile_1_1Reloc_1_1RelocationBlock_html_ad60ee6c44fa61d009f66c8c48e847dad"><div class="ttname"><a href="structPeFile_1_1Reloc_1_1RelocationBlock.html#ad60ee6c44fa61d009f66c8c48e847dad">PeFile::Reloc::RelocationBlock::reset</a></div><div class="ttdeci">void reset() noexcept</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00292">pefile.cpp:292</a></div></div>
<div class="ttc" id="autil_8cpp_html_a420c4464159a133442e53a0d8dafc225"><div class="ttname"><a href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225">ptr_diff_bytes</a></div><div class="ttdeci">int ptr_diff_bytes(const void *a, const void *b) may_throw</div><div class="ttdoc">ptr util</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00109">util.cpp:109</a></div></div>
<div class="ttc" id="autil_8cpp_html_a49db04c61486d695f7f04b44ac2201c0"><div class="ttname"><a href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a></div><div class="ttdeci">unsigned ptr_udiff_bytes(const void *a, const void *b) may_throw</div><div class="ttdef"><b>Definition:</b> <a href="util_8cpp_source.html#l00126">util.cpp:126</a></div></div>
<div class="ttc" id="autil_8h_html_a1d64ae7c7bc6de45e39c612cb0b0e592"><div class="ttname"><a href="util_8h.html#a1d64ae7c7bc6de45e39c612cb0b0e592">ptr_invalidate_and_poison</a></div><div class="ttdeci">void ptr_invalidate_and_poison(T *(&amp;ptr)) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00164">util.h:164</a></div></div>
<div class="ttc" id="autil_8h_html_afafc04a977e45706ac9f76ed6122ee54"><div class="ttname"><a href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a></div><div class="ttdeci">#define upx_qsort</div><div class="ttdef"><b>Definition:</b> <a href="util_8h_source.html#l00205">util.h:205</a></div></div>
<div class="ttc" id="axspan_8h_html_a00c10eac38d459291658bac6b02989b7"><div class="ttname"><a href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a></div><div class="ttdeci">#define SPAN_S</div><div class="ttdef"><b>Definition:</b> <a href="xspan_8h_source.html#l00176">xspan.h:176</a></div></div>
<div class="ttc" id="axspan_8h_html_a161507b18bd6b2dead3d3e69120105cd"><div class="ttname"><a href="xspan_8h.html#a161507b18bd6b2dead3d3e69120105cd">SPAN_INVALIDATE</a></div><div class="ttdeci">#define SPAN_INVALIDATE</div><div class="ttdef"><b>Definition:</b> <a href="xspan_8h_source.html#l00188">xspan.h:188</a></div></div>
<div class="ttc" id="axspan_8h_html_a1826f60b41ebe2a169eba6e5f6f16a42"><div class="ttname"><a href="xspan_8h.html#a1826f60b41ebe2a169eba6e5f6f16a42">SPAN_TYPE_CAST</a></div><div class="ttdeci">#define SPAN_TYPE_CAST</div><div class="ttdef"><b>Definition:</b> <a href="xspan_8h_source.html#l00186">xspan.h:186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pefile_8cpp.html#a24ca95aa0001994cba9787266a6b0429">ALWAYS_CHECK_STRICT_RELOCS</a>, <a class="el" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320">mem_size()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225">ptr_diff_bytes()</a>, <a class="el" href="util_8h.html#a1d64ae7c7bc6de45e39c612cb0b0e592">ptr_invalidate_and_poison()</a>, <a class="el" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes()</a>, <a class="el" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751">raw_bytes()</a>, <a class="el" href="membuffer_8h.html#a1717baab5552eaf123e584afe8141c7a">raw_index_bytes()</a>, <a class="el" href="pefile_8cpp.html#a651de538a65fcfd5a13b54287ecd8a6d">reloc_entry_compare()</a>, <a class="el" href="pefile_8cpp.html#a1af5035e3911d475c1d7e50ff46f7330">reloc_entry_decode()</a>, <a class="el" href="pefile_8cpp.html#a075198df2195ebe0e36c5c8f10489da1">RELOC_ENTRY_SIZE</a>, <a class="el" href="pefile_8cpp.html#acc61339e653265009e880515f9909472">RELOC_INPLACE_OFFSET</a>, <a class="el" href="xspan_8h.html#a161507b18bd6b2dead3d3e69120105cd">SPAN_INVALIDATE</a>, <a class="el" href="xspan_8h.html#a00c10eac38d459291658bac6b02989b7">SPAN_S</a>, <a class="el" href="xspan_8h.html#a1826f60b41ebe2a169eba6e5f6f16a42">SPAN_TYPE_CAST</a>, <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>, and <a class="el" href="util_8h.html#afafc04a977e45706ac9f76ed6122ee54">upx_qsort</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPeFile.html#ad8e6ec987ca037c22af9bbdcf3e76469">PeFile::callProcessStubRelocs()</a>, and <a class="el" href="classPeFile.html#acbeaaf1e9537f2bcf9573505c7b46461">PeFile::rebuildRelocs()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_cgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_cgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_cgraph" id="aclassPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_cgraph">
<area shape="rect" title=" " alt="" coords="5,268,153,293"/>
<area shape="rect" href="util_8cpp.html#aa054bbcac51cef77258c20fa0321b320" title=" " alt="" coords="443,157,532,183"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="641,268,759,293"/>
<area shape="rect" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225" title="ptr util" alt="" coords="432,369,543,395"/>
<area shape="rect" href="util_8h.html#a1d64ae7c7bc6de45e39c612cb0b0e592" title=" " alt="" coords="209,203,352,243"/>
<area shape="rect" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0" title=" " alt="" coords="221,319,340,344"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="236,29,325,55"/>
<area shape="rect" href="membuffer_8h.html#a1717baab5552eaf123e584afe8141c7a" title=" " alt="" coords="215,103,347,128"/>
<area shape="rect" href="pefile_8cpp.html#a651de538a65fcfd5a13b54287ecd8a6d" title=" " alt="" coords="201,469,360,495"/>
<area shape="rect" href="pefile_8cpp.html#a1af5035e3911d475c1d7e50ff46f7330" title=" " alt="" coords="206,420,355,445"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="615,377,785,403"/>
<area shape="rect" href="util_8h.html#a38df66b3eff123e66d6b92ceb76eb4c3" title=" " alt="" coords="651,328,749,353"/>
<area shape="rect" href="util_8h.html#ada5fbeddd8d88707d5b8dd9fa6557c65" title="ptr util" alt="" coords="845,328,972,353"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="408,93,567,133"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="446,460,529,485"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="625,453,775,493"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="833,459,984,499"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="833,395,984,435"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_icgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_icgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_icgraph" id="aclassPeFile_1_1Reloc_ac595521c698368cff9b950c3c50fc3b7_icgraph">
<area shape="rect" title=" " alt="" coords="440,31,588,56"/>
<area shape="rect" href="classPeFile.html#ad8e6ec987ca037c22af9bbdcf3e76469" title=" " alt="" coords="177,5,392,31"/>
<area shape="rect" href="classPeFile.html#acbeaaf1e9537f2bcf9573505c7b46461" title="unpack" alt="" coords="206,55,363,80"/>
<area shape="rect" href="classPeFile.html#ad9fc5f9eff8c16e397552c1a0681b632" title="create UPX0 section" alt="" coords="13,5,121,31"/>
<area shape="rect" href="classPeFile.html#aa8d033dfaeb206c4235410f24b083df5" title="create UPX0 section" alt="" coords="5,55,129,80"/>
</map>
</div>

</div>
</div>
<a id="a5e83b0eba96da31d037b5fa145f61ca7" name="a5e83b0eba96da31d037b5fa145f61ca7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e83b0eba96da31d037b5fa145f61ca7">&#9670;&#160;</a></span>getcounts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned * PeFile::Reloc::getcounts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00456">456</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  456</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classPeFile_1_1Reloc.html#abd39c068846140a9fc94caa2274a6b3e">counts</a>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="classPeFile32.html#af442d76c5b12d3f224d3c661882a20b6">PeFile32::processRelocs()</a>, and <a class="el" href="classPeFile64.html#a04bed4efe5fd80ea6bc7513befb169e0">PeFile64::processRelocs()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_a5e83b0eba96da31d037b5fa145f61ca7_icgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_a5e83b0eba96da31d037b5fa145f61ca7_icgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_a5e83b0eba96da31d037b5fa145f61ca7_icgraph" id="aclassPeFile_1_1Reloc_a5e83b0eba96da31d037b5fa145f61ca7_icgraph">
<area shape="rect" title=" " alt="" coords="232,31,409,56"/>
<area shape="rect" href="classPeFile32.html#af442d76c5b12d3f224d3c661882a20b6" title=" " alt="" coords="5,5,184,31"/>
<area shape="rect" href="classPeFile64.html#a04bed4efe5fd80ea6bc7513befb169e0" title=" " alt="" coords="5,55,184,80"/>
</map>
</div>

</div>
</div>
<a id="a3f3df8ae7a5feba1df21bd6076b08742" name="a3f3df8ae7a5feba1df21bd6076b08742"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f3df8ae7a5feba1df21bd6076b08742">&#9670;&#160;</a></span>initSpans()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PeFile::Reloc::initSpans </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00351">351</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  351</span>                            {</div>
<div class="line"><span class="lineno">  352</span>    start_buf = <a class="code hl_define" href="xspan_8h.html#a21999f476d1898d01d7042d17dae4029">SPAN_0_MAKE</a>(<span class="keywordtype">byte</span>, <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a>, <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a>); <span class="comment">// =&gt; now a SPAN_S</span></div>
<div class="line"><span class="lineno">  353</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel = <a class="code hl_define" href="xspan_8h.html#a1826f60b41ebe2a169eba6e5f6f16a42">SPAN_TYPE_CAST</a>(BaseReloc, start_buf);             <span class="comment">// SPAN_0</span></div>
<div class="line"><span class="lineno">  354</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1 = <a class="code hl_define" href="xspan_8h.html#a1826f60b41ebe2a169eba6e5f6f16a42">SPAN_TYPE_CAST</a>(<a class="code hl_struct" href="structLE16.html">LE16</a>, start_buf);                 <span class="comment">// SPAN_0</span></div>
<div class="line"><span class="lineno">  355</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_function" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#ad60ee6c44fa61d009f66c8c48e847dad">reset</a>();</div>
<div class="line"><span class="lineno">  356</span>}</div>
<div class="ttc" id="axspan_8h_html_a21999f476d1898d01d7042d17dae4029"><div class="ttname"><a href="xspan_8h.html#a21999f476d1898d01d7042d17dae4029">SPAN_0_MAKE</a></div><div class="ttdeci">#define SPAN_0_MAKE</div><div class="ttdef"><b>Definition:</b> <a href="xspan_8h_source.html#l00178">xspan.h:178</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="xspan_8h.html#a21999f476d1898d01d7042d17dae4029">SPAN_0_MAKE</a>, and <a class="el" href="xspan_8h.html#a1826f60b41ebe2a169eba6e5f6f16a42">SPAN_TYPE_CAST</a>.</p>

</div>
</div>
<a id="ab4ac69f442e78ce8e5ed49d43f669b51" name="ab4ac69f442e78ce8e5ed49d43f669b51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ac69f442e78ce8e5ed49d43f669b51">&#9670;&#160;</a></span>next()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PeFile::Reloc::next </td>
          <td>(</td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>result_pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned &amp;&#160;</td>
          <td class="paramname"><em>result_reloc_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00400">400</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  400</span>                                                                        {</div>
<div class="line"><span class="lineno">  401</span>    assert(!<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a>);</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">for</span> (;;) {</div>
<div class="line"><span class="lineno">  403</span>        <span class="comment">// search current block</span></div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">while</span> (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_variable" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#a75a61a50bbe9e894b3d216e0c43f224c">count</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  405</span>            <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_variable" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#a75a61a50bbe9e894b3d216e0c43f224c">count</a> -= 1;</div>
<div class="line"><span class="lineno">  406</span>            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> value = *<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1++;</div>
<div class="line"><span class="lineno">  407</span>            result_pos = <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel-&gt;virtual_address + (value &amp; 0xfff);</div>
<div class="line"><span class="lineno">  408</span>            result_reloc_type = (value &gt;&gt; 12) &amp; 0xf;</div>
<div class="line"><span class="lineno">  409</span>            <a class="code hl_function" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a>(<span class="stringliteral">&quot;Reloc::next %#x %d\n&quot;</span>, result_pos, result_reloc_type);</div>
<div class="line"><span class="lineno">  410</span>            <span class="keywordflow">if</span> (result_reloc_type != <a class="code hl_enumvalue" href="classPeFile.html#a7de746815d41e6f494669bec5bb0f103abb445a70d0174ef143dee2f07173a53d">IMAGE_REL_BASED_IGNORE</a>)</div>
<div class="line"><span class="lineno">  411</span>                <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// success</span></div>
<div class="line"><span class="lineno">  412</span>        }</div>
<div class="line"><span class="lineno">  413</span>        <span class="comment">// advance to next block</span></div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordtype">byte</span> *next_rb = (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel == <span class="keyword">nullptr</span>) ? <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a> : (<span class="keywordtype">byte</span> *) <a class="code hl_function" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751">raw_bytes</a>(<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1, 0);</div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPeFile_1_1Reloc.html#a2d5a92fe95758c82bb2f026850e6bd1b">readFromRelocationBlock</a>(next_rb)) {</div>
<div class="line"><span class="lineno">  416</span>            <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_function" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#ad60ee6c44fa61d009f66c8c48e847dad">reset</a>();   <span class="comment">// rewind</span></div>
<div class="line"><span class="lineno">  417</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// EOF</span></div>
<div class="line"><span class="lineno">  418</span>        }</div>
<div class="line"><span class="lineno">  419</span>    }</div>
<div class="line"><span class="lineno">  420</span>}</div>
<div class="ttc" id="aclassPeFile_1_1Reloc_html_a2d5a92fe95758c82bb2f026850e6bd1b"><div class="ttname"><a href="classPeFile_1_1Reloc.html#a2d5a92fe95758c82bb2f026850e6bd1b">PeFile::Reloc::readFromRelocationBlock</a></div><div class="ttdeci">bool readFromRelocationBlock(byte *)</div><div class="ttdef"><b>Definition:</b> <a href="pefile_8cpp_source.html#l00359">pefile.cpp:359</a></div></div>
<div class="ttc" id="aconf_8h_html_af79eab1f480f5a57b6bfbff38256b0d2"><div class="ttname"><a href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf</a></div><div class="ttdeci">void NO_printf(const char *,...) noexcept attribute_format(1</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00375">conf.h:375</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classPeFile.html#a7de746815d41e6f494669bec5bb0f103abb445a70d0174ef143dee2f07173a53d">PeFile::IMAGE_REL_BASED_IGNORE</a>, <a class="el" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2">NO_printf()</a>, and <a class="el" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751">raw_bytes()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPeFile.html#aa56a9d4583f360bfc3d4d1c62e63d1c8">PeFile::processLoadConf()</a>, <a class="el" href="classPeFile32.html#af442d76c5b12d3f224d3c661882a20b6">PeFile32::processRelocs()</a>, <a class="el" href="classPeFile64.html#a04bed4efe5fd80ea6bc7513befb169e0">PeFile64::processRelocs()</a>, and <a class="el" href="classPeFile.html#a72740c1b72ad602b4b9e0a607c745713">PeFile::processTls1()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_cgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_cgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_cgraph" id="aclassPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_cgraph">
<area shape="rect" title=" " alt="" coords="5,43,148,68"/>
<area shape="rect" href="conf_8h.html#af79eab1f480f5a57b6bfbff38256b0d2" title=" " alt="" coords="199,5,283,31"/>
<area shape="rect" href="membuffer_8h.html#a8bc8e23a965fc63e336d6158814f5751" title=" " alt="" coords="196,79,285,104"/>
<area shape="rect" href="classMemBufferBase.html#a251f844e7095c2d09002cf356e3ed208" title=" " alt="" coords="333,71,492,111"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="540,79,659,104"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_icgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_icgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_icgraph" id="aclassPeFile_1_1Reloc_ab4ac69f442e78ce8e5ed49d43f669b51_icgraph">
<area shape="rect" title=" " alt="" coords="233,80,376,105"/>
<area shape="rect" href="classPeFile.html#aa56a9d4583f360bfc3d4d1c62e63d1c8" title="Load Configuration handling." alt="" coords="5,5,185,31"/>
<area shape="rect" href="classPeFile32.html#af442d76c5b12d3f224d3c661882a20b6" title=" " alt="" coords="6,55,185,80"/>
<area shape="rect" href="classPeFile64.html#a04bed4efe5fd80ea6bc7513befb169e0" title=" " alt="" coords="6,104,185,129"/>
<area shape="rect" href="classPeFile.html#a72740c1b72ad602b4b9e0a607c745713" title=" " alt="" coords="22,153,169,179"/>
</map>
</div>

</div>
</div>
<a id="a2d5a92fe95758c82bb2f026850e6bd1b" name="a2d5a92fe95758c82bb2f026850e6bd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d5a92fe95758c82bb2f026850e6bd1b">&#9670;&#160;</a></span>readFromRelocationBlock()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PeFile::Reloc::readFromRelocationBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *&#160;</td>
          <td class="paramname"><em>next_rb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8cpp_source.html#l00359">359</a> of file <a class="el" href="pefile_8cpp_source.html">pefile.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  359</span>                                                       { <span class="comment">// set rb</span></div>
<div class="line"><span class="lineno">  360</span>    assert(!<a class="code hl_variable" href="classPeFile_1_1Reloc.html#a3971fd1d95cb4ef9755b9d2ebba88153">start_did_alloc</a>);</div>
<div class="line"><span class="lineno">  361</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> off = <a class="code hl_function" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes</a>(next_rb, <a class="code hl_variable" href="classPeFile_1_1Reloc.html#acea4d9cde6e95239086fbd2d56d2cf69">start</a>);</div>
<div class="line"><span class="lineno">  362</span>    assert((off &amp; 1) == 0);</div>
<div class="line"><span class="lineno">  363</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_function" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#ad60ee6c44fa61d009f66c8c48e847dad">reset</a>();</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">if</span> (off &gt;= <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a>) { <span class="comment">// permissive: use &quot;&gt;=&quot; instead of strict &quot;==&quot;</span></div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">if</span> (off &gt; <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a>) {</div>
<div class="line"><span class="lineno">  366</span>            <span class="comment">// MAYBE TODO later: could add a warning here?</span></div>
<div class="line"><span class="lineno">  367</span>        }</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// EOF</span></div>
<div class="line"><span class="lineno">  369</span>    }</div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> - off &lt; 8)</div>
<div class="line"><span class="lineno">  371</span>        <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;relocs overflow&quot;</span>);</div>
<div class="line"><span class="lineno">  372</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sob = <a class="code hl_function" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a>(start_buf + (off + 4)); <span class="comment">// size_of_block</span></div>
<div class="line"><span class="lineno">  373</span><span class="preprocessor">#if 1</span></div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">// ignore a dubious single empty relocation block with sob == 0</span></div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordflow">if</span> (sob == 0 &amp;&amp; (off == 0 &amp;&amp; <a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> == 8))</div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// EOF</span></div>
<div class="line"><span class="lineno">  377</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="pefile_8cpp.html#a24ca95aa0001994cba9787266a6b0429">ALWAYS_CHECK_STRICT_RELOCS</a>) {</div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordflow">if</span> (sob &lt; 8)</div>
<div class="line"><span class="lineno">  380</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad reloc size_of_block %u&quot;</span>, sob);</div>
<div class="line"><span class="lineno">  381</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> - off &lt; sob)</div>
<div class="line"><span class="lineno">  382</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;overflow reloc size_of_block %u&quot;</span>, sob);</div>
<div class="line"><span class="lineno">  383</span>        <span class="keywordflow">if</span> ((sob &amp; 1) != 0)</div>
<div class="line"><span class="lineno">  384</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;odd reloc size_of_block %u&quot;</span>, sob);</div>
<div class="line"><span class="lineno">  385</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>-&gt;force) {</div>
<div class="line"><span class="lineno">  386</span>        <span class="keywordflow">if</span> (sob &lt; 8)</div>
<div class="line"><span class="lineno">  387</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;bad reloc size_of_block %u (try --force)&quot;</span>, sob);</div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPeFile_1_1Reloc.html#aef4f860c18404d424cc1ea20bc304658">start_size_in_bytes</a> - off &lt; sob)</div>
<div class="line"><span class="lineno">  389</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;overflow reloc size_of_block %u (try --force)&quot;</span>, sob);</div>
<div class="line"><span class="lineno">  390</span>        <span class="keywordflow">if</span> ((sob &amp; 1) != 0)</div>
<div class="line"><span class="lineno">  391</span>            <a class="code hl_function" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack</a>(<span class="stringliteral">&quot;odd reloc size_of_block %u (try --force)&quot;</span>, sob);</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span>    <span class="comment">// success</span></div>
<div class="line"><span class="lineno">  394</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel = (BaseReloc *) next_rb;   <span class="comment">// SPAN checked</span></div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.rel1 = (<a class="code hl_struct" href="structLE16.html">LE16</a> *) (next_rb + 8); <span class="comment">// SPAN checked</span></div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_variable" href="classPeFile_1_1Reloc.html#a6d72cec859fb7a0f61273022ed60080f">rb</a>.<a class="code hl_variable" href="structPeFile_1_1Reloc_1_1RelocationBlock.html#a75a61a50bbe9e894b3d216e0c43f224c">count</a> = sob &lt; 8 ? 0 : (sob - 8) / <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structLE16.html">LE16</a>);</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  398</span>}</div>
<div class="ttc" id="abele_8h_html_a975f8af4219a9c95cf3395cbd46fc472"><div class="ttname"><a href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32</a></div><div class="ttdeci">REQUIRE_XE32 bele_constexpr unsigned get_le32(const XE32 *p) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="bele_8h_source.html#l00327">bele.h:327</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pefile_8cpp.html#a24ca95aa0001994cba9787266a6b0429">ALWAYS_CHECK_STRICT_RELOCS</a>, <a class="el" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472">get_le32()</a>, <a class="el" href="options_8cpp.html#a887b9edd7a68b4cde1de1f0d7ac1d6eb">opt</a>, <a class="el" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0">ptr_udiff_bytes()</a>, and <a class="el" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff">throwCantPack()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classPeFile_1_1Reloc_a2d5a92fe95758c82bb2f026850e6bd1b_cgraph.png" border="0" usemap="#aclassPeFile_1_1Reloc_a2d5a92fe95758c82bb2f026850e6bd1b_cgraph" alt=""/></div>
<map name="aclassPeFile_1_1Reloc_a2d5a92fe95758c82bb2f026850e6bd1b_cgraph" id="aclassPeFile_1_1Reloc_a2d5a92fe95758c82bb2f026850e6bd1b_cgraph">
<area shape="rect" title=" " alt="" coords="5,161,249,201"/>
<area shape="rect" href="bele_8h.html#a975f8af4219a9c95cf3395cbd46fc472" title=" " alt="" coords="317,94,396,119"/>
<area shape="rect" href="util_8cpp.html#a49db04c61486d695f7f04b44ac2201c0" title=" " alt="" coords="297,169,416,194"/>
<area shape="rect" href="except_8cpp.html#a388ab1f73d9ba5222a35cbdd67b396ff" title="compression" alt="" coords="649,207,767,233"/>
<area shape="rect" href="bele_8h.html#a1314f3e23986bd34448f6f9d00884fbe" title=" " alt="" coords="478,79,561,105"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a79fb2f241fcb7bcba4da861c7ba3e52d" title=" " alt="" coords="633,44,783,84"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a623cf193544d13a4a34436bd5ee84dc8" title=" " alt="" coords="841,5,992,45"/>
<area shape="rect" href="namespaceupx_1_1compile__time.html#a61a216c2aecc9431c1464e50239871c8" title=" " alt="" coords="841,69,992,109"/>
<area shape="rect" href="util_8cpp.html#a420c4464159a133442e53a0d8dafc225" title="ptr util" alt="" coords="464,133,575,158"/>
<area shape="rect" href="util_8h.html#ad55181add5f2758a5f49cf106faef962" title="upx_rsize_t and mem_size: assert sane memory buffer sizes to protect against integer overflows and ma..." alt="" coords="623,109,793,134"/>
<area shape="rect" href="util_8h.html#a38df66b3eff123e66d6b92ceb76eb4c3" title=" " alt="" coords="659,158,757,183"/>
<area shape="rect" href="util_8h.html#ada5fbeddd8d88707d5b8dd9fa6557c65" title="ptr util" alt="" coords="853,158,980,183"/>
</map>
</div>

</div>
</div>
<a id="a62b1866ad6bbceaf3f3fd30fc0c13ae8" name="a62b1866ad6bbceaf3f3fd30fc0c13ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b1866ad6bbceaf3f3fd30fc0c13ae8">&#9670;&#160;</a></span>SPAN_0()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PeFile::Reloc::SPAN_0 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="abd39c068846140a9fc94caa2274a6b3e" name="abd39c068846140a9fc94caa2274a6b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd39c068846140a9fc94caa2274a6b3e">&#9670;&#160;</a></span>counts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PeFile::Reloc::counts[16] = {}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00447">447</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>

</div>
</div>
<a id="a6d72cec859fb7a0f61273022ed60080f" name="a6d72cec859fb7a0f61273022ed60080f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d72cec859fb7a0f61273022ed60080f">&#9670;&#160;</a></span>rb</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structPeFile_1_1Reloc_1_1RelocationBlock.html">RelocationBlock</a> PeFile::Reloc::rb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00444">444</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>

</div>
</div>
<a id="acea4d9cde6e95239086fbd2d56d2cf69" name="acea4d9cde6e95239086fbd2d56d2cf69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea4d9cde6e95239086fbd2d56d2cf69">&#9670;&#160;</a></span>start</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a>* PeFile::Reloc::start = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00428">428</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>

</div>
</div>
<a id="a3971fd1d95cb4ef9755b9d2ebba88153" name="a3971fd1d95cb4ef9755b9d2ebba88153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3971fd1d95cb4ef9755b9d2ebba88153">&#9670;&#160;</a></span>start_did_alloc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PeFile::Reloc::start_did_alloc = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00430">430</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>

</div>
</div>
<a id="aef4f860c18404d424cc1ea20bc304658" name="aef4f860c18404d424cc1ea20bc304658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef4f860c18404d424cc1ea20bc304658">&#9670;&#160;</a></span>start_size_in_bytes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned PeFile::Reloc::start_size_in_bytes = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pefile_8h_source.html#l00429">429</a> of file <a class="el" href="pefile_8h_source.html">pefile.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="pefile_8h_source.html">pefile.h</a></li>
<li>src/<a class="el" href="pefile_8cpp_source.html">pefile.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classPeFile.html">PeFile</a></li><li class="navelem"><a class="el" href="classPeFile_1_1Reloc.html">Reloc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
