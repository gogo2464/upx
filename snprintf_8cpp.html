<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/util/snprintf.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('snprintf_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">snprintf.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="conf_8h_source.html">../conf.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for snprintf.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp__incl.png" border="0" usemap="#asrc_2util_2snprintf_8cpp" alt=""/></div>
<map name="asrc_2util_2snprintf_8cpp" id="asrc_2util_2snprintf_8cpp">
<area shape="rect" title=" " alt="" coords="2189,5,2336,31"/>
<area shape="rect" href="conf_8h.html" title=" " alt="" coords="2226,79,2299,104"/>
<area shape="rect" href="system__headers_8h.html" title=" " alt="" coords="590,152,756,177"/>
<area shape="rect" href="system__check__predefs_8h.html" title=" " alt="" coords="647,387,830,412"/>
<area shape="rect" href="system__undefs_8h.html" title=" " alt="" coords="1419,152,1578,177"/>
<area shape="rect" href="version_8h.html" title=" " alt="" coords="1602,152,1685,177"/>
<area shape="rect" href="cxxlib_8h.html" title=" " alt="" coords="1709,152,1808,177"/>
<area shape="rect" title=" " alt="" coords="1832,152,2010,177"/>
<area shape="rect" title=" " alt="" coords="2034,152,2184,177"/>
<area shape="rect" href="snprintf_8h.html" title=" " alt="" coords="2208,152,2316,177"/>
<area shape="rect" href="util_8h.html" title=" " alt="" coords="2341,152,2421,177"/>
<area shape="rect" href="options_8h.html" title=" " alt="" coords="2445,152,2528,177"/>
<area shape="rect" href="except_8h.html" title=" " alt="" coords="2552,152,2631,177"/>
<area shape="rect" href="bele_8h.html" title=" " alt="" coords="2655,152,2718,177"/>
<area shape="rect" href="console_8h.html" title=" " alt="" coords="2742,152,2881,177"/>
<area shape="rect" href="raw__bytes_8h.html" title=" " alt="" coords="2906,152,3032,177"/>
<area shape="rect" href="xspan_8h.html" title=" " alt="" coords="3057,152,3156,177"/>
<area shape="rect" href="system__defs_8h.html" title=" " alt="" coords="38,313,156,339"/>
<area shape="rect" href="system__features_8h.html" title=" " alt="" coords="26,233,168,258"/>
<area shape="rect" href="miniacc_8h.html" title=" " alt="" coords="193,233,278,258"/>
<area shape="rect" title=" " alt="" coords="303,233,374,258"/>
<area shape="rect" title=" " alt="" coords="398,233,465,258"/>
<area shape="rect" title=" " alt="" coords="490,233,576,258"/>
<area shape="rect" title=" " alt="" coords="600,233,650,258"/>
<area shape="rect" title=" " alt="" coords="674,233,766,258"/>
<area shape="rect" title=" " alt="" coords="790,233,850,258"/>
<area shape="rect" title=" " alt="" coords="874,233,960,258"/>
<area shape="rect" title=" " alt="" coords="984,233,1061,258"/>
<area shape="rect" title=" " alt="" coords="1086,225,1244,265"/>
<area shape="rect" title=" " alt="" coords="1269,233,1344,258"/>
<area shape="rect" title=" " alt="" coords="200,313,271,339"/>
<area shape="rect" href="bele__policy_8h.html" title=" " alt="" coords="2633,233,2740,258"/>
<area shape="rect" href="xspan__impl_8h.html" title=" " alt="" coords="3052,233,3161,258"/>
</map>
</div>
</div>
<p><a href="snprintf_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a417fef1b5cd577cfc9a2836bb40fa885"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#ac49c6ee626aef90777d2105d61d23884">upx_safe_strlen</a></td></tr>
<tr class="separator:a417fef1b5cd577cfc9a2836bb40fa885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a417fef1b5cd577cfc9a2836bb40fa885"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#ac49c6ee626aef90777d2105d61d23884">upx_safe_strlen</a></td></tr>
<tr class="separator:a417fef1b5cd577cfc9a2836bb40fa885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00ba2ca988495904efc418acbf0627d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a></td></tr>
<tr class="separator:a00ba2ca988495904efc418acbf0627d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00ba2ca988495904efc418acbf0627d7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a></td></tr>
<tr class="separator:a00ba2ca988495904efc418acbf0627d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac49c6ee626aef90777d2105d61d23884"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#ac49c6ee626aef90777d2105d61d23884">upx_safe_strlen</a> (const char *s)</td></tr>
<tr class="memdesc:ac49c6ee626aef90777d2105d61d23884"><td class="mdescLeft">&#160;</td><td class="mdescRight">UPX version of string functions, with assertions and sane limits.  <br /></td></tr>
<tr class="separator:ac49c6ee626aef90777d2105d61d23884"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa704c100eb475276a64c7f43bf299c5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#aa704c100eb475276a64c7f43bf299c5d">upx_safe_strlen_noexcept</a> (const char *s) noexcept</td></tr>
<tr class="separator:aa704c100eb475276a64c7f43bf299c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe32fefd67da2c86f318a89731cdad88"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a> (char *str, <a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a> max_size, const char *format, va_list ap)</td></tr>
<tr class="separator:afe32fefd67da2c86f318a89731cdad88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42250e1e335a2b4f145b776af619c05e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a42250e1e335a2b4f145b776af619c05e">upx_safe_vsnprintf_noexcept</a> (char *str, <a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a> max_size, const char *format, va_list ap) noexcept</td></tr>
<tr class="separator:a42250e1e335a2b4f145b776af619c05e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb5ecd87245d4c8804418d9fd916d5f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f">upx_safe_snprintf</a> (char *str, <a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a> max_size, const char *format,...)</td></tr>
<tr class="separator:aefb5ecd87245d4c8804418d9fd916d5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe4fbca72a8613a044a180546c89c3fb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf</a> (char **<a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, const char *format, va_list ap)</td></tr>
<tr class="separator:abe4fbca72a8613a044a180546c89c3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22424cbb4c1d4ffe04729daecfc54e61"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a22424cbb4c1d4ffe04729daecfc54e61">upx_safe_asprintf</a> (char **<a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, const char *format,...)</td></tr>
<tr class="separator:a22424cbb4c1d4ffe04729daecfc54e61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb53e9895b931be2924d854870908b9"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="snprintf_8cpp.html#a4fb53e9895b931be2924d854870908b9">upx_safe_xprintf</a> (const char *format,...)</td></tr>
<tr class="separator:a4fb53e9895b931be2924d854870908b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a417fef1b5cd577cfc9a2836bb40fa885" name="a417fef1b5cd577cfc9a2836bb40fa885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a417fef1b5cd577cfc9a2836bb40fa885">&#9670;&#160;</a></span>strlen <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define strlen&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#ac49c6ee626aef90777d2105d61d23884">upx_safe_strlen</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a417fef1b5cd577cfc9a2836bb40fa885" name="a417fef1b5cd577cfc9a2836bb40fa885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a417fef1b5cd577cfc9a2836bb40fa885">&#9670;&#160;</a></span>strlen <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define strlen&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#ac49c6ee626aef90777d2105d61d23884">upx_safe_strlen</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a00ba2ca988495904efc418acbf0627d7" name="a00ba2ca988495904efc418acbf0627d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00ba2ca988495904efc418acbf0627d7">&#9670;&#160;</a></span>vsnprintf <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vsnprintf&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a00ba2ca988495904efc418acbf0627d7" name="a00ba2ca988495904efc418acbf0627d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00ba2ca988495904efc418acbf0627d7">&#9670;&#160;</a></span>vsnprintf <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vsnprintf&#160;&#160;&#160;<a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a22424cbb4c1d4ffe04729daecfc54e61" name="a22424cbb4c1d4ffe04729daecfc54e61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22424cbb4c1d4ffe04729daecfc54e61">&#9670;&#160;</a></span>upx_safe_asprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upx_safe_asprintf </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00141">141</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>                                                           {</div>
<div class="line"><span class="lineno">  142</span>    va_list ap;</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordtype">int</span> len;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    va_start(ap, format);</div>
<div class="line"><span class="lineno">  146</span>    len = <a class="code hl_function" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf</a>(<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, format, ap);</div>
<div class="line"><span class="lineno">  147</span>    va_end(ap);</div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">return</span> len;</div>
<div class="line"><span class="lineno">  149</span>}</div>
<div class="ttc" id="alzma__m_8h_html_a7b01bc9a5d719e0ece76d9b8dd822dde"><div class="ttname"><a href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a></div><div class="ttdeci">macro M_PIA_small add bx adc mov cl mov __AHSHIFT shl cl add bl endm macro M_PIA_fast add bx adc shl cl shl cl shl cl shl cl add cl endm macro M_PIA1_small L1 inc ax jnes L1 add __AHINCR sbb bl and __AHINCR add bl endm macro M_PTS endm macro M_PTC L1 cmp cx jnes L1 cmp bx bx jnes l cmp cx jnes l endm macro M_U4M_dxax_00bx mov ax mov dx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_00bx_ptr mov ax mov dx mul word ptr[bx] xchg cx mul word ptr[bx] add cx endm macro M_U4M_axcx_00bx mul bx xchg cx mul bx add cx endm macro M_U4M_dxax_0x0600 shl ax rcl dx mov dx mov ax shl ax rcl dx add bx adc cx M_shld_8 endm macro M_shld_8 mov dl mov ah mov al xor al endm macro M_shld_disi_8_bxcx mov di mov si mov bl mov ch mov cl xor cl mov bx mov cx endm macro M_shld_diax_8_bxcx mov di mov bl mov ah mov al xor al mov bx endm macro M_shld_8_bp h l mov word ptr[bp+h] mov word ptr[bp+l] M_shld_8 mov word ptr[bp+h]</div><div class="ttdef"><b>Definition:</b> <a href="lzma__m_8h_source.html#l00292">lzma_m.h:292</a></div></div>
<div class="ttc" id="asnprintf_8cpp_html_abe4fbca72a8613a044a180546c89c3fb"><div class="ttname"><a href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf</a></div><div class="ttdeci">int upx_safe_vasprintf(char **ptr, const char *format, va_list ap)</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8cpp_source.html#l00119">snprintf.cpp:119</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, and <a class="el" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_a22424cbb4c1d4ffe04729daecfc54e61_cgraph.png" border="0" usemap="#asnprintf_8cpp_a22424cbb4c1d4ffe04729daecfc54e61_cgraph" alt=""/></div>
<map name="asnprintf_8cpp_a22424cbb4c1d4ffe04729daecfc54e61_cgraph" id="asnprintf_8cpp_a22424cbb4c1d4ffe04729daecfc54e61_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,31"/>
<area shape="rect" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb" title=" " alt="" coords="192,5,339,31"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="387,5,533,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="581,5,629,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="677,5,768,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="816,5,943,31"/>
</map>
</div>

</div>
</div>
<a id="aefb5ecd87245d4c8804418d9fd916d5f" name="aefb5ecd87245d4c8804418d9fd916d5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefb5ecd87245d4c8804418d9fd916d5f">&#9670;&#160;</a></span>upx_safe_snprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upx_safe_snprintf </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a>&#160;</td>
          <td class="paramname"><em>max_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00109">109</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>                                                                                {</div>
<div class="line"><span class="lineno">  110</span>    va_list ap;</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordtype">int</span> len;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    va_start(ap, format);</div>
<div class="line"><span class="lineno">  114</span>    len = <a class="code hl_function" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a>(str, max_size, format, ap);</div>
<div class="line"><span class="lineno">  115</span>    va_end(ap);</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">return</span> len;</div>
<div class="line"><span class="lineno">  117</span>}</div>
<div class="ttc" id="asnprintf_8cpp_html_afe32fefd67da2c86f318a89731cdad88"><div class="ttname"><a href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a></div><div class="ttdeci">int upx_safe_vsnprintf(char *str, upx_rsize_t max_size, const char *format, va_list ap)</div><div class="ttdef"><b>Definition:</b> <a href="snprintf_8cpp_source.html#l00052">snprintf.cpp:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPeFile_1_1ImportLinker.html#a9d3ea2cdd37f72f457346b9b2e0010dc">PeFile::ImportLinker::add_import()</a>, <a class="el" href="classPeFile.html#abf1fb5e63caa5794a600596bc3d9b099">PeFile::checkHeaderValues()</a>, <a class="el" href="classUiPacker.html#ad8ae73893897d820b121cfd367d10e77">UiPacker::doCallback()</a>, <a class="el" href="classElfLinker.html#ae734830b45899f5a685654cb1736697d">ElfLinker::dumpSymbol()</a>, <a class="el" href="classElfLinker.html#ab1fade76dc005235b127cd26316a51c4">ElfLinker::dumpSymbols()</a>, <a class="el" href="classPeFile_1_1ImportLinker.html#ab37e1dfdd7e53f34a3829a541d18c7ce">PeFile::ImportLinker::getAddress()</a>, <a class="el" href="util_8cpp.html#a822ef1a8d7f44a14b9c655a2e456940b">makebakname()</a>, <a class="el" href="util_8cpp.html#afd535abdda123db1d1b691b588917162">maketempname()</a>, <a class="el" href="ui_8cpp.html#a0b3f1497cefecad060e020f390bf0dcc">mkline()</a>, <a class="el" href="classPeFile_1_1ImportLinker.html#a7e904372b5c18a9bafc0a0075c078b0b">PeFile::ImportLinker::name_for_proc()</a>, <a class="el" href="msg_8cpp.html#aa1f2d3914fb7d6a826e7276e8f542847">pr_error()</a>, <a class="el" href="conf_8h.html#ac214d3199ed0588967b705d709909d67">printErr()</a>, <a class="el" href="classPeFile.html#aa837c0972c716047dfb4ddfd3d21e02f">PeFile::processResources()</a>, <a class="el" href="util_8cpp.html#a68184923ba8a182cf87e6f761f391b40">set_method_name()</a>, <a class="el" href="classUiPacker.html#aa6695297fa390bbcdf75526c701b5c2f">UiPacker::startCallback()</a>, <a class="el" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41">MemBuffer::subref_impl()</a>, <a class="el" href="classUiPacker.html#a2c6a2659f3d92d26f4ac922fc42f4252">UiPacker::uiListTotal()</a>, and <a class="el" href="dt__check_8cpp.html#a3a6b242ecd120ddf74c7aefb91486186">upx_compiler_sanity_check()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_cgraph.png" border="0" usemap="#asnprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_cgraph" alt=""/></div>
<map name="asnprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_cgraph" id="asnprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,31"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="192,5,339,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="387,5,435,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="483,5,573,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="621,5,748,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_icgraph.png" border="0" usemap="#asnprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_icgraph" alt=""/></div>
<map name="asnprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_icgraph" id="asnprintf_8cpp_aefb5ecd87245d4c8804418d9fd916d5f_icgraph">
<area shape="rect" title=" " alt="" coords="1252,727,1391,753"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a9d3ea2cdd37f72f457346b9b2e0010dc" title=" " alt="" coords="582,5,733,45"/>
<area shape="rect" href="classPeFile.html#abf1fb5e63caa5794a600596bc3d9b099" title=" " alt="" coords="299,337,496,362"/>
<area shape="rect" href="classUiPacker.html#ad8ae73893897d820b121cfd367d10e77" title=" " alt="" coords="1035,517,1194,542"/>
<area shape="rect" href="classUiPacker.html#aa6695297fa390bbcdf75526c701b5c2f" title=" " alt="" coords="571,602,743,627"/>
<area shape="rect" href="classElfLinker.html#ae734830b45899f5a685654cb1736697d" title=" " alt="" coords="1029,753,1201,778"/>
<area shape="rect" href="classElfLinker.html#ab1fade76dc005235b127cd26316a51c4" title=" " alt="" coords="799,753,977,778"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#ab37e1dfdd7e53f34a3829a541d18c7ce" title=" " alt="" coords="1039,803,1190,843"/>
<area shape="rect" href="util_8cpp.html#a822ef1a8d7f44a14b9c655a2e456940b" title=" " alt="" coords="1055,1017,1174,1042"/>
<area shape="rect" href="util_8cpp.html#afd535abdda123db1d1b691b588917162" title=" " alt="" coords="1050,967,1179,993"/>
<area shape="rect" href="ui_8cpp.html#a0b3f1497cefecad060e020f390bf0dcc" title=" " alt="" coords="1081,1118,1148,1143"/>
<area shape="rect" href="classUiPacker.html#a2c6a2659f3d92d26f4ac922fc42f4252" title=" " alt="" coords="812,1057,964,1082"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a7e904372b5c18a9bafc0a0075c078b0b" title=" " alt="" coords="1039,171,1190,211"/>
<area shape="rect" href="msg_8cpp.html#aa1f2d3914fb7d6a826e7276e8f542847" title=" " alt="" coords="1078,918,1151,943"/>
<area shape="rect" href="msg_8cpp.html#ac214d3199ed0588967b705d709909d67" title=" " alt="" coords="853,869,923,894"/>
<area shape="rect" href="classPeFile.html#aa837c0972c716047dfb4ddfd3d21e02f" title=" " alt="" coords="564,387,751,413"/>
<area shape="rect" href="util_8cpp.html#a68184923ba8a182cf87e6f761f391b40" title=" " alt="" coords="1043,651,1186,677"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="1025,286,1204,311"/>
<area shape="rect" href="dt__check_8cpp.html#a3a6b242ecd120ddf74c7aefb91486186" title=" " alt="" coords="579,1197,736,1237"/>
<area shape="rect" href="classPeFile.html#ad9fc5f9eff8c16e397552c1a0681b632" title="Create UPX0 section with compressed full executable." alt="" coords="115,362,223,387"/>
<area shape="rect" href="classUiPacker.html#ab786a18aad2abfb3e6e228b2a1061e6c" title=" " alt="" coords="803,438,973,463"/>
<area shape="rect" href="classUiPacker.html#a0b969da42e2785054c6ca9f98600eb42" title=" " alt="" coords="805,487,971,513"/>
<area shape="rect" href="classUiPacker.html#a0cb074e9a2b6997bd3094f10ba617554" title="the callback" alt="" coords="817,537,959,577"/>
<area shape="rect" href="work_8cpp.html#acb26fb37f44aef462017c0319a0c7b51" title="process one file" alt="" coords="840,997,936,1022"/>
<area shape="rect" href="work_8cpp.html#a9ec6798d280944a40890ad8f08dbe964" title=" " alt="" coords="361,1051,433,1077"/>
<area shape="rect" href="main_8cpp.html#ae733ccfc8b1bfd23af63d56f51903f1d" title="main entry point" alt="" coords="126,1051,213,1077"/>
<area shape="rect" href="main_8cpp.html#a7726c3c4e37d3478021cf41b755207eb" title="real entry point" alt="" coords="5,862,60,887"/>
<area shape="rect" href="classUiPacker.html#ad08273e0a8c72e60d1142cf8642a5a52" title=" " alt="" coords="827,1106,949,1131"/>
<area shape="rect" href="classUiPacker.html#a338cc89db30f2940545410a19a4d3313" title=" " alt="" coords="812,1155,964,1181"/>
<area shape="rect" href="classUiPacker.html#ad9dfb3d9345980ee7c9745a34660d530" title=" " alt="" coords="803,1205,973,1230"/>
<area shape="rect" href="classUiPacker.html#ad872e08ac0689db01af6b92981240926" title=" " alt="" coords="578,1047,737,1073"/>
<area shape="rect" href="classUiPacker.html#a12f3b46c4adf8051276daccaff15f2ee" title=" " alt="" coords="568,1097,747,1122"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a4eba97bc1df4f2743bab0757dd64acdf" title=" " alt="" coords="813,85,963,125"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#ae03ad2cf981fe13520474042323181fc" title=" " alt="" coords="813,171,963,211"/>
<area shape="rect" href="classPeFile.html#a1a99f1e23999449456ed83d219dd5150" title=" " alt="" coords="569,70,746,95"/>
<area shape="rect" href="classPeFile.html#a9c07dbb841251c1c147f94200868ae76" title=" " alt="" coords="309,178,486,203"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a922536bc6bdadd0eac70e61bae0f08f7" title=" " alt="" coords="582,171,733,211"/>
<area shape="rect" href="msg_8cpp.html#a108c61284004fd15ae8419264eb6e09b" title=" " alt="" coords="845,918,931,943"/>
<area shape="rect" href="classMemBuffer.html#adefde4c29dbecfa830fa198f6f22b538" title=" " alt="" coords="583,845,732,870"/>
<area shape="rect" href="msg_8cpp.html#a949f70c2ca1e1beaecea9a2b91e8582a" title=" " alt="" coords="564,946,751,971"/>
<area shape="rect" href="classPackWcle.html#abd8a5d698ae53f1e4182902b62dd751e" title=" " alt="" coords="307,723,488,749"/>
<area shape="rect" href="classPackVmlinuzI386.html#a398205192b0191637b8f06fe18b04447" title=" " alt="" coords="287,773,507,813"/>
<area shape="rect" href="classPackVmlinuzARMEL.html#a57f63d0522c104a49326d091701a1292" title=" " alt="" coords="279,837,516,877"/>
<area shape="rect" href="classPackWcle.html#a2c3b799c69917a8aa184c3216dca8734" title=" " alt="" coords="307,953,487,978"/>
<area shape="rect" href="classPackWcle.html#ae1a86eced9af3a3422bd9ebeacac907d" title=" " alt="" coords="108,927,231,953"/>
<area shape="rect" href="classPackTmt.html#a9847e2567fdbb210ec015dbaf4102374" title=" " alt="" coords="339,1002,456,1027"/>
<area shape="rect" href="classPeFile.html#a8232ec2b156471ca27d54bfdc7594dd4" title=" " alt="" coords="293,438,502,463"/>
<area shape="rect" href="classPackPs1.html#a542fd798443fb299c1d95ee98db5ae53" title=" " alt="" coords="831,653,945,678"/>
<area shape="rect" href="classUiPacker.html#a887309fdbf007cc17ddfa2896ee3f63c" title="start callback" alt="" coords="817,702,959,727"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="817,286,959,311"/>
</map>
</div>

</div>
</div>
<a id="ac49c6ee626aef90777d2105d61d23884" name="ac49c6ee626aef90777d2105d61d23884"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49c6ee626aef90777d2105d61d23884">&#9670;&#160;</a></span>upx_safe_strlen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a> upx_safe_strlen </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>UPX version of string functions, with assertions and sane limits. </p>

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00034">34</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>                                           {</div>
<div class="line"><span class="lineno">   35</span><span class="preprocessor">#undef strlen</span></div>
<div class="line"><span class="lineno">   36</span>    assert(s != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordtype">size_t</span> len = <a class="code hl_define" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>(s);</div>
<div class="line"><span class="lineno">   38</span>    assert(len &lt; <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">return</span> len;</div>
<div class="line"><span class="lineno">   40</span><span class="preprocessor">#define strlen upx_safe_strlen</span></div>
<div class="line"><span class="lineno">   41</span>}</div>
<div class="ttc" id="aconf_8h_html_a0b8b7ab807afaa9e73cb750887aa60b9"><div class="ttname"><a href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a></div><div class="ttdeci">#define UPX_RSIZE_MAX_STR</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00157">conf.h:157</a></div></div>
<div class="ttc" id="asnprintf_8cpp_html_a417fef1b5cd577cfc9a2836bb40fa885"><div class="ttname"><a href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a></div><div class="ttdeci">#define strlen</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>, and <a class="el" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>.</p>

<p class="reference">Referenced by <a class="el" href="classPeFile.html#a9c07dbb841251c1c147f94200868ae76">PeFile::processImports0()</a>, and <a class="el" href="snprintf_8h.html#a99b7f47bf84177456f9c049da58e223e">upx_safe_strlen()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_ac49c6ee626aef90777d2105d61d23884_icgraph.png" border="0" usemap="#asnprintf_8cpp_ac49c6ee626aef90777d2105d61d23884_icgraph" alt=""/></div>
<map name="asnprintf_8cpp_ac49c6ee626aef90777d2105d61d23884_icgraph" id="asnprintf_8cpp_ac49c6ee626aef90777d2105d61d23884_icgraph">
<area shape="rect" title="UPX version of string functions, with assertions and sane limits." alt="" coords="231,31,356,56"/>
<area shape="rect" href="classPeFile.html#a9c07dbb841251c1c147f94200868ae76" title=" " alt="" coords="5,5,183,31"/>
<area shape="rect" href="snprintf_8h.html#a99b7f47bf84177456f9c049da58e223e" title="some uchar string support functions to avoid casts" alt="" coords="31,55,157,80"/>
</map>
</div>

</div>
</div>
<a id="aa704c100eb475276a64c7f43bf299c5d" name="aa704c100eb475276a64c7f43bf299c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa704c100eb475276a64c7f43bf299c5d">&#9670;&#160;</a></span>upx_safe_strlen_noexcept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a> upx_safe_strlen_noexcept </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00043">43</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>                                                             {</div>
<div class="line"><span class="lineno">   44</span><span class="preprocessor">#undef strlen</span></div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(s != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordtype">size_t</span> len = <a class="code hl_define" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>(s);</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(len &lt; <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">return</span> len;</div>
<div class="line"><span class="lineno">   49</span><span class="preprocessor">#define strlen upx_safe_strlen</span></div>
<div class="line"><span class="lineno">   50</span>}</div>
<div class="ttc" id="aconf_8h_html_a2b4c65ac64db4f1fec7f03b6dcd0eaa8"><div class="ttname"><a href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a></div><div class="ttdeci">#define assert_noexcept</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00478">conf.h:478</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>, <a class="el" href="snprintf_8cpp.html#a417fef1b5cd577cfc9a2836bb40fa885">strlen</a>, and <a class="el" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>.</p>

</div>
</div>
<a id="abe4fbca72a8613a044a180546c89c3fb" name="abe4fbca72a8613a044a180546c89c3fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe4fbca72a8613a044a180546c89c3fb">&#9670;&#160;</a></span>upx_safe_vasprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upx_safe_vasprintf </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00119">119</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  119</span>                                                                   {</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordtype">int</span> len;</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    assert(<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  123</span>    *<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    va_list ap_copy;</div>
<div class="line"><span class="lineno">  126</span>    va_copy(ap_copy, ap);</div>
<div class="line"><span class="lineno">  127</span>    len = <a class="code hl_function" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a>(<span class="keyword">nullptr</span>, 0, format, ap_copy);</div>
<div class="line"><span class="lineno">  128</span>    va_end(ap_copy);</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">if</span> (len &gt;= 0) {</div>
<div class="line"><span class="lineno">  131</span>        *<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> = (<span class="keywordtype">char</span> *) ::malloc(len + 1);</div>
<div class="line"><span class="lineno">  132</span>        assert(*<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">if</span> (*<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  134</span>            <span class="keywordflow">return</span> -1;</div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordtype">int</span> len2 = <a class="code hl_function" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf</a>(*<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, len + 1, format, ap);</div>
<div class="line"><span class="lineno">  136</span>        assert(len2 == len);</div>
<div class="line"><span class="lineno">  137</span>    }</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">return</span> len;</div>
<div class="line"><span class="lineno">  139</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, and <a class="el" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88">upx_safe_vsnprintf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="snprintf_8cpp.html#a22424cbb4c1d4ffe04729daecfc54e61">upx_safe_asprintf()</a>, and <a class="el" href="snprintf_8cpp.html#a4fb53e9895b931be2924d854870908b9">upx_safe_xprintf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_cgraph.png" border="0" usemap="#asnprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_cgraph" alt=""/></div>
<map name="asnprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_cgraph" id="asnprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,152,31"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="200,5,347,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="395,5,443,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="491,5,581,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="629,5,756,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_icgraph.png" border="0" usemap="#asnprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_icgraph" alt=""/></div>
<map name="asnprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_icgraph" id="asnprintf_8cpp_abe4fbca72a8613a044a180546c89c3fb_icgraph">
<area shape="rect" title=" " alt="" coords="192,31,339,56"/>
<area shape="rect" href="snprintf_8cpp.html#a22424cbb4c1d4ffe04729daecfc54e61" title=" " alt="" coords="5,5,144,31"/>
<area shape="rect" href="snprintf_8cpp.html#a4fb53e9895b931be2924d854870908b9" title=" " alt="" coords="9,55,140,80"/>
</map>
</div>

</div>
</div>
<a id="afe32fefd67da2c86f318a89731cdad88" name="afe32fefd67da2c86f318a89731cdad88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe32fefd67da2c86f318a89731cdad88">&#9670;&#160;</a></span>upx_safe_vsnprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int upx_safe_vsnprintf </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a>&#160;</td>
          <td class="paramname"><em>max_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00052">52</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                                                        {</div>
<div class="line"><span class="lineno">   53</span><span class="preprocessor">#undef vsnprintf</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">// preconditions</span></div>
<div class="line"><span class="lineno">   57</span>    assert(max_size &lt;= <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> (str != <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">   59</span>        assert(max_size &gt; 0);</div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   61</span>        assert(max_size == 0);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> len = <a class="code hl_define" href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>(str, max_size, format, ap);</div>
<div class="line"><span class="lineno">   64</span>    assert(len &gt;= 0);</div>
<div class="line"><span class="lineno">   65</span>    assert(len &lt; <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> = (<a class="code hl_typedef" href="bsd_8h.html#acf18a0d6c4b39d531e021702e9a77984">size_t</a>) len + 1;</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">// postconditions</span></div>
<div class="line"><span class="lineno">   69</span>    assert(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> &gt; 0);</div>
<div class="line"><span class="lineno">   70</span>    assert(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> &lt;= <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">if</span> (str != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">   72</span>        assert(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> &lt;= max_size);</div>
<div class="line"><span class="lineno">   73</span>        assert(str[<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> - 1] == <span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><span class="lineno">   74</span>    }</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="miniacc_8h.html#a8418a712b181d53b01101c70f6090ee5">ACC_ICONV</a>(<span class="keywordtype">int</span>, <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> - 1); <span class="comment">// snprintf() returns length, not size</span></div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">#define vsnprintf upx_safe_vsnprintf</span></div>
<div class="line"><span class="lineno">   78</span>}</div>
<div class="ttc" id="absd_8h_html_acf18a0d6c4b39d531e021702e9a77984"><div class="ttname"><a href="bsd_8h.html#acf18a0d6c4b39d531e021702e9a77984">size_t</a></div><div class="ttdeci">unsigned long size_t</div><div class="ttdef"><b>Definition:</b> <a href="bsd_8h_source.html#l00054">bsd.h:54</a></div></div>
<div class="ttc" id="aminiacc_8h_html_a8418a712b181d53b01101c70f6090ee5"><div class="ttname"><a href="miniacc_8h.html#a8418a712b181d53b01101c70f6090ee5">ACC_ICONV</a></div><div class="ttdeci">#define ACC_ICONV(t, e)</div><div class="ttdef"><b>Definition:</b> <a href="miniacc_8h_source.html#l01546">miniacc.h:1546</a></div></div>
<div class="ttc" id="asnprintf_8cpp_html_a00ba2ca988495904efc418acbf0627d7"><div class="ttname"><a href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a></div><div class="ttdeci">#define vsnprintf</div></div>
<div class="ttc" id="axspan__impl__common_8h_html_a60304b65bf89363bcc3165d3cde67f86"><div class="ttname"><a href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a></div><div class="ttdeci">size_type size() const</div><div class="ttdef"><b>Definition:</b> <a href="xspan__impl__common_8h_source.html#l00460">xspan_impl_common.h:460</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="miniacc_8h.html#a8418a712b181d53b01101c70f6090ee5">ACC_ICONV</a>, <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size()</a>, <a class="el" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>, and <a class="el" href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>.</p>

<p class="reference">Referenced by <a class="el" href="msg_8cpp.html#a0511f53ec8c1d85f0b9b82ab6ab02f9a">info()</a>, <a class="el" href="msg_8cpp.html#aa6166e9ce1687c1e384907470d4474a6">infoHeader()</a>, <a class="el" href="msg_8cpp.html#a4c0f7ae33d297188264f626f6818adad">infoWarning()</a>, <a class="el" href="msg_8cpp.html#a52494a80bc9e2392058eee9152d12578">printErr()</a>, <a class="el" href="msg_8cpp.html#a108c61284004fd15ae8419264eb6e09b">printWarn()</a>, <a class="el" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f">upx_safe_snprintf()</a>, and <a class="el" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_cgraph.png" border="0" usemap="#asnprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_cgraph" alt=""/></div>
<map name="asnprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_cgraph" id="asnprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,152,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="200,5,248,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="296,5,387,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="435,5,561,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_icgraph.png" border="0" usemap="#asnprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_icgraph" alt=""/></div>
<map name="asnprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_icgraph" id="asnprintf_8cpp_afe32fefd67da2c86f318a89731cdad88_icgraph">
<area shape="rect" title=" " alt="" coords="1404,1211,1551,1237"/>
<area shape="rect" href="msg_8cpp.html#a0511f53ec8c1d85f0b9b82ab6ab02f9a" title=" " alt="" coords="1259,66,1306,91"/>
<area shape="rect" href="msg_8cpp.html#a4c0f7ae33d297188264f626f6818adad" title=" " alt="" coords="1022,15,1122,41"/>
<area shape="rect" href="msg_8cpp.html#aa6166e9ce1687c1e384907470d4474a6" title=" " alt="" coords="1235,1262,1330,1287"/>
<area shape="rect" href="msg_8cpp.html#a52494a80bc9e2392058eee9152d12578" title=" " alt="" coords="1247,1311,1318,1337"/>
<area shape="rect" href="msg_8cpp.html#a108c61284004fd15ae8419264eb6e09b" title=" " alt="" coords="803,1211,888,1237"/>
<area shape="rect" href="snprintf_8cpp.html#aefb5ecd87245d4c8804418d9fd916d5f" title=" " alt="" coords="1213,745,1352,770"/>
<area shape="rect" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb" title=" " alt="" coords="1209,1361,1356,1386"/>
<area shape="rect" href="msg_8cpp.html#a9d720f791d6fd68748cb41d1f58ae46f" title=" " alt="" coords="321,66,416,91"/>
<area shape="rect" href="classPeFile.html#ad9fc5f9eff8c16e397552c1a0681b632" title="Create UPX0 section with compressed full executable." alt="" coords="108,166,216,191"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a9d3ea2cdd37f72f457346b9b2e0010dc" title=" " alt="" coords="539,319,690,359"/>
<area shape="rect" href="classPeFile.html#abf1fb5e63caa5794a600596bc3d9b099" title=" " alt="" coords="270,115,467,141"/>
<area shape="rect" href="classUiPacker.html#ad8ae73893897d820b121cfd367d10e77" title=" " alt="" coords="993,511,1151,537"/>
<area shape="rect" href="classUiPacker.html#aa6695297fa390bbcdf75526c701b5c2f" title=" " alt="" coords="529,611,701,637"/>
<area shape="rect" href="classElfLinker.html#ae734830b45899f5a685654cb1736697d" title=" " alt="" coords="986,745,1158,770"/>
<area shape="rect" href="classElfLinker.html#ab1fade76dc005235b127cd26316a51c4" title=" " alt="" coords="756,761,935,786"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#ab37e1dfdd7e53f34a3829a541d18c7ce" title=" " alt="" coords="997,795,1147,835"/>
<area shape="rect" href="util_8cpp.html#a822ef1a8d7f44a14b9c655a2e456940b" title=" " alt="" coords="1013,859,1131,885"/>
<area shape="rect" href="util_8cpp.html#afd535abdda123db1d1b691b588917162" title=" " alt="" coords="1007,909,1137,934"/>
<area shape="rect" href="ui_8cpp.html#a0b3f1497cefecad060e020f390bf0dcc" title=" " alt="" coords="1039,1110,1105,1135"/>
<area shape="rect" href="classUiPacker.html#a2c6a2659f3d92d26f4ac922fc42f4252" title=" " alt="" coords="769,959,921,985"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a7e904372b5c18a9bafc0a0075c078b0b" title=" " alt="" coords="997,383,1147,423"/>
<area shape="rect" href="msg_8cpp.html#aa1f2d3914fb7d6a826e7276e8f542847" title=" " alt="" coords="1035,1061,1109,1086"/>
<area shape="rect" href="msg_8cpp.html#ac214d3199ed0588967b705d709909d67" title=" " alt="" coords="810,1061,881,1086"/>
<area shape="rect" href="classPeFile.html#aa837c0972c716047dfb4ddfd3d21e02f" title=" " alt="" coords="521,193,708,218"/>
<area shape="rect" href="util_8cpp.html#a68184923ba8a182cf87e6f761f391b40" title=" " alt="" coords="1001,643,1143,669"/>
<area shape="rect" href="classMemBuffer.html#a24b991e9e3a445fc9edb4cba6cdcdb41" title=" " alt="" coords="983,218,1161,243"/>
<area shape="rect" href="dt__check_8cpp.html#a3a6b242ecd120ddf74c7aefb91486186" title=" " alt="" coords="536,1153,693,1193"/>
<area shape="rect" href="classUiPacker.html#ab786a18aad2abfb3e6e228b2a1061e6c" title=" " alt="" coords="760,447,931,473"/>
<area shape="rect" href="classUiPacker.html#a0b969da42e2785054c6ca9f98600eb42" title=" " alt="" coords="762,497,929,522"/>
<area shape="rect" href="classUiPacker.html#a0cb074e9a2b6997bd3094f10ba617554" title="the callback" alt="" coords="774,547,917,587"/>
<area shape="rect" href="work_8cpp.html#acb26fb37f44aef462017c0319a0c7b51" title="process one file" alt="" coords="797,859,893,885"/>
<area shape="rect" href="work_8cpp.html#a9ec6798d280944a40890ad8f08dbe964" title=" " alt="" coords="333,1027,405,1053"/>
<area shape="rect" href="main_8cpp.html#ae733ccfc8b1bfd23af63d56f51903f1d" title="main entry point" alt="" coords="119,1161,205,1186"/>
<area shape="rect" href="main_8cpp.html#a7726c3c4e37d3478021cf41b755207eb" title="real entry point" alt="" coords="5,1190,60,1215"/>
<area shape="rect" href="classUiPacker.html#ad08273e0a8c72e60d1142cf8642a5a52" title=" " alt="" coords="785,1110,906,1135"/>
<area shape="rect" href="classUiPacker.html#a338cc89db30f2940545410a19a4d3313" title=" " alt="" coords="769,1261,921,1286"/>
<area shape="rect" href="classUiPacker.html#ad9dfb3d9345980ee7c9745a34660d530" title=" " alt="" coords="760,1310,931,1335"/>
<area shape="rect" href="classUiPacker.html#ad872e08ac0689db01af6b92981240926" title=" " alt="" coords="535,953,694,978"/>
<area shape="rect" href="classUiPacker.html#a12f3b46c4adf8051276daccaff15f2ee" title=" " alt="" coords="525,1002,704,1027"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#a4eba97bc1df4f2743bab0757dd64acdf" title=" " alt="" coords="770,319,921,359"/>
<area shape="rect" href="classPeFile_1_1ImportLinker.html#ae03ad2cf981fe13520474042323181fc" title=" " alt="" coords="770,383,921,423"/>
<area shape="rect" href="classMemBuffer.html#adefde4c29dbecfa830fa198f6f22b538" title=" " alt="" coords="540,1269,689,1294"/>
<area shape="rect" href="msg_8cpp.html#a949f70c2ca1e1beaecea9a2b91e8582a" title=" " alt="" coords="521,1103,708,1129"/>
<area shape="rect" href="classPeFile.html#a8232ec2b156471ca27d54bfdc7594dd4" title=" " alt="" coords="264,217,473,242"/>
<area shape="rect" href="classPackPs1.html#a542fd798443fb299c1d95ee98db5ae53" title=" " alt="" coords="788,711,903,737"/>
<area shape="rect" href="classUiPacker.html#a887309fdbf007cc17ddfa2896ee3f63c" title="start callback" alt="" coords="775,662,916,687"/>
<area shape="rect" href="classMemBuffer.html#a4909e2f9df016dda4d2a9e4d1991e7be" title=" " alt="" coords="774,218,917,243"/>
<area shape="rect" href="snprintf_8cpp.html#a22424cbb4c1d4ffe04729daecfc54e61" title=" " alt="" coords="1003,1335,1141,1361"/>
<area shape="rect" href="snprintf_8cpp.html#a4fb53e9895b931be2924d854870908b9" title=" " alt="" coords="1007,1385,1137,1410"/>
</map>
</div>

</div>
</div>
<a id="a42250e1e335a2b4f145b776af619c05e" name="a42250e1e335a2b4f145b776af619c05e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42250e1e335a2b4f145b776af619c05e">&#9670;&#160;</a></span>upx_safe_vsnprintf_noexcept()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int upx_safe_vsnprintf_noexcept </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="conf_8h.html#a75343ac8600d9203b7875a1e9c238998">upx_rsize_t</a>&#160;</td>
          <td class="paramname"><em>max_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00080">80</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>                                                     {</div>
<div class="line"><span class="lineno">   82</span><span class="preprocessor">#undef vsnprintf</span></div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordtype">size_t</span> <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a>;</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="comment">// preconditions</span></div>
<div class="line"><span class="lineno">   86</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(max_size &lt;= <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">if</span> (str != <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">   88</span>        <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(max_size &gt; 0);</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   90</span>        <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(max_size == 0);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> len = <a class="code hl_define" href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>(str, max_size, format, ap);</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(len &gt;= 0);</div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(len &lt; <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> = (<a class="code hl_typedef" href="bsd_8h.html#acf18a0d6c4b39d531e021702e9a77984">size_t</a>) len + 1;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="comment">// postconditions</span></div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> &gt; 0);</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> &lt;= <a class="code hl_define" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>);</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">if</span> (str != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno">  101</span>        <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> &lt;= max_size);</div>
<div class="line"><span class="lineno">  102</span>        <a class="code hl_define" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>(str[<a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> - 1] == <span class="charliteral">&#39;\0&#39;</span>);</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="miniacc_8h.html#a8418a712b181d53b01101c70f6090ee5">ACC_ICONV</a>(<span class="keywordtype">int</span>, <a class="code hl_function" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size</a> - 1); <span class="comment">// snprintf() returns length, not size</span></div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">#define vsnprintf upx_safe_vsnprintf</span></div>
<div class="line"><span class="lineno">  107</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="miniacc_8h.html#a8418a712b181d53b01101c70f6090ee5">ACC_ICONV</a>, <a class="el" href="conf_8h.html#a2b4c65ac64db4f1fec7f03b6dcd0eaa8">assert_noexcept</a>, <a class="el" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86">size()</a>, <a class="el" href="conf_8h.html#a0b8b7ab807afaa9e73cb750887aa60b9">UPX_RSIZE_MAX_STR</a>, and <a class="el" href="snprintf_8cpp.html#a00ba2ca988495904efc418acbf0627d7">vsnprintf</a>.</p>

<p class="reference">Referenced by <a class="el" href="except_8cpp.html#a130016d13089a56e18c1b7f6f95b2bb9">throwCantPack()</a>, <a class="el" href="except_8cpp.html#a2a6759e920ceddb8cf4299eff12c59c9">throwCantUnpack()</a>, and <a class="el" href="except_8cpp.html#a5937408aef81aac4a9bf271939aa2cc8">throwInternalError()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_cgraph.png" border="0" usemap="#asnprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_cgraph" alt=""/></div>
<map name="asnprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_cgraph" id="asnprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,152,45"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="200,13,248,38"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="296,13,387,38"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="435,13,561,38"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_icgraph.png" border="0" usemap="#asnprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_icgraph" alt=""/></div>
<map name="asnprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_icgraph" id="asnprintf_8cpp_a42250e1e335a2b4f145b776af619c05e_icgraph">
<area shape="rect" title=" " alt="" coords="193,47,340,87"/>
<area shape="rect" href="except_8cpp.html#a130016d13089a56e18c1b7f6f95b2bb9" title="varargs overloads" alt="" coords="16,5,135,31"/>
<area shape="rect" href="except_8cpp.html#a2a6759e920ceddb8cf4299eff12c59c9" title=" " alt="" coords="6,55,145,80"/>
<area shape="rect" href="except_8cpp.html#a5937408aef81aac4a9bf271939aa2cc8" title=" " alt="" coords="5,104,145,129"/>
</map>
</div>

</div>
</div>
<a id="a4fb53e9895b931be2924d854870908b9" name="a4fb53e9895b931be2924d854870908b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fb53e9895b931be2924d854870908b9">&#9670;&#160;</a></span>upx_safe_xprintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * upx_safe_xprintf </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="snprintf_8cpp_source.html#l00151">151</a> of file <a class="el" href="snprintf_8cpp_source.html">snprintf.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  151</span>                                                {</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordtype">char</span> *<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  153</span>    va_list ap;</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordtype">int</span> len;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    va_start(ap, format);</div>
<div class="line"><span class="lineno">  157</span>    len = <a class="code hl_function" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf</a>(&amp;<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, format, ap);</div>
<div class="line"><span class="lineno">  158</span>    va_end(ap);</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_define" href="conf_8h.html#a5f64c424fc4e04a8b3afd79a1e245625">UNUSED</a>(len);</div>
<div class="line"><span class="lineno">  160</span>    assert(<a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a> != <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>;</div>
<div class="line"><span class="lineno">  162</span>}</div>
<div class="ttc" id="aconf_8h_html_a5f64c424fc4e04a8b3afd79a1e245625"><div class="ttname"><a href="conf_8h.html#a5f64c424fc4e04a8b3afd79a1e245625">UNUSED</a></div><div class="ttdeci">#define UNUSED(var)</div><div class="ttdef"><b>Definition:</b> <a href="conf_8h_source.html#l00239">conf.h:239</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="lzma__m_8h.html#a7b01bc9a5d719e0ece76d9b8dd822dde">ptr</a>, <a class="el" href="conf_8h.html#a5f64c424fc4e04a8b3afd79a1e245625">UNUSED</a>, and <a class="el" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb">upx_safe_vasprintf()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="snprintf_8cpp_a4fb53e9895b931be2924d854870908b9_cgraph.png" border="0" usemap="#asnprintf_8cpp_a4fb53e9895b931be2924d854870908b9_cgraph" alt=""/></div>
<map name="asnprintf_8cpp_a4fb53e9895b931be2924d854870908b9_cgraph" id="asnprintf_8cpp_a4fb53e9895b931be2924d854870908b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,136,31"/>
<area shape="rect" href="snprintf_8cpp.html#abe4fbca72a8613a044a180546c89c3fb" title=" " alt="" coords="184,5,331,31"/>
<area shape="rect" href="snprintf_8cpp.html#afe32fefd67da2c86f318a89731cdad88" title=" " alt="" coords="379,5,525,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#a60304b65bf89363bcc3165d3cde67f86" title=" " alt="" coords="573,5,621,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#af7f8ff1beaa5a2bfec38929faa15a546" title=" " alt="" coords="669,5,760,31"/>
<area shape="rect" href="xspan__impl__common_8h.html#adc002fafd98360e97e7066a463592829" title=" " alt="" coords="808,5,935,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7878ad5ecbf2506f4125b9d34c97e45.html">util</a></li><li class="navelem"><a class="el" href="snprintf_8cpp.html">snprintf.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
